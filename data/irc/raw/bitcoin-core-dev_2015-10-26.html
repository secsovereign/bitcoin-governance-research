<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-10-26
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-10-26' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-09-26">&lt;</a><span class='header'>   October 2015   </span><a href="/bitcoin-core-dev/2015-11-26">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2015-10-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-10-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2015-10-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-10-09">9</a> <a class="" href="/bitcoin-core-dev/2015-10-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-11">11</a> <a class="" href="/bitcoin-core-dev/2015-10-12">12</a> <a class="" href="/bitcoin-core-dev/2015-10-13">13</a> <a class="" href="/bitcoin-core-dev/2015-10-14">14</a> <a class="" href="/bitcoin-core-dev/2015-10-15">15</a> <a class="" href="/bitcoin-core-dev/2015-10-16">16</a> <a class="" href="/bitcoin-core-dev/2015-10-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-18">18</a> <a class="" href="/bitcoin-core-dev/2015-10-19">19</a> <a class="" href="/bitcoin-core-dev/2015-10-20">20</a> <a class="" href="/bitcoin-core-dev/2015-10-21">21</a> <a class="" href="/bitcoin-core-dev/2015-10-22">22</a> <a class="" href="/bitcoin-core-dev/2015-10-23">23</a> <a class="" href="/bitcoin-core-dev/2015-10-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-25">25</a> <a class="current" href="/bitcoin-core-dev/2015-10-26">26</a> <a class="" href="/bitcoin-core-dev/2015-10-27">27</a> <a class="" href="/bitcoin-core-dev/2015-10-28">28</a> <a class="" href="/bitcoin-core-dev/2015-10-29">29</a> <a class="" href="/bitcoin-core-dev/2015-10-30">30</a> <a class="" href="/bitcoin-core-dev/2015-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1445843160' id='432223'>
<a class='timestamp' href='#432223'><time timestamp='2015-10-26T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/46f74379b86b...450893769f7a" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/46f74379b86b...450893769f7a</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445843160' id='432224'>
<a class='timestamp' href='#432224'><time timestamp='2015-10-26T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
bitcoin/master ceb2a9c Wladimir J. van der Laan: doc: mention BIP65 softfork in bips.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1445843160' id='432225'>
<a class='timestamp' href='#432225'><time timestamp='2015-10-26T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
bitcoin/master 4508937 Wladimir J. van der Laan: Merge pull request #6879...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445843160' id='432226'>
<a class='timestamp' href='#432226'><time timestamp='2015-10-26T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-15'> GitHub137</span>&gt;
[bitcoin] laanwj closed pull request #6879: doc: mention BIP65 softfork in bips.md (master...2015_10_bip65) <a href="https://github.com/bitcoin/bitcoin/pull/6879" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6879</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445844060' id='432227'>
<a class='timestamp' href='#432227'><time timestamp='2015-10-26T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/450893769f7a...867d6c90b850" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/450893769f7a...867d6c90b850</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445844060' id='432228'>
<a class='timestamp' href='#432228'><time timestamp='2015-10-26T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
bitcoin/master dca7bd3 Wladimir J. van der Laan: doc: Add developer notes about gitignore...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445844060' id='432229'>
<a class='timestamp' href='#432229'><time timestamp='2015-10-26T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
bitcoin/master 867d6c9 Wladimir J. van der Laan: Merge pull request #6878...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445844060' id='432230'>
<a class='timestamp' href='#432230'><time timestamp='2015-10-26T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-14'> GitHub17</span>&gt;
[bitcoin] laanwj closed pull request #6878: doc: Add developer notes about gitignore (master...2015_10_ignore_files) <a href="https://github.com/bitcoin/bitcoin/pull/6878" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6878</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445844900' id='432231'>
<a class='timestamp' href='#432231'><time timestamp='2015-10-26T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
gmaxwell: re: -maxuploadtarget. Will try to complete it today. Need to adapt sdaftuar tests and rebase/squash.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445847000' id='432232'>
<a class='timestamp' href='#432232'><time timestamp='2015-10-26T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-15'> GitHub137</span>&gt;
[bitcoin] laanwj pushed 7 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/867d6c90b850...5242bb32c723" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/867d6c90b850...5242bb32c723</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445847000' id='432233'>
<a class='timestamp' href='#432233'><time timestamp='2015-10-26T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-15'> GitHub137</span>&gt;
bitcoin/master 4d2a926 dexX7: Ignore coverage data related and temporary test files
<br>
</div>

<div class='talk op-msg' data-timestamp='1445847000' id='432234'>
<a class='timestamp' href='#432234'><time timestamp='2015-10-26T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-15'> GitHub137</span>&gt;
bitcoin/master d425877 dexX7: Remove coverage and test related files, when cleaning up...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445847000' id='432235'>
<a class='timestamp' href='#432235'><time timestamp='2015-10-26T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-15'> GitHub137</span>&gt;
bitcoin/master 8e3a27b dexX7: Require Python for RPC tests, when using lcov...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445847000' id='432236'>
<a class='timestamp' href='#432236'><time timestamp='2015-10-26T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-4'> GitHub173</span>&gt;
[bitcoin] laanwj closed pull request #6813: Support gathering code coverage data for RPC tests with lcov (master...btc-test-lcov-rpc) <a href="https://github.com/bitcoin/bitcoin/pull/6813" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6813</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445848440' id='432237'>
<a class='timestamp' href='#432237'><time timestamp='2015-10-26T08:34:00Z'>08:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
anyone getting the same build errors (osx) for current master: boost: mutex lock failed in pthread_mutex_lock: Invalid argument?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445848500' id='432238'>
<a class='timestamp' href='#432238'><time timestamp='2015-10-26T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-12'> * jonasschnelli</span>&gt;
is doing a fresh checkout / build
<br>
</div>

<div class='talk op-msg' data-timestamp='1445848980' id='432239'>
<a class='timestamp' href='#432239'><time timestamp='2015-10-26T08:43:00Z'>08:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
hmm.. same issue when doing a fresh checkout / build...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849040' id='432240'>
<a class='timestamp' href='#432240'><time timestamp='2015-10-26T08:44:00Z'>08:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
is that a <b>*build*</b> error?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849040' id='432241'>
<a class='timestamp' href='#432241'><time timestamp='2015-10-26T08:44:00Z'>08:44</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
libc++abi.dylib: terminating with uncaught exception of type boost::exception_detail::clone_impl&lt;boost::exception_detail::error_info_injector&lt;boost::lock_error&gt; &gt;: boost: mutex lock failed in pthread_mutex_lock: Invalid argument
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849040' id='432242'>
<a class='timestamp' href='#432242'><time timestamp='2015-10-26T08:44:00Z'>08:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
looks like a runtime errror to me, something abusing boost?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849100' id='432243'>
<a class='timestamp' href='#432243'><time timestamp='2015-10-26T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
i try now to upgarde from 1.57 to 1.58... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849100' id='432244'>
<a class='timestamp' href='#432244'><time timestamp='2015-10-26T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
let&#x27;s first try to debug it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849100' id='432245'>
<a class='timestamp' href='#432245'><time timestamp='2015-10-26T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
when does it happen? can you get a traceback?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849100' id='432246'>
<a class='timestamp' href='#432246'><time timestamp='2015-10-26T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
stacktrace stops when program tries to call the first LOCK
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849160' id='432247'>
<a class='timestamp' href='#432247'><time timestamp='2015-10-26T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849160' id='432248'>
<a class='timestamp' href='#432248'><time timestamp='2015-10-26T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
EnterCritical() / push_lock()
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849160' id='432249'>
<a class='timestamp' href='#432249'><time timestamp='2015-10-26T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
when was the last time it worked? maybe try a git bisect
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849160' id='432250'>
<a class='timestamp' href='#432250'><time timestamp='2015-10-26T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
that is strange: <b>*pthread_mutex_lock: Invalid argument*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849220' id='432251'>
<a class='timestamp' href='#432251'><time timestamp='2015-10-26T08:47:00Z'>08:47</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: okay... i&#x27;ll try to find out if it&#x27;s related to a source change or something on my local machine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849220' id='432252'>
<a class='timestamp' href='#432252'><time timestamp='2015-10-26T08:47:00Z'>08:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
can be a use-after-free of a lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445849280' id='432253'>
<a class='timestamp' href='#432253'><time timestamp='2015-10-26T08:48:00Z'>08:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if it happens at startup it may be a unexpected error path that doesn&#x27;t wind down properly
<br>
</div>

<div class='talk op-msg' data-timestamp='1445850420' id='432254'>
<a class='timestamp' href='#432254'><time timestamp='2015-10-26T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-9'> GitHub136</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/5242bb32c723...26f5b34e8838" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/5242bb32c723...26f5b34e8838</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445850420' id='432255'>
<a class='timestamp' href='#432255'><time timestamp='2015-10-26T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-9'> GitHub136</span>&gt;
bitcoin/master 10e2eae Wladimir J. van der Laan: rpc: Add maxmempool and effective min fee to getmempoolinfo
<br>
</div>

<div class='talk op-msg' data-timestamp='1445850420' id='432256'>
<a class='timestamp' href='#432256'><time timestamp='2015-10-26T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-9'> GitHub136</span>&gt;
bitcoin/master 26f5b34 Wladimir J. van der Laan: Merge pull request #6877...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445850420' id='432257'>
<a class='timestamp' href='#432257'><time timestamp='2015-10-26T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-10'> GitHub170</span>&gt;
[bitcoin] laanwj closed pull request #6877: rpc: Add maxmempool and effective min fee to getmempoolinfo (master...2015_10_mempool_effective_fee) <a href="https://github.com/bitcoin/bitcoin/pull/6877" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6877</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445851980' id='432258'>
<a class='timestamp' href='#432258'><time timestamp='2015-10-26T09:33:00Z'>09:33</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: with the address index comment, you mention it might drive away users, but,  this is an opt-in patch
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852040' id='432259'>
<a class='timestamp' href='#432259'><time timestamp='2015-10-26T09:34:00Z'>09:34</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
I&#x27;d much rather use this than my own self-maintained version of the patch,  hell,  several block explorers I know have written their own implementations eating up much more than 50GB of space etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852280' id='432260'>
<a class='timestamp' href='#432260'><time timestamp='2015-10-26T09:38:00Z'>09:38</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
dcousens: FYI, my .bitcoin folder is 67GB with addrindex turned on. What is it without?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852340' id='432261'>
<a class='timestamp' href='#432261'><time timestamp='2015-10-26T09:39:00Z'>09:39</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
btcdrak: moment, just checking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432262'>
<a class='timestamp' href='#432262'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
56G
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432263'>
<a class='timestamp' href='#432263'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
with -txindex
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432264'>
<a class='timestamp' href='#432264'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
dcousens: but as a maintainer of an addrindex fork, I think this particular implementation is absolutely not the right way to go about it. It&#x27;s ugly. I&#x27;d much prefer to see something like #5048 which maintains a separate index entirely.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432265'>
<a class='timestamp' href='#432265'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Oh no doubt
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432266'>
<a class='timestamp' href='#432266'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
I meant in concept only
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852400' id='432267'>
<a class='timestamp' href='#432267'><time timestamp='2015-10-26T09:40:00Z'>09:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Hence, only my concept ACK
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852460' id='432268'>
<a class='timestamp' href='#432268'><time timestamp='2015-10-26T09:41:00Z'>09:41</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
There might be a way to do this as gmaxwell pointed out, via fast re-scan or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852520' id='432269'>
<a class='timestamp' href='#432269'><time timestamp='2015-10-26T09:42:00Z'>09:42</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
It would just have to be super fast in the case of being feasible for block explorers etc, but, I guess you could just throw some caches/LBs in front of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852580' id='432270'>
<a class='timestamp' href='#432270'><time timestamp='2015-10-26T09:43:00Z'>09:43</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
dcousens: yeah, I&#x27;m not sure how addrindex would scale in the long term.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852700' id='432271'>
<a class='timestamp' href='#432271'><time timestamp='2015-10-26T09:45:00Z'>09:45</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
yeah, but I mean, we have that same concern for the blockchain itself haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852700' id='432272'>
<a class='timestamp' href='#432272'><time timestamp='2015-10-26T09:45:00Z'>09:45</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
I just figured, in terms of worrying about users losing resources, in the end, their opting-in, so they&#x27;d be aware no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852760' id='432273'>
<a class='timestamp' href='#432273'><time timestamp='2015-10-26T09:46:00Z'>09:46</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
dcousens: I&#x27;m no longer as passionate because I provide a fork for those that want it. It&#x27;s easy enough to maintain.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852760' id='432274'>
<a class='timestamp' href='#432274'><time timestamp='2015-10-26T09:46:00Z'>09:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
indexing the whole block chain is generally the wrong thing to do
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852820' id='432275'>
<a class='timestamp' href='#432275'><time timestamp='2015-10-26T09:47:00Z'>09:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and I understand there are forensic or research reasons to do so, but if you end up at that it&#x27;s generally an indication you&#x27;re doing something wrong in your design
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852880' id='432276'>
<a class='timestamp' href='#432276'><time timestamp='2015-10-26T09:48:00Z'>09:48</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: that really depends on your trust model though?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852880' id='432277'>
<a class='timestamp' href='#432277'><time timestamp='2015-10-26T09:48:00Z'>09:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no, it depends on your scaling model
<br>
</div>

<div class='talk op-msg' data-timestamp='1445852940' id='432278'>
<a class='timestamp' href='#432278'><time timestamp='2015-10-26T09:49:00Z'>09:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s best to regard the block chain as transitory data used to update the utxo state
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853000' id='432279'>
<a class='timestamp' href='#432279'><time timestamp='2015-10-26T09:50:00Z'>09:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(as well as other things, such as wallets)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853060' id='432280'>
<a class='timestamp' href='#432280'><time timestamp='2015-10-26T09:51:00Z'>09:51</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
agreed, but the UTXO may not be all you care about.  But yes your right, in that sense, its your scaling model
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853120' id='432281'>
<a class='timestamp' href='#432281'><time timestamp='2015-10-26T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s why I added (as well as other things) - it&#x27;s data you want to use to apply changes to your running state, then throw away
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853120' id='432282'>
<a class='timestamp' href='#432282'><time timestamp='2015-10-26T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: but that lacks the information in the case of a user wanting to see the &#x27;history&#x27; of a certain address
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853120' id='432283'>
<a class='timestamp' href='#432283'><time timestamp='2015-10-26T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bitcoind&#x27;s wallet, as one exaple, does this correctly. It only requires the whole beast for rescans. It would be nice to have an external example though that isn&#x27;t embedded into bitcoind.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853120' id='432284'>
<a class='timestamp' href='#432284'><time timestamp='2015-10-26T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
the only way to generate that history would be to view all hte transitory data
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853180' id='432285'>
<a class='timestamp' href='#432285'><time timestamp='2015-10-26T09:53:00Z'>09:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the way to generate that history would be to store it as it comes along, as metadata
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853180' id='432286'>
<a class='timestamp' href='#432286'><time timestamp='2015-10-26T09:53:00Z'>09:53</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
that assumes you know the address from the start
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853180' id='432287'>
<a class='timestamp' href='#432287'><time timestamp='2015-10-26T09:53:00Z'>09:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the same way bitcoind&#x27;s wallet does - store the transactions, or whatever you need to list it later
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853240' id='432288'>
<a class='timestamp' href='#432288'><time timestamp='2015-10-26T09:54:00Z'>09:54</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
for example for a wallet I maintain, we very often have users that come along with BIP39 mnemonics with 100&#x27;s of used addresses, forcing a rescan for each time they introduce a new mnemonic/wallet would be a huge rescan burden for us
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853240' id='432289'>
<a class='timestamp' href='#432289'><time timestamp='2015-10-26T09:54:00Z'>09:54</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
history (or the part of history that you want to store for accounting purposes) is part of your running state
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853240' id='432290'>
<a class='timestamp' href='#432290'><time timestamp='2015-10-26T09:54:00Z'>09:54</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Which again, relates to our scaling model, but, that too relates directly to this patch (as a concept)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853420' id='432291'>
<a class='timestamp' href='#432291'><time timestamp='2015-10-26T09:57:00Z'>09:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, if you essentially offer rescanning-as-a-service it makes sense to keep an index. I still think it should be something external though, not part of bitcoind. There are tons of differents kinds of indexes one could want, for specific purposes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853420' id='432292'>
<a class='timestamp' href='#432292'><time timestamp='2015-10-26T09:57:00Z'>09:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ideally some external indexing tool would source block data from bitcoind then keep an index, as running state
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853540' id='432293'>
<a class='timestamp' href='#432293'><time timestamp='2015-10-26T09:59:00Z'>09:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so my points are: do not encourage people to keep that index, and do not clutter the codebase with all kinds of extra indexes not necessary for node functionaity. It is not &quot;never create an index&quot;. sure there may be reasons to do so but it&#x27;s very custom
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853600' id='432294'>
<a class='timestamp' href='#432294'><time timestamp='2015-10-26T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: hmmm, but, maintaing this indexing is not a simple task
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853600' id='432295'>
<a class='timestamp' href='#432295'><time timestamp='2015-10-26T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: I think I finally see your point
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853600' id='432296'>
<a class='timestamp' href='#432296'><time timestamp='2015-10-26T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I haven&#x27;t used the word &#x27;simple&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853600' id='432297'>
<a class='timestamp' href='#432297'><time timestamp='2015-10-26T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
It requires a lot of complex logic in regards to re-orgs etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853660' id='432298'>
<a class='timestamp' href='#432298'><time timestamp='2015-10-26T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: I know, just putting it out there as to why this is probably a persistent feature request
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853660' id='432299'>
<a class='timestamp' href='#432299'><time timestamp='2015-10-26T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, it requires logic with regard to re-orgs. To be precise, you need to be able to roll back updates from a block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853660' id='432300'>
<a class='timestamp' href='#432300'><time timestamp='2015-10-26T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bitcoind does this by keeping undo files, but your database may have features to do so as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853720' id='432301'>
<a class='timestamp' href='#432301'><time timestamp='2015-10-26T10:02:00Z'>10:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and once this code is written people can just use it, it&#x27;s no more complex than using your patch
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853720' id='432302'>
<a class='timestamp' href='#432302'><time timestamp='2015-10-26T10:02:00Z'>10:02</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: in my mind, it seems more like its just a way to offload the maintenance burden haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853780' id='432303'>
<a class='timestamp' href='#432303'><time timestamp='2015-10-26T10:03:00Z'>10:03</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
why dont we use zmq to notify external apps?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853780' id='432304'>
<a class='timestamp' href='#432304'><time timestamp='2015-10-26T10:03:00Z'>10:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
there&#x27;s --enable-zmq?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853840' id='432305'>
<a class='timestamp' href='#432305'><time timestamp='2015-10-26T10:04:00Z'>10:04</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: is there a re-org notification?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853840' id='432306'>
<a class='timestamp' href='#432306'><time timestamp='2015-10-26T10:04:00Z'>10:04</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
That would make the roll backs super simple
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853840' id='432307'>
<a class='timestamp' href='#432307'><time timestamp='2015-10-26T10:04:00Z'>10:04</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
it could store whatever it wants, bitcoind would notify about reorgs etc. that would allow to build a sort of indexd. The indexd could always query bitcoind for things like blocks as a passthrough
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853900' id='432308'>
<a class='timestamp' href='#432308'><time timestamp='2015-10-26T10:05:00Z'>10:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
not sure - there is a notification when there is a new block, you can use that to determine if there has been a reorg. But a more direct notification of what blocks have to be un-done/applies might be useful too. Though be careful, zmq notifications can be lossy, so you shouldn&#x27;t rely on their content.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853960' id='432309'>
<a class='timestamp' href='#432309'><time timestamp='2015-10-26T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
btcdrak: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853960' id='432310'>
<a class='timestamp' href='#432310'><time timestamp='2015-10-26T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
indexd would pull the data it requires from bitcoind
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853960' id='432311'>
<a class='timestamp' href='#432311'><time timestamp='2015-10-26T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: if we&#x27;re missing notifications I&#x27;m sure they are easy to add.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445853960' id='432312'>
<a class='timestamp' href='#432312'><time timestamp='2015-10-26T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: really? Are they consistently lossy? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854020' id='432313'>
<a class='timestamp' href='#432313'><time timestamp='2015-10-26T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
dcousens: yes, if the queue is full new messages are discarded
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854020' id='432314'>
<a class='timestamp' href='#432314'><time timestamp='2015-10-26T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: right, so its just a matter of consumption
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854080' id='432315'>
<a class='timestamp' href='#432315'><time timestamp='2015-10-26T10:08:00Z'>10:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
not sure if are any guarantees for delivery - that&#x27;s why I have always been kind of careful there, it&#x27;s easy to use it in a wrong way. Notifications are &quot;hey, wake up, there is new information&quot;. If those get lost there&#x27;s no big issue, it will pick them up next time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854200' id='432316'>
<a class='timestamp' href='#432316'><time timestamp='2015-10-26T10:10:00Z'>10:10</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: mmm, I guess, in the end, its as btcdrak as suggested.  The underyling problem is that the maintenance of the address index becomes difficult due to re-org detection.  If we can have bitcoind provide us with that information in a clear way, most of this becomes trivial
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854260' id='432317'>
<a class='timestamp' href='#432317'><time timestamp='2015-10-26T10:11:00Z'>10:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m not sure reorg detection is so difficult? keep the list of hashes up to the current block, then if a new best block comes in, look at its parents, where it intersects with the list of your blocks is the fork/reorg point
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854320' id='432318'>
<a class='timestamp' href='#432318'><time timestamp='2015-10-26T10:12:00Z'>10:12</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: requires maintaing another list, another source of data
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854320' id='432319'>
<a class='timestamp' href='#432319'><time timestamp='2015-10-26T10:12:00Z'>10:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes it does
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854320' id='432320'>
<a class='timestamp' href='#432320'><time timestamp='2015-10-26T10:12:00Z'>10:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s life, you need to maintain the data structures that you need to do your work. only be keeping this state yourself you can be sure your state is consistent.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854380' id='432321'>
<a class='timestamp' href='#432321'><time timestamp='2015-10-26T10:13:00Z'>10:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
indexd could even use bitcoind for SPV lookups
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854440' id='432322'>
<a class='timestamp' href='#432322'><time timestamp='2015-10-26T10:14:00Z'>10:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
would be great to have some library or existing software to handle this for you, I&#x27;m just talking concepts here not implementation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854440' id='432323'>
<a class='timestamp' href='#432323'><time timestamp='2015-10-26T10:14:00Z'>10:14</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
btcdrak: I was thinking about that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854440' id='432324'>
<a class='timestamp' href='#432324'><time timestamp='2015-10-26T10:14:00Z'>10:14</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
you don&#x27;t even need to verify since you&#x27;d already trust your own node
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854500' id='432325'>
<a class='timestamp' href='#432325'><time timestamp='2015-10-26T10:15:00Z'>10:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right - you outsource trust to your node, verification, that&#x27;s what it&#x27;s for
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854500' id='432326'>
<a class='timestamp' href='#432326'><time timestamp='2015-10-26T10:15:00Z'>10:15</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
just as wumpus said, probably still need to maintain the hash-chain if theres no notification for re-orgs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854500' id='432327'>
<a class='timestamp' href='#432327'><time timestamp='2015-10-26T10:15:00Z'>10:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well you need to know what hash-chain your state is based on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854560' id='432328'>
<a class='timestamp' href='#432328'><time timestamp='2015-10-26T10:16:00Z'>10:16</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
well, not really, all you actually care about is what blocks got reverted, such that you can roll back the relevant transactions in the index
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854620' id='432329'>
<a class='timestamp' href='#432329'><time timestamp='2015-10-26T10:17:00Z'>10:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
otherwise the couling is dangerously tight, say, your indexd was disconnected from bitcoind for a while and you reconnect and have to catch up
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854620' id='432330'>
<a class='timestamp' href='#432330'><time timestamp='2015-10-26T10:17:00Z'>10:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
coupling*
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854620' id='432331'>
<a class='timestamp' href='#432331'><time timestamp='2015-10-26T10:17:00Z'>10:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, but you need to detect that yourself. You can&#x27;t rely on bitcoind to keep state for you
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854620' id='432332'>
<a class='timestamp' href='#432332'><time timestamp='2015-10-26T10:17:00Z'>10:17</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: it would know what blocks get reverted in a re-org, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854680' id='432333'>
<a class='timestamp' href='#432333'><time timestamp='2015-10-26T10:18:00Z'>10:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but only in realtime - ideally you don&#x27;t want that kind of tight coupling. What if indexd wasn&#x27;t connected at the time the reorg happens. Do you want to restart all the way from the beginning? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854680' id='432334'>
<a class='timestamp' href='#432334'><time timestamp='2015-10-26T10:18:00Z'>10:18</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
true
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854740' id='432335'>
<a class='timestamp' href='#432335'><time timestamp='2015-10-26T10:19:00Z'>10:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
you have a) your own hash chain b) bitcoind&#x27;s hash chain  , you always want to go from a to b
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854740' id='432336'>
<a class='timestamp' href='#432336'><time timestamp='2015-10-26T10:19:00Z'>10:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(given that you trust bitcoind to give you the best chain)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854800' id='432337'>
<a class='timestamp' href='#432337'><time timestamp='2015-10-26T10:20:00Z'>10:20</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: i can successfully build up to <a href="https://github.com/bitcoin/bitcoin/commit/579b863cd7586b98974484ad55e19be2a54d241d" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/579b863cd7586b98974484ad55e19be2a54d241d</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854800' id='432338'>
<a class='timestamp' href='#432338'><time timestamp='2015-10-26T10:20:00Z'>10:20</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: <a href="https://github.com/bitcoin/bitcoin/commit/a09297010e171af28a7a3fcad65a4e0aefea53ba" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/a09297010e171af28a7a3fcad65a4e0aefea53ba</a> seams to break things.. how can this even be possible...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854800' id='432339'>
<a class='timestamp' href='#432339'><time timestamp='2015-10-26T10:20:00Z'>10:20</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
no code changes at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854860' id='432340'>
<a class='timestamp' href='#432340'><time timestamp='2015-10-26T10:21:00Z'>10:21</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
btcdrak: happy to work with you on indexd concept
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854860' id='432341'>
<a class='timestamp' href='#432341'><time timestamp='2015-10-26T10:21:00Z'>10:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
would be awesome if someone implemented that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854860' id='432342'>
<a class='timestamp' href='#432342'><time timestamp='2015-10-26T10:21:00Z'>10:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: huh that just changes my silly dev tools :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445854920' id='432343'>
<a class='timestamp' href='#432343'><time timestamp='2015-10-26T10:22:00Z'>10:22</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
yeah. I know... let me investigate more
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855280' id='432344'>
<a class='timestamp' href='#432344'><time timestamp='2015-10-26T10:28:00Z'>10:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so 0fbfc51 works?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855400' id='432345'>
<a class='timestamp' href='#432345'><time timestamp='2015-10-26T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(that&#x27;s the last commit before merging #6854)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855580' id='432346'>
<a class='timestamp' href='#432346'><time timestamp='2015-10-26T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-11'> GitHub168</span>&gt;
[bitcoin] laanwj pushed 3 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/26f5b34e8838...ff057f41aa14" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/26f5b34e8838...ff057f41aa14</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855580' id='432347'>
<a class='timestamp' href='#432347'><time timestamp='2015-10-26T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-11'> GitHub168</span>&gt;
bitcoin/master 9d55050 Mark Friedenbach: Add rules--presently disabled--for using GetMedianTimePast as endpoint for lock-time calculations...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855580' id='432348'>
<a class='timestamp' href='#432348'><time timestamp='2015-10-26T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-11'> GitHub168</span>&gt;
bitcoin/master dea8d21 Mark Friedenbach: Enable policy enforcing GetMedianTimePast as the end point of lock-time constraints...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855580' id='432349'>
<a class='timestamp' href='#432349'><time timestamp='2015-10-26T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-11'> GitHub168</span>&gt;
bitcoin/master ff057f4 Wladimir J. van der Laan: Merge pull request #6566...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855580' id='432350'>
<a class='timestamp' href='#432350'><time timestamp='2015-10-26T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-15'> GitHub161</span>&gt;
[bitcoin] laanwj closed pull request #6566: BIP-113: Mempool-only median time-past as endpoint for lock-time calculations (master...medianpasttimelock) <a href="https://github.com/bitcoin/bitcoin/pull/6566" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6566</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855760' id='432351'>
<a class='timestamp' href='#432351'><time timestamp='2015-10-26T10:36:00Z'>10:36</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
dcousens: sure.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855880' id='432352'>
<a class='timestamp' href='#432352'><time timestamp='2015-10-26T10:38:00Z'>10:38</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: would it better to maintain indexd in repo or as a separate application?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445855940' id='432353'>
<a class='timestamp' href='#432353'><time timestamp='2015-10-26T10:39:00Z'>10:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well - better is always to have it completely detached, but I suppose developing it inside the repository is easier for now if you need serialization and certain data structures
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856000' id='432354'>
<a class='timestamp' href='#432354'><time timestamp='2015-10-26T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we don&#x27;t have a way to export those as a library yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856000' id='432355'>
<a class='timestamp' href='#432355'><time timestamp='2015-10-26T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus : found the problem: <a href="https://github.com/bitcoin/bitcoin/pull/6722/files#diff-ca74c4b28865382863b8fe7633a85cd6R312" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6722/files#diff-ca74c4b28865382863b8fe7633a85cd6R312</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856000' id='432356'>
<a class='timestamp' href='#432356'><time timestamp='2015-10-26T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: aye
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856000' id='432357'>
<a class='timestamp' href='#432357'><time timestamp='2015-10-26T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
clear() calls LOCK() in cxx_global_var_init() 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856060' id='432358'>
<a class='timestamp' href='#432358'><time timestamp='2015-10-26T10:41:00Z'>10:41</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
i think this should be changed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856240' id='432359'>
<a class='timestamp' href='#432359'><time timestamp='2015-10-26T10:44:00Z'>10:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
common, straightforward to do this is to separate it out into a private function, say clear_(), and a public function clear() that gets the lock and calls clear_()
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856240' id='432360'>
<a class='timestamp' href='#432360'><time timestamp='2015-10-26T10:44:00Z'>10:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this way, functions that already have the lock, or don&#x27;t need it otherwise, can call clear_ instead
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856300' id='432361'>
<a class='timestamp' href='#432361'><time timestamp='2015-10-26T10:45:00Z'>10:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in this case it is the constructor so obviously it doesn&#x27;t need the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856300' id='432362'>
<a class='timestamp' href='#432362'><time timestamp='2015-10-26T10:45:00Z'>10:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
okay... can try a patch.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856540' id='432363'>
<a class='timestamp' href='#432363'><time timestamp='2015-10-26T10:49:00Z'>10:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
not that it should normally hurt to lock a lock that is part of your object inthe constructor... but this looks like some global obscure initialization order thing because the mempool object is global :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1445856660' id='432364'>
<a class='timestamp' href='#432364'><time timestamp='2015-10-26T10:51:00Z'>10:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(probably it would be better to use an explicit lifetime for objects such as these, but fixing that is more than you bargained for)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445859120' id='432365'>
<a class='timestamp' href='#432365'><time timestamp='2015-10-26T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
huh, the wallet rescan % shown in the splash screen is much higher than the debug.log Progress - block count vs tx count? :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445859360' id='432366'>
<a class='timestamp' href='#432366'><time timestamp='2015-10-26T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
GUIstd::max(1, std::min(99, (int)((Checkpoints::GuessVerificationProgress(chainParams.Checkpoints(), pindex, false) - dProgressStart) / (dProgressTip - dProgressStart) * 100)))
<br>
</div>

<div class='talk op-msg' data-timestamp='1445859360' id='432367'>
<a class='timestamp' href='#432367'><time timestamp='2015-10-26T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
log: Checkpoints::GuessVerificationProgress(chainParams.Checkpoints(), pindex)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445859420' id='432368'>
<a class='timestamp' href='#432368'><time timestamp='2015-10-26T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the GUI takes into account the starting point, which you&#x27;d expect would result in it showing a <b>*lower*</b> progress % when it makes a difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1445859480' id='432369'>
<a class='timestamp' href='#432369'><time timestamp='2015-10-26T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but the GUI also has fSigchecks=false for GuessVerificationprogress, maybe tha&#x27;ts it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445863320' id='432370'>
<a class='timestamp' href='#432370'><time timestamp='2015-10-26T12:42:00Z'>12:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this is curious, anyone else having problems with address parsing on windows 10? <a href="https://github.com/bitcoin/bitcoin/issues/6886" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/6886</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445863440' id='432371'>
<a class='timestamp' href='#432371'><time timestamp='2015-10-26T12:44:00Z'>12:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
looks like the IP parsing (using getaddrinfo) always returns 0:0:0:0:0:0:0:0/128, IPv4 parsing as well as IPv6 parsing fails
<br>
</div>

<div class='talk op-msg' data-timestamp='1445867820' id='432372'>
<a class='timestamp' href='#432372'><time timestamp='2015-10-26T13:57:00Z'>13:57</time></a>
&lt;<span class='nick nick-7'> GitHub175</span>&gt;
[bitcoin] jonasschnelli opened pull request #6889: fix locking issue with new mempool limiting (master...2015/10/fix_mempool_lock) <a href="https://github.com/bitcoin/bitcoin/pull/6889" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6889</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445870760' id='432373'>
<a class='timestamp' href='#432373'><time timestamp='2015-10-26T14:46:00Z'>14:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Does anybody have any thoughts on storing the number of sigOps in a tx in the CTxMempoolEntry?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445870820' id='432374'>
<a class='timestamp' href='#432374'><time timestamp='2015-10-26T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
We calculate this on ATMP, and we need it in CreateNewBlock, but it is on the expensive&#x27;ish side to calculate.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445870880' id='432375'>
<a class='timestamp' href='#432375'><time timestamp='2015-10-26T14:48:00Z'>14:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sounds good
<br>
</div>

<div class='talk op-msg' data-timestamp='1445870880' id='432376'>
<a class='timestamp' href='#432376'><time timestamp='2015-10-26T14:48:00Z'>14:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Wow, I was prepared to have to fight for that... :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871000' id='432377'>
<a class='timestamp' href='#432377'><time timestamp='2015-10-26T14:50:00Z'>14:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I was naively hoping you could just assume every scriptSig was satisfying a P2SH and you wouldn&#x27;t over count by too much, but turns out that is NOT the case..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871300' id='432378'>
<a class='timestamp' href='#432378'><time timestamp='2015-10-26T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-3'> dgenr8</span>&gt;
morcos: any plans to cache ancestor pkg sums the way descendants are? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871360' id='432379'>
<a class='timestamp' href='#432379'><time timestamp='2015-10-26T14:56:00Z'>14:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
dgenr8: sdaftuar has written something which he might publish soon.  but i don&#x27;t think there is any point in merging it until we have mining code that can take advantage of it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871420' id='432380'>
<a class='timestamp' href='#432380'><time timestamp='2015-10-26T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m starting by just trying to make the existing mining code much faster
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871540' id='432381'>
<a class='timestamp' href='#432381'><time timestamp='2015-10-26T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
02:58 &lt; gmaxwell&gt; Is there a reason that for fee purposes we are not using max(size, sigops*BLOCK_MAX_BYTES/BLOCK_MAX_SIGOPS) as the size of a transaction?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871540' id='432382'>
<a class='timestamp' href='#432382'><time timestamp='2015-10-26T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
as in &quot;the size&quot; that we use for mempool/etc. purposes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871720' id='432383'>
<a class='timestamp' href='#432383'><time timestamp='2015-10-26T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
dcousens: Opt-in isn&#x27;t sufficient to prevent it from driving users out, I do explain this...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871720' id='432384'>
<a class='timestamp' href='#432384'><time timestamp='2015-10-26T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: i saw that.  on my list somewhere is to research algorithms for satisfying multiple constraints.  presumably if we know that actual size is usually the limiting factor, then it doesn&#x27;t seem right to sort something lower b/c it has a lot of sigops even though you&#x27;re not going to hit that limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871720' id='432385'>
<a class='timestamp' href='#432385'><time timestamp='2015-10-26T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i was thnking about it in the terms of some future consensus requirement on utxo deltas as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871900' id='432386'>
<a class='timestamp' href='#432386'><time timestamp='2015-10-26T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the discussion we were having the other day about a separate thread for template generation seems very difficult to me.  its very hard to extract code from needing to lock at least the mempool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871900' id='432387'>
<a class='timestamp' href='#432387'><time timestamp='2015-10-26T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think to do that, we might need 2 mempools, or to just allow the mempool to queue tx&#x27;s while the mining code is running
<br>
</div>

<div class='talk op-msg' data-timestamp='1445871960' id='432388'>
<a class='timestamp' href='#432388'><time timestamp='2015-10-26T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but its an easy win to make existing createnewblock significantly faster just by adding an index on individual tx feerate, so i figured i&#x27;d start with that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445872740' id='432389'>
<a class='timestamp' href='#432389'><time timestamp='2015-10-26T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: I&#x27;ve generally assumed the multivariable optimization would be much harder and not really worth it-- the sigops limit is high enough that it doesn&#x27;t normally have an effect. What I suggested at least prevents the case where some silly dos attack transaction with a high per byte fee kills a feerate greedy selection.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445872800' id='432390'>
<a class='timestamp' href='#432390'><time timestamp='2015-10-26T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: hm. So I didn&#x27;t expect the seperate template thread would avoid locking the mempool. I assumed it would. But that having it would allow the createnewblock to always run without taking any long-held locks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445872860' id='432391'>
<a class='timestamp' href='#432391'><time timestamp='2015-10-26T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
E.g. block creation thread would lock the mempool and build a block. Then take a blocktemplate lock for just an instant to replace the last template.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445872860' id='432392'>
<a class='timestamp' href='#432392'><time timestamp='2015-10-26T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: ah, interesting, so trick the mining code into producing small blocks unecessarily..  maybe that is a good idea.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445872980' id='432393'>
<a class='timestamp' href='#432393'><time timestamp='2015-10-26T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: i see.  i guess i need to understand how getblocktemplate is used in practice.  i was assuming the threading was so we could be optimizing all the time.  i didn&#x27;t realize it was because you wanted to return a previously generated template to someone calling gbt.  i assumed they had already gotten the previous template
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873040' id='432394'>
<a class='timestamp' href='#432394'><time timestamp='2015-10-26T15:24:00Z'>15:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and if the cached template is out of date with the chain when gbt runs, you just generate an empty template, which you can do without touching he mempool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873100' id='432395'>
<a class='timestamp' href='#432395'><time timestamp='2015-10-26T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, so i did write a threaded version that does what you suggested, but it was bad, because it was basically just busy grabbing cs_main and mempool, and i thought well ok we&#x27;ll have to make it run only every so often, but then i didn&#x27;t see why that was better than the existing usage
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873160' id='432396'>
<a class='timestamp' href='#432396'><time timestamp='2015-10-26T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but you want to optimize for the case where the caller currently has nothing valid to work on?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873160' id='432397'>
<a class='timestamp' href='#432397'><time timestamp='2015-10-26T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
When a new block is accepted by the node the miner process learns this (either via p2p inspection or via longpolling) and calls GBT.  You want the lowest latency response possible; because until it returns the mining gear is working on a fork.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873160' id='432398'>
<a class='timestamp' href='#432398'><time timestamp='2015-10-26T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Then the mining clients will periodically poll to update the transaction list. In this polling you don&#x27;t care if the transaction data returned is seconds stale. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873220' id='432399'>
<a class='timestamp' href='#432399'><time timestamp='2015-10-26T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, understood that the new block case needs to be optimized, that was my next step, and that seems pretty easy
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873220' id='432400'>
<a class='timestamp' href='#432400'><time timestamp='2015-10-26T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
since all that does is deny you the little incremental fee rate from new transactions that came in.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873280' id='432401'>
<a class='timestamp' href='#432401'><time timestamp='2015-10-26T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We already do createnewblock caching. but it only helps with the second and later requests.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873280' id='432402'>
<a class='timestamp' href='#432402'><time timestamp='2015-10-26T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so what i was assuming is that when you periodically poll, which is the common use case, you already have valid work, so the existing longpoll functionality is fine, and there is no need for background process 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873280' id='432403'>
<a class='timestamp' href='#432403'><time timestamp='2015-10-26T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873400' id='432404'>
<a class='timestamp' href='#432404'><time timestamp='2015-10-26T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so i think what you&#x27;re saying is that for instance a new block could come in while you happen to not be longpolling, so then it won&#x27;t be until you call getblocktemplate that it even tries to do anything, and it woudl be better if it started immediately?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873400' id='432405'>
<a class='timestamp' href='#432405'><time timestamp='2015-10-26T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Ultimately it would be good to avoid the case where if you poll just before a new block is accepted, you don&#x27;t delay getting work on the new block. Though, indeed, then I think you run into locking issues with the mempool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873460' id='432406'>
<a class='timestamp' href='#432406'><time timestamp='2015-10-26T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: yes, when a new block comes in and you have been mining it should immediately compute a new block template, and until thats done, return empty ones so you&#x27;ll at least be working on extending the longest valid chain.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873520' id='432407'>
<a class='timestamp' href='#432407'><time timestamp='2015-10-26T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(a failure to make this optimization is part of what contributes to miners mining on other miners work without validating-- they go and &#x27;optimize&#x27; at a layer higher than Bitcoin, and as a resut complex details like validation go out the window. :) )
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873520' id='432408'>
<a class='timestamp' href='#432408'><time timestamp='2015-10-26T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems like you&#x27;d want to be notified of 2 things, when there is a new block template (empty) and when there is the first template with txs based on the new block.   how do you get that notification if you&#x27;re not longpolling constantly?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873760' id='432409'>
<a class='timestamp' href='#432409'><time timestamp='2015-10-26T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i was just going to change it so the longpool returns immediately with an empty block if a new block comes in, via a flag to create new block or something.  and then your next long polling call to getblocktemplate also calls CNB immediately which will return with txs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873760' id='432410'>
<a class='timestamp' href='#432410'><time timestamp='2015-10-26T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We could trigger the GBT LP&#x27;s every N seconds or when the fees change by X, I don&#x27;t actually know what (if anything) triggers the GBT LP now except a new block.  I also don&#x27;t know how widely GBT LP is used at the moment:  RPC concurrency has been kinda broken for a long time (fixed in git master), and GBT LP was a late addition, so I think most things decide when to poll GBT based on monitoring 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873760' id='432411'>
<a class='timestamp' href='#432411'><time timestamp='2015-10-26T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
P2P and then otherwise run on a timer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873820' id='432412'>
<a class='timestamp' href='#432412'><time timestamp='2015-10-26T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok... well doing it the threaded way shouldn&#x27;t be hard either...   
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873880' id='432413'>
<a class='timestamp' href='#432413'><time timestamp='2015-10-26T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: we do want to get people mining transactions quickly too-- as otherwise you&#x27;re missing out on fees (and the public tends to get really angry when they&#x27;re waiting for transactions and an empty block shows up. :) )
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873880' id='432414'>
<a class='timestamp' href='#432414'><time timestamp='2015-10-26T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yes, will be much much faster, so as long as you poll again immediately, shouldn&#x27;t be more than 100ms
<br>
</div>

<div class='talk op-msg' data-timestamp='1445873940' id='432415'>
<a class='timestamp' href='#432415'><time timestamp='2015-10-26T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;ll probably have a lot more questions when our mining hardware shows up.. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445874180' id='432416'>
<a class='timestamp' href='#432416'><time timestamp='2015-10-26T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
There is some ... potential for &quot;can&#x27;t win&quot; here, so there is some hardware that really dislikes being longpolled often. E.g. for some dumb reason (usually a complete lack of understanding about all the reasons you might LP) and they flush the pipeline completely.  Now, GBT LPing doesn&#x27;t necessarily mean the hardware gets disrupted, as some higher layer thing can ignore an early long poll and pi
<br>
</div>

<div class='talk op-msg' data-timestamp='1445874180' id='432417'>
<a class='timestamp' href='#432417'><time timestamp='2015-10-26T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ck up the non-empty template on a later timed run.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445874240' id='432418'>
<a class='timestamp' href='#432418'><time timestamp='2015-10-26T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So it might be the case that we expose breakage if we start LPing 100ms after the last time we LPed, just because we now have transactions. But if so, we can probably add a flag to delay that second LP event.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445874240' id='432419'>
<a class='timestamp' href='#432419'><time timestamp='2015-10-26T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(that same hardware is the stuff that cannot be used with P2Pool)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445876700' id='432420'>
<a class='timestamp' href='#432420'><time timestamp='2015-10-26T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-7'> GitHub52</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/ff057f41aa14...c8322ff7f754" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/ff057f41aa14...c8322ff7f754</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445876700' id='432421'>
<a class='timestamp' href='#432421'><time timestamp='2015-10-26T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-7'> GitHub52</span>&gt;
bitcoin/master 143d173 Eric Lombrozo: Use BOOST_CHECK_MESSAGE() rather than BOOST_CHECK() in alerts_tests.cpp and initialize strMiscWarning before calling PartitionCheck().&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445876700' id='432422'>
<a class='timestamp' href='#432422'><time timestamp='2015-10-26T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-7'> GitHub52</span>&gt;
bitcoin/master c8322ff Wladimir J. van der Laan: Merge pull request #6888...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445876700' id='432423'>
<a class='timestamp' href='#432423'><time timestamp='2015-10-26T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-4'> GitHub96</span>&gt;
[bitcoin] laanwj closed pull request #6888: Clear strMiscWarning before running PartitionAlert (master...alert_tests) <a href="https://github.com/bitcoin/bitcoin/pull/6888" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6888</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445877720' id='432424'>
<a class='timestamp' href='#432424'><time timestamp='2015-10-26T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
[bitcoin] laanwj pushed 3 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/c8322ff7f754...dbc5ee821ecd" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c8322ff7f754...dbc5ee821ecd</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445877720' id='432425'>
<a class='timestamp' href='#432425'><time timestamp='2015-10-26T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
bitcoin/master d4aa54c Kevin Cooper: added org.bitcoin.bitcoind.plist for launchd (OS X)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445877720' id='432426'>
<a class='timestamp' href='#432426'><time timestamp='2015-10-26T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
bitcoin/master e04b0b6 Kevin Cooper: added OS X documentation to doc/init.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1445877720' id='432427'>
<a class='timestamp' href='#432427'><time timestamp='2015-10-26T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
bitcoin/master dbc5ee8 Wladimir J. van der Laan: Merge pull request #6621...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445877720' id='432428'>
<a class='timestamp' href='#432428'><time timestamp='2015-10-26T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-14'> GitHub118</span>&gt;
[bitcoin] laanwj closed pull request #6621: added org.bitcoin.bitcoind.plist for launchd (OS X) (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/6621" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6621</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445878440' id='432429'>
<a class='timestamp' href='#432429'><time timestamp='2015-10-26T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-9'> GitHub11</span>&gt;
[bitcoin] laanwj pushed 3 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/dbc5ee821ecd...7939164d8985" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/dbc5ee821ecd...7939164d8985</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445878440' id='432430'>
<a class='timestamp' href='#432430'><time timestamp='2015-10-26T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-14'> GitHub69</span>&gt;
[bitcoin] laanwj closed pull request #6622: Introduce -maxuploadtarget (master...2015/09/maxuploadtarget) <a href="https://github.com/bitcoin/bitcoin/pull/6622" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6622</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445878440' id='432431'>
<a class='timestamp' href='#432431'><time timestamp='2015-10-26T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-9'> GitHub11</span>&gt;
bitcoin/master 872fee3 Jonas Schnelli: Introduce -maxuploadtarget...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445878440' id='432432'>
<a class='timestamp' href='#432432'><time timestamp='2015-10-26T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-9'> GitHub11</span>&gt;
bitcoin/master 17a073a Suhas Daftuar: Add RPC test for -maxuploadtarget
<br>
</div>

<div class='talk op-msg' data-timestamp='1445878440' id='432433'>
<a class='timestamp' href='#432433'><time timestamp='2015-10-26T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-9'> GitHub11</span>&gt;
bitcoin/master 7939164 Wladimir J. van der Laan: Merge pull request #6622...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884380' id='432434'>
<a class='timestamp' href='#432434'><time timestamp='2015-10-26T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos, sdaftuar, BlueMatt: perhaps we need to talk a bit about what the expectation of the coincache + mempool size limiting is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884440' id='432435'>
<a class='timestamp' href='#432435'><time timestamp='2015-10-26T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do we want a &quot;all of the mempool&#x27;s dependencies are guaranteed to always fit in memory&quot; ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884560' id='432436'>
<a class='timestamp' href='#432436'><time timestamp='2015-10-26T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: hmm, i don&#x27;t think i was trying to argue for that.  in fact i don&#x27;t think it would be at all reasonable to do that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884620' id='432437'>
<a class='timestamp' href='#432437'><time timestamp='2015-10-26T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think we should set the default sizes so that is true in general though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884620' id='432438'>
<a class='timestamp' href='#432438'><time timestamp='2015-10-26T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-3'> dgenr8</span>&gt;
Was reversing the feerate sort just an expressiveness change, or did it fix something? 78b82f4
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884620' id='432439'>
<a class='timestamp' href='#432439'><time timestamp='2015-10-26T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
dgenr8: expressiveness mostly, avoids an issue with using project
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884680' id='432440'>
<a class='timestamp' href='#432440'><time timestamp='2015-10-26T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: one way to accomplish that is to just have a combined coincache+mempool memory limit size, and depending on whether the dependencies are large or small, effectively have a smaller resp. larger mempool limit as a result
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884680' id='432441'>
<a class='timestamp' href='#432441'><time timestamp='2015-10-26T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: but if we don&#x27;t have that, we <u>_must_</u> enforce the coincache limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884680' id='432442'>
<a class='timestamp' href='#432442'><time timestamp='2015-10-26T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-3'> dgenr8</span>&gt;
sdaftuar: thx!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884680' id='432443'>
<a class='timestamp' href='#432443'><time timestamp='2015-10-26T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i think that might be a little dangerous though because that has an effect on relay policy
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884740' id='432444'>
<a class='timestamp' href='#432444'><time timestamp='2015-10-26T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: if the coincache exceeds its size, it will be wiped anyway when the next block comes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884740' id='432445'>
<a class='timestamp' href='#432445'><time timestamp='2015-10-26T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
calling flush in the tx code just makes it happen a bit earlier to avoid an OOM
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884740' id='432446'>
<a class='timestamp' href='#432446'><time timestamp='2015-10-26T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: i think we should revisit that behavior.  ideally the coinscache would have in it the set of things likely to be needed when the next block arrives
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884740' id='432447'>
<a class='timestamp' href='#432447'><time timestamp='2015-10-26T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: you realize that we can&#x27;t always enforce the coincache size?  when we&#x27;re connecting a block it could temporarily exceed for example
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432448'>
<a class='timestamp' href='#432448'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yeah...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432449'>
<a class='timestamp' href='#432449'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i agree that we should <u>_eventually_</u> put in something that enforces limitation of the coincache size between blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432450'>
<a class='timestamp' href='#432450'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but that might as well wait for something smarter than just flushing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432451'>
<a class='timestamp' href='#432451'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think the only real solution is to switching to a per-txout cache instead of a per-tx cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432452'>
<a class='timestamp' href='#432452'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the ratio is more or less fixed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432453'>
<a class='timestamp' href='#432453'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
ah i was wondering how feasible that would be
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884800' id='432454'>
<a class='timestamp' href='#432454'><time timestamp='2015-10-26T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and in the meantime we set the ratio of the defaults to be reasonable so that we don&#x27;t usually blow through the cache limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884860' id='432455'>
<a class='timestamp' href='#432455'><time timestamp='2015-10-26T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
given that you have to pay for relay to increase the cache size there is some cost to the attack after all
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884860' id='432456'>
<a class='timestamp' href='#432456'><time timestamp='2015-10-26T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and how big are we worried the cache size could get?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884860' id='432457'>
<a class='timestamp' href='#432457'><time timestamp='2015-10-26T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
define usually
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884920' id='432458'>
<a class='timestamp' href='#432458'><time timestamp='2015-10-26T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i guess i&#x27;m thinking that if we set mempool to 300M then it&#x27;d be rare than the coinsview cache was over 600M or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445884980' id='432459'>
<a class='timestamp' href='#432459'><time timestamp='2015-10-26T18:43:00Z'>18:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
thats just a lot bigger than the current default
<br>
</div>

<div class='talk op-msg' data-timestamp='1445885100' id='432460'>
<a class='timestamp' href='#432460'><time timestamp='2015-10-26T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i just think flushing after txs should be rare, if we want to set some higher limit to protect against OOM and flush after txs there, then thats fine, lets just set all these defaults so that what happens usually is the cache is big enough to contain a good chunk of the mempool.  it doesn&#x27;t really have to contain the whole thing, because
<br>
</div>

<div class='talk op-msg' data-timestamp='1445885100' id='432461'>
<a class='timestamp' href='#432461'><time timestamp='2015-10-26T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you wont&#x27; get to 100% mempool size in between blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445887980' id='432462'>
<a class='timestamp' href='#432462'><time timestamp='2015-10-26T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
indeed why are we keeping the already accepted mempool dependencies in the cache? they&#x27;re already validated isn&#x27;t that going to reduce the cache hit % ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888040' id='432463'>
<a class='timestamp' href='#432463'><time timestamp='2015-10-26T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: they&#x27;re validated again when a block is received
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888040' id='432464'>
<a class='timestamp' href='#432464'><time timestamp='2015-10-26T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which we want to make fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432465'>
<a class='timestamp' href='#432465'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, ah that&#x27;s right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432466'>
<a class='timestamp' href='#432466'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
an approach to avoid that is caching the success, but if you store that cache value in the mempool, you&#x27;re making the mempool code consensus critical
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432467'>
<a class='timestamp' href='#432467'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah lets not do that :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432468'>
<a class='timestamp' href='#432468'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, and that doesn&#x27;t even help
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432469'>
<a class='timestamp' href='#432469'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
signature validation is already cached anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432470'>
<a class='timestamp' href='#432470'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
oh that reminds me
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888100' id='432471'>
<a class='timestamp' href='#432471'><time timestamp='2015-10-26T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and you need to be able to update the spends in the chainstate anyway after the block is validated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888160' id='432472'>
<a class='timestamp' href='#432472'><time timestamp='2015-10-26T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the size of the sig cache isn&#x27;t in the help menu
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888160' id='432473'>
<a class='timestamp' href='#432473'><time timestamp='2015-10-26T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
good point
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888160' id='432474'>
<a class='timestamp' href='#432474'><time timestamp='2015-10-26T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it significantly reduces worst case AcceptNewBlock() latency to increase that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888160' id='432475'>
<a class='timestamp' href='#432475'><time timestamp='2015-10-26T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
miners should basically all have that be 10-100x the default
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888160' id='432476'>
<a class='timestamp' href='#432476'><time timestamp='2015-10-26T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
what?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888220' id='432477'>
<a class='timestamp' href='#432477'><time timestamp='2015-10-26T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the entries are _tiny_, we should be able to have a &quot;big enough for ~100% hitrate&quot; cache for everyone.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888220' id='432478'>
<a class='timestamp' href='#432478'><time timestamp='2015-10-26T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i actually have no idea what size the sigcache is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888340' id='432479'>
<a class='timestamp' href='#432479'><time timestamp='2015-10-26T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
huh it is in the help
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888340' id='432480'>
<a class='timestamp' href='#432480'><time timestamp='2015-10-26T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: for block acceptance speed it may make sense to seperately cache success and failure.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888340' id='432481'>
<a class='timestamp' href='#432481'><time timestamp='2015-10-26T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
50000 entries
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888400' id='432482'>
<a class='timestamp' href='#432482'><time timestamp='2015-10-26T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, yes map&lt;prevblockhash, set&lt;txid&gt; &gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432483'>
<a class='timestamp' href='#432483'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
should work nicely under non adversarial conditions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432484'>
<a class='timestamp' href='#432484'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that means that an entry &quot;3000 ago&quot; (which is around 1000 tx) only has a 96% hitrate
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432485'>
<a class='timestamp' href='#432485'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, 94%
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432486'>
<a class='timestamp' href='#432486'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: what, no. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432487'>
<a class='timestamp' href='#432487'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it uses random replacement
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432488'>
<a class='timestamp' href='#432488'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, yup 10-100x makes a big difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888460' id='432489'>
<a class='timestamp' href='#432489'><time timestamp='2015-10-26T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: transactions can spend unconfirmed outputs my friend.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888520' id='432490'>
<a class='timestamp' href='#432490'><time timestamp='2015-10-26T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, yeah you still have to check that the dependencies
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888580' id='432491'>
<a class='timestamp' href='#432491'><time timestamp='2015-10-26T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that <b>*does*</b> make the mempool view consensus critical though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888580' id='432492'>
<a class='timestamp' href='#432492'><time timestamp='2015-10-26T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: if you only mean to check that the ECDSA passes, than &lt;txid&gt; is enough.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888580' id='432493'>
<a class='timestamp' href='#432493'><time timestamp='2015-10-26T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the sigcache is per signature, not per transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888580' id='432494'>
<a class='timestamp' href='#432494'><time timestamp='2015-10-26T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
per transaction is pretty complicated, as you need to take active softforks into account etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888640' id='432495'>
<a class='timestamp' href='#432495'><time timestamp='2015-10-26T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, hadn&#x27;t considered that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888640' id='432496'>
<a class='timestamp' href='#432496'><time timestamp='2015-10-26T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there have been patching before that cached full tx validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888640' id='432497'>
<a class='timestamp' href='#432497'><time timestamp='2015-10-26T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but actually just script validation caching is cheaper
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888700' id='432498'>
<a class='timestamp' href='#432498'><time timestamp='2015-10-26T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
s/cheaper/easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888700' id='432499'>
<a class='timestamp' href='#432499'><time timestamp='2015-10-26T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888760' id='432500'>
<a class='timestamp' href='#432500'><time timestamp='2015-10-26T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i can implement that easily
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888760' id='432501'>
<a class='timestamp' href='#432501'><time timestamp='2015-10-26T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
have we considered that upload limiting disconnecting peers will have an impact on the network topology?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888820' id='432502'>
<a class='timestamp' href='#432502'><time timestamp='2015-10-26T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: it only disconnects peers that fetch historic blocks currently; largely avoiding the concern.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888820' id='432503'>
<a class='timestamp' href='#432503'><time timestamp='2015-10-26T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that seems safe
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888880' id='432504'>
<a class='timestamp' href='#432504'><time timestamp='2015-10-26T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well safer at least. it doesn&#x27;t completely escape topology impact.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888880' id='432505'>
<a class='timestamp' href='#432505'><time timestamp='2015-10-26T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Because a new node will, of course, not remain connected to anything over its limit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888940' id='432506'>
<a class='timestamp' href='#432506'><time timestamp='2015-10-26T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so even once its synced up it will end up with a different position in the topology than it would otherwise.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888940' id='432507'>
<a class='timestamp' href='#432507'><time timestamp='2015-10-26T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
export MALLOC_ARENA_MAX=1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888940' id='432508'>
<a class='timestamp' href='#432508'><time timestamp='2015-10-26T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that completely fixes the problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445888940' id='432509'>
<a class='timestamp' href='#432509'><time timestamp='2015-10-26T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
neat
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432510'>
<a class='timestamp' href='#432510'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
IBD&#x27;s stall detection already causes significant movement in the topology
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432511'>
<a class='timestamp' href='#432511'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: ??
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432512'>
<a class='timestamp' href='#432512'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to reduce fragmentation?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432513'>
<a class='timestamp' href='#432513'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, right which means new nodes will tend to end up connected to nodes that have no upload limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432514'>
<a class='timestamp' href='#432514'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, yeah, calling getblocktemplate in a loop and memory usage &lt;1GB
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889000' id='432515'>
<a class='timestamp' href='#432515'><time timestamp='2015-10-26T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: at least during their first runtime, after restart their topo will be more uniform.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889060' id='432516'>
<a class='timestamp' href='#432516'><time timestamp='2015-10-26T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: we really need outbound rotation to flatten topo hotspots.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889060' id='432517'>
<a class='timestamp' href='#432517'><time timestamp='2015-10-26T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, for that we need &quot;outbound slots&quot; basically
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889120' id='432518'>
<a class='timestamp' href='#432518'><time timestamp='2015-10-26T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the easiest way to do that is to just assign the second half of the outbound connections (based on vNodes position) as rotating
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889120' id='432519'>
<a class='timestamp' href='#432519'><time timestamp='2015-10-26T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
definitely dont want to rotate all the outbounds :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889120' id='432520'>
<a class='timestamp' href='#432520'><time timestamp='2015-10-26T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
right, it&#x27;s a good way to wander into a sybil attack.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889180' id='432521'>
<a class='timestamp' href='#432521'><time timestamp='2015-10-26T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
are you guys submitting proposals for hong kong?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889180' id='432522'>
<a class='timestamp' href='#432522'><time timestamp='2015-10-26T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
sorry if off-topic
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889240' id='432523'>
<a class='timestamp' href='#432523'><time timestamp='2015-10-26T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
hmm this is actually kind of annoying to test
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889300' id='432524'>
<a class='timestamp' href='#432524'><time timestamp='2015-10-26T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
have to get the mempool full again
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889300' id='432525'>
<a class='timestamp' href='#432525'><time timestamp='2015-10-26T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sending the &quot;mempool&quot; command to peers when they connect results in comical performance issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889300' id='432526'>
<a class='timestamp' href='#432526'><time timestamp='2015-10-26T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: i run with that for benchmarking mempool behaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889360' id='432527'>
<a class='timestamp' href='#432527'><time timestamp='2015-10-26T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, have you noticed that you just sit there spinning at 100% cpu processing something (i haven&#x27;t bothered to figur eout what yet)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889360' id='432528'>
<a class='timestamp' href='#432528'><time timestamp='2015-10-26T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: turn on debug=mempool and debug=mempoolrej
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889420' id='432529'>
<a class='timestamp' href='#432529'><time timestamp='2015-10-26T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i run this node with debug=
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889840' id='432530'>
<a class='timestamp' href='#432530'><time timestamp='2015-10-26T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-16'> GitHub138</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/7939164d8985...2b625510d374" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/7939164d8985...2b625510d374</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889840' id='432531'>
<a class='timestamp' href='#432531'><time timestamp='2015-10-26T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-16'> GitHub138</span>&gt;
bitcoin/master 7bbc7c3 Suhas Daftuar: Add option for microsecond precision in debug.log
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889840' id='432532'>
<a class='timestamp' href='#432532'><time timestamp='2015-10-26T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-16'> GitHub138</span>&gt;
bitcoin/master 2b62551 Wladimir J. van der Laan: Merge pull request #6881...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445889900' id='432533'>
<a class='timestamp' href='#432533'><time timestamp='2015-10-26T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> GitHub108</span>&gt;
[bitcoin] laanwj closed pull request #6881: Debug: Add option for microsecond precision in debug.log (master...add-microsecond-timestamps) <a href="https://github.com/bitcoin/bitcoin/pull/6881" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6881</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890080' id='432534'>
<a class='timestamp' href='#432534'><time timestamp='2015-10-26T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, plz2rebase seed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890440' id='432535'>
<a class='timestamp' href='#432535'><time timestamp='2015-10-26T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, non-scientific gdb interrupt+ bt says it&#x27;s spinning on ECDSA_verify
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890440' id='432536'>
<a class='timestamp' href='#432536'><time timestamp='2015-10-26T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
which i guess is to be expected :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890560' id='432537'>
<a class='timestamp' href='#432537'><time timestamp='2015-10-26T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
is it catching up or in initial sync? if so, that&#x27;s expected
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890560' id='432538'>
<a class='timestamp' href='#432538'><time timestamp='2015-10-26T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if in steady state it&#x27;s not normal
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890620' id='432539'>
<a class='timestamp' href='#432539'><time timestamp='2015-10-26T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: this is with sending out a BIP35 &quot;mempool&quot; command, so at startup it receives zillions of transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890680' id='432540'>
<a class='timestamp' href='#432540'><time timestamp='2015-10-26T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890680' id='432541'>
<a class='timestamp' href='#432541'><time timestamp='2015-10-26T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, then it makes sense too
<br>
</div>

<div class='talk op-msg' data-timestamp='1445890680' id='432542'>
<a class='timestamp' href='#432542'><time timestamp='2015-10-26T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i do expect you&#x27;d be accepting mempool txn at the speed you can handle
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891160' id='432543'>
<a class='timestamp' href='#432543'><time timestamp='2015-10-26T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, <a href="http://0bin.net/paste/8349G1adfXBgLthd#l6rCtj99ayGFnNdx6-C" class="link" target="_blank">http://0bin.net/paste/8349G1adfXBgLthd#l6rCtj99ayGFnNdx6-C</a>+bbP1fYFF0EJIvg4qvV4JnD9
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891520' id='432544'>
<a class='timestamp' href='#432544'><time timestamp='2015-10-26T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
you do have commit 5ce43da03dff3ee655949cd53d952dace555e268?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891580' id='432545'>
<a class='timestamp' href='#432545'><time timestamp='2015-10-26T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891580' id='432546'>
<a class='timestamp' href='#432546'><time timestamp='2015-10-26T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if so, this shouldn&#x27;t happen - unless gdb happens to reenable the signal
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891640' id='432547'>
<a class='timestamp' href='#432547'><time timestamp='2015-10-26T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it shouldn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891640' id='432548'>
<a class='timestamp' href='#432548'><time timestamp='2015-10-26T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yeah it does, it reports all signals by default. Try: &quot;handle SIGPIPE nostop noprint pass&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891640' id='432549'>
<a class='timestamp' href='#432549'><time timestamp='2015-10-26T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
but who knows... gmaxwell do you know :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891700' id='432550'>
<a class='timestamp' href='#432550'><time timestamp='2015-10-26T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, sigh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891700' id='432551'>
<a class='timestamp' href='#432551'><time timestamp='2015-10-26T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ok yes that&#x27;s good
<br>
</div>

<div class='talk op-msg' data-timestamp='1445891760' id='432552'>
<a class='timestamp' href='#432552'><time timestamp='2015-10-26T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
bleh why does it do that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893020' id='432553'>
<a class='timestamp' href='#432553'><time timestamp='2015-10-26T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, can verify that MALLOC_ARENA_MAX=1 works btw
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893020' id='432554'>
<a class='timestamp' href='#432554'><time timestamp='2015-10-26T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: what about 2 instead of 1?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893080' id='432555'>
<a class='timestamp' href='#432555'><time timestamp='2015-10-26T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, not sure it takes ages to load enough transactions into the mempool for the result to be valid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893080' id='432556'>
<a class='timestamp' href='#432556'><time timestamp='2015-10-26T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit: awesome
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893140' id='432557'>
<a class='timestamp' href='#432557'><time timestamp='2015-10-26T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
too bad we can&#x27;t set MALLOC_ARENA_MAX from the program itself, i suppose?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893140' id='432558'>
<a class='timestamp' href='#432558'><time timestamp='2015-10-26T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, well we can but...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893200' id='432559'>
<a class='timestamp' href='#432559'><time timestamp='2015-10-26T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
how so?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893200' id='432560'>
<a class='timestamp' href='#432560'><time timestamp='2015-10-26T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I think you can
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893200' id='432561'>
<a class='timestamp' href='#432561'><time timestamp='2015-10-26T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can change the env variable, but i expect that the arenas are created at library load time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893200' id='432562'>
<a class='timestamp' href='#432562'><time timestamp='2015-10-26T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
before we can change it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893200' id='432563'>
<a class='timestamp' href='#432563'><time timestamp='2015-10-26T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, the easiest would be to set the env and execve 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893260' id='432564'>
<a class='timestamp' href='#432564'><time timestamp='2015-10-26T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ie h4x
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893260' id='432565'>
<a class='timestamp' href='#432565'><time timestamp='2015-10-26T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
let me see glibc source...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893380' id='432566'>
<a class='timestamp' href='#432566'><time timestamp='2015-10-26T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it indeed makes no sense to set the env var, as it parses it at startup as expected, however you should be able to do mallopt(M_ARENA_MAX, 1)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893500' id='432567'>
<a class='timestamp' href='#432567'><time timestamp='2015-10-26T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
 /* mallopt options that actually do something */ in /usr/include/malloc.h :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893560' id='432568'>
<a class='timestamp' href='#432568'><time timestamp='2015-10-26T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
man mallopt does not list M_ARENA_MAX here
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893620' id='432569'>
<a class='timestamp' href='#432569'><time timestamp='2015-10-26T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s an undocumented option
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893680' id='432570'>
<a class='timestamp' href='#432570'><time timestamp='2015-10-26T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
probably should call it before any call to malloc to be effective
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893740' id='432571'>
<a class='timestamp' href='#432571'><time timestamp='2015-10-26T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
or at least before calling it in a thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893740' id='432572'>
<a class='timestamp' href='#432572'><time timestamp='2015-10-26T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the execve approach works...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893740' id='432573'>
<a class='timestamp' href='#432573'><time timestamp='2015-10-26T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s ugly because it needs to know the name of the binary you just started
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893740' id='432574'>
<a class='timestamp' href='#432574'><time timestamp='2015-10-26T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s really ugly, and makes debugging harder
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893800' id='432575'>
<a class='timestamp' href='#432575'><time timestamp='2015-10-26T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893800' id='432576'>
<a class='timestamp' href='#432576'><time timestamp='2015-10-26T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ha it&#x27;s not even in the libc manual
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893800' id='432577'>
<a class='timestamp' href='#432577'><time timestamp='2015-10-26T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and that (though you should always have that in argv[0] on unix)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893800' id='432578'>
<a class='timestamp' href='#432578'><time timestamp='2015-10-26T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it looks like we could set M_MMAP_THRESHOLD which would be slower but seems to guarantee memory is actually free&#x27;d
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893920' id='432579'>
<a class='timestamp' href='#432579'><time timestamp='2015-10-26T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but gdb will show something like &quot;process 28686 is executing new program: /bin/dash&quot; when a program execve&#x27;s, and it loses all its state
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893980' id='432580'>
<a class='timestamp' href='#432580'><time timestamp='2015-10-26T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, yeah i know thus &quot;h4x&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893980' id='432581'>
<a class='timestamp' href='#432581'><time timestamp='2015-10-26T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it would probably also break anybody using start-stop-daemon
<br>
</div>

<div class='talk op-msg' data-timestamp='1445893980' id='432582'>
<a class='timestamp' href='#432582'><time timestamp='2015-10-26T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gtg
<br>
</div>

<div class='talk op-msg' data-timestamp='1445894040' id='432583'>
<a class='timestamp' href='#432583'><time timestamp='2015-10-26T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but the mallopt should work too (can&#x27;t check it right now though)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445894040' id='432584'>
<a class='timestamp' href='#432584'><time timestamp='2015-10-26T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok later
<br>
</div>

<div class='talk op-msg' data-timestamp='1445900760' id='432585'>
<a class='timestamp' href='#432585'><time timestamp='2015-10-26T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
41k transaction in the mempool and counting
<br>
</div>

<div class='talk op-msg' data-timestamp='1445900820' id='432586'>
<a class='timestamp' href='#432586'><time timestamp='2015-10-26T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yeah, 50k sigcache entries won&#x27;t be good in that case...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445900820' id='432587'>
<a class='timestamp' href='#432587'><time timestamp='2015-10-26T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah i changed mine to maxsigcachesize=1000000
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901180' id='432588'>
<a class='timestamp' href='#432588'><time timestamp='2015-10-26T23:13:00Z'>23:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: sigcache is currently uint256,vector&lt;char&gt;,cpubkey.... bloat bloat bloat.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901240' id='432589'>
<a class='timestamp' href='#432589'><time timestamp='2015-10-26T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Could be compressed with H(the above). 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901240' id='432590'>
<a class='timestamp' href='#432590'><time timestamp='2015-10-26T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
H() need not even be very collission resistant if there is a per node secret nonce.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901660' id='432591'>
<a class='timestamp' href='#432591'><time timestamp='2015-10-26T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, yeah that&#x27;s what i was thinking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901660' id='432592'>
<a class='timestamp' href='#432592'><time timestamp='2015-10-26T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s around 220 bytes per entry now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901780' id='432593'>
<a class='timestamp' href='#432593'><time timestamp='2015-10-26T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, depends on the size of the pubkey script right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901780' id='432594'>
<a class='timestamp' href='#432594'><time timestamp='2015-10-26T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it would be nice if it didn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901780' id='432595'>
<a class='timestamp' href='#432595'><time timestamp='2015-10-26T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
upto 44.5k now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901840' id='432596'>
<a class='timestamp' href='#432596'><time timestamp='2015-10-26T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: it&#x27;s a pubkey; not a script
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901840' id='432597'>
<a class='timestamp' href='#432597'><time timestamp='2015-10-26T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
pubkeys are 65 bytes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901840' id='432598'>
<a class='timestamp' href='#432598'><time timestamp='2015-10-26T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901840' id='432599'>
<a class='timestamp' href='#432599'><time timestamp='2015-10-26T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
+ alignment
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901840' id='432600'>
<a class='timestamp' href='#432600'><time timestamp='2015-10-26T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
oh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901960' id='432601'>
<a class='timestamp' href='#432601'><time timestamp='2015-10-26T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: plus whatever overhead there is from the std::set.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445901960' id='432602'>
<a class='timestamp' href='#432602'><time timestamp='2015-10-26T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: around 40 bytes, i included that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445902740' id='432603'>
<a class='timestamp' href='#432603'><time timestamp='2015-10-26T23:39:00Z'>23:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: would it be really ugly if accepting the block carried a flag to the checker that told it to remove the entry?  with that alone the hitrate would no longer be low absent attacks because the cache would not be full all the time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445903520' id='432604'>
<a class='timestamp' href='#432604'><time timestamp='2015-10-26T23:52:00Z'>23:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: phantomcircuit: i don&#x27;t think we need to worry about M_ARENA_MAX.  we can drastically reduce the size of the problem.  first we rewrite CreateNewBlock to only pull into the cache 1 blocks worth of txs.  second we make it run in only 1 thread.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445903580' id='432605'>
<a class='timestamp' href='#432605'><time timestamp='2015-10-26T23:53:00Z'>23:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but yeah that maxsigcachesize will bite you.  i couldn&#x27;t figure out why my new code was slower and it was that its sigcache was getting blown away
<br>
</div>

</div>
</section>

</body>
</html>
