<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2020-07-24
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2020-07-24' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:18 UTC</pre>
<pre><a href="/bitcoin-core-dev/2020-06-24">&lt;</a><span class='header'>    July 2020     </span><a href="/bitcoin-core-dev/2020-08-24">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;          <a class="" href="/bitcoin-core-dev/2020-07-01">1</a>  2  3  4  &#x000A; <a class="" href="/bitcoin-core-dev/2020-07-05">5</a>  <a class="" href="/bitcoin-core-dev/2020-07-06">6</a>  <a class="" href="/bitcoin-core-dev/2020-07-07">7</a>  <a class="" href="/bitcoin-core-dev/2020-07-08">8</a>  <a class="" href="/bitcoin-core-dev/2020-07-09">9</a> <a class="" href="/bitcoin-core-dev/2020-07-10">10</a> <a class="" href="/bitcoin-core-dev/2020-07-11">11</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-07-12">12</a> <a class="" href="/bitcoin-core-dev/2020-07-13">13</a> <a class="" href="/bitcoin-core-dev/2020-07-14">14</a> <a class="" href="/bitcoin-core-dev/2020-07-15">15</a> <a class="" href="/bitcoin-core-dev/2020-07-16">16</a> <a class="" href="/bitcoin-core-dev/2020-07-17">17</a> <a class="" href="/bitcoin-core-dev/2020-07-18">18</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-07-19">19</a> <a class="" href="/bitcoin-core-dev/2020-07-20">20</a> <a class="" href="/bitcoin-core-dev/2020-07-21">21</a> <a class="" href="/bitcoin-core-dev/2020-07-22">22</a> <a class="" href="/bitcoin-core-dev/2020-07-23">23</a> <a class="current" href="/bitcoin-core-dev/2020-07-24">24</a> <a class="" href="/bitcoin-core-dev/2020-07-25">25</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-07-26">26</a> <a class="" href="/bitcoin-core-dev/2020-07-27">27</a> <a class="" href="/bitcoin-core-dev/2020-07-28">28</a> <a class="" href="/bitcoin-core-dev/2020-07-29">29</a> <a class="" href="/bitcoin-core-dev/2020-07-30">30</a> <a class="" href="/bitcoin-core-dev/2020-07-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1595552280' id='396354'>
<a class='timestamp' href='#396354'><time timestamp='2020-07-24T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/f4cfa6d01900...007e15dcd7f8" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/f4cfa6d01900...007e15dcd7f8</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595552280' id='396355'>
<a class='timestamp' href='#396355'><time timestamp='2020-07-24T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master ef3d4ce fanquake: build: call AC_PATH_TOOL for dsymutil in macOS cross-compile
<br>
</div>

<div class='talk op-msg' data-timestamp='1595552280' id='396356'>
<a class='timestamp' href='#396356'><time timestamp='2020-07-24T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 007e15d fanquake: Merge #19565: build: call AC_PATH_TOOL for dsymutil in macOS cross-compile...
<br>
</div>

<div class='talk op-msg' data-timestamp='1595552280' id='396357'>
<a class='timestamp' href='#396357'><time timestamp='2020-07-24T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #19565: build: call AC_PATH_TOOL for dsymutil in macOS cross-compile (master...cant_find_dsymutil) <a href="https://github.com/bitcoin/bitcoin/pull/19565" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19565</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595572260' id='396358'>
<a class='timestamp' href='#396358'><time timestamp='2020-07-24T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
Is there a python function in test/functional that can be used to serialize varint?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595572320' id='396359'>
<a class='timestamp' href='#396359'><time timestamp='2020-07-24T06:32:00Z'>06:32</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
There is ser_compact_size() test/functional/test_framework/messages.py, but I can&#x27;t seem to find one for varint
<br>
</div>

<div class='talk op-msg' data-timestamp='1595574840' id='396360'>
<a class='timestamp' href='#396360'><time timestamp='2020-07-24T07:14:00Z'>07:14</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
this error makes no sense and I can&#x27;t reproduce it :/ <a href="https://travis-ci.org/github/bitcoin/bitcoin/jobs/711362669#L3131" class="link" target="_blank">https://travis-ci.org/github/bitcoin/bitcoin/jobs/711362669#L3131</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595576100' id='396361'>
<a class='timestamp' href='#396361'><time timestamp='2020-07-24T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
src/wallet/walletdb.h:44:using WalletDatabase = BerkeleyDatabase;
<br>
</div>

<div class='talk op-msg' data-timestamp='1595576160' id='396362'>
<a class='timestamp' href='#396362'><time timestamp='2020-07-24T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
luke-jr: maybe it picked some &quot;strange&quot; berkeley db version that does not have &quot;env&quot; and &quot;GetFileId&quot; members?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595576160' id='396363'>
<a class='timestamp' href='#396363'><time timestamp='2020-07-24T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
-I/home/travis/build/bitcoin/bitcoin/db4/include
<br>
</div>

<div class='talk op-msg' data-timestamp='1595577300' id='396364'>
<a class='timestamp' href='#396364'><time timestamp='2020-07-24T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
vasild: that&#x27;s not a bdb class
<br>
</div>

<div class='talk op-msg' data-timestamp='1595577420' id='396365'>
<a class='timestamp' href='#396365'><time timestamp='2020-07-24T07:57:00Z'>07:57</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
hm, right, it is defined in src/wallet/bdb.h:101:class BerkeleyDatabase
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578200' id='396366'>
<a class='timestamp' href='#396366'><time timestamp='2020-07-24T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
luke-jr: I can&#x27;t reproduce it locally either, but it failed to compile for me for another reason: <a href="https://bpa.st/PUHA" class="link" target="_blank">https://bpa.st/PUHA</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578500' id='396367'>
<a class='timestamp' href='#396367'><time timestamp='2020-07-24T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yeah, I was wondering why I wasn&#x27;t getting that one..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578500' id='396368'>
<a class='timestamp' href='#396368'><time timestamp='2020-07-24T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
clang 11 here
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578560' id='396369'>
<a class='timestamp' href='#396369'><time timestamp='2020-07-24T08:16:00Z'>08:16</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hmm, does GCC lack it entirely? :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578620' id='396370'>
<a class='timestamp' href='#396370'><time timestamp='2020-07-24T08:17:00Z'>08:17</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
g++10 -Wthread-safety-analysis
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578620' id='396371'>
<a class='timestamp' href='#396371'><time timestamp='2020-07-24T08:17:00Z'>08:17</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
g++10: error: unrecognized command-line option &#x27;-Wthread-safety-analysis&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578680' id='396372'>
<a class='timestamp' href='#396372'><time timestamp='2020-07-24T08:18:00Z'>08:18</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
apparently it was removed at some point :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1595578860' id='396373'>
<a class='timestamp' href='#396373'><time timestamp='2020-07-24T08:21:00Z'>08:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] hebasto closed pull request #19567: p2p, refactor: Do not over-reserve vAddr capacity (master...200722-addr) <a href="https://github.com/bitcoin/bitcoin/pull/19567" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19567</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595587860' id='396374'>
<a class='timestamp' href='#396374'><time timestamp='2020-07-24T10:51:00Z'>10:51</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: you need to rebase
<br>
</div>

<div class='talk op-msg' data-timestamp='1595587920' id='396375'>
<a class='timestamp' href='#396375'><time timestamp='2020-07-24T10:52:00Z'>10:52</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
An actual WalletDatabase virtual class was added. It doesn&#x27;t have an env member
<br>
</div>

<div class='talk op-msg' data-timestamp='1595588100' id='396376'>
<a class='timestamp' href='#396376'><time timestamp='2020-07-24T10:55:00Z'>10:55</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
Do you really need the bdb unique file id? Sqlite doesn&#x27;t have a similar id so it&#x27;s not guaranteed that file IDs will exist for all WalletDatabase classes
<br>
</div>

<div class='talk op-msg' data-timestamp='1595588400' id='396377'>
<a class='timestamp' href='#396377'><time timestamp='2020-07-24T11:00:00Z'>11:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yanmaani: it should be preferred to use named parameters with RPC where possible as they prevent some kinds of bugs, positional arguments are mainly still accepted for historical compatiblity (no, they&#x27;re not going away any time soon if it&#x27;s up to me)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595588700' id='396378'>
<a class='timestamp' href='#396378'><time timestamp='2020-07-24T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
Personally I still prefer positional because I can never spell the named args correctly the first time
<br>
</div>

<div class='talk op-msg' data-timestamp='1595588940' id='396379'>
<a class='timestamp' href='#396379'><time timestamp='2020-07-24T11:09:00Z'>11:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right for use in a program is different than using it manually
<br>
</div>

<div class='talk op-msg' data-timestamp='1595589300' id='396380'>
<a class='timestamp' href='#396380'><time timestamp='2020-07-24T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
+1. for manual use, I mostly use positional.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595591880' id='396381'>
<a class='timestamp' href='#396381'><time timestamp='2020-07-24T11:58:00Z'>11:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in principle bitcoin-cli could add in the names before sending it to the server and emulate the same interface
<br>
</div>

<div class='talk op-msg' data-timestamp='1595592660' id='396382'>
<a class='timestamp' href='#396382'><time timestamp='2020-07-24T12:11:00Z'>12:11</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
heh, just realised i&#x27;ve made 4 failed CLI PRs in a row, and 16439 by aj has been open for exactly a year now with only one ACK (from me)... CLI PRs seem unsexy :D
<br>
</div>

<div class='talk op-msg' data-timestamp='1595593080' id='396383'>
<a class='timestamp' href='#396383'><time timestamp='2020-07-24T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] troygiorshev opened pull request #19580: Remove message_count (master...2020-07-remove-message_count) <a href="https://github.com/bitcoin/bitcoin/pull/19580" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19580</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595596200' id='396384'>
<a class='timestamp' href='#396384'><time timestamp='2020-07-24T13:10:00Z'>13:10</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
jonatack, clearly the -cli is perfect then
<br>
</div>

<div class='talk op-msg' data-timestamp='1595597520' id='396385'>
<a class='timestamp' href='#396385'><time timestamp='2020-07-24T13:32:00Z'>13:32</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
harding: Thanks! russell&#x27;s tool was exactly what I was looking for :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595601120' id='396386'>
<a class='timestamp' href='#396386'><time timestamp='2020-07-24T14:32:00Z'>14:32</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
instagibbs: yup seems so
<br>
</div>

<div class='talk op-msg' data-timestamp='1595602380' id='396387'>
<a class='timestamp' href='#396387'><time timestamp='2020-07-24T14:53:00Z'>14:53</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
wumpus: I think #19472 is RFM. It has 4 ACKs
<br>
</div>

<div class='talk op-msg' data-timestamp='1595602380' id='396388'>
<a class='timestamp' href='#396388'><time timestamp='2020-07-24T14:53:00Z'>14:53</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/19472" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/19472</a> | [net processing] Reduce cs_main scope in MaybeDiscourageAndDisconnect() by jnewbery · Pull Request #19472 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1595602920' id='396389'>
<a class='timestamp' href='#396389'><time timestamp='2020-07-24T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jnewbery: thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1595603700' id='396390'>
<a class='timestamp' href='#396390'><time timestamp='2020-07-24T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
possible to subscribe to bitcoin-dev list without using the browser? captcha doesn&#x27;t work on tor
<br>
</div>

<div class='talk op-msg' data-timestamp='1595604060' id='396391'>
<a class='timestamp' href='#396391'><time timestamp='2020-07-24T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 5 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/007e15dcd7f8...40a04814d130" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/007e15dcd7f8...40a04814d130</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595604060' id='396392'>
<a class='timestamp' href='#396392'><time timestamp='2020-07-24T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 1a1c23f John Newbery: [net processing] Change cs_main TRY_LOCK to LOCK in SendMessages()
<br>
</div>

<div class='talk op-msg' data-timestamp='1595604060' id='396393'>
<a class='timestamp' href='#396393'><time timestamp='2020-07-24T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master a1d5a42 John Newbery: [net processing] Fix bad indentation in SendMessages()
<br>
</div>

<div class='talk op-msg' data-timestamp='1595604060' id='396394'>
<a class='timestamp' href='#396394'><time timestamp='2020-07-24T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master a49781e John Newbery: [net processing] Only call MaybeDiscourageAndDisconnect from SendMessages
<br>
</div>

<div class='talk op-msg' data-timestamp='1595604060' id='396395'>
<a class='timestamp' href='#396395'><time timestamp='2020-07-24T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj merged pull request #19472: [net processing] Reduce cs_main scope in MaybeDiscourageAndDisconnect() (master...2020-07-tidyup-maybediscourage) <a href="https://github.com/bitcoin/bitcoin/pull/19472" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19472</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595605500' id='396396'>
<a class='timestamp' href='#396396'><time timestamp='2020-07-24T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jnewbery opened pull request #19583: Clean up Misbehaving() (master...2020-07-tidy-misbehavior) <a href="https://github.com/bitcoin/bitcoin/pull/19583" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19583</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595606700' id='396397'>
<a class='timestamp' href='#396397'><time timestamp='2020-07-24T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ecurrencyhodler opened pull request #19584: doc: Update obsolete links to online reference #19582 (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/19584" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19584</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595607600' id='396398'>
<a class='timestamp' href='#396398'><time timestamp='2020-07-24T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] stylesuxx opened pull request #19585: rpc: RPCResult Type of MempoolEntryDescription should be OBJ. (master...19579) <a href="https://github.com/bitcoin/bitcoin/pull/19585" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19585</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595607960' id='396399'>
<a class='timestamp' href='#396399'><time timestamp='2020-07-24T16:26:00Z'>16:26</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: what else uniquely identifies a wallet? if sqlite doesn&#x27;t have one, I suggest adding one explicitly from the start..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610480' id='396400'>
<a class='timestamp' href='#396400'><time timestamp='2020-07-24T17:08:00Z'>17:08</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
jnewbery: I just happened to see it here, haven&#x27;t looked into it fully...
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610540' id='396401'>
<a class='timestamp' href='#396401'><time timestamp='2020-07-24T17:09:00Z'>17:09</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
&quot;Change cs_main TRY_LOCK to LOCK&quot; IIRC the TRY_LOCK was <u>_very_</u> important for making sure that peers are visited fairly.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610660' id='396402'>
<a class='timestamp' href='#396402'><time timestamp='2020-07-24T17:11:00Z'>17:11</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
I believe that change may significantly change how peers are processed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610660' id='396403'>
<a class='timestamp' href='#396403'><time timestamp='2020-07-24T17:11:00Z'>17:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
vasild: what do you need varint for? afaik it&#x27;s not used in any public interface
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610720' id='396404'>
<a class='timestamp' href='#396404'><time timestamp='2020-07-24T17:12:00Z'>17:12</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
I&#x27;ll add it to my review queue.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595610720' id='396405'>
<a class='timestamp' href='#396405'><time timestamp='2020-07-24T17:12:00Z'>17:12</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: thanks for the explanation of rebase needed; I was quite confused, lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611560' id='396406'>
<a class='timestamp' href='#396406'><time timestamp='2020-07-24T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
cfields_: TIL, interesting!
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611620' id='396407'>
<a class='timestamp' href='#396407'><time timestamp='2020-07-24T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
jonatack: I&#x27;m struggling trying to remember the details.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611680' id='396408'>
<a class='timestamp' href='#396408'><time timestamp='2020-07-24T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: i believe that a long time ago, during ProcessMessages cs_recv was held, and during SendMessages cs_send was held
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611680' id='396409'>
<a class='timestamp' href='#396409'><time timestamp='2020-07-24T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and the network thread would try to grab what wasn&#x27;t locked, so sends could be done in parallel with ProcessMessages, and receives could be done in parallel with SendMessages, for the same peer
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611740' id='396410'>
<a class='timestamp' href='#396410'><time timestamp='2020-07-24T17:29:00Z'>17:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe that&#x27;s no longer the case, and SendMessages/ProcessMessages just grab send/recv locks whenever needed
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611740' id='396411'>
<a class='timestamp' href='#396411'><time timestamp='2020-07-24T17:29:00Z'>17:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in particular, ProcessMessages doesn&#x27;t lock cs_recv while validating a block...
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611740' id='396412'>
<a class='timestamp' href='#396412'><time timestamp='2020-07-24T17:29:00Z'>17:29</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: maybe, but there&#x27;s something about taking cs_main and stalling the processing pipeline.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611800' id='396413'>
<a class='timestamp' href='#396413'><time timestamp='2020-07-24T17:30:00Z'>17:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
nothing in net locks cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611860' id='396414'>
<a class='timestamp' href='#396414'><time timestamp='2020-07-24T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: right, but now SendMessages is guaranteed to wait for cs_main for every peer, every run through the loop.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611920' id='396415'>
<a class='timestamp' href='#396415'><time timestamp='2020-07-24T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
before that would&#x27;ve caused it to hop around peers due to randomly failing to grab the lock.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611920' id='396416'>
<a class='timestamp' href='#396416'><time timestamp='2020-07-24T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
Now they&#x27;ll be guaranteed processed in-order.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611920' id='396417'>
<a class='timestamp' href='#396417'><time timestamp='2020-07-24T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611920' id='396418'>
<a class='timestamp' href='#396418'><time timestamp='2020-07-24T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
exactly which PR are you talking about, btw?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611920' id='396419'>
<a class='timestamp' href='#396419'><time timestamp='2020-07-24T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
Which iirc was explicitly not desired at one point, though I can&#x27;t remember why :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611980' id='396420'>
<a class='timestamp' href='#396420'><time timestamp='2020-07-24T17:33:00Z'>17:33</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
#19472
<br>
</div>

<div class='talk op-msg' data-timestamp='1595611980' id='396421'>
<a class='timestamp' href='#396421'><time timestamp='2020-07-24T17:33:00Z'>17:33</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/19472" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/19472</a> | [net processing] Reduce cs_main scope in MaybeDiscourageAndDisconnect() by jnewbery · Pull Request #19472 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1595612100' id='396422'>
<a class='timestamp' href='#396422'><time timestamp='2020-07-24T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: ah i see
<br>
</div>

<div class='talk op-msg' data-timestamp='1595612100' id='396423'>
<a class='timestamp' href='#396423'><time timestamp='2020-07-24T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: i&#x27;m not sure this really matters, as nearly every message being processed for incoming messages also grabs cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1595612160' id='396424'>
<a class='timestamp' href='#396424'><time timestamp='2020-07-24T17:36:00Z'>17:36</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: sure, for post-handshake peers :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595612220' id='396425'>
<a class='timestamp' href='#396425'><time timestamp='2020-07-24T17:37:00Z'>17:37</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
you&#x27;re right though. I&#x27;m struggling to remember how this could&#x27;ve been significant.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595613420' id='396426'>
<a class='timestamp' href='#396426'><time timestamp='2020-07-24T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: that&#x27;s what it is... ProcessMessages and SendMessages are called together, as &quot;we have a message to process&quot; is what we use as a proxy for &quot;maybe we should send some stuff too&quot;. Now the SendMessages are all guaranteed to run to the end, so we&#x27;ll be spending more time in there now than before. I have no idea what the hit/miss ratio looked like before, so I&#x27;m not sure if that&#x27;s significant.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595613480' id='396427'>
<a class='timestamp' href='#396427'><time timestamp='2020-07-24T17:58:00Z'>17:58</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
*TRY_LOCK hit/miss
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614260' id='396428'>
<a class='timestamp' href='#396428'><time timestamp='2020-07-24T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: the full file path to the wallet should be sufficient
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614260' id='396429'>
<a class='timestamp' href='#396429'><time timestamp='2020-07-24T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
As a unique identifier
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614380' id='396430'>
<a class='timestamp' href='#396430'><time timestamp='2020-07-24T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
cfields_: does that mean that if a user is doing a bunch of RPC calls that are grabbing cs_main, we might let our receive buffers fill up more?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614380' id='396431'>
<a class='timestamp' href='#396431'><time timestamp='2020-07-24T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
that seems like a plausible reason why the old behavior might have been desirable i guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614440' id='396432'>
<a class='timestamp' href='#396432'><time timestamp='2020-07-24T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sdaftuar: not on the socket side, but on the processing side, yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614500' id='396433'>
<a class='timestamp' href='#396433'><time timestamp='2020-07-24T18:15:00Z'>18:15</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sdaftuar: but like sipa said, something would be bound to take cs_main eventually anyway.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614560' id='396434'>
<a class='timestamp' href='#396434'><time timestamp='2020-07-24T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: not if the user moves it
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614620' id='396435'>
<a class='timestamp' href='#396435'><time timestamp='2020-07-24T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: i think it makes sense to be able to give a warning to detect a (fork of) a wallet file being loaded multiple times, but it&#x27;s not really as necessary as it was with bdb (which would give annoying errors if you had the same db opened twice in the same env)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614620' id='396436'>
<a class='timestamp' href='#396436'><time timestamp='2020-07-24T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sdaftuar: the more I think about it, the more I think it was probably just a way of throttling SendMessages to be called less often than every run through the message handler loop.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614620' id='396437'>
<a class='timestamp' href='#396437'><time timestamp='2020-07-24T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: we could do the check at a more semantic level... like do you have multiple wallets watching the same addresses
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614680' id='396438'>
<a class='timestamp' href='#396438'><time timestamp='2020-07-24T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
s/to be called/to fully execute/
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614680' id='396439'>
<a class='timestamp' href='#396439'><time timestamp='2020-07-24T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: you&#x27;re persisting the IDs?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614740' id='396440'>
<a class='timestamp' href='#396440'><time timestamp='2020-07-24T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_, sdaftuar: in that scenario i think the difference is spinning through SendMessages and blocking on the first ProcessMessages that needs cs_main, vs blocking immediately in SendMessages
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614800' id='396441'>
<a class='timestamp' href='#396441'><time timestamp='2020-07-24T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think that&#x27;s a big difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614860' id='396442'>
<a class='timestamp' href='#396442'><time timestamp='2020-07-24T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: this isn&#x27;t for detecting forks..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614920' id='396443'>
<a class='timestamp' href='#396443'><time timestamp='2020-07-24T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: i mean forks in the history of the wallet file; not blockchain forks
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614920' id='396444'>
<a class='timestamp' href='#396444'><time timestamp='2020-07-24T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: yes, that&#x27;s the whole point
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614920' id='396445'>
<a class='timestamp' href='#396445'><time timestamp='2020-07-24T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614920' id='396446'>
<a class='timestamp' href='#396446'><time timestamp='2020-07-24T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: what I&#x27;m doing in that PR, is preventing pruning if we know we have a wallet that needs the blocks for syncing
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614920' id='396447'>
<a class='timestamp' href='#396447'><time timestamp='2020-07-24T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: I agree with that. I drop the cs_main objection. I am still concerned about the time spent in that function, though. Will follow-up with jnewbery for some before/after benchmarks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614980' id='396448'>
<a class='timestamp' href='#396448'><time timestamp='2020-07-24T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: i think post-move-to-more-net_processing-and-it-having-its-own-lock(s), there are more opportunities to do conditional processing anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614980' id='396449'>
<a class='timestamp' href='#396449'><time timestamp='2020-07-24T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: once the wallet is synced, we want pruning to continue, so it uses the fileid to track the prune lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614980' id='396450'>
<a class='timestamp' href='#396450'><time timestamp='2020-07-24T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: I guess you could add an id record..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595614980' id='396451'>
<a class='timestamp' href='#396451'><time timestamp='2020-07-24T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: i think the differene is that in SendMessages, if you were waiting a long time before you get invoked, then you might be sending stale data to your peers
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615040' id='396452'>
<a class='timestamp' href='#396452'><time timestamp='2020-07-24T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: bdb already has this, it&#x27;s just sqlite where we&#x27;d need to add it
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615040' id='396453'>
<a class='timestamp' href='#396453'><time timestamp='2020-07-24T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
which is fine since sqlite has no existing wallets yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615040' id='396454'>
<a class='timestamp' href='#396454'><time timestamp='2020-07-24T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(and if we migrate bdb to sqlite someday, we can migrate fileid)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615040' id='396455'>
<a class='timestamp' href='#396455'><time timestamp='2020-07-24T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: i&#x27;m not really a fan of mixing a dblayer identifier with an application level identifier
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615100' id='396456'>
<a class='timestamp' href='#396456'><time timestamp='2020-07-24T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you import a descriptors from one wallet file into another, shouldn&#x27;t that also be treated as a duplicate?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615100' id='396457'>
<a class='timestamp' href='#396457'><time timestamp='2020-07-24T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
dunno
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615100' id='396458'>
<a class='timestamp' href='#396458'><time timestamp='2020-07-24T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
syncing the new one won&#x27;t sync the old one if you still have it around
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615160' id='396459'>
<a class='timestamp' href='#396459'><time timestamp='2020-07-24T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
actually, scratch what i said, i misremembered how those ProcessMessages/SendMessages calls work
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615160' id='396460'>
<a class='timestamp' href='#396460'><time timestamp='2020-07-24T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sdaftuar: right, the actual sends are happening async :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615220' id='396461'>
<a class='timestamp' href='#396461'><time timestamp='2020-07-24T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: it&#x27;s not the keys in the wallet that matter for this per se, but the state of the sync of the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615220' id='396462'>
<a class='timestamp' href='#396462'><time timestamp='2020-07-24T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
which isn&#x27;t really correlated with the descriptor
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615280' id='396463'>
<a class='timestamp' href='#396463'><time timestamp='2020-07-24T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: i see
<br>
</div>

<div class='talk op-msg' data-timestamp='1595615640' id='396464'>
<a class='timestamp' href='#396464'><time timestamp='2020-07-24T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: I suppose it&#x27;s fine to use the bdb I&#x27;d. But I would prefer if you didn&#x27;t use WalletDatabaseFileId. A uint160 should work, the id is 20 bytes
<br>
</div>

<div class='talk op-msg' data-timestamp='1595616360' id='396465'>
<a class='timestamp' href='#396465'><time timestamp='2020-07-24T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: well, I&#x27;m turning it into a std::string in CWallet - maybe I should do that at the WalletDatabase level?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595616420' id='396466'>
<a class='timestamp' href='#396466'><time timestamp='2020-07-24T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
That would be preferable
<br>
</div>

<div class='talk op-msg' data-timestamp='1595621160' id='396467'>
<a class='timestamp' href='#396467'><time timestamp='2020-07-24T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
cfields_: Just catching up on this now. Thanks for looking at the PR.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595621160' id='396468'>
<a class='timestamp' href='#396468'><time timestamp='2020-07-24T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
My understanding was that the TRY_LOCK was added to fix a potential deadlock between cs_main and cs_vSend, introduced in #1117
<br>
</div>

<div class='talk op-msg' data-timestamp='1595621160' id='396469'>
<a class='timestamp' href='#396469'><time timestamp='2020-07-24T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/1117" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/1117</a> | Fix potential deadlock by sipa · Pull Request #1117 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1595621220' id='396470'>
<a class='timestamp' href='#396470'><time timestamp='2020-07-24T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
I expect that the hit ratio for that TRY_LOCK is almost 1 (ie we get the lock almost always), because other threads don&#x27;t hold cs_main very much
<br>
</div>

<div class='talk op-msg' data-timestamp='1595621280' id='396471'>
<a class='timestamp' href='#396471'><time timestamp='2020-07-24T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
unless you&#x27;re really hammering the RPC with something that takes cs_main, but even then it&#x27;d be difficult
<br>
</div>

<div class='talk op-msg' data-timestamp='1595625660' id='396472'>
<a class='timestamp' href='#396472'><time timestamp='2020-07-24T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sanjaykdragon opened pull request #19586: REFACTOR: moved from percent format to proper format for consistency (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/19586" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19586</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627280' id='396473'>
<a class='timestamp' href='#396473'><time timestamp='2020-07-24T21:48:00Z'>21:48</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
What&#x27;s the purpose of the options objects in RPCs, such as bumpfee?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627280' id='396474'>
<a class='timestamp' href='#396474'><time timestamp='2020-07-24T21:48:00Z'>21:48</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
couldn&#x27;t you just leave them as normal root-level named params?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627340' id='396475'>
<a class='timestamp' href='#396475'><time timestamp='2020-07-24T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: if you want an ugly interface..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627340' id='396476'>
<a class='timestamp' href='#396476'><time timestamp='2020-07-24T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
luke-jr: how do you mean? Aren&#x27;t named params optional?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627340' id='396477'>
<a class='timestamp' href='#396477'><time timestamp='2020-07-24T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yanmaani: ootions objects existed before we supported named params
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627340' id='396478'>
<a class='timestamp' href='#396478'><time timestamp='2020-07-24T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: foo(1, null, null, null, null, null, null, null, null, null, 2) is super ugly
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396479'>
<a class='timestamp' href='#396479'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and it makes the positional interface pretty annoying
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396480'>
<a class='timestamp' href='#396480'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as luke-jr points out
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396481'>
<a class='timestamp' href='#396481'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: after #17356 I have a commit that allows mixing options in with the usual named params
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396482'>
<a class='timestamp' href='#396482'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/17356" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/17356</a> | RPC: Internal named params by luke-jr · Pull Request #17356 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396483'>
<a class='timestamp' href='#396483'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
Oh wait, so named args are sort of positional at the same time?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627400' id='396484'>
<a class='timestamp' href='#396484'><time timestamp='2020-07-24T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
Couldn&#x27;t you just have all the named args at the end? Or would you still need nulls
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396485'>
<a class='timestamp' href='#396485'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: root-level are positional
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396486'>
<a class='timestamp' href='#396486'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yanmaani: internally everything is positional
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396487'>
<a class='timestamp' href='#396487'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
yanmaani: 
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396488'>
<a class='timestamp' href='#396488'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
Are named args positional?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396489'>
<a class='timestamp' href='#396489'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: you&#x27;d need nulls to get to the option you want
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396490'>
<a class='timestamp' href='#396490'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
ops
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396491'>
<a class='timestamp' href='#396491'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yanmaani: they&#x27;re mapped to positional arguments internally
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396492'>
<a class='timestamp' href='#396492'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
luke-jr: Can&#x27;t I write option=value?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396493'>
<a class='timestamp' href='#396493'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
positional arguments only make sense for things you would normally specify for every/common use case
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627460' id='396494'>
<a class='timestamp' href='#396494'><time timestamp='2020-07-24T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: only if you&#x27;re using named params
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396495'>
<a class='timestamp' href='#396495'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yanmaani: the external interface supports both named or positional, as json-rpc specifies
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396496'>
<a class='timestamp' href='#396496'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
internally every named argument is just mapped to an internal positional on3
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396497'>
<a class='timestamp' href='#396497'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
Ohh. So you don&#x27;t want them because of that reason?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396498'>
<a class='timestamp' href='#396498'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yanmaani: i don&#x27;t think this matters
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396499'>
<a class='timestamp' href='#396499'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: the only reason for args to be root-level, is for them to be used positionally
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627520' id='396500'>
<a class='timestamp' href='#396500'><time timestamp='2020-07-24T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
If someone is using something where they can only use positional args, then you don&#x27;t want them to write null, null, null, ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627580' id='396501'>
<a class='timestamp' href='#396501'><time timestamp='2020-07-24T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
even if things were implemented differently internally, we still want to support a usable.positional interface 
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627580' id='396502'>
<a class='timestamp' href='#396502'><time timestamp='2020-07-24T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
yanmaani: if you read rpc method implementations then you see that params are read with index, like param[2]..
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396503'>
<a class='timestamp' href='#396503'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
luke-jr: Well it&#x27;s a bit cleaner to write rpccall true 1 foo=bar asd=asd than rpccall true 1 &#x27;{&quot;foo&quot;: &quot;bar&quot;, &quot;asd&quot;: &quot;asd&quot;}&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396504'>
<a class='timestamp' href='#396504'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: implementing it differently would enable naming options without an options={…} though
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396505'>
<a class='timestamp' href='#396505'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396506'>
<a class='timestamp' href='#396506'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: JSON-RPC doesn&#x27;t allow that
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396507'>
<a class='timestamp' href='#396507'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
yanmaani: you mean on the console?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396508'>
<a class='timestamp' href='#396508'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
So the names are just cosmetic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396509'>
<a class='timestamp' href='#396509'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
promag: yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396510'>
<a class='timestamp' href='#396510'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yanmaani: JSON-RPC only allows ALL positional or ALL named
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396511'>
<a class='timestamp' href='#396511'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
options is how we can get both
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396512'>
<a class='timestamp' href='#396512'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
oh.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627640' id='396513'>
<a class='timestamp' href='#396513'><time timestamp='2020-07-24T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
nice
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627700' id='396514'>
<a class='timestamp' href='#396514'><time timestamp='2020-07-24T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
And if you&#x27;re using all named, then you still need a fallback all-named API? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627700' id='396515'>
<a class='timestamp' href='#396515'><time timestamp='2020-07-24T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you mean all-positionalm
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627700' id='396516'>
<a class='timestamp' href='#396516'><time timestamp='2020-07-24T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627760' id='396517'>
<a class='timestamp' href='#396517'><time timestamp='2020-07-24T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
rpccall true 1 foo=bar asd=asd   &lt;----- you are mixing here
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627760' id='396518'>
<a class='timestamp' href='#396518'><time timestamp='2020-07-24T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
tbh, i never use the named interface
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627820' id='396519'>
<a class='timestamp' href='#396519'><time timestamp='2020-07-24T21:57:00Z'>21:57</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
sipa: I though you use brain-ipc-foo
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627820' id='396520'>
<a class='timestamp' href='#396520'><time timestamp='2020-07-24T21:57:00Z'>21:57</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
sipa: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627820' id='396521'>
<a class='timestamp' href='#396521'><time timestamp='2020-07-24T21:57:00Z'>21:57</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
a fallback all-pos
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627820' id='396522'>
<a class='timestamp' href='#396522'><time timestamp='2020-07-24T21:57:00Z'>21:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right, we need some way of supporting an all-pos interface
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627880' id='396523'>
<a class='timestamp' href='#396523'><time timestamp='2020-07-24T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i wouldn&#x27;t call it fallback - it&#x27;s just one of the two supported interfacez
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627880' id='396524'>
<a class='timestamp' href='#396524'><time timestamp='2020-07-24T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
Oh. Nice.
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627880' id='396525'>
<a class='timestamp' href='#396525'><time timestamp='2020-07-24T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
promag: lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396526'>
<a class='timestamp' href='#396526'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
what was the motivation for named params btw?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396527'>
<a class='timestamp' href='#396527'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
json-rpc specifies them
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396528'>
<a class='timestamp' href='#396528'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
XD
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396529'>
<a class='timestamp' href='#396529'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and in some contexts, i think they&#x27;re useful
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396530'>
<a class='timestamp' href='#396530'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
it&#x27;s not mandatory is it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1595627940' id='396531'>
<a class='timestamp' href='#396531'><time timestamp='2020-07-24T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
though i hacen&#x27;t seen much need personally
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628000' id='396532'>
<a class='timestamp' href='#396532'><time timestamp='2020-07-24T22:00:00Z'>22:00</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
for methods with optional params then yeah, named is cool
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628000' id='396533'>
<a class='timestamp' href='#396533'><time timestamp='2020-07-24T22:00:00Z'>22:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
promag: it is not clear from the spec, to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628000' id='396534'>
<a class='timestamp' href='#396534'><time timestamp='2020-07-24T22:00:00Z'>22:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
whether thet&#x27;re required to be supported on the server side or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628060' id='396535'>
<a class='timestamp' href='#396535'><time timestamp='2020-07-24T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
commit -m &quot;drop rpc, add graphql&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628180' id='396536'>
<a class='timestamp' href='#396536'><time timestamp='2020-07-24T22:03:00Z'>22:03</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
jk, long live json-rpc, its awesome
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628240' id='396537'>
<a class='timestamp' href='#396537'><time timestamp='2020-07-24T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think we need x86-rpc; the client sends a bit of x86 assembly to the server, which executes it
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628240' id='396538'>
<a class='timestamp' href='#396538'><time timestamp='2020-07-24T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s extremely flexible!
<br>
</div>

<div class='talk op-msg' data-timestamp='1595628300' id='396539'>
<a class='timestamp' href='#396539'><time timestamp='2020-07-24T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
ack
<br>
</div>

<div class='talk op-msg' data-timestamp='1595634420' id='396540'>
<a class='timestamp' href='#396540'><time timestamp='2020-07-24T23:47:00Z'>23:47</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
named params are super helpful when you have an rpc call with 9+ args :)
<br>
</div>

</div>
</section>

</body>
</html>
