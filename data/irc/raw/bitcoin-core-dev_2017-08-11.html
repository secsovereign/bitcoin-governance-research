<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2017-08-11
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2017-08-11' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:23 UTC</pre>
<pre><a href="/bitcoin-core-dev/2017-07-11">&lt;</a><span class='header'>   August 2017    </span><a href="/bitcoin-core-dev/2017-09-11">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;       <a class="" href="/bitcoin-core-dev/2017-08-01">1</a>  <a class="" href="/bitcoin-core-dev/2017-08-02">2</a>  <a class="" href="/bitcoin-core-dev/2017-08-03">3</a>  <a class="" href="/bitcoin-core-dev/2017-08-04">4</a>  <a class="" href="/bitcoin-core-dev/2017-08-05">5</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2017-08-06">6</a>  <a class="" href="/bitcoin-core-dev/2017-08-07">7</a>  <a class="" href="/bitcoin-core-dev/2017-08-08">8</a>  <a class="" href="/bitcoin-core-dev/2017-08-09">9</a> <a class="" href="/bitcoin-core-dev/2017-08-10">10</a> <a class="current" href="/bitcoin-core-dev/2017-08-11">11</a> <a class="" href="/bitcoin-core-dev/2017-08-12">12</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-13">13</a> <a class="" href="/bitcoin-core-dev/2017-08-14">14</a> <a class="" href="/bitcoin-core-dev/2017-08-15">15</a> <a class="" href="/bitcoin-core-dev/2017-08-16">16</a> <a class="" href="/bitcoin-core-dev/2017-08-17">17</a> <a class="" href="/bitcoin-core-dev/2017-08-18">18</a> <a class="" href="/bitcoin-core-dev/2017-08-19">19</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-20">20</a> <a class="" href="/bitcoin-core-dev/2017-08-21">21</a> <a class="" href="/bitcoin-core-dev/2017-08-22">22</a> <a class="" href="/bitcoin-core-dev/2017-08-23">23</a> <a class="" href="/bitcoin-core-dev/2017-08-24">24</a> <a class="" href="/bitcoin-core-dev/2017-08-25">25</a> <a class="" href="/bitcoin-core-dev/2017-08-26">26</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-27">27</a> <a class="" href="/bitcoin-core-dev/2017-08-28">28</a> <a class="" href="/bitcoin-core-dev/2017-08-29">29</a> <a class="" href="/bitcoin-core-dev/2017-08-30">30</a> <a class="" href="/bitcoin-core-dev/2017-08-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1502410440' id='563763'>
<a class='timestamp' href='#563763'><time timestamp='2017-08-11T00:14:00Z'>00:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sipa opened pull request #11028: Avoid masking of difficulty adjustment errors by checkpoints (master...20170810_maskpow) <a href="https://github.com/bitcoin/bitcoin/pull/11028" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11028</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502423220' id='563764'>
<a class='timestamp' href='#563764'><time timestamp='2017-08-11T03:47:00Z'>03:47</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] achow101 closed pull request #10875: BIP 91 deployment parameters (master...bip91-dep-params) <a href="https://github.com/bitcoin/bitcoin/pull/10875" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10875</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502425020' id='563765'>
<a class='timestamp' href='#563765'><time timestamp='2017-08-11T04:17:00Z'>04:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] FelixWeis opened pull request #11029: [RPC] trivial: gettxout no longer shows version of tx (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/11029" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11029</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502458020' id='563766'>
<a class='timestamp' href='#563766'><time timestamp='2017-08-11T13:27:00Z'>13:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
so what&#x27;s with &quot;0.15.SW&quot;? Is the plan for the next release to branch off 0.15 rather than master?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502458380' id='563767'>
<a class='timestamp' href='#563767'><time timestamp='2017-08-11T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/e526ca6284b9...96a63a3e0cef" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/e526ca6284b9...96a63a3e0cef</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502458380' id='563768'>
<a class='timestamp' href='#563768'><time timestamp='2017-08-11T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 8627946 Felix Weis: [RPC] trivial: gettxout no longer shows version of tx...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502458380' id='563769'>
<a class='timestamp' href='#563769'><time timestamp='2017-08-11T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 96a63a3 MarcoFalke: Merge #11029: [RPC] trivial: gettxout no longer shows version of tx...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502458440' id='563770'>
<a class='timestamp' href='#563770'><time timestamp='2017-08-11T13:34:00Z'>13:34</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #11029: [RPC] trivial: gettxout no longer shows version of tx (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/11029" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11029</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502460720' id='563771'>
<a class='timestamp' href='#563771'><time timestamp='2017-08-11T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I don&#x27;t entirely understand that check:
<br>
</div>

<div class='talk op-msg' data-timestamp='1502460720' id='563772'>
<a class='timestamp' href='#563772'><time timestamp='2017-08-11T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L1655" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L1655</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502460720' id='563773'>
<a class='timestamp' href='#563773'><time timestamp='2017-08-11T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Why do we check &#x27;pindex-&gt;nHeight &lt;= chainActive.Tip()-&gt;nHeight - nPrunedBlocksLikelyToHave&#x27; during pruning when responsing to GETBLOCKS
<br>
</div>

<div class='talk op-msg' data-timestamp='1502460780' id='563774'>
<a class='timestamp' href='#563774'><time timestamp='2017-08-11T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I mean we check for BLOCK_HAVE_DATA, I don&#x27;t see why we need to check for &#x27;tip - nPrunedBlocksLikelyToHave&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1502460840' id='563775'>
<a class='timestamp' href='#563775'><time timestamp='2017-08-11T14:14:00Z'>14:14</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
maybe to prevent fingerprinting?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502461500' id='563776'>
<a class='timestamp' href='#563776'><time timestamp='2017-08-11T14:25:00Z'>14:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. Maybe.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502463720' id='563777'>
<a class='timestamp' href='#563777'><time timestamp='2017-08-11T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/96a63a3e0cef...e5d26e47c7a4" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/96a63a3e0cef...e5d26e47c7a4</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502463720' id='563778'>
<a class='timestamp' href='#563778'><time timestamp='2017-08-11T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master faa76d1 MarcoFalke: qa: Fix inv race in example_test
<br>
</div>

<div class='talk op-msg' data-timestamp='1502463720' id='563779'>
<a class='timestamp' href='#563779'><time timestamp='2017-08-11T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master e5d26e4 MarcoFalke: Merge #11025: qa: Fix inv race in example_test...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502463720' id='563780'>
<a class='timestamp' href='#563780'><time timestamp='2017-08-11T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #11025: qa: Fix inv race in example_test (master...Mf1708-qaInvExampleTest) <a href="https://github.com/bitcoin/bitcoin/pull/11025" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11025</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502464500' id='563781'>
<a class='timestamp' href='#563781'><time timestamp='2017-08-11T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
jonasschnelli: i think the comment explains it -- the idea is that we don&#x27;t want to respond with block hashes that we may be likely to prune in the near future
<br>
</div>

<div class='talk op-msg' data-timestamp='1502464500' id='563782'>
<a class='timestamp' href='#563782'><time timestamp='2017-08-11T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
jonasschnelli: because otherwise the peer might request those blocks from us and we&#x27;ll stall their block download by ignoring the request
<br>
</div>

<div class='talk op-msg' data-timestamp='1502465580' id='563783'>
<a class='timestamp' href='#563783'><time timestamp='2017-08-11T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jnewbery opened pull request #11031: [rpc] deprecate estimatefee (master...deprecate_estimatefee) <a href="https://github.com/bitcoin/bitcoin/pull/11031" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11031</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466480' id='563784'>
<a class='timestamp' href='#563784'><time timestamp='2017-08-11T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sdaftuar: but the check to break the response is:  &#x27;pindex-&gt;nHeight &lt;= chainActive.Tip()-&gt;nHeight - nPrunedBlocksLikelyToHave&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466480' id='563785'>
<a class='timestamp' href='#563785'><time timestamp='2017-08-11T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Isn&#x27;t that that blocks &quot;older@ the 288+6 can then never be relaxed regardless of the prune target?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563786'>
<a class='timestamp' href='#563786'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
s/@/&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563787'>
<a class='timestamp' href='#563787'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/e5d26e47c7a4...2c811e08db65" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/e5d26e47c7a4...2c811e08db65</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563788'>
<a class='timestamp' href='#563788'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master c5ebddd René Nyffenegger: Tests: address placement should be deterministic by default
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563789'>
<a class='timestamp' href='#563789'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
*relayed (dry phone typing)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563790'>
<a class='timestamp' href='#563790'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 2c811e0 MarcoFalke: Merge #10765: Tests: address placement should be deterministic by default...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466540' id='563791'>
<a class='timestamp' href='#563791'><time timestamp='2017-08-11T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #10765: Tests: address placement should be deterministic by default (master...test-addrman) <a href="https://github.com/bitcoin/bitcoin/pull/10765" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10765</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466600' id='563792'>
<a class='timestamp' href='#563792'><time timestamp='2017-08-11T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sdaftuar opened pull request #11032: [qa] Fix block message processing error in sendheaders.py (master...2017-08-sendheaders) <a href="https://github.com/bitcoin/bitcoin/pull/11032" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11032</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466660' id='563793'>
<a class='timestamp' href='#563793'><time timestamp='2017-08-11T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: no-- if we offer a block we need to be willing to provide it or we will dos attack our peers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466660' id='563794'>
<a class='timestamp' href='#563794'><time timestamp='2017-08-11T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
doesn&#x27;t matter if its 300 blocks deep or 30000 blocks deep.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466720' id='563795'>
<a class='timestamp' href='#563795'><time timestamp='2017-08-11T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
also keep in mind that the line of code you&#x27;re looking at is the getblocks handler, which is no longer really used to sync the chain by anyone (i hope!)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466840' id='563796'>
<a class='timestamp' href='#563796'><time timestamp='2017-08-11T15:54:00Z'>15:54</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Hmm... seems harder then I thought to add by-prune-height-fingerprinting protection for NODE_NETWORK_LIMITED
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466900' id='563797'>
<a class='timestamp' href='#563797'><time timestamp='2017-08-11T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
you&#x27;re concerned about fingerprinting protection for nodes using manual pruning?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466960' id='563798'>
<a class='timestamp' href='#563798'><time timestamp='2017-08-11T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i would think that if you support NODE_NETWORK_LIMITED (and not NODE_NETWORK), you just always advertise exactly the last 1008 blocks or whatever that target value is
<br>
</div>

<div class='talk op-msg' data-timestamp='1502466960' id='563799'>
<a class='timestamp' href='#563799'><time timestamp='2017-08-11T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I&#x27;m concerned introducing a fingerprinting possibility by NODE_NETWORK_LIMITED
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467020' id='563800'>
<a class='timestamp' href='#563800'><time timestamp='2017-08-11T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. That is what I want. But older messages like getblock must also be covered via that protection
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467080' id='563801'>
<a class='timestamp' href='#563801'><time timestamp='2017-08-11T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
still don&#x27;t see the fingerprinting issue -- can&#x27;t all NODE_NETWORK_LIMITED nodes answer the getblocks issue the same way, with only up to the last 1008 block hashes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467200' id='563802'>
<a class='timestamp' href='#563802'><time timestamp='2017-08-11T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
nPrunedBlocksLikelyToHave can be calculated differently if you&#x27;re pruning to a 1-week target versus a 2-day target
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467200' id='563803'>
<a class='timestamp' href='#563803'><time timestamp='2017-08-11T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
which correspond to LIMITED_HIGH and LIMITED_LOW
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467260' id='563804'>
<a class='timestamp' href='#563804'><time timestamp='2017-08-11T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. The check we discussed above is kind of a fingerprinting protection.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467260' id='563805'>
<a class='timestamp' href='#563805'><time timestamp='2017-08-11T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(Need to check it in detail when im back on my desk)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467320' id='563806'>
<a class='timestamp' href='#563806'><time timestamp='2017-08-11T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i guess!  but that&#x27;s just a coincidence i think, i believe that getblocks handler predates the manual pruning by a lot.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467320' id='563807'>
<a class='timestamp' href='#563807'><time timestamp='2017-08-11T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
so the concern was taht we might return an inv for blocks that we currently have, but are about to prune
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467320' id='563808'>
<a class='timestamp' href='#563808'><time timestamp='2017-08-11T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
the idea is that pruning only (largely-) guarantees the last 288 blocks, so we&#x27;re conservative and never advertise more than that
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467380' id='563809'>
<a class='timestamp' href='#563809'><time timestamp='2017-08-11T16:03:00Z'>16:03</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
and that happens to also give fingerprinting protection for manual pruners, too. though really it&#x27;s just a consequence of manual pruners not having any additional guarantees of what they might keep.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467440' id='563810'>
<a class='timestamp' href='#563810'><time timestamp='2017-08-11T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
eg you could manually prune down to 288 right after you send someone a getblocks response, and then cause problems.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467620' id='563811'>
<a class='timestamp' href='#563811'><time timestamp='2017-08-11T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
separately i could imagine we could schedule getblocks for deprecation
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467620' id='563812'>
<a class='timestamp' href='#563812'><time timestamp='2017-08-11T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
we should probably just change to only advertise things releated to the last 288 or 1008 (however configured) blocks, whatever is our minimum.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467620' id='563813'>
<a class='timestamp' href='#563813'><time timestamp='2017-08-11T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I see. I guess then increasing that protection up to 8 days of blocks in HIGH mode makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467620' id='563814'>
<a class='timestamp' href='#563814'><time timestamp='2017-08-11T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t see why.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467680' id='563815'>
<a class='timestamp' href='#563815'><time timestamp='2017-08-11T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
What we signal should become the minimum we&#x27;ll prune to, even with manual pruning.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467680' id='563816'>
<a class='timestamp' href='#563816'><time timestamp='2017-08-11T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
And then we can getblock advertise out to that minimum.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467920' id='563817'>
<a class='timestamp' href='#563817'><time timestamp='2017-08-11T16:12:00Z'>16:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
gmaxwell, sdaftuar: advertise, yes. I see. But I guess we need a protection here: <a href="https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L977" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L977</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502467980' id='563818'>
<a class='timestamp' href='#563818'><time timestamp='2017-08-11T16:13:00Z'>16:13</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Otherwise one can getdata blocks to fingerprint the prune depth?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468040' id='563819'>
<a class='timestamp' href='#563819'><time timestamp='2017-08-11T16:14:00Z'>16:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2c811e08db65...bf74d377fb8e" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2c811e08db65...bf74d377fb8e</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468040' id='563820'>
<a class='timestamp' href='#563820'><time timestamp='2017-08-11T16:14:00Z'>16:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master cc5d38f John Newbery: Add option to attach a python debugger if test fails
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468040' id='563821'>
<a class='timestamp' href='#563821'><time timestamp='2017-08-11T16:14:00Z'>16:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master bf74d37 MarcoFalke: Merge #11023: [tests] Add option to attach a python debugger if functional test fails...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468040' id='563822'>
<a class='timestamp' href='#563822'><time timestamp='2017-08-11T16:14:00Z'>16:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #11023: [tests] Add option to attach a python debugger if functional test fails (master...func_test_pdb) <a href="https://github.com/bitcoin/bitcoin/pull/11023" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11023</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468220' id='563823'>
<a class='timestamp' href='#563823'><time timestamp='2017-08-11T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yes, but it should allow whitelisted peers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468460' id='563824'>
<a class='timestamp' href='#563824'><time timestamp='2017-08-11T16:21:00Z'>16:21</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
agreed
<br>
</div>

<div class='talk op-msg' data-timestamp='1502468460' id='563825'>
<a class='timestamp' href='#563825'><time timestamp='2017-08-11T16:21:00Z'>16:21</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483040' id='563826'>
<a class='timestamp' href='#563826'><time timestamp='2017-08-11T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
(not for v0.15) I was thinking of adding &#x27;bestblock&#x27; to the output from &#x27;getwalletinfo&#x27;, so if we implement something where the wallet stops advancing because of keypool deplation, at least there&#x27;s an indication that your wallet is falling behind
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483160' id='563827'>
<a class='timestamp' href='#563827'><time timestamp='2017-08-11T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
But bestblock is only updated when the block index is written to disk (usually once an hour), so I think without description, that might be very confusing for users (bestblock showing as some blocks behind, but transactions from recent blocks shown in wallet)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483160' id='563828'>
<a class='timestamp' href='#563828'><time timestamp='2017-08-11T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
any thoughts/suggestions?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483280' id='563829'>
<a class='timestamp' href='#563829'><time timestamp='2017-08-11T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
can we show the more up-to-date bestblock, but only store the block index as currently done?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483400' id='563830'>
<a class='timestamp' href='#563830'><time timestamp='2017-08-11T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
the wallet doesn&#x27;t currently store its best block in memory. It only writes bestblock to disk when the node sends it SetBestChain (shutdown and block index flush)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483460' id='563831'>
<a class='timestamp' href='#563831'><time timestamp='2017-08-11T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
I suppose the wallet could store the most recent block connected when it gets BlockConnected. Is that safe?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483760' id='563832'>
<a class='timestamp' href='#563832'><time timestamp='2017-08-11T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jnewbery: i think that&#x27;s what needs to happen anyway, allow the wallet at any time to run behind the node, and make it catch up in the background
<br>
</div>

<div class='talk op-msg' data-timestamp='1502483760' id='563833'>
<a class='timestamp' href='#563833'><time timestamp='2017-08-11T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so ack on adding bestblock to walletinfo output
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484420' id='563834'>
<a class='timestamp' href='#563834'><time timestamp='2017-08-11T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-12'> ryanofsky</span>&gt;
#10286 adds CWallet::m_last_block_processed, which is a better name than bestblock imo
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484420' id='563835'>
<a class='timestamp' href='#563835'><time timestamp='2017-08-11T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/10286" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/10286</a> | Call wallet notify callbacks in scheduler thread (without cs_main) by TheBlueMatt · Pull Request #10286 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484420' id='563836'>
<a class='timestamp' href='#563836'><time timestamp='2017-08-11T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
sipa : does storing the hash of the most recent BlockConnected seem like the right thing to do?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484480' id='563837'>
<a class='timestamp' href='#563837'><time timestamp='2017-08-11T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-16'> jnewbery</span>&gt;
ryanofsky oh great. Thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484540' id='563838'>
<a class='timestamp' href='#563838'><time timestamp='2017-08-11T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-12'> ryanofsky</span>&gt;
10286 stores it as a cblockindex pointer, but #10973 turns that into a hash, so either way seems fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1502484540' id='563839'>
<a class='timestamp' href='#563839'><time timestamp='2017-08-11T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/10973" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/10973</a> | WIP: Add IPC layer between node and wallet by ryanofsky · Pull Request #10973 · bitcoin/bitcoin · GitHub
<br>
</div>

</div>
</section>

</body>
</html>
