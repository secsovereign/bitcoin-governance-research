<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-10-31
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-10-31' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:25 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-09-30">&lt;</a><span class='header'>   October 2016   </span><a href="/bitcoin-core-dev/2016-11-30">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;                   <a class="" href="/bitcoin-core-dev/2016-10-01">1</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2016-10-03">3</a>  <a class="" href="/bitcoin-core-dev/2016-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2016-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2016-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2016-10-08">8</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-10-09">9</a> <a class="" href="/bitcoin-core-dev/2016-10-10">10</a> <a class="" href="/bitcoin-core-dev/2016-10-11">11</a> <a class="" href="/bitcoin-core-dev/2016-10-12">12</a> <a class="" href="/bitcoin-core-dev/2016-10-13">13</a> <a class="" href="/bitcoin-core-dev/2016-10-14">14</a> <a class="" href="/bitcoin-core-dev/2016-10-15">15</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-10-16">16</a> <a class="" href="/bitcoin-core-dev/2016-10-17">17</a> <a class="" href="/bitcoin-core-dev/2016-10-18">18</a> <a class="" href="/bitcoin-core-dev/2016-10-19">19</a> <a class="" href="/bitcoin-core-dev/2016-10-20">20</a> <a class="" href="/bitcoin-core-dev/2016-10-21">21</a> <a class="" href="/bitcoin-core-dev/2016-10-22">22</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-10-23">23</a> <a class="" href="/bitcoin-core-dev/2016-10-24">24</a> <a class="" href="/bitcoin-core-dev/2016-10-25">25</a> <a class="" href="/bitcoin-core-dev/2016-10-26">26</a> <a class="" href="/bitcoin-core-dev/2016-10-27">27</a> <a class="" href="/bitcoin-core-dev/2016-10-28">28</a> <a class="" href="/bitcoin-core-dev/2016-10-29">29</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-10-30">30</a> <a class="current" href="/bitcoin-core-dev/2016-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1477874040' id='507712'>
<a class='timestamp' href='#507712'><time timestamp='2016-10-31T00:34:00Z'>00:34</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
does anyone care about a 0.5ms speedup to CheckBlock?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874100' id='507713'>
<a class='timestamp' href='#507713'><time timestamp='2016-10-31T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
is it a simple clean change?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874100' id='507714'>
<a class='timestamp' href='#507714'><time timestamp='2016-10-31T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I had speedups at that levle (somewhat faster) by merging loops over all the txn.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874160' id='507715'>
<a class='timestamp' href='#507715'><time timestamp='2016-10-31T00:36:00Z'>00:36</time></a>
&lt;<span class='nick nick-2'> * gmaxwell</span>&gt;
goes looking for those patches that were held off waiting for segwit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874160' id='507716'>
<a class='timestamp' href='#507716'><time timestamp='2016-10-31T00:36:00Z'>00:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
well half of it is (<a href="https://github.com/bitcoinfibre/bitcoinfibre/commit/e4884c9f706881fb33ed49f7098e1cea58807e87)" class="link" target="_blank">https://github.com/bitcoinfibre/bitcoinfibre/commit/e4884c9f706881fb33ed49f7098e1cea58807e87)</a> the other half is only bareless less so (<a href="https://github.com/bitcoinfibre/bitcoinfibre/commit/8bd42b8f763fb736bfde4fba7390d49b9f3cccc6)" class="link" target="_blank">https://github.com/bitcoinfibre/bitcoinfibre/commit/8bd42b8f763fb736bfde4fba7390d49b9f3cccc6)</a> though i havent benchmarked individually so not sure which is helping
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874160' id='507717'>
<a class='timestamp' href='#507717'><time timestamp='2016-10-31T00:36:00Z'>00:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i think it might actually be the first one, which is 2 line diff
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874220' id='507718'>
<a class='timestamp' href='#507718'><time timestamp='2016-10-31T00:37:00Z'>00:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do we even need that check?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874220' id='507719'>
<a class='timestamp' href='#507719'><time timestamp='2016-10-31T00:37:00Z'>00:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which? the transaction-length one? no, it is 100% redundant
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874280' id='507720'>
<a class='timestamp' href='#507720'><time timestamp='2016-10-31T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the duplicate-inputs one? unclear, probably not but we added it for a reason
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874280' id='507721'>
<a class='timestamp' href='#507721'><time timestamp='2016-10-31T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
dont recall what it was
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874280' id='507722'>
<a class='timestamp' href='#507722'><time timestamp='2016-10-31T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i do remember that we had a reason, however
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874280' id='507723'>
<a class='timestamp' href='#507723'><time timestamp='2016-10-31T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
was it related to bip30?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874400' id='507724'>
<a class='timestamp' href='#507724'><time timestamp='2016-10-31T00:40:00Z'>00:40</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hum...i dont see why? :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874400' id='507725'>
<a class='timestamp' href='#507725'><time timestamp='2016-10-31T00:40:00Z'>00:40</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
lol, all these half-empty blocks are fucking with my benchmarking :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874520' id='507726'>
<a class='timestamp' href='#507726'><time timestamp='2016-10-31T00:42:00Z'>00:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/pull/443" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/443</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874520' id='507727'>
<a class='timestamp' href='#507727'><time timestamp='2016-10-31T00:42:00Z'>00:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you added this.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874520' id='507728'>
<a class='timestamp' href='#507728'><time timestamp='2016-10-31T00:42:00Z'>00:42</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yes, and i recall having a reason :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874580' id='507729'>
<a class='timestamp' href='#507729'><time timestamp='2016-10-31T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the pr explains, they were getting relayed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874580' id='507730'>
<a class='timestamp' href='#507730'><time timestamp='2016-10-31T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(or so says the pr)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874580' id='507731'>
<a class='timestamp' href='#507731'><time timestamp='2016-10-31T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hum, that seems strange to me?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874640' id='507732'>
<a class='timestamp' href='#507732'><time timestamp='2016-10-31T00:44:00Z'>00:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i mean that was a long time ago, though, i guess before CCoins
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874640' id='507733'>
<a class='timestamp' href='#507733'><time timestamp='2016-10-31T00:44:00Z'>00:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
CCoinsViewCache stuff should have fixed this?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874640' id='507734'>
<a class='timestamp' href='#507734'><time timestamp='2016-10-31T00:44:00Z'>00:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874700' id='507735'>
<a class='timestamp' href='#507735'><time timestamp='2016-10-31T00:45:00Z'>00:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe the ConnectInputs code at the time may not have been able to catch this
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874700' id='507736'>
<a class='timestamp' href='#507736'><time timestamp='2016-10-31T00:45:00Z'>00:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yes, this sounds correct to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874760' id='507737'>
<a class='timestamp' href='#507737'><time timestamp='2016-10-31T00:46:00Z'>00:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it had an fBlock which was false for mempool txn, and it disabled part of the checks
<br>
</div>

<div class='talk op-msg' data-timestamp='1477874940' id='507738'>
<a class='timestamp' href='#507738'><time timestamp='2016-10-31T00:49:00Z'>00:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
removal trumps optimizing, though if you want to optimize there, I think I found a 1ms-scale speedup by fusing varrious loops over every transaction in the block into a single loop.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875120' id='507739'>
<a class='timestamp' href='#507739'><time timestamp='2016-10-31T00:52:00Z'>00:52</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
you mean in CheckBlock?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875120' id='507740'>
<a class='timestamp' href='#507740'><time timestamp='2016-10-31T00:52:00Z'>00:52</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
theres only two over-tx loops
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875120' id='507741'>
<a class='timestamp' href='#507741'><time timestamp='2016-10-31T00:52:00Z'>00:52</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
no, 3
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875180' id='507742'>
<a class='timestamp' href='#507742'><time timestamp='2016-10-31T00:53:00Z'>00:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
there are three, coinbase check, checktransaction and sigops check.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875180' id='507743'>
<a class='timestamp' href='#507743'><time timestamp='2016-10-31T00:53:00Z'>00:53</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yea, should merge that, though the sigops loop is ~free
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875240' id='507744'>
<a class='timestamp' href='#507744'><time timestamp='2016-10-31T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
well, its well under 1ms
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875240' id='507745'>
<a class='timestamp' href='#507745'><time timestamp='2016-10-31T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
well, well under
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875240' id='507746'>
<a class='timestamp' href='#507746'><time timestamp='2016-10-31T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
IIRC I benchmarked it an it was about a 1ms change. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875300' id='507747'>
<a class='timestamp' href='#507747'><time timestamp='2016-10-31T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-16'> * BlueMatt</span>&gt;
-&gt; dinner
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875300' id='507748'>
<a class='timestamp' href='#507748'><time timestamp='2016-10-31T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hum, that would surprise me (or your system was slower than mine :p)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875300' id='507749'>
<a class='timestamp' href='#507749'><time timestamp='2016-10-31T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well slower probably, -- probably benchmarked it on my laptop.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875480' id='507750'>
<a class='timestamp' href='#507750'><time timestamp='2016-10-31T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: or I flubbed the meaurement. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1477875540' id='507751'>
<a class='timestamp' href='#507751'><time timestamp='2016-10-31T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But I think the opterations can basically be fused into CheckTransaction... e.g. takes a flag that indicates if its allowed to be a coinbase, and returns the sigops count.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477883700' id='507752'>
<a class='timestamp' href='#507752'><time timestamp='2016-10-31T03:15:00Z'>03:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: in 9045 what initilizes data_hash?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477883760' id='507753'>
<a class='timestamp' href='#507753'><time timestamp='2016-10-31T03:16:00Z'>03:16</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: default-initialized to null
<br>
</div>

<div class='talk op-msg' data-timestamp='1477883760' id='507754'>
<a class='timestamp' href='#507754'><time timestamp='2016-10-31T03:16:00Z'>03:16</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
its a class
<br>
</div>

<div class='talk op-msg' data-timestamp='1477884360' id='507755'>
<a class='timestamp' href='#507755'><time timestamp='2016-10-31T03:26:00Z'>03:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: anyway, i&#x27;ll look at optimizing it a bit tomorrow...see if i can write a bench_bitcoin thinggy for it
<br>
</div>

<div class='talk op-msg' data-timestamp='1477884420' id='507756'>
<a class='timestamp' href='#507756'><time timestamp='2016-10-31T03:27:00Z'>03:27</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
CheckBlock is not-insignificant in terms of time from wire to udp broadcast (which is right before disk write in AcceptBlock - same place compact block announcement will end up)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477884420' id='507757'>
<a class='timestamp' href='#507757'><time timestamp='2016-10-31T03:27:00Z'>03:27</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ofc actual block deserialization is really the largest time sink
<br>
</div>

<div class='talk op-msg' data-timestamp='1477884540' id='507758'>
<a class='timestamp' href='#507758'><time timestamp='2016-10-31T03:29:00Z'>03:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t believe you. <a href="http://0bin.net/paste/KLQCR8JpdMu5i-x2#VitVZ6nLLdJSu" class="link" target="_blank">http://0bin.net/paste/KLQCR8JpdMu5i-x2#VitVZ6nLLdJSu</a>+EnHlCy70e95NLkWxxGgoeNtjY7JmZ
<br>
</div>

<div class='talk op-msg' data-timestamp='1477884960' id='507759'>
<a class='timestamp' href='#507759'><time timestamp='2016-10-31T03:36:00Z'>03:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: ^
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885020' id='507760'>
<a class='timestamp' href='#507760'><time timestamp='2016-10-31T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: ints are default not initialized
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885200' id='507761'>
<a class='timestamp' href='#507761'><time timestamp='2016-10-31T03:40:00Z'>03:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh, matt was saying the uint256 constructor is initing it. I thought he was saying because CNetMessage is a class all its members are initilized.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885200' id='507762'>
<a class='timestamp' href='#507762'><time timestamp='2016-10-31T03:40:00Z'>03:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, it is
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885200' id='507763'>
<a class='timestamp' href='#507763'><time timestamp='2016-10-31T03:40:00Z'>03:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
CNetMessage is a class, so all its members have their default constructor called
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885260' id='507764'>
<a class='timestamp' href='#507764'><time timestamp='2016-10-31T03:41:00Z'>03:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yes, I&#x27;d just missed that the hash was a uint256. (or rather that a uint256 behaves differently from a primitive type. :) )
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885260' id='507765'>
<a class='timestamp' href='#507765'><time timestamp='2016-10-31T03:41:00Z'>03:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we could in theory not initialize the member chars in a uint5
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885260' id='507766'>
<a class='timestamp' href='#507766'><time timestamp='2016-10-31T03:41:00Z'>03:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*uintw56
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885320' id='507767'>
<a class='timestamp' href='#507767'><time timestamp='2016-10-31T03:42:00Z'>03:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
**uint256
<br>
</div>

<div class='talk op-msg' data-timestamp='1477885320' id='507768'>
<a class='timestamp' href='#507768'><time timestamp='2016-10-31T03:42:00Z'>03:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i think that would surprise people
<br>
</div>

<div class='talk op-msg' data-timestamp='1477899060' id='507769'>
<a class='timestamp' href='#507769'><time timestamp='2016-10-31T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: <a href="https://github.com/bitcoin/bitcoin/pull/8930/commits/37aefff5fcf7169a1b07ff8939850f630640f7e7" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8930/commits/37aefff5fcf7169a1b07ff8939850f630640f7e7</a> &lt;- i remember there was some discussion about the reintroduction of #ifdef ENABLE_WALLET there, but i don&#x27;t know where it was or what was said
<br>
</div>

<div class='talk op-msg' data-timestamp='1477901520' id='507770'>
<a class='timestamp' href='#507770'><time timestamp='2016-10-31T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: <a href="https://github.com/bitcoin/bitcoin/pull/8977/files" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8977/files</a> fixes BlueMatt&#x27;s #ifdef ENABLE_WALLET
<br>
</div>

<div class='talk op-msg' data-timestamp='1477908000' id='507771'>
<a class='timestamp' href='#507771'><time timestamp='2016-10-31T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-11'>@wumpus</span>&gt;
gmaxwell: can you take a look here? <a href="https://github.com/bitcoin-dot-org/bitcoin.org/pull/1401" class="link" target="_blank">https://github.com/bitcoin-dot-org/bitcoin.org/pull/1401</a> (re: final alert stuff)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477908060' id='507772'>
<a class='timestamp' href='#507772'><time timestamp='2016-10-31T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-11'>@wumpus</span>&gt;
I think it can be merged but as you&#x27;re going to send it, it makes sense if you sign off on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1477916100' id='507773'>
<a class='timestamp' href='#507773'><time timestamp='2016-10-31T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
ping gmaxwell 
<br>
</div>

<div class='talk op-msg' data-timestamp='1477916280' id='507774'>
<a class='timestamp' href='#507774'><time timestamp='2016-10-31T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-8'> Victorsueca</span>&gt;
try to CTCP ping him? that usually shows on other tabs
<br>
</div>

<div class='talk op-msg' data-timestamp='1477917120' id='507775'>
<a class='timestamp' href='#507775'><time timestamp='2016-10-31T12:32:00Z'>12:32</time></a>
&lt;<span class='nick nick-4'> rabidus_</span>&gt;
try ddos
<br>
</div>

<div class='talk op-msg' data-timestamp='1477917120' id='507776'>
<a class='timestamp' href='#507776'><time timestamp='2016-10-31T12:32:00Z'>12:32</time></a>
&lt;<span class='nick nick-4'> rabidus_</span>&gt;
ehm... i didn&#x27;t really say that
<br>
</div>

<div class='talk op-msg' data-timestamp='1477917120' id='507777'>
<a class='timestamp' href='#507777'><time timestamp='2016-10-31T12:32:00Z'>12:32</time></a>
&lt;<span class='nick nick-4'> rabidus_</span>&gt;
that&#x27;s not an advice
<br>
</div>

<div class='talk op-msg' data-timestamp='1477917240' id='507778'>
<a class='timestamp' href='#507778'><time timestamp='2016-10-31T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
…     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477917240' id='507779'>
<a class='timestamp' href='#507779'><time timestamp='2016-10-31T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-4'> rabidus_</span>&gt;
:&#x27;(     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477918980' id='507780'>
<a class='timestamp' href='#507780'><time timestamp='2016-10-31T13:03:00Z'>13:03</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
<a href="https://www.reddit.com/r/Bitcoin/comments/5ac1a4/error_in_bitcoind_munmap_chunk_invalid_pointer/" class="link" target="_blank">https://www.reddit.com/r/Bitcoin/comments/5ac1a4/error_in_bitcoind_munmap_chunk_invalid_pointer/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477920660' id='507781'>
<a class='timestamp' href='#507781'><time timestamp='2016-10-31T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: I prefer adding an ifdef than having a segfault (also that was already merged in another pr)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477925220' id='507782'>
<a class='timestamp' href='#507782'><time timestamp='2016-10-31T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-13'> GitHub117</span>&gt;
[bitcoin] sdaftuar opened pull request #9048: [0.13 backport] Fix handling of invalid compact blocks (0.13...fix-invalid-cb-ban-0.13) <a href="https://github.com/bitcoin/bitcoin/pull/9048" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9048</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477927200' id='507783'>
<a class='timestamp' href='#507783'><time timestamp='2016-10-31T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: 8977 it seems
<br>
</div>

<div class='talk op-msg' data-timestamp='1477932600' id='507784'>
<a class='timestamp' href='#507784'><time timestamp='2016-10-31T16:50:00Z'>16:50</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: so i went and combined everything into one loop of txn in a block (and even combined the sigops count loops pushed into checktransaction, etc...also removed the duplicative GetSerializeSize check in CheckTransaction (which is duplicative of CheckBlock) and the only part of that whole excersize that made any noticeable performance difference was removing the duplicate-input check, which made for a significant performance 
<br>
</div>

<div class='talk op-msg' data-timestamp='1477932600' id='507785'>
<a class='timestamp' href='#507785'><time timestamp='2016-10-31T16:50:00Z'>16:50</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
increase (of around 1.5ms in the 3-4ms function...)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477932840' id='507786'>
<a class='timestamp' href='#507786'><time timestamp='2016-10-31T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
nvm, 0.7ms
<br>
</div>

<div class='talk op-msg' data-timestamp='1477932900' id='507787'>
<a class='timestamp' href='#507787'><time timestamp='2016-10-31T16:55:00Z'>16:55</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
on my laptop: 8ms to deserialize, 11.1 -&gt; 10.5ms for deserialize + checkblock
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934160' id='507788'>
<a class='timestamp' href='#507788'><time timestamp='2016-10-31T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: cool, so let&#x27;s just get rid of the duplicates check
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934220' id='507789'>
<a class='timestamp' href='#507789'><time timestamp='2016-10-31T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: not so easy due to network partition risk, as sdaftuar and I just found out :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934280' id='507790'>
<a class='timestamp' href='#507790'><time timestamp='2016-10-31T17:18:00Z'>17:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
uh?     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934280' id='507791'>
<a class='timestamp' href='#507791'><time timestamp='2016-10-31T17:18:00Z'>17:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah.     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934280' id='507792'>
<a class='timestamp' href='#507792'><time timestamp='2016-10-31T17:18:00Z'>17:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oops, no, nvm, just makes it tricky-er to do pre-relay of compact blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934280' id='507793'>
<a class='timestamp' href='#507793'><time timestamp='2016-10-31T17:18:00Z'>17:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
since then CheckBlock becomes network-ban-partition-consensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934340' id='507794'>
<a class='timestamp' href='#507794'><time timestamp='2016-10-31T17:19:00Z'>17:19</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(0.13.1 will already ban you for this, so it cant get worse...)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934400' id='507795'>
<a class='timestamp' href='#507795'><time timestamp='2016-10-31T17:20:00Z'>17:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: re: #9026
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934520' id='507796'>
<a class='timestamp' href='#507796'><time timestamp='2016-10-31T17:22:00Z'>17:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
bump the protocol version number. then you can decide on your behavior based on it.?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934760' id='507797'>
<a class='timestamp' href='#507797'><time timestamp='2016-10-31T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
true, probably need to do that, though still really want to do for 0.13.2
<br>
</div>

<div class='talk op-msg' data-timestamp='1477934760' id='507798'>
<a class='timestamp' href='#507798'><time timestamp='2016-10-31T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and then the problem is we dont want to change too often because you would just skip pre-relay for people not on your protocol version
<br>
</div>

<div class='talk op-msg' data-timestamp='1477937400' id='507799'>
<a class='timestamp' href='#507799'><time timestamp='2016-10-31T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: i&#x27;m really curious what typo you made that got corrected into &quot;I did not Rome the hashing&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1477937400' id='507800'>
<a class='timestamp' href='#507800'><time timestamp='2016-10-31T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
dunno how my phone converted benchmark to rome, but it appears to have
<br>
</div>

<div class='talk op-msg' data-timestamp='1477937460' id='507801'>
<a class='timestamp' href='#507801'><time timestamp='2016-10-31T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
.query eragmus
<br>
</div>

<div class='talk op-msg' data-timestamp='1477937460' id='507802'>
<a class='timestamp' href='#507802'><time timestamp='2016-10-31T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oops
<br>
</div>

<div class='talk op-msg' data-timestamp='1477939740' id='507803'>
<a class='timestamp' href='#507803'><time timestamp='2016-10-31T18:49:00Z'>18:49</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/d2143dc937e3...3d69ecb4edeb" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/d2143dc937e3...3d69ecb4edeb</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477939800' id='507804'>
<a class='timestamp' href='#507804'><time timestamp='2016-10-31T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
bitcoin/master 7f61b49 matthias: Change all instance of &#x27;GMT epoch&#x27; to &#x27;Unix epoch&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1477939800' id='507805'>
<a class='timestamp' href='#507805'><time timestamp='2016-10-31T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-8'> GitHub133</span>&gt;
bitcoin/master 3d69ecb MarcoFalke: Merge #9041: keypoololdest denote Unix epoch, not GMT...
<br>
</div>

<div class='talk op-msg' data-timestamp='1477939800' id='507806'>
<a class='timestamp' href='#507806'><time timestamp='2016-10-31T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
[bitcoin] MarcoFalke closed pull request #9041: keypoololdest denote Unix epoch, not GMT (master...patch-8) <a href="https://github.com/bitcoin/bitcoin/pull/9041" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9041</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477939920' id='507807'>
<a class='timestamp' href='#507807'><time timestamp='2016-10-31T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-4'> GitHub112</span>&gt;
[bitcoin] TheBlueMatt opened pull request #9049: Remove duplicatble duplicate-input check from CheckTransaction (master...2016-10-bench-checkblock) <a href="https://github.com/bitcoin/bitcoin/pull/9049" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9049</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477940220' id='507808'>
<a class='timestamp' href='#507808'><time timestamp='2016-10-31T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
duplicatble duplicate-input ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951380' id='507809'>
<a class='timestamp' href='#507809'><time timestamp='2016-10-31T22:03:00Z'>22:03</time></a>
&lt;<span class='nick nick-12'> GitHub106</span>&gt;
[bitcoin] theuni opened pull request #9050: net: make a few values immutible, and use deterministic randomness for the localnonce (master...connman-const) <a href="https://github.com/bitcoin/bitcoin/pull/9050" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9050</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951740' id='507810'>
<a class='timestamp' href='#507810'><time timestamp='2016-10-31T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields_: I haven&#x27;t looked yet, but does that fix the current race condition, where if you connect to yourself then someone else connects to you then you get your own nonce, you&#x27;ll not detect the connect to self?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951800' id='507811'>
<a class='timestamp' href='#507811'><time timestamp='2016-10-31T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: i believe that was fixed a while back with the initial CConnman merge.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951800' id='507812'>
<a class='timestamp' href='#507812'><time timestamp='2016-10-31T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Ah. good
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951860' id='507813'>
<a class='timestamp' href='#507813'><time timestamp='2016-10-31T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, that was fixed afaik
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951920' id='507814'>
<a class='timestamp' href='#507814'><time timestamp='2016-10-31T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: if we&#x27;re speaking of the same race, this should&#x27;ve fixed it: <a href="https://github.com/bitcoin/bitcoin/commit/960cf2e4058a9c195bf64e1aecb46024f9ef022a" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/960cf2e4058a9c195bf64e1aecb46024f9ef022a</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1477951980' id='507815'>
<a class='timestamp' href='#507815'><time timestamp='2016-10-31T22:13:00Z'>22:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yup! that looks good. Okay, I&#x27;d missed that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952160' id='507816'>
<a class='timestamp' href='#507816'><time timestamp='2016-10-31T22:16:00Z'>22:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields_: whats the motivation for making the nonce determinstic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952280' id='507817'>
<a class='timestamp' href='#507817'><time timestamp='2016-10-31T22:18:00Z'>22:18</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: none really, other than it&#x27;s one of the few (the only?) users of Rand in there. Eliminating them could ease replay for testing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507818'>
<a class='timestamp' href='#507818'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
uh. wait... you mean this is completely determinstic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507819'>
<a class='timestamp' href='#507819'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-2'> * gmaxwell</span>&gt;
goes to read the patch.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507820'>
<a class='timestamp' href='#507820'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: really not much though, i just figured if it was immutible and per-connection, may as well make it deterministic if possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507821'>
<a class='timestamp' href='#507821'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: heh, no. It&#x27;s seeded at startup
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507822'>
<a class='timestamp' href='#507822'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
wait, i hope...
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952340' id='507823'>
<a class='timestamp' href='#507823'><time timestamp='2016-10-31T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
yes, sorry. It&#x27;s a per-connman seed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952400' id='507824'>
<a class='timestamp' href='#507824'><time timestamp='2016-10-31T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
you made me doubt myself for a sec :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952580' id='507825'>
<a class='timestamp' href='#507825'><time timestamp='2016-10-31T22:23:00Z'>22:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
K. yes, I see that.  Just the &#x27;replay for testing&#x27; made me wonder!
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952640' id='507826'>
<a class='timestamp' href='#507826'><time timestamp='2016-10-31T22:24:00Z'>22:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so if someone manages to make enough connections to wrap the peer_id ... it&#x27;ll repeat. OTOH if someone manages to do that lots of other things will probably break. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1477952820' id='507827'>
<a class='timestamp' href='#507827'><time timestamp='2016-10-31T22:27:00Z'>22:27</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
heh, yes. NodeId is signed, so things could go wonky way before that
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953060' id='507828'>
<a class='timestamp' href='#507828'><time timestamp='2016-10-31T22:31:00Z'>22:31</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
err     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953360' id='507829'>
<a class='timestamp' href='#507829'><time timestamp='2016-10-31T22:36:00Z'>22:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: cfields_ just had a spurrious travis failure caused by the overly jumpy rand_bits test in libsecp256k1.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953420' id='507830'>
<a class='timestamp' href='#507830'><time timestamp='2016-10-31T22:37:00Z'>22:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: IMO we should ifdef out the RNG tests and just run them once per release as part of a prerelease checklist or something.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953540' id='507831'>
<a class='timestamp' href='#507831'><time timestamp='2016-10-31T22:39:00Z'>22:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
iirc i started a replacement for that at some point, but it remained too spurious
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953660' id='507832'>
<a class='timestamp' href='#507832'><time timestamp='2016-10-31T22:41:00Z'>22:41</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: hum, hashing isnt much of a bottleneck here...
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953720' id='507833'>
<a class='timestamp' href='#507833'><time timestamp='2016-10-31T22:42:00Z'>22:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: I believe its the only rest with spurrious failures, and the rng tests are the only ones which <u>_must_</u> have spurrious failures.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953780' id='507834'>
<a class='timestamp' href='#507834'><time timestamp='2016-10-31T22:43:00Z'>22:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right, but it should be doable to bring that down to 1 in a billion runs or so
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953780' id='507835'>
<a class='timestamp' href='#507835'><time timestamp='2016-10-31T22:43:00Z'>22:43</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
well, the compact blocks stuff is somewhat spurious
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953840' id='507836'>
<a class='timestamp' href='#507836'><time timestamp='2016-10-31T22:44:00Z'>22:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
though i suppose it could effect regtest during semi-normal usage
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953840' id='507837'>
<a class='timestamp' href='#507837'><time timestamp='2016-10-31T22:44:00Z'>22:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: this is about libsecp256k1
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953900' id='507838'>
<a class='timestamp' href='#507838'><time timestamp='2016-10-31T22:45:00Z'>22:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oh, sorry
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953900' id='507839'>
<a class='timestamp' href='#507839'><time timestamp='2016-10-31T22:45:00Z'>22:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
get your own channel!
<br>
</div>

<div class='talk op-msg' data-timestamp='1477953900' id='507840'>
<a class='timestamp' href='#507840'><time timestamp='2016-10-31T22:45:00Z'>22:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(jk)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954020' id='507841'>
<a class='timestamp' href='#507841'><time timestamp='2016-10-31T22:47:00Z'>22:47</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: i just can&#x27;t think of any good reason for handling it on the socket thread, which lags more with each added connection, as opposed to on the message thread(/pool), potentially lazily, and only as needed
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954080' id='507842'>
<a class='timestamp' href='#507842'><time timestamp='2016-10-31T22:48:00Z'>22:48</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: oops, see my respond on github
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954140' id='507843'>
<a class='timestamp' href='#507843'><time timestamp='2016-10-31T22:49:00Z'>22:49</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
its a latency question...our current hasher should (mostly) be able to keep up with 1Gbps of shit (ok, maybe more like 500Mbps), but putting it in the processing logic adds latency to block processing
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954260' id='507844'>
<a class='timestamp' href='#507844'><time timestamp='2016-10-31T22:51:00Z'>22:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
also we do no other computation in the thread that handles the incoming data... so this should better let it run concurrently with processing given the current setup.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954320' id='507845'>
<a class='timestamp' href='#507845'><time timestamp='2016-10-31T22:52:00Z'>22:52</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
hmm     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954380' id='507846'>
<a class='timestamp' href='#507846'><time timestamp='2016-10-31T22:53:00Z'>22:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i would expect that in the future it&#x27;s also easier to parallellize networking than it is to parallellize processing
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954500' id='507847'>
<a class='timestamp' href='#507847'><time timestamp='2016-10-31T22:55:00Z'>22:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and the bip151 hasher should be a few times faster
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954500' id='507848'>
<a class='timestamp' href='#507848'><time timestamp='2016-10-31T22:55:00Z'>22:55</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: heh, i argued the exact opposite in the PR. At the select/epoll/etc. level anyway. Though I suppose you could split the nodes into batches.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954500' id='507849'>
<a class='timestamp' href='#507849'><time timestamp='2016-10-31T22:55:00Z'>22:55</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: if you&#x27;re bored, #8969 can probably get another ack and a merge, then we&#x27;re only about 3 commits from splitting main, altough the next one will probably have to wait until the compact block fix goes in
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954560' id='507850'>
<a class='timestamp' href='#507850'><time timestamp='2016-10-31T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-16'> * BlueMatt</span>&gt;
realizes he hasnt re-reviewed 8708, oops
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954560' id='507851'>
<a class='timestamp' href='#507851'><time timestamp='2016-10-31T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: you can save the poke, i owe you an ack on that one already :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954560' id='507852'>
<a class='timestamp' href='#507852'><time timestamp='2016-10-31T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
heh, ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954560' id='507853'>
<a class='timestamp' href='#507853'><time timestamp='2016-10-31T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
just trying to move things in since its gonna be a painful merge cycle to get this all in for 0.4
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954680' id='507854'>
<a class='timestamp' href='#507854'><time timestamp='2016-10-31T22:58:00Z'>22:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: also, 8708 mentions constness... i&#x27;m addressing that to some extent in #8580, which now is queued after #9039 :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954740' id='507855'>
<a class='timestamp' href='#507855'><time timestamp='2016-10-31T22:59:00Z'>22:59</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
lol, so much to review
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954740' id='507856'>
<a class='timestamp' href='#507856'><time timestamp='2016-10-31T22:59:00Z'>22:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
9039 grew a bit beyond what i originally planned to address, but i think the result is worth it
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954800' id='507857'>
<a class='timestamp' href='#507857'><time timestamp='2016-10-31T23:00:00Z'>23:00</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yea, i saw there was some back-and-forth, but, indeed, I&#x27;ll bet thats worth it
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954800' id='507858'>
<a class='timestamp' href='#507858'><time timestamp='2016-10-31T23:00:00Z'>23:00</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
serialization can always use cleaning
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954800' id='507859'>
<a class='timestamp' href='#507859'><time timestamp='2016-10-31T23:00:00Z'>23:00</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: ack. Your serialization changes are next on my list to review. As it relates to 8708, i removed the const hack that i justified with &quot;but we already do this elsewhere!&quot;, so my changes won&#x27;t undo your fixes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954860' id='507860'>
<a class='timestamp' href='#507860'><time timestamp='2016-10-31T23:01:00Z'>23:01</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
we need an irc bot that posts pr titles after numbers are mentioned :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954860' id='507861'>
<a class='timestamp' href='#507861'><time timestamp='2016-10-31T23:01:00Z'>23:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: yes!
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954860' id='507862'>
<a class='timestamp' href='#507862'><time timestamp='2016-10-31T23:01:00Z'>23:01</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
where is nanotube when you need him?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954860' id='507863'>
<a class='timestamp' href='#507863'><time timestamp='2016-10-31T23:01:00Z'>23:01</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: heh, yes, and links to commit ids
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954860' id='507864'>
<a class='timestamp' href='#507864'><time timestamp='2016-10-31T23:01:00Z'>23:01</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gribble: help me out bro
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954920' id='507865'>
<a class='timestamp' href='#507865'><time timestamp='2016-10-31T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: i used that in another channel, iirc it was easy enough to setup
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954920' id='507866'>
<a class='timestamp' href='#507866'><time timestamp='2016-10-31T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I&#x27;m sure, but I&#x27;m lazy...prefer if someone who&#x27;s already running a bot in here does it :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954920' id='507867'>
<a class='timestamp' href='#507867'><time timestamp='2016-10-31T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I mean its easy...4 digit number starting with a # and link to github.com/bitcoin/bitcoin/issue/#
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954980' id='507868'>
<a class='timestamp' href='#507868'><time timestamp='2016-10-31T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: I&#x27;ll try to get you another review on 8708 tonight, otherwise tomorrow morning
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954980' id='507869'>
<a class='timestamp' href='#507869'><time timestamp='2016-10-31T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt, cfields_: can you two fight over the order in which 8708 and 8969?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954980' id='507870'>
<a class='timestamp' href='#507870'><time timestamp='2016-10-31T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
should be minimal conflicts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954980' id='507871'>
<a class='timestamp' href='#507871'><time timestamp='2016-10-31T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477954980' id='507872'>
<a class='timestamp' href='#507872'><time timestamp='2016-10-31T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
or at least easy-to-resolve ones?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955040' id='507873'>
<a class='timestamp' href='#507873'><time timestamp='2016-10-31T23:04:00Z'>23:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so much easier :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955040' id='507874'>
<a class='timestamp' href='#507874'><time timestamp='2016-10-31T23:04:00Z'>23:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i assumed they&#x27;d conflict a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955040' id='507875'>
<a class='timestamp' href='#507875'><time timestamp='2016-10-31T23:04:00Z'>23:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
8969 is some random trivial cleanups in preparation for the big split (tm)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955040' id='507876'>
<a class='timestamp' href='#507876'><time timestamp='2016-10-31T23:04:00Z'>23:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so souldnt conflict with much of anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955100' id='507877'>
<a class='timestamp' href='#507877'><time timestamp='2016-10-31T23:05:00Z'>23:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: 9039 touches pretty much every line that deals with serialization, so it&#x27;ll conflict with the beginning of 8708
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955160' id='507878'>
<a class='timestamp' href='#507878'><time timestamp='2016-10-31T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: I think 8708 is further along?
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955160' id='507879'>
<a class='timestamp' href='#507879'><time timestamp='2016-10-31T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: np, i don&#x27;t mind rebasing that one. It&#x27;ll need one more set of changes on top, in fact, so i&#x27;ll take the burden there
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955160' id='507880'>
<a class='timestamp' href='#507880'><time timestamp='2016-10-31T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I think cfields_ and I probably agree on it now, just need to review
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955160' id='507881'>
<a class='timestamp' href='#507881'><time timestamp='2016-10-31T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
heh, ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955220' id='507882'>
<a class='timestamp' href='#507882'><time timestamp='2016-10-31T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955220' id='507883'>
<a class='timestamp' href='#507883'><time timestamp='2016-10-31T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;ll review 8708 in more detail too hen
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955220' id='507884'>
<a class='timestamp' href='#507884'><time timestamp='2016-10-31T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955220' id='507885'>
<a class='timestamp' href='#507885'><time timestamp='2016-10-31T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
yea, it should be ready, i think, but it&#x27;ll touch PushMessage again.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955280' id='507886'>
<a class='timestamp' href='#507886'><time timestamp='2016-10-31T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: if it makes more sense to get the serialization changes in first, I could go ahead and make the other change in 8708, rather than breaking it out, that way it can be reviewed in parallel, then just rebase on the serialization changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955280' id='507887'>
<a class='timestamp' href='#507887'><time timestamp='2016-10-31T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
either way, doesn&#x27;t matter at all to me.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955340' id='507888'>
<a class='timestamp' href='#507888'><time timestamp='2016-10-31T23:09:00Z'>23:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields_: i think it&#x27;ll just boil down to removing &quot;nType, nVersion, &quot; everywhere in your patch
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955340' id='507889'>
<a class='timestamp' href='#507889'><time timestamp='2016-10-31T23:09:00Z'>23:09</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
sipa: ah ok, that&#x27;s trivial then.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955520' id='507890'>
<a class='timestamp' href='#507890'><time timestamp='2016-10-31T23:12:00Z'>23:12</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: btw, i&#x27;m just a few steps away from splitting CConnman out of net, but I&#x27;ll wait for the main split :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955520' id='507891'>
<a class='timestamp' href='#507891'><time timestamp='2016-10-31T23:12:00Z'>23:12</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: cool
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955580' id='507892'>
<a class='timestamp' href='#507892'><time timestamp='2016-10-31T23:13:00Z'>23:13</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if we get all this shit in 0.14 I&#x27;m gonna be really impressed
<br>
</div>

<div class='talk op-msg' data-timestamp='1477955940' id='507893'>
<a class='timestamp' href='#507893'><time timestamp='2016-10-31T23:19:00Z'>23:19</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: you missed one of my nits - you need to move the assert in EndMessage up above the first WriteLE32
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956000' id='507894'>
<a class='timestamp' href='#507894'><time timestamp='2016-10-31T23:20:00Z'>23:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: while you&#x27;re at it, just change it to assert size &gt;= HEADER_SIZE
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956180' id='507895'>
<a class='timestamp' href='#507895'><time timestamp='2016-10-31T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: hm, thought I moved it. sorry about that. will make that change.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956180' id='507896'>
<a class='timestamp' href='#507896'><time timestamp='2016-10-31T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: while you&#x27;re at it, you changed the LogPrint on sending messages
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956240' id='507897'>
<a class='timestamp' href='#507897'><time timestamp='2016-10-31T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it used to read &quot;sending: ...&quot; you removed the sending
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956240' id='507898'>
<a class='timestamp' href='#507898'><time timestamp='2016-10-31T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and you got rid of the SanitizeString() call there, though i doubt that matters
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956360' id='507899'>
<a class='timestamp' href='#507899'><time timestamp='2016-10-31T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
BlueMatt: grr, not sure why those got dropped. will fix.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956360' id='507900'>
<a class='timestamp' href='#507900'><time timestamp='2016-10-31T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
crap, got to go help with dinner. bbl.
<br>
</div>

<div class='talk op-msg' data-timestamp='1477956360' id='507901'>
<a class='timestamp' href='#507901'><time timestamp='2016-10-31T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields_: ok, I&#x27;ll queue them in review...gotta run as well, so might have to finish tomorrow
<br>
</div>

</div>
</section>

</body>
</html>
