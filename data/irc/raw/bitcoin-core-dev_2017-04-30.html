<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2017-04-30
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2017-04-30' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:24 UTC</pre>
<pre><a href="/bitcoin-core-dev/2017-03-30">&lt;</a><span class='header'>    April 2017    </span><a href="/bitcoin-core-dev/2017-05-30">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;                   <a class="" href="/bitcoin-core-dev/2017-04-01">1</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2017-04-02">2</a>  <a class="" href="/bitcoin-core-dev/2017-04-03">3</a>  <a class="" href="/bitcoin-core-dev/2017-04-04">4</a>  <a class="" href="/bitcoin-core-dev/2017-04-05">5</a>  <a class="" href="/bitcoin-core-dev/2017-04-06">6</a>  <a class="" href="/bitcoin-core-dev/2017-04-07">7</a>  <a class="" href="/bitcoin-core-dev/2017-04-08">8</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2017-04-09">9</a> <a class="" href="/bitcoin-core-dev/2017-04-10">10</a> <a class="" href="/bitcoin-core-dev/2017-04-11">11</a> <a class="" href="/bitcoin-core-dev/2017-04-12">12</a> <a class="" href="/bitcoin-core-dev/2017-04-13">13</a> <a class="" href="/bitcoin-core-dev/2017-04-14">14</a> <a class="" href="/bitcoin-core-dev/2017-04-15">15</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-04-16">16</a> <a class="" href="/bitcoin-core-dev/2017-04-17">17</a> <a class="" href="/bitcoin-core-dev/2017-04-18">18</a> <a class="" href="/bitcoin-core-dev/2017-04-19">19</a> <a class="" href="/bitcoin-core-dev/2017-04-20">20</a> <a class="" href="/bitcoin-core-dev/2017-04-21">21</a> <a class="" href="/bitcoin-core-dev/2017-04-22">22</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-04-23">23</a> <a class="" href="/bitcoin-core-dev/2017-04-24">24</a> <a class="" href="/bitcoin-core-dev/2017-04-25">25</a> <a class="" href="/bitcoin-core-dev/2017-04-26">26</a> <a class="" href="/bitcoin-core-dev/2017-04-27">27</a> <a class="" href="/bitcoin-core-dev/2017-04-28">28</a> <a class="" href="/bitcoin-core-dev/2017-04-29">29</a>  &#x000A;<a class="current" href="/bitcoin-core-dev/2017-04-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1493530020' id='543222'>
<a class='timestamp' href='#543222'><time timestamp='2017-04-30T05:27:00Z'>05:27</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jameshilliard opened pull request #10301: Check if sys/random.h is required for getentropy. (master...getentropy-rand) <a href="https://github.com/bitcoin/bitcoin/pull/10301" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10301</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548200' id='543223'>
<a class='timestamp' href='#543223'><time timestamp='2017-04-30T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
hey all. been looking at the MAST BIP and it got me wondering how jl2012 was able to do the hash-locked example. It&#x27;s a good example for MAST (look what happens the DUP), and for parsing mutually exclusive execution pathways in general
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548260' id='543224'>
<a class='timestamp' href='#543224'><time timestamp='2017-04-30T10:31:00Z'>10:31</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
anyways, I&#x27;ve come up with something that seems to allow one to produce the mutually exclusive branches for any script. Need to test it over more scripts 2bh, but it&#x27;s coming along nicely
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548320' id='543225'>
<a class='timestamp' href='#543225'><time timestamp='2017-04-30T10:32:00Z'>10:32</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
<a href="https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki#hashed-time-lock-contract" class="link" target="_blank">https://github.com/bitcoin/bips/blob/master/bip-0114.mediawiki#hashed-time-lock-contract</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548440' id='543226'>
<a class='timestamp' href='#543226'><time timestamp='2017-04-30T10:34:00Z'>10:34</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
keeping in mind most bitcoin libraries only sign scripts that don&#x27;t have any degrees of freedom with the pathway that&#x27;s executed.. I&#x27;m starting out by iterating over script opcodes and making a tree out of possible execution pathways as they come
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548500' id='543227'>
<a class='timestamp' href='#543227'><time timestamp='2017-04-30T10:35:00Z'>10:35</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
to do this, I start with a single node in the tree (the no logical ops case), and build up a vector of values of dependent ifs. for the above script, that&#x27;s [true], [false, true], and [false, false] (same order jl2012 has them)
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548740' id='543228'>
<a class='timestamp' href='#543228'><time timestamp='2017-04-30T10:39:00Z'>10:39</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
next, you need all the opcodes under that pathway.. I decided to do this separately to building the tree. Basically copy EvalScript, remove all opcodes but IF/ELSE/ENDIF/NOTIF, strip away some checks, and log all logical operations and opcodes where fExec==true. The mainStack is now only operated on by IF/ELSE/ENDIF/NOTIF, so you can pass in the vector of vchs representing the list above, ie, &quot;\x01&quot; for true, &quot;&quot; for false.. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548800' id='543229'>
<a class='timestamp' href='#543229'><time timestamp='2017-04-30T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
and that gets you a list of all opcodes in the script that you need to satisfy if you wished to sign it
<br>
</div>

<div class='talk op-msg' data-timestamp='1493548920' id='543230'>
<a class='timestamp' href='#543230'><time timestamp='2017-04-30T10:42:00Z'>10:42</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
I&#x27;ve only gotten as far as normal scripts, ie, bare or P2SH. MAST requires checking for side effects of earlier operations, and stripping away any where the predicate was failed. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1493549340' id='543231'>
<a class='timestamp' href='#543231'><time timestamp='2017-04-30T10:49:00Z'>10:49</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
if this should be in #bitcoin-dev please someone let me know
<br>
</div>

<div class='talk op-msg' data-timestamp='1493549400' id='543232'>
<a class='timestamp' href='#543232'><time timestamp='2017-04-30T10:50:00Z'>10:50</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
the general motivation behind all this is to allow signing of arbitrary scripts. you can only do that once you know if there are logical operations.. after that, looking at the opcodes just under that branch tells you what you need to satisfy in order to redeem using that branch
<br>
</div>

<div class='talk op-msg' data-timestamp='1493549580' id='543233'>
<a class='timestamp' href='#543233'><time timestamp='2017-04-30T10:53:00Z'>10:53</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
with the branch specific opcodes, you can then try to break up the script into pieces the signer can understand, and may support: hashlocks, csv/cltv checks (signer should know the current time), signature operations
<br>
</div>

<div class='talk op-msg' data-timestamp='1493549940' id='543234'>
<a class='timestamp' href='#543234'><time timestamp='2017-04-30T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
I think using the [true], [false,true], [false, false] could be a good way of relating to another party to your script/payment channel which branch you are expecting them to sign. Wallets like Copay work by creating a proposed spend from a multisig address, and requesting signatures from others, and atm there isn&#x27;t really a way to specify branches in a script agnostic way. Hardware wallets also may also face the same thing in the future
<br>
</div>

<div class='talk op-msg' data-timestamp='1493550240' id='543235'>
<a class='timestamp' href='#543235'><time timestamp='2017-04-30T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
anyway, I think if wallets come to deal with scripts with logical operators, the innermost Sign() function should really be checking that the user isn&#x27;t accidentally working on the wrong branch, hence the need for to designate the branch in a way the software can verify against later.
<br>
</div>

<div class='talk op-msg' data-timestamp='1493550420' id='543236'>
<a class='timestamp' href='#543236'><time timestamp='2017-04-30T11:07:00Z'>11:07</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
I don&#x27;t want to use something like branch 1, 2, 3, because the allowed boolean values are specific to the script.
<br>
</div>

<div class='talk op-msg' data-timestamp='1493551560' id='543237'>
<a class='timestamp' href='#543237'><time timestamp='2017-04-30T11:26:00Z'>11:26</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] spencerlievens opened pull request #10302: [Makefile] Alphabetically Reorder addrdb.cpp (master...patch-2) <a href="https://github.com/bitcoin/bitcoin/pull/10302" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10302</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1493552040' id='543238'>
<a class='timestamp' href='#543238'><time timestamp='2017-04-30T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
oh, forgot to post a gist showing steps to try and sign that hashlock script: <a href="https://gist.github.com/afk11/cb276f78b7407773e76e81f6d5b62d4f" class="link" target="_blank">https://gist.github.com/afk11/cb276f78b7407773e76e81f6d5b62d4f</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1493575440' id='543239'>
<a class='timestamp' href='#543239'><time timestamp='2017-04-30T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
is there a way in Bitcoin Core to get an unused address ? I am tempted to call getnewaddress everytimes, but doing so would create big gap in by BIP32 path, which would make rescanning fail
<br>
</div>

<div class='talk op-msg' data-timestamp='1493576520' id='543240'>
<a class='timestamp' href='#543240'><time timestamp='2017-04-30T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
bitcoin core doesn&#x27;t support gaps or reconstruction from a seed at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1493576520' id='543241'>
<a class='timestamp' href='#543241'><time timestamp='2017-04-30T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(yet)
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577360' id='543242'>
<a class='timestamp' href='#543242'><time timestamp='2017-04-30T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-7'> SopaXorzTaker</span>&gt;
dammit piqure
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577420' id='543243'>
<a class='timestamp' href='#543243'><time timestamp='2017-04-30T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-7'> SopaXorzTaker</span>&gt;
banned me from #bitcoin for posting a malware link, explicitly marked like this and obsured: [https://]malware[.]coin.stealer
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577540' id='543244'>
<a class='timestamp' href='#543244'><time timestamp='2017-04-30T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
sipa: I know, for now. jonasschnelli is working on it somewhere I saw recently. Anyway, do you know a way to get the latest unused address of the wallet ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577540' id='543245'>
<a class='timestamp' href='#543245'><time timestamp='2017-04-30T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
or any unused address
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577600' id='543246'>
<a class='timestamp' href='#543246'><time timestamp='2017-04-30T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
Another reason is that I provide a link to the user to send money to my address. And I don&#x27;t want a user to generate a new address everytimes he hit F5 on my page
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577600' id='543247'>
<a class='timestamp' href='#543247'><time timestamp='2017-04-30T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
other solutions to do it of course
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577600' id='543248'>
<a class='timestamp' href='#543248'><time timestamp='2017-04-30T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
but if anything exist in core, would make life easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577660' id='543249'>
<a class='timestamp' href='#543249'><time timestamp='2017-04-30T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
NicolasDorier: getnewaddress...
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577780' id='543250'>
<a class='timestamp' href='#543250'><time timestamp='2017-04-30T18:43:00Z'>18:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
NicolasDorier: or make your application cache a number of addresses ahead of time
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577960' id='543251'>
<a class='timestamp' href='#543251'><time timestamp='2017-04-30T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
sipa: Imagine I want to show the QR code of an unused address of my wallet in the profile page of whatever social media service. If I use getnewaddress, then everytimes someone make a request to the QR code, a new address will bloat up my wallet, leading to DOS eventually.
<br>
</div>

<div class='talk op-msg' data-timestamp='1493577960' id='543252'>
<a class='timestamp' href='#543252'><time timestamp='2017-04-30T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
of course I can use the server generating the QR cache the latest created address and verify if not used
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578020' id='543253'>
<a class='timestamp' href='#543253'><time timestamp='2017-04-30T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
NicolasDorier: yes, so cache addresses in your application, and remove them when used?
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578020' id='543254'>
<a class='timestamp' href='#543254'><time timestamp='2017-04-30T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there used to be a way in core get an unused address, which was only updated when a tx was seen to it
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578020' id='543255'>
<a class='timestamp' href='#543255'><time timestamp='2017-04-30T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that&#x27;s very hard to not make different RPC clients get in eachother&#x27;s way
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578080' id='543256'>
<a class='timestamp' href='#543256'><time timestamp='2017-04-30T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
ha ok I see
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578080' id='543257'>
<a class='timestamp' href='#543257'><time timestamp='2017-04-30T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
well yes I will cache the address on the server side, and just make a request to bitcoin core to know if it was used before returning it to the server
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578080' id='543258'>
<a class='timestamp' href='#543258'><time timestamp='2017-04-30T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
good enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1493578500' id='543259'>
<a class='timestamp' href='#543259'><time timestamp='2017-04-30T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-15'> afk11</span>&gt;
*     
<br>
</div>

<div class='talk op-msg' data-timestamp='1493594040' id='543260'>
<a class='timestamp' href='#543260'><time timestamp='2017-04-30T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-7'> chatter29</span>&gt;
hey guys
<br>
</div>

</div>
</section>

</body>
</html>
