<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-09-08
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-09-08' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:26 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-08-08">&lt;</a><span class='header'>  September 2016  </span><a href="/bitcoin-core-dev/2016-10-08">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2016-09-01">1</a>  <a class="" href="/bitcoin-core-dev/2016-09-02">2</a>  <a class="" href="/bitcoin-core-dev/2016-09-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-09-04">4</a>  <a class="" href="/bitcoin-core-dev/2016-09-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-09-06">6</a>  <a class="" href="/bitcoin-core-dev/2016-09-07">7</a>  <a class="current" href="/bitcoin-core-dev/2016-09-08">8</a>  <a class="" href="/bitcoin-core-dev/2016-09-09">9</a> <a class="" href="/bitcoin-core-dev/2016-09-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-11">11</a> <a class="" href="/bitcoin-core-dev/2016-09-12">12</a> <a class="" href="/bitcoin-core-dev/2016-09-13">13</a> <a class="" href="/bitcoin-core-dev/2016-09-14">14</a> <a class="" href="/bitcoin-core-dev/2016-09-15">15</a> <a class="" href="/bitcoin-core-dev/2016-09-16">16</a> <a class="" href="/bitcoin-core-dev/2016-09-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-18">18</a> <a class="" href="/bitcoin-core-dev/2016-09-19">19</a> <a class="" href="/bitcoin-core-dev/2016-09-20">20</a> <a class="" href="/bitcoin-core-dev/2016-09-21">21</a> <a class="" href="/bitcoin-core-dev/2016-09-22">22</a> <a class="" href="/bitcoin-core-dev/2016-09-23">23</a> <a class="" href="/bitcoin-core-dev/2016-09-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-25">25</a> <a class="" href="/bitcoin-core-dev/2016-09-26">26</a> <a class="" href="/bitcoin-core-dev/2016-09-27">27</a> <a class="" href="/bitcoin-core-dev/2016-09-28">28</a> <a class="" href="/bitcoin-core-dev/2016-09-29">29</a> <a class="" href="/bitcoin-core-dev/2016-09-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1473298740' id='491825'>
<a class='timestamp' href='#491825'><time timestamp='2016-09-08T01:39:00Z'>01:39</time></a>
&lt;<span class='nick nick-9'> veleiro</span>&gt;
found the problem. couldnt get the depends build to work, but i removed /usr/local/lib/libboost* and /usr/local/include/boost* and reinstalled libboost-all-dev. thanks for the advice sipa
<br>
</div>

<div class='talk op-msg' data-timestamp='1473312720' id='491826'>
<a class='timestamp' href='#491826'><time timestamp='2016-09-08T05:32:00Z'>05:32</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jeremyrubin: started reviewing your checkqueue, but the emplacer distracted me. Will pick up where I left off tomorrow.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320040' id='491827'>
<a class='timestamp' href='#491827'><time timestamp='2016-09-08T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
let&#x27;s try to make cfields network refactor (<a href="https://github.com/bitcoin/bitcoin/pull/8085/files)" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8085/files)</a> happen , it&#x27;s been open so long now, line-wise there&#x27;s a lot of changes so he keeps having to rebase it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320100' id='491828'>
<a class='timestamp' href='#491828'><time timestamp='2016-09-08T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
/home/user/projects/bitcoin/bitcoin/src/test/addrman_tests.cpp:336:471: warning: stack frame size of 328360 bytes in function &#x27;addrman_tests::addrman_delete::test_method&#x27; [-Wframe-larger-than=]    whoa :) luckily only in the tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320220' id='491829'>
<a class='timestamp' href='#491829'><time timestamp='2016-09-08T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what is a reasonable max frame size?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320280' id='491830'>
<a class='timestamp' href='#491830'><time timestamp='2016-09-08T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
largest in the normal core code is a stack frame size of 67256 bytes in function &#x27;ThreadSocketHandler&#x27;, which is peculiar but not that bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320340' id='491831'>
<a class='timestamp' href='#491831'><time timestamp='2016-09-08T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
64k or so for non-recursive code? most is far below that, even &lt;10kB
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320400' id='491832'>
<a class='timestamp' href='#491832'><time timestamp='2016-09-08T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
whopping &#x27;warning: stack frame size of 984520 bytes in function &#x27;net_tests::caddrdb_read::test_method&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320460' id='491833'>
<a class='timestamp' href='#491833'><time timestamp='2016-09-08T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
8654 introduces a 9 kB struct in CTransactionSignatureChecker
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320460' id='491834'>
<a class='timestamp' href='#491834'><time timestamp='2016-09-08T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
peanuts
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320520' id='491835'>
<a class='timestamp' href='#491835'><time timestamp='2016-09-08T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
984kB sounds like mild overkill, indeex
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320520' id='491836'>
<a class='timestamp' href='#491836'><time timestamp='2016-09-08T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473320520' id='491837'>
<a class='timestamp' href='#491837'><time timestamp='2016-09-08T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, agree on making the net refactor happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1473321000' id='491838'>
<a class='timestamp' href='#491838'><time timestamp='2016-09-08T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. Net factor should happen... I have the PR running since a couple of days...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473325980' id='491839'>
<a class='timestamp' href='#491839'><time timestamp='2016-09-08T09:13:00Z'>09:13</time></a>
&lt;<span class='nick nick-5'> GitHub87</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/ec139a5621a9...ddc308068d69" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/ec139a5621a9...ddc308068d69</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473325980' id='491840'>
<a class='timestamp' href='#491840'><time timestamp='2016-09-08T09:13:00Z'>09:13</time></a>
&lt;<span class='nick nick-5'> GitHub87</span>&gt;
bitcoin/master f71d4a3 Jeremy Rubin: Minimal fix to slow prevector tests as stopgap measure
<br>
</div>

<div class='talk op-msg' data-timestamp='1473325980' id='491841'>
<a class='timestamp' href='#491841'><time timestamp='2016-09-08T09:13:00Z'>09:13</time></a>
&lt;<span class='nick nick-5'> GitHub87</span>&gt;
bitcoin/master ddc3080 MarcoFalke: Merge #8671: Minimal fix to slow prevector tests as stopgap measure...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473325980' id='491842'>
<a class='timestamp' href='#491842'><time timestamp='2016-09-08T09:13:00Z'>09:13</time></a>
&lt;<span class='nick nick-11'> GitHub67</span>&gt;
[bitcoin] MarcoFalke closed pull request #8671: Minimal fix to slow prevector tests as stopgap measure (master...simple_faster_tests) <a href="https://github.com/bitcoin/bitcoin/pull/8671" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8671</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473334860' id='491843'>
<a class='timestamp' href='#491843'><time timestamp='2016-09-08T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-12'> translatoree3</span>&gt;
Hello, need help with contributing a translation
<br>
</div>

<div class='talk op-msg' data-timestamp='1473334860' id='491844'>
<a class='timestamp' href='#491844'><time timestamp='2016-09-08T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-12'> translatoree3</span>&gt;
I&#x27;ve seen transfix, so translations there get credit on the github bitcoin repo?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473334920' id='491845'>
<a class='timestamp' href='#491845'><time timestamp='2016-09-08T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-12'> translatoree3</span>&gt;
I&#x27;d like to get credit as I have a github account
<br>
</div>

<div class='talk op-msg' data-timestamp='1473334920' id='491846'>
<a class='timestamp' href='#491846'><time timestamp='2016-09-08T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-12'> translatoree3</span>&gt;
is there a way to send a pull request if the Transifex process doesn&#x27;t give contributor credit on github repo?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473336300' id='491847'>
<a class='timestamp' href='#491847'><time timestamp='2016-09-08T12:05:00Z'>12:05</time></a>
&lt;<span class='nick nick-5'> GitHub24</span>&gt;
[bitcoin] bitcoinsSG opened pull request #8683: fix incorrect file name bitcoin.qrc  (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/8683" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8683</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341100' id='491848'>
<a class='timestamp' href='#491848'><time timestamp='2016-09-08T13:25:00Z'>13:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: nice work with the network refactor, and sorry for not having the courage earlier to read through 34 commits (it wasn&#x27;t all that bad)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341460' id='491849'>
<a class='timestamp' href='#491849'><time timestamp='2016-09-08T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> * sipa</span>&gt;
is slightly annoyed with the introduction of many &#x27;for(&#x27;s and &#x27;if(&#x27;s, but seems we&#x27;re not consistent about that already anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341700' id='491850'>
<a class='timestamp' href='#491850'><time timestamp='2016-09-08T13:35:00Z'>13:35</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: thanks. np about review. I haven&#x27;t been pushy about it because it&#x27;s pretty rough to get through. The next round should be much easier since after this PR it&#x27;s mostly self-contained
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341700' id='491851'>
<a class='timestamp' href='#491851'><time timestamp='2016-09-08T13:35:00Z'>13:35</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
and yes, sorry about the fors and ifs. I know that one bugs you. That&#x27;s a habit that I can&#x27;t seem to get out of
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341760' id='491852'>
<a class='timestamp' href='#491852'><time timestamp='2016-09-08T13:36:00Z'>13:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i realize it&#x27;s just preference, and i&#x27;m sure the existing spaces bother you too :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341760' id='491853'>
<a class='timestamp' href='#491853'><time timestamp='2016-09-08T13:36:00Z'>13:36</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
mm, I should get vim to fix that for me
<br>
</div>

<div class='talk op-msg' data-timestamp='1473341820' id='491854'>
<a class='timestamp' href='#491854'><time timestamp='2016-09-08T13:37:00Z'>13:37</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
not at all, they&#x27;re only reminders that i forgot to space my changes around it (while re-reading post-commit, of course)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473346080' id='491855'>
<a class='timestamp' href='#491855'><time timestamp='2016-09-08T14:48:00Z'>14:48</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
cfields: be sure to look on the latest; I fixed it i beleive
<br>
</div>

<div class='talk op-msg' data-timestamp='1473346560' id='491856'>
<a class='timestamp' href='#491856'><time timestamp='2016-09-08T14:56:00Z'>14:56</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jeremyrubin: see github comments
<br>
</div>

<div class='talk op-msg' data-timestamp='1473346920' id='491857'>
<a class='timestamp' href='#491857'><time timestamp='2016-09-08T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: i was just trying to review #8660, so this is also a regression caused by <a href="https://github.com/bitcoin/bitcoin/pull/7946" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7946</a>?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473346980' id='491858'>
<a class='timestamp' href='#491858'><time timestamp='2016-09-08T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
cfields: yeah you weren&#x27;t looking at the one i sent you yest
<br>
</div>

<div class='talk op-msg' data-timestamp='1473346980' id='491859'>
<a class='timestamp' href='#491859'><time timestamp='2016-09-08T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: aha, probably so
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347040' id='491860'>
<a class='timestamp' href='#491860'><time timestamp='2016-09-08T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: i wonder if we need to think a bit more carefully about that pull.  is there anything other than the RPC tests that might be depending on wallets being synced onces cs_main is released
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347040' id='491861'>
<a class='timestamp' href='#491861'><time timestamp='2016-09-08T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
for instance you could imagine someone using bitcoin core has come to depend on that behavior
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347040' id='491862'>
<a class='timestamp' href='#491862'><time timestamp='2016-09-08T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
not saying it shouldn&#x27;t eventually be changed, but seems like something that requires a bit more thought
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347100' id='491863'>
<a class='timestamp' href='#491863'><time timestamp='2016-09-08T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: think more about 7946, you mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347100' id='491864'>
<a class='timestamp' href='#491864'><time timestamp='2016-09-08T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491865'>
<a class='timestamp' href='#491865'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
cfields: oops I&#x27;m wrong you were sorry -- i need to fix my github notifs they suck
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491866'>
<a class='timestamp' href='#491866'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: 8660? sure you have the right number?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491867'>
<a class='timestamp' href='#491867'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what the RPC tests are uncovering is that the wallet can now be out of sync with the blockchain.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491868'>
<a class='timestamp' href='#491868'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: now that you mention it, i wonder if blocknotify is affected
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491869'>
<a class='timestamp' href='#491869'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: morcos is referring to the already merged one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491870'>
<a class='timestamp' href='#491870'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeoops 8680
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347160' id='491871'>
<a class='timestamp' href='#491871'><time timestamp='2016-09-08T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
oops nvm
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347220' id='491872'>
<a class='timestamp' href='#491872'><time timestamp='2016-09-08T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
ok nm, blocknotify uses the same signal, so the wallet would already be synced there
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347220' id='491873'>
<a class='timestamp' href='#491873'><time timestamp='2016-09-08T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: for 8680, isn&#x27;t it possible to use ping/waitforpong instead?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347280' id='491874'>
<a class='timestamp' href='#491874'><time timestamp='2016-09-08T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: the issues isn&#x27;t fixing it for the RPC tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347280' id='491875'>
<a class='timestamp' href='#491875'><time timestamp='2016-09-08T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the issue is whether there are things other than the rpc tests that were relying on wallet always being synced with blockchain once cs_main was released
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347340' id='491876'>
<a class='timestamp' href='#491876'><time timestamp='2016-09-08T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: isn&#x27;t that just punting the problem to &quot;now we assume we&#x27;re all synced&quot; at a different point?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347340' id='491877'>
<a class='timestamp' href='#491877'><time timestamp='2016-09-08T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also ping/waitforpong would happen to work i think with the current architecture, but not necessarily in the future right..  
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347400' id='491878'>
<a class='timestamp' href='#491878'><time timestamp='2016-09-08T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i don&#x27;t think we can get rid of the synchronizing behaviour of ping/pong without breaking half the network software
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347460' id='491879'>
<a class='timestamp' href='#491879'><time timestamp='2016-09-08T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: there is a difference between it always synchronizing network behavior and synchronizing other thigns right?  it just happens that the processing of messages happens in the same thread as the wallet syncing code now
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347460' id='491880'>
<a class='timestamp' href='#491880'><time timestamp='2016-09-08T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so you couldn&#x27;t get to the pong until you&#x27;d synced the wallets, but that doesn&#x27;t seem like something that would necessarily always be true
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347460' id='491881'>
<a class='timestamp' href='#491881'><time timestamp='2016-09-08T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i see
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347460' id='491882'>
<a class='timestamp' href='#491882'><time timestamp='2016-09-08T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, i think we should prepare for a case where wallet syncing happens entirely in the background
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347520' id='491883'>
<a class='timestamp' href='#491883'><time timestamp='2016-09-08T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and can lag behind more than one block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347520' id='491884'>
<a class='timestamp' href='#491884'><time timestamp='2016-09-08T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and network synchronizing messages don&#x27;t change that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347520' id='491885'>
<a class='timestamp' href='#491885'><time timestamp='2016-09-08T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i suppose that&#x27;s why sdaftuar was thinking more in terms of wait_for_wallet()
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347580' id='491886'>
<a class='timestamp' href='#491886'><time timestamp='2016-09-08T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: agreed.  and i think #7946 has forced that issue to be we have to think about that for 0.13.   b/c as far as RPC is concerned the wallet syncing can be happening several blocks behind now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347580' id='491887'>
<a class='timestamp' href='#491887'><time timestamp='2016-09-08T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sorry, for master, not 0.13.  i&#x27;m still behind.  :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347700' id='491888'>
<a class='timestamp' href='#491888'><time timestamp='2016-09-08T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so what probably should happen, to avoid changing the api, is that any time you call into wallet it blocks until it has a consistent state with current blockchain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347700' id='491889'>
<a class='timestamp' href='#491889'><time timestamp='2016-09-08T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
in the event that we start moving towards more async behavior, i think it&#x27;s only natural to start introducing blocking rpcs
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347760' id='491890'>
<a class='timestamp' href='#491890'><time timestamp='2016-09-08T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
otherwise you get an inconsistent rpc api - getblockheight will tell you something and then wallet will be behind that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347760' id='491891'>
<a class='timestamp' href='#491891'><time timestamp='2016-09-08T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which is a hugely surprising api change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347760' id='491892'>
<a class='timestamp' href='#491892'><time timestamp='2016-09-08T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347760' id='491893'>
<a class='timestamp' href='#491893'><time timestamp='2016-09-08T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: i thought you just typed super fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347760' id='491894'>
<a class='timestamp' href='#491894'><time timestamp='2016-09-08T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
moving wallet sync out of main thread is an important goal - and unlocking cs_main for it is a first step
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347820' id='491895'>
<a class='timestamp' href='#491895'><time timestamp='2016-09-08T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but an api change like that is probaly just not ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347820' id='491896'>
<a class='timestamp' href='#491896'><time timestamp='2016-09-08T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that does make sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347820' id='491897'>
<a class='timestamp' href='#491897'><time timestamp='2016-09-08T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just have the wallet rcps wait for sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347880' id='491898'>
<a class='timestamp' href='#491898'><time timestamp='2016-09-08T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but what exactly should they wait for
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347880' id='491899'>
<a class='timestamp' href='#491899'><time timestamp='2016-09-08T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
being up-to-date with the chain state at the call entry
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347880' id='491900'>
<a class='timestamp' href='#491900'><time timestamp='2016-09-08T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
as you&#x27;re catching up the blockheight could still be increasing i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347880' id='491901'>
<a class='timestamp' href='#491901'><time timestamp='2016-09-08T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
or, maybe, lock cs_main...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473347940' id='491902'>
<a class='timestamp' href='#491902'><time timestamp='2016-09-08T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: you&#x27;d need to pass in the synced-to-x height to the wallet rpc :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348000' id='491903'>
<a class='timestamp' href='#491903'><time timestamp='2016-09-08T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i guess what i just described is an existing problem, so maybe thats ok, b/c cs_main is released anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348060' id='491904'>
<a class='timestamp' href='#491904'><time timestamp='2016-09-08T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i mean, ok, what makes the rpc consistent? if the rpc request blocks, then its not crazy to make the state returned consistent with where the chainstate was when you entered the rpc, because otherwise the client is multithreaded and thats gonna be broken no matter what we do
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348060' id='491905'>
<a class='timestamp' href='#491905'><time timestamp='2016-09-08T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: but, if you&#x27;ve specifically waited for a certain height/hash, and it&#x27;s blocked/returned until that&#x27;s hit, then you&#x27;re at least synced to that height for the next call
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348060' id='491906'>
<a class='timestamp' href='#491906'><time timestamp='2016-09-08T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
(ignoring invalidate/reconsider, which ruin all of that)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348060' id='491907'>
<a class='timestamp' href='#491907'><time timestamp='2016-09-08T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: yes. agreed. i think we should fix it that much.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348120' id='491908'>
<a class='timestamp' href='#491908'><time timestamp='2016-09-08T15:22:00Z'>15:22</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: well, the new rpcs in #8680 do all that we&#x27;ve described here. We could just wrap the old ones around those...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348180' id='491909'>
<a class='timestamp' href='#491909'><time timestamp='2016-09-08T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: yes that sounds right...  i think we need to call getblockheight from the wallet calls and then use your new calls to wait for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348180' id='491910'>
<a class='timestamp' href='#491910'><time timestamp='2016-09-08T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well the wallet can remember independently up to what block hash it is synced
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348240' id='491911'>
<a class='timestamp' href='#491911'><time timestamp='2016-09-08T15:24:00Z'>15:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which afaik it does not do now
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348240' id='491912'>
<a class='timestamp' href='#491912'><time timestamp='2016-09-08T15:24:00Z'>15:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i think you want to avoid querying the wallet mid-block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348300' id='491913'>
<a class='timestamp' href='#491913'><time timestamp='2016-09-08T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: oh? I thought it did?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348300' id='491914'>
<a class='timestamp' href='#491914'><time timestamp='2016-09-08T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
It used to at least be on-disk, too
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348300' id='491915'>
<a class='timestamp' href='#491915'><time timestamp='2016-09-08T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: eh, yes, how does that matter?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348300' id='491916'>
<a class='timestamp' href='#491916'><time timestamp='2016-09-08T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: yes, but that isn&#x27;t uodated for every block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348360' id='491917'>
<a class='timestamp' href='#491917'><time timestamp='2016-09-08T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ahh, well, ok, lets update it (in memory) for every block :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348360' id='491918'>
<a class='timestamp' href='#491918'><time timestamp='2016-09-08T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348420' id='491919'>
<a class='timestamp' href='#491919'><time timestamp='2016-09-08T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: if the wallet rpcs aren&#x27;t synced using cory&#x27;s mechanism then when you check the wallet you don&#x27;t know if its in the middle of syncing some next block (that maybe you weren&#x27;t waiting for)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348420' id='491920'>
<a class='timestamp' href='#491920'><time timestamp='2016-09-08T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but actually, i guess you still don&#x27;t know that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348420' id='491921'>
<a class='timestamp' href='#491921'><time timestamp='2016-09-08T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
shoot
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348540' id='491922'>
<a class='timestamp' href='#491922'><time timestamp='2016-09-08T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so maybe we need to lock the wallet around the SyncWithWallets loops?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348600' id='491923'>
<a class='timestamp' href='#491923'><time timestamp='2016-09-08T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348600' id='491924'>
<a class='timestamp' href='#491924'><time timestamp='2016-09-08T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
brb
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348720' id='491925'>
<a class='timestamp' href='#491925'><time timestamp='2016-09-08T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: isn&#x27;t there nothing that stops a getbalance() call from happening in the middle of a SyncWithWallets() loop for a given blcok
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491926'>
<a class='timestamp' href='#491926'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i&#x27;m not sure the out of syncness matters to external observers... if you used to wait for a block and then later do and RPC query, it has always been possible that yet another block got processed in between
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491927'>
<a class='timestamp' href='#491927'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491928'>
<a class='timestamp' href='#491928'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but now half of another block could be processed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491929'>
<a class='timestamp' href='#491929'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what matters is consistency of wallet rpcs with its own state of the chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491930'>
<a class='timestamp' href='#491930'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which seems somehow worse
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491931'>
<a class='timestamp' href='#491931'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: its very, very, strange to get a balance response that is valid as of the middle of a block, but will change before the end of the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491932'>
<a class='timestamp' href='#491932'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I&#x27;m not sure that ever used to be pososible
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348780' id='491933'>
<a class='timestamp' href='#491933'><time timestamp='2016-09-08T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it didn&#x27;t it was protected by cs_main previously
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491934'>
<a class='timestamp' href='#491934'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what is the middle of a block?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491935'>
<a class='timestamp' href='#491935'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
how can the middle of a block be observed?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491936'>
<a class='timestamp' href='#491936'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
don&#x27;t you just loop through the txs and call SyncWithWallets individually for each one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491937'>
<a class='timestamp' href='#491937'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the only problem is using main&#x27;s tip to determine wallet confirmations etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491938'>
<a class='timestamp' href='#491938'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the wallet should use its own tip idea to determine confirmations, instead of main&#x27;s
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348840' id='491939'>
<a class='timestamp' href='#491939'><time timestamp='2016-09-08T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
why can&#x27;t you ask for the balance in the rpc thread while you are in the middle of that loop
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348900' id='491940'>
<a class='timestamp' href='#491940'><time timestamp='2016-09-08T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think that&#x27;s fine; it won&#x27;t be counted as confirmed until it&#x27;s done
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348900' id='491941'>
<a class='timestamp' href='#491941'><time timestamp='2016-09-08T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(with the change to use the wallet&#x27;s idea of the tip)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348960' id='491942'>
<a class='timestamp' href='#491942'><time timestamp='2016-09-08T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: its hard to imagine an exact problem, but it just seems an odd change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348960' id='491943'>
<a class='timestamp' href='#491943'><time timestamp='2016-09-08T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
whats the downside to locking the wallet around that loop?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348960' id='491944'>
<a class='timestamp' href='#491944'><time timestamp='2016-09-08T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, now i understand what you mean
<br>
</div>

<div class='talk op-msg' data-timestamp='1473348960' id='491945'>
<a class='timestamp' href='#491945'><time timestamp='2016-09-08T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to prevent a partially updated wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349020' id='491946'>
<a class='timestamp' href='#491946'><time timestamp='2016-09-08T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think that&#x27;s fine, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349020' id='491947'>
<a class='timestamp' href='#491947'><time timestamp='2016-09-08T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i think it can be avoided
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349020' id='491948'>
<a class='timestamp' href='#491948'><time timestamp='2016-09-08T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
now someone just has to remember these ideas we&#x27;ve discussed.  on that note, lunch time.  :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349020' id='491949'>
<a class='timestamp' href='#491949'><time timestamp='2016-09-08T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
indeed, but we should :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349020' id='491950'>
<a class='timestamp' href='#491950'><time timestamp='2016-09-08T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
enjoy nourishment
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349320' id='491951'>
<a class='timestamp' href='#491951'><time timestamp='2016-09-08T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
back. all fixed? :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473349380' id='491952'>
<a class='timestamp' href='#491952'><time timestamp='2016-09-08T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: lunch thought: i suppose we&#x27;ll need the same fencing for individual transactions + wallet interactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473357600' id='491953'>
<a class='timestamp' href='#491953'><time timestamp='2016-09-08T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: how do you mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358260' id='491954'>
<a class='timestamp' href='#491954'><time timestamp='2016-09-08T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: now that i&#x27;m poking around, i can&#x27;t come up with a realistic example
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358320' id='491955'>
<a class='timestamp' href='#491955'><time timestamp='2016-09-08T18:12:00Z'>18:12</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: i was thinking about cases where the mempool holds a tx that the wallet isn&#x27;t in sync with yet, where the mempool presence would lead the rpc caller to expect a wallet entry
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358920' id='491956'>
<a class='timestamp' href='#491956'><time timestamp='2016-09-08T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe we&#x27;ve had a related discussion to this before
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358980' id='491957'>
<a class='timestamp' href='#491957'><time timestamp='2016-09-08T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
about whether or not external notifications should be sent before or after wallet updates
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358980' id='491958'>
<a class='timestamp' href='#491958'><time timestamp='2016-09-08T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or something like that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473358980' id='491959'>
<a class='timestamp' href='#491959'><time timestamp='2016-09-08T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because in some cases you want the update as soon as possible, but if you&#x27;re going to use it to trigger a wallet request, the wallet should be updated first
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359280' id='491960'>
<a class='timestamp' href='#491960'><time timestamp='2016-09-08T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
probably there should be an external notification for the core as well as the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359340' id='491961'>
<a class='timestamp' href='#491961'><time timestamp='2016-09-08T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you want to be updated of the wallet processing some information, you&#x27;d listen for the wallet notification, if you want to know as soon as possible after the core rpocessed something you&#x27;d listen for the core notification
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359400' id='491962'>
<a class='timestamp' href='#491962'><time timestamp='2016-09-08T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup, agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359400' id='491963'>
<a class='timestamp' href='#491963'><time timestamp='2016-09-08T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the wallet is going to be asynchronously updated from the rest, it should have independent notifications too
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359400' id='491964'>
<a class='timestamp' href='#491964'><time timestamp='2016-09-08T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and in the hypothetical case with with multiple wallets you&#x27;d want to register for <b>*that*</b> wallet you&#x27;re interested in
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359400' id='491965'>
<a class='timestamp' href='#491965'><time timestamp='2016-09-08T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359460' id='491966'>
<a class='timestamp' href='#491966'><time timestamp='2016-09-08T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it would make a lot of sense for wallet processing to be asynchronous
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359460' id='491967'>
<a class='timestamp' href='#491967'><time timestamp='2016-09-08T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and indeed, in that case there&#x27;s no use in getting a signal after the wallet got the signal
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359460' id='491968'>
<a class='timestamp' href='#491968'><time timestamp='2016-09-08T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it still has to start processing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359520' id='491969'>
<a class='timestamp' href='#491969'><time timestamp='2016-09-08T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what you need is a notification from the wallet itself that it processed 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359820' id='491970'>
<a class='timestamp' href='#491970'><time timestamp='2016-09-08T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
we have one! -walletnotify <b>*duck*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473359940' id='491971'>
<a class='timestamp' href='#491971'><time timestamp='2016-09-08T18:39:00Z'>18:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, but we&#x27;d also need a notification from the wallet that it processed a block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360060' id='491972'>
<a class='timestamp' href='#491972'><time timestamp='2016-09-08T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. Maybe an signal short after when the wallet bestblock was updated.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360060' id='491973'>
<a class='timestamp' href='#491973'><time timestamp='2016-09-08T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360120' id='491974'>
<a class='timestamp' href='#491974'><time timestamp='2016-09-08T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Though this works agains in the opposite direction then the possible plan of decoupling the wallet process.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360120' id='491975'>
<a class='timestamp' href='#491975'><time timestamp='2016-09-08T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(if the core side is consuming the event)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360120' id='491976'>
<a class='timestamp' href='#491976'><time timestamp='2016-09-08T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
parse error
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360240' id='491977'>
<a class='timestamp' href='#491977'><time timestamp='2016-09-08T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
In case we want the wallet be capable of running without the validation (utxo-set/mempool) we should be carefully add signals (or lets say additional coupling between those elements)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360240' id='491978'>
<a class='timestamp' href='#491978'><time timestamp='2016-09-08T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no, the wallet would be emitting the event
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491979'>
<a class='timestamp' href='#491979'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I&#x27;ll be afk during the meeting but will read later
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491980'>
<a class='timestamp' href='#491980'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the core side doesn&#x27;t subscribe to it or anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491981'>
<a class='timestamp' href='#491981'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&#x27;has wallet processed block&#x27; is only something that external clients may care about, maybe the GUI, but certainly not the core
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491982'>
<a class='timestamp' href='#491982'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
this seems to be someone from a law firm talking about &quot;veil of decentralization&quot; and fork types <a href="https://www.youtube.com/watch?v=7aV-k_6nZ8g&amp;t=43m10s" class="link" target="_blank">https://www.youtube.com/watch?v=7aV-k_6nZ8g&amp;t=43m10s</a> 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491983'>
<a class='timestamp' href='#491983'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
oh crud.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491984'>
<a class='timestamp' href='#491984'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Ok. Right. This would make sense.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360300' id='491985'>
<a class='timestamp' href='#491985'><time timestamp='2016-09-08T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
please ignore.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360360' id='491986'>
<a class='timestamp' href='#491986'><time timestamp='2016-09-08T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-2'> * kanzure</span>&gt;
wanders off
<br>
</div>

<div class='talk op-msg' data-timestamp='1473360660' id='491987'>
<a class='timestamp' href='#491987'><time timestamp='2016-09-08T18:51:00Z'>18:51</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
[bitcoin] jl2012 opened pull request #8685: Discourage P2WSH with too big script or stack (master...bigp2wsh) <a href="https://github.com/bitcoin/bitcoin/pull/8685" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8685</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361140' id='491988'>
<a class='timestamp' href='#491988'><time timestamp='2016-09-08T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
meeting time?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361140' id='491989'>
<a class='timestamp' href='#491989'><time timestamp='2016-09-08T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
ack
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361140' id='491990'>
<a class='timestamp' href='#491990'><time timestamp='2016-09-08T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#startmeeting
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361140' id='491991'>
<a class='timestamp' href='#491991'><time timestamp='2016-09-08T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Meeting started Thu Sep  8 18:59:58 2016 UTC.  The chair is wumpus. Information about MeetBot at <a href="http://wiki.debian.org/MeetBot" class="link" target="_blank">http://wiki.debian.org/MeetBot</a>.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361140' id='491992'>
<a class='timestamp' href='#491992'><time timestamp='2016-09-08T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Useful Commands: #action #agreed #help #info #idea #link #topic.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491993'>
<a class='timestamp' href='#491993'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#bitcoin-core-dev Meeting: wumpus sipa gmaxwell jonasschnelli morcos luke-jr btcdrak sdaftuar jtimon cfields petertodd kanzure bluematt instagibbs phantomcircuit codeshark michagogo marcofalke paveljanik NicolasDorier
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491994'>
<a class='timestamp' href='#491994'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491995'>
<a class='timestamp' href='#491995'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491996'>
<a class='timestamp' href='#491996'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491997'>
<a class='timestamp' href='#491997'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
topic: sing morcos happy birthday
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491998'>
<a class='timestamp' href='#491998'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='491999'>
<a class='timestamp' href='#491999'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492000'>
<a class='timestamp' href='#492000'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
thanks, here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492001'>
<a class='timestamp' href='#492001'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492002'>
<a class='timestamp' href='#492002'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
BlueMatt: ack!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492003'>
<a class='timestamp' href='#492003'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
happy birthday morcos
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492004'>
<a class='timestamp' href='#492004'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
leaked PII
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492005'>
<a class='timestamp' href='#492005'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell you missed jl2012
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492006'>
<a class='timestamp' href='#492006'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
wumpus: no doxxing :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492007'>
<a class='timestamp' href='#492007'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
Alex sing your ssn!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361200' id='492008'>
<a class='timestamp' href='#492008'><time timestamp='2016-09-08T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
kanzure: lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492009'>
<a class='timestamp' href='#492009'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Happy birthday!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492010'>
<a class='timestamp' href='#492010'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: happy birthday <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" class="link" target="_blank">https://www.youtube.com/watch?v=dQw4w9WgXcQ</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492011'>
<a class='timestamp' href='#492011'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492012'>
<a class='timestamp' href='#492012'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: congrats
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492013'>
<a class='timestamp' href='#492013'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
here in spirit only
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492014'>
<a class='timestamp' href='#492014'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
saved by DCMA filters &quot;The uploader has not made this video available in your country.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492015'>
<a class='timestamp' href='#492015'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
morcos: hey! happy birthday.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492016'>
<a class='timestamp' href='#492016'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
kanzure: happy birthday to anyone who considers themselves born on this date
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492017'>
<a class='timestamp' href='#492017'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
much better.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492018'>
<a class='timestamp' href='#492018'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
btcdrak: the copyright on happy birthday got overturned :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361260' id='492019'>
<a class='timestamp' href='#492019'><time timestamp='2016-09-08T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
petertodd: click the link
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492020'>
<a class='timestamp' href='#492020'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyone with proposed topics?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492021'>
<a class='timestamp' href='#492021'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
btcdrak: oh, that&#x27;s a great song
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492022'>
<a class='timestamp' href='#492022'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: just one: we have quite a queue of things for 0.13.1, and i&#x27;d like to encourage people to review
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492023'>
<a class='timestamp' href='#492023'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
real topic: segwit-cb bip
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492024'>
<a class='timestamp' href='#492024'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: birthday cake
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361320' id='492025'>
<a class='timestamp' href='#492025'><time timestamp='2016-09-08T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
not a topic proposal, but i would like to eventually get a resolution on the after_failure weirdness
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361380' id='492026'>
<a class='timestamp' href='#492026'><time timestamp='2016-09-08T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I just wanted to let you know that there will be two hack days on monday and tuesday 10th and 11th of October after the SB conference in Milan.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361380' id='492027'>
<a class='timestamp' href='#492027'><time timestamp='2016-09-08T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
jonasschnelli: I&#x27;ll be there
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361380' id='492028'>
<a class='timestamp' href='#492028'><time timestamp='2016-09-08T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: the list was just based the top participants in the past.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361380' id='492029'>
<a class='timestamp' href='#492029'><time timestamp='2016-09-08T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
More info and registration will follow... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361380' id='492030'>
<a class='timestamp' href='#492030'><time timestamp='2016-09-08T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes last week there was an ACTION for &quot;Support for compact blocks together with segwit&quot; (#8393), there has been a bit of review activity in last days, what&#x27;s the status there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492031'>
<a class='timestamp' href='#492031'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: I&#x27;ve been doing some testing. There aren&#x27;t many segwit transactions on testnet currently. I was going to call for people to create more once I got more testing setup.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492032'>
<a class='timestamp' href='#492032'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: i haven&#x27;t reviewed the changes for the bip you suggested - does it require any code changes to the bitcoin core pr?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492033'>
<a class='timestamp' href='#492033'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#info jonasschnelli: I just wanted to let you know that there will be two hack days on monday and tuesday 10th and 11th of October after the SB conference in Milan. More info and registration will follow... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492034'>
<a class='timestamp' href='#492034'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: possibly, two options, though, one minor, one slightly more
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492035'>
<a class='timestamp' href='#492035'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
maybe we can ask roasbeef to help tx generation there
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361440' id='492036'>
<a class='timestamp' href='#492036'><time timestamp='2016-09-08T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: more segwit transactions would help, yes :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361500' id='492037'>
<a class='timestamp' href='#492037'><time timestamp='2016-09-08T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
can we pick a topic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361500' id='492038'>
<a class='timestamp' href='#492038'><time timestamp='2016-09-08T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#link re: queue of things for 0.13.1, link is <a href="https://github.com/bitcoin/bitcoin/milestones/0.13.1" class="link" target="_blank">https://github.com/bitcoin/bitcoin/milestones/0.13.1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361560' id='492039'>
<a class='timestamp' href='#492039'><time timestamp='2016-09-08T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#topic segwit-cb bip
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361560' id='492040'>
<a class='timestamp' href='#492040'><time timestamp='2016-09-08T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jl2012: is everything you are working correctly tagged (or not) for 0.13.1?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361560' id='492041'>
<a class='timestamp' href='#492041'><time timestamp='2016-09-08T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so, to quote github issue &quot;The last commit changes the protocol entirely, adding a cmpctack message. This has the advantage that you could implement receiving of some version of compactlocks without implementing sending that encoding, as well as simplifying the protocol slightly (instead of having to check if the current protocol version is higher-priority according to your probably-compile-time list of supported version you know 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361560' id='492042'>
<a class='timestamp' href='#492042'><time timestamp='2016-09-08T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which version you&#x27;re using directly from the ack message) at the expensee of complicating the implementation somewhat (now you have to add support for another message type and special-case version 1). The last commit is definitely not worth it if we dont anticipate adding more than one or so more versions, but might be worth it if we anticipate compact blocks version 4, 5, 6 at some point. I&#x27;ll bring this up in the IRC meeting later 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361560' id='492043'>
<a class='timestamp' href='#492043'><time timestamp='2016-09-08T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
today.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361620' id='492044'>
<a class='timestamp' href='#492044'><time timestamp='2016-09-08T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
essentially, the current proposal is that you annoucne the set of compact block versions you want at startup (BIP text says before you send any pong or other compact block messages)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361620' id='492045'>
<a class='timestamp' href='#492045'><time timestamp='2016-09-08T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and each sendcmpct announce implies that you are willing to encode to those
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361620' id='492046'>
<a class='timestamp' href='#492046'><time timestamp='2016-09-08T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
btcdrak: including those already tagged, I think 8685, 8654 and 8635 are also for 0.13.1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361620' id='492047'>
<a class='timestamp' href='#492047'><time timestamp='2016-09-08T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and you send them in the priority of what you want to receive
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361620' id='492048'>
<a class='timestamp' href='#492048'><time timestamp='2016-09-08T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and the version you use to send is the first one you receive from the other side that you also sent
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361680' id='492049'>
<a class='timestamp' href='#492049'><time timestamp='2016-09-08T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
at least we may consider to include in 0.13.1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361680' id='492050'>
<a class='timestamp' href='#492050'><time timestamp='2016-09-08T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and you use the highest-priority one the other side also announced to decode
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361680' id='492051'>
<a class='timestamp' href='#492051'><time timestamp='2016-09-08T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(comment text from above link <a href="https://github.com/bitcoin/bips/pull/423#issuecomment-245629813" class="link" target="_blank">https://github.com/bitcoin/bips/pull/423#issuecomment-245629813</a> )
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361680' id='492052'>
<a class='timestamp' href='#492052'><time timestamp='2016-09-08T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m not a fan of changing the code again after all testing, but i do agree it&#x27;s a cleaner solution, and will make things easier for future extensions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361680' id='492053'>
<a class='timestamp' href='#492053'><time timestamp='2016-09-08T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so this is obviously somewhat complicated
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361740' id='492054'>
<a class='timestamp' href='#492054'><time timestamp='2016-09-08T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and the solution would be to introduce a cmpctack which you use to pick the one you want to encode to
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361740' id='492055'>
<a class='timestamp' href='#492055'><time timestamp='2016-09-08T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cmpctack containing the version you picked?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361740' id='492056'>
<a class='timestamp' href='#492056'><time timestamp='2016-09-08T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jl2012: (tagged. number of pulls for 0.13.1 does seem to be getting a bit out of hand)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361740' id='492057'>
<a class='timestamp' href='#492057'><time timestamp='2016-09-08T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
can we have some discussion about this outside of the meeting, I want to ask some questions but I think it&#x27;ll be a design rathole right now. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492058'>
<a class='timestamp' href='#492058'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
simplifying the which-do-i-use-to-decode code from &quot;for each sendcmpct msg received, is this higher priority than the previously-highest-prirotiy one&quot; to &quot;the one I saw in a sendcmpct&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492059'>
<a class='timestamp' href='#492059'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
in practice the proposed cmpctack is way more code, but a bit simpler
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492060'>
<a class='timestamp' href='#492060'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: ok, i&#x27;ll review and adapt the pr
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492061'>
<a class='timestamp' href='#492061'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
s/&quot;&quot;the one I saw in a sendcmpct&quot;/&quot;&quot;the one I saw in a cmpctack&quot;/g
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492062'>
<a class='timestamp' href='#492062'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492063'>
<a class='timestamp' href='#492063'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I, personally, dont really like the cmpctack idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492064'>
<a class='timestamp' href='#492064'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i do like the cmpctack idea!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492065'>
<a class='timestamp' href='#492065'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so what alternative do you propose?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492066'>
<a class='timestamp' href='#492066'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
certainly if we plan on having lots of versions, it is simpler protocol-wise
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361800' id='492067'>
<a class='timestamp' href='#492067'><time timestamp='2016-09-08T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
wumpus: most of mine are pretty trivial. I am no able to do more than that anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492068'>
<a class='timestamp' href='#492068'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if we only ever have version 1 and 2 and maybe like a 3, then the previous proposal seems perfectly ok to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492069'>
<a class='timestamp' href='#492069'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
My viewpoint is that we suffer a history of technical debt, and we have a chance now while compact blocks are new to kind of clean up the protocol messages with a bit less fuss
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492070'>
<a class='timestamp' href='#492070'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492071'>
<a class='timestamp' href='#492071'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: either way I&#x27;m proposing to switch the priority order to first-is-highest from last-is-highest
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492072'>
<a class='timestamp' href='#492072'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jl2012: agreed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492073'>
<a class='timestamp' href='#492073'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so we shoudl take the added changes now to be happier later with a better design
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361860' id='492074'>
<a class='timestamp' href='#492074'><time timestamp='2016-09-08T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
would it ever make sense to support a per-block encoding? for example, if nodes at some point want to pass blocks along as-is from peer A to other peers when possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361920' id='492075'>
<a class='timestamp' href='#492075'><time timestamp='2016-09-08T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
note that we have to introduce a backwards compatibility hack if we do cmpctack
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361920' id='492076'>
<a class='timestamp' href='#492076'><time timestamp='2016-09-08T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think it&#x27;s fine to clean things up. But at some point the correct &#x27;upgrade&#x27; is to just introduce a seperate mechenism sendcmpt2 and drop the old one, rather than extending.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361920' id='492077'>
<a class='timestamp' href='#492077'><time timestamp='2016-09-08T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: just say that if no ack is ever sent, it is implicitly for v1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361920' id='492078'>
<a class='timestamp' href='#492078'><time timestamp='2016-09-08T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
BlueMatt: do we? old CBs will die with segwit anyway..
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361980' id='492079'>
<a class='timestamp' href='#492079'><time timestamp='2016-09-08T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: this implies you have to announce sendcmpct version 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361980' id='492080'>
<a class='timestamp' href='#492080'><time timestamp='2016-09-08T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
past some point trying to create a forever design just guarentees technical debt of a different kind. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473361980' id='492081'>
<a class='timestamp' href='#492081'><time timestamp='2016-09-08T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which the proposal for creating a cmpctack would not do
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492082'>
<a class='timestamp' href='#492082'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
we should maybe do as gmaxwell said and discuss after meeting, but i don&#x27;t think we actually need a hack, you just need to still tell 0.13 nodes that you support v1 and they only understand that by sending them a sendcmpct 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492083'>
<a class='timestamp' href='#492083'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but it doesn&#x27;t hurt to send that to everyone
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492084'>
<a class='timestamp' href='#492084'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
alternatively: compact block version 3 can be called something other than compact blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492085'>
<a class='timestamp' href='#492085'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
then you can do whatever :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492086'>
<a class='timestamp' href='#492086'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: hahaha
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492087'>
<a class='timestamp' href='#492087'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i could live with that too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492088'>
<a class='timestamp' href='#492088'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: yea, thats what I was saying, effectively.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362040' id='492089'>
<a class='timestamp' href='#492089'><time timestamp='2016-09-08T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
besides the general framework here has limitations, further latency optinization should basically be a non-goal, because the fiber approach is vastly better in that respect.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362100' id='492090'>
<a class='timestamp' href='#492090'><time timestamp='2016-09-08T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
anyway, its taken 15 minutes to explain what the issues are, so maybe decide later, or let other topics go ahead first
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362100' id='492091'>
<a class='timestamp' href='#492091'><time timestamp='2016-09-08T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t think any other topics have been (seriously) proposed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492092'>
<a class='timestamp' href='#492092'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so go ahead
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492093'>
<a class='timestamp' href='#492093'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
I got to go. See you
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492094'>
<a class='timestamp' href='#492094'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
proposed topic: picking a segwit rollout date and announcing this in a wider format
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492095'>
<a class='timestamp' href='#492095'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
see you later jl2012
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492096'>
<a class='timestamp' href='#492096'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jl2012: good night
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362160' id='492097'>
<a class='timestamp' href='#492097'><time timestamp='2016-09-08T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: how about just sending sendcmpct2 for v2 :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362220' id='492098'>
<a class='timestamp' href='#492098'><time timestamp='2016-09-08T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-4'> * sipa</span>&gt;
hides
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362220' id='492099'>
<a class='timestamp' href='#492099'><time timestamp='2016-09-08T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: I think the blocker there was basically having all the things merged in 0.13 branch that we believe would be needed on our end.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362220' id='492100'>
<a class='timestamp' href='#492100'><time timestamp='2016-09-08T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
alternatively: version negotiation protocol examples are at <a href="https://github.com/bitcoin/bips/blob/833dea41c4c757087ef4c35e3b19259ba2f80128/bip-0152.mediawiki#Sample_Version_Implementation" class="link" target="_blank">https://github.com/bitcoin/bips/blob/833dea41c4c757087ef4c35e3b19259ba2f80128/bip-0152.mediawiki#Sample_Version_Implementation</a> and <a href="https://github.com/bitcoin/bips/blob/0d9b12cf285762e8ff661fe17e3261d014af1581/bip-0152.mediawiki#Sample_Version_Implementation" class="link" target="_blank">https://github.com/bitcoin/bips/blob/0d9b12cf285762e8ff661fe17e3261d014af1581/bip-0152.mediawiki#Sample_Version_Implementation</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362220' id='492101'>
<a class='timestamp' href='#492101'><time timestamp='2016-09-08T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
topic suggestion: rpc sync assumptions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362220' id='492102'>
<a class='timestamp' href='#492102'><time timestamp='2016-09-08T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
need review of these backport #8679, should be simple enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362280' id='492103'>
<a class='timestamp' href='#492103'><time timestamp='2016-09-08T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
though I think the second misses the fact that you have to use sendcmpct instead of cmpctack if its version 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362280' id='492104'>
<a class='timestamp' href='#492104'><time timestamp='2016-09-08T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
oh hi. znc bouncer is broke or something.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362280' id='492105'>
<a class='timestamp' href='#492105'><time timestamp='2016-09-08T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yeah i&#x27;ve been a bit out of touch, and i can see that makes sense..   but i also think it would be nice to give as much warning to the community as possible as to when we are proposing to actually release this
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492106'>
<a class='timestamp' href='#492106'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: yes, a message that says &quot;This will happen soon, our side waiting for X&quot; to give people a chance to raise any concerns would be reasonable, I think.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492107'>
<a class='timestamp' href='#492107'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
 /release/activate/ ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492108'>
<a class='timestamp' href='#492108'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs_: yes, both
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492109'>
<a class='timestamp' href='#492109'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
we&#x27;ve been giving that message for several weeks already ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492110'>
<a class='timestamp' href='#492110'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#topic picking a segwit rollout date and announcing this in a wider format
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492111'>
<a class='timestamp' href='#492111'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
I&#x27;ve been pointing out the remaining milestone list, but it&#x27;s a bit opaque for people who aren&#x27;t actively reviewing stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362340' id='492112'>
<a class='timestamp' href='#492112'><time timestamp='2016-09-08T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I went around to soem forks and asked for what their scheduling looked like and the response I got was basically &#x27;after it&#x27;s deployed in the network&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362400' id='492113'>
<a class='timestamp' href='#492113'><time timestamp='2016-09-08T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can&#x27;t propose a rollout date before knowing when we can have 0.13.1 out, and there are quite a few things to work out for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362400' id='492114'>
<a class='timestamp' href='#492114'><time timestamp='2016-09-08T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: yeah i suppose i agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362400' id='492115'>
<a class='timestamp' href='#492115'><time timestamp='2016-09-08T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I&#x27;d rather not pile on additional scheduling issues externally unless we&#x27;re confident
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362400' id='492116'>
<a class='timestamp' href='#492116'><time timestamp='2016-09-08T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
is a 0.12.2 backport still happening?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362460' id='492117'>
<a class='timestamp' href='#492117'><time timestamp='2016-09-08T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
Would the amount of lead time differ once we&#x27;ve merged all remaining issuess?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362460' id='492118'>
<a class='timestamp' href='#492118'><time timestamp='2016-09-08T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes it seems 0.13.1 is a lot more work than expected
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362460' id='492119'>
<a class='timestamp' href='#492119'><time timestamp='2016-09-08T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
achow101: I don&#x27;t think so
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362460' id='492120'>
<a class='timestamp' href='#492120'><time timestamp='2016-09-08T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
achow101: segwit needs compact block relay, so very unlikely.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362520' id='492121'>
<a class='timestamp' href='#492121'><time timestamp='2016-09-08T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362520' id='492122'>
<a class='timestamp' href='#492122'><time timestamp='2016-09-08T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
&quot;needs&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362520' id='492123'>
<a class='timestamp' href='#492123'><time timestamp='2016-09-08T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
achow101: getting this into 0.13 in the first place and assuring it is correct is a lot of work, I doubt anyone can pile up the extra work for 0.12
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362520' id='492124'>
<a class='timestamp' href='#492124'><time timestamp='2016-09-08T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
luke-jr: yea, what? segwit doesnt NEED it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362580' id='492125'>
<a class='timestamp' href='#492125'><time timestamp='2016-09-08T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
And no one seems to be demanding it, more importantly
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362580' id='492126'>
<a class='timestamp' href='#492126'><time timestamp='2016-09-08T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
just might be painful if you dont have it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362580' id='492127'>
<a class='timestamp' href='#492127'><time timestamp='2016-09-08T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
unless you are happy with bigger blocks being relayed without it...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362580' id='492128'>
<a class='timestamp' href='#492128'><time timestamp='2016-09-08T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
anyway. weeds.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362580' id='492129'>
<a class='timestamp' href='#492129'><time timestamp='2016-09-08T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, weeds
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492130'>
<a class='timestamp' href='#492130'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
Which PRs need the most attention at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492131'>
<a class='timestamp' href='#492131'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
achow101: no we pretty much decided to not do a 0.12. backport over a month ago.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492132'>
<a class='timestamp' href='#492132'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
weeds?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492133'>
<a class='timestamp' href='#492133'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: &quot;we&#x27;re getting into the weeds&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492134'>
<a class='timestamp' href='#492134'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ohh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492135'>
<a class='timestamp' href='#492135'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
achow101: not worth the risk and resource investment, and no one was jumping to do it. From measurements and feedback we&#x27;ve found that virtually no one uses backport releases.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492136'>
<a class='timestamp' href='#492136'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
mfw pieter is explaining English idioms 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492137'>
<a class='timestamp' href='#492137'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
in the netherlands that might have a different meaning ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492138'>
<a class='timestamp' href='#492138'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492139'>
<a class='timestamp' href='#492139'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, 0.12 just isn&#x27;t a very important topic right now, let&#x27;s focus on moving forward
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362640' id='492140'>
<a class='timestamp' href='#492140'><time timestamp='2016-09-08T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
CodeShark: yes :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362700' id='492141'>
<a class='timestamp' href='#492141'><time timestamp='2016-09-08T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
also, if someone really needs 0.12, they can put it behind a 0.13.1 node
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362700' id='492142'>
<a class='timestamp' href='#492142'><time timestamp='2016-09-08T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
next topic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362700' id='492143'>
<a class='timestamp' href='#492143'><time timestamp='2016-09-08T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#topic rpc sync assumptions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362700' id='492144'>
<a class='timestamp' href='#492144'><time timestamp='2016-09-08T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: precisely, and any sw backport would create the disruption people were trying to avoid in staying with an older version.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362760' id='492145'>
<a class='timestamp' href='#492145'><time timestamp='2016-09-08T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: I don&#x27;t understand why people thought it was a problem that getbalance could return a &quot;mid block&quot; response.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362760' id='492146'>
<a class='timestamp' href='#492146'><time timestamp='2016-09-08T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
just to be clear, the change to reduce cs_main locks is only for 0.14, so we don&#x27;t have to worry about rpc sync assumptions for 0.13.1 right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362760' id='492147'>
<a class='timestamp' href='#492147'><time timestamp='2016-09-08T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
so, marcos pointed out that the reason that the rpc tests are failing and fix is needed is that we broke some timing assumptions by optimizing some stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492148'>
<a class='timestamp' href='#492148'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
so the question is: are those assumptions ok to break (just fix the tests), or are they part of the api?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492149'>
<a class='timestamp' href='#492149'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
wow, re-reading that, that&#x27;s incredibly vague :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492150'>
<a class='timestamp' href='#492150'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492151'>
<a class='timestamp' href='#492151'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Can you make a clear example?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492152'>
<a class='timestamp' href='#492152'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think the question should be what do we think the best behavior is. And if the best behavior changes the API, we should do it and document the change.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362820' id='492153'>
<a class='timestamp' href='#492153'><time timestamp='2016-09-08T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
WalletSync expected to occur in test
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492154'>
<a class='timestamp' href='#492154'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Do we assume the wallet has processed a transaction after getting informed of a blockupdate?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492155'>
<a class='timestamp' href='#492155'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
*under the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492156'>
<a class='timestamp' href='#492156'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
does &quot;mid block&quot; include &quot;numbers are being changed, so the value is unlike either the previous OR the next correct value&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492157'>
<a class='timestamp' href='#492157'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: I don&#x27;t know either, there&#x27;s no guarantee that blocks are atomically processed by the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492158'>
<a class='timestamp' href='#492158'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can make it atomic, as pointed out by morcos earlier
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492159'>
<a class='timestamp' href='#492159'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
s/blockupdate/tipupdate
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492160'>
<a class='timestamp' href='#492160'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but is it necessary?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492161'>
<a class='timestamp' href='#492161'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
luke-jr: it reflects the full effect of some of the txs in the block but not all
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492162'>
<a class='timestamp' href='#492162'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
my understanding is that the tests are doing things like handing a node a block, then instantly checking the wallet, and expecting it to be fully consistent with the block right away. Is this understanding correct?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362880' id='492163'>
<a class='timestamp' href='#492163'><time timestamp='2016-09-08T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
my alternative is that we make the wallet aware of the current tip it knows about, and we let confirmations be computed based on that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492164'>
<a class='timestamp' href='#492164'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that means that mid-block update you can see unconfirmed transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492165'>
<a class='timestamp' href='#492165'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: ex: you do a getblockheight rpc call - under previous versions if you then do a getbalance that balance is up to date to that block, this is no longer true
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492166'>
<a class='timestamp' href='#492166'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the tests need proper synchronization commands, some of those need to be implemented, I don&#x27;t think we need to change the whole API for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492167'>
<a class='timestamp' href='#492167'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: well before we get to the atomic block question, there is the question of whether if you wait for the blockchain to be synced to some height, and then query the wallet whether you are getting wallet values of at least that height (mid-block or not)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492168'>
<a class='timestamp' href='#492168'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gmaxwell: correct. as soon as the height/hash is reflected, they assume the wallet is synced with that height/hash
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492169'>
<a class='timestamp' href='#492169'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(besides adding those syncronization commands)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492170'>
<a class='timestamp' href='#492170'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Can we not just have the wallets bestblock in getwalletinfo and use it for sync with getchaintips?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492171'>
<a class='timestamp' href='#492171'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: I think mid-block updates is a blatant violation of the &quot;principal of least surprise&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473362940' id='492172'>
<a class='timestamp' href='#492172'><time timestamp='2016-09-08T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: okay, I think sipa&#x27;s suggestion would address that esp with coupled with a way of asking for the wallet&#x27;s tip.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492173'>
<a class='timestamp' href='#492173'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: well it would make sense for the wallet to track where it is, synchronization-wise, absolutely
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492174'>
<a class='timestamp' href='#492174'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: uh then we need to remove unconfirmed transactions too?!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492175'>
<a class='timestamp' href='#492175'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos:  and for thtat info to be available externally
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492176'>
<a class='timestamp' href='#492176'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
showing a best-wallet-block would make the whole mid-block state even more broken IMO (what best-block will it show mid-state?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492177'>
<a class='timestamp' href='#492177'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: there can always be unconfirmed transactions in the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492178'>
<a class='timestamp' href='#492178'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and, further, if wallet is allowed to return something that is not up to date with the start of the call, this changes literally our entire api....so now anyone using the rpc has to go re-audit all of their uses of it???
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492179'>
<a class='timestamp' href='#492179'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: the previous one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363000' id='492180'>
<a class='timestamp' href='#492180'><time timestamp='2016-09-08T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: huh? I mean things mid-block...am I missing what you said?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492181'>
<a class='timestamp' href='#492181'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: it will update its state when its done processing updates, of course.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492182'>
<a class='timestamp' href='#492182'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
fixing the mid-block thing seems pretty trivial to me, why wouldnt&#x27; we just do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492183'>
<a class='timestamp' href='#492183'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
luke-jr: the bestblock should only be updated after fully processing? Right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492184'>
<a class='timestamp' href='#492184'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: i was under the impression you indicated that you would see txn which come later in that block as unconfirmed, while txn earlier in the block are marked confirmed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492185'>
<a class='timestamp' href='#492185'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Why are people regarding mid block as a bug?!?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492186'>
<a class='timestamp' href='#492186'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492187'>
<a class='timestamp' href='#492187'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
at <u>_any_</u> time a transaction can show up and appear in the wallet, unrelated to any blocks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492188'>
<a class='timestamp' href='#492188'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: b/c its not a feature?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363060' id='492189'>
<a class='timestamp' href='#492189'><time timestamp='2016-09-08T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: mid-update you would see the transactions of the new block as unconfirmed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492190'>
<a class='timestamp' href='#492190'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
that seems the most obvious behaviour, but if you look at bestblock+balance, I would think them a pair, yet balance might be bestblock+partOfNextBlock in reality?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492191'>
<a class='timestamp' href='#492191'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i mean does anyone want that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492192'>
<a class='timestamp' href='#492192'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ahh, yes, ok, so i was just confused....txn which appear in wallet before the block has processed seems reasonable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492193'>
<a class='timestamp' href='#492193'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Unless you want to remove unconfirmed transactions that will always happen.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492194'>
<a class='timestamp' href='#492194'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i also don&#x27;t think there is any problem with grabbing a wallet lock during the update
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492195'>
<a class='timestamp' href='#492195'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so if changing the balance mid-block is regarded as a bug, that should apply to all other state too: the transaction list, for example. It should hold all updates until it processed the entire block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492196'>
<a class='timestamp' href='#492196'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which would prevent seeing a mid-update state
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492197'>
<a class='timestamp' href='#492197'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m just questioning if it is necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363120' id='492198'>
<a class='timestamp' href='#492198'><time timestamp='2016-09-08T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it seems strange to me to hurt concurrency to protect a property that we don&#x27;t actually have (due to unconfirmed transactions)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492199'>
<a class='timestamp' href='#492199'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t think using the lock for that is a good thing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492200'>
<a class='timestamp' href='#492200'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
agree with gmaxwell
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492201'>
<a class='timestamp' href='#492201'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
From the wallet perspective processing doesn&#x27;t matter, you just want to see confirmations... can slowly appear on a tx list IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492202'>
<a class='timestamp' href='#492202'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
wumpus: right, that made me cringe. That seems like a major layer violation
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492203'>
<a class='timestamp' href='#492203'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: gmaxwell: but can you explain what concurrency we are hurting?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492204'>
<a class='timestamp' href='#492204'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m not suggesting we put cs_main covering those again
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492205'>
<a class='timestamp' href='#492205'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: you have to hold the lock <b>*all*</b> the time while processing the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492206'>
<a class='timestamp' href='#492206'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: if it were listing your <b>*confirmed*</b> balance as mid-block, then it would be an issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363180' id='492207'>
<a class='timestamp' href='#492207'><time timestamp='2016-09-08T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492208'>
<a class='timestamp' href='#492208'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Wallet processing shouldn&#x27;t stall when the node is processing a block, at least not any more than strictly necessary.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492209'>
<a class='timestamp' href='#492209'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which I believe is what people are worried about
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492210'>
<a class='timestamp' href='#492210'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: the proposal is to grab cs_wallet during the wallet updating for the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492211'>
<a class='timestamp' href='#492211'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-14'> * luke-jr</span>&gt;
wonders if there&#x27;s a good way to use listsinceblock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492212'>
<a class='timestamp' href='#492212'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: which happens in its entirety after main processes the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492213'>
<a class='timestamp' href='#492213'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m just suggesting we use cs_wallet or some other lock that prevents a wallet specific call from returning until you are no longer in the middle of a loop that calls SyncWithWallets (on a given block)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492214'>
<a class='timestamp' href='#492214'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: cs_main isn&#x27;t even held at the point
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492215'>
<a class='timestamp' href='#492215'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: I know, but you&#x27;d still be holding the wallet lock longer than necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492216'>
<a class='timestamp' href='#492216'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
to be fair, all of this should move onto a background thread in the future anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492217'>
<a class='timestamp' href='#492217'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: so now wallet calls will stall block processing? (when the block processing waits to take that lock?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492218'>
<a class='timestamp' href='#492218'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
BlueMatt: agreed on that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363240' id='492219'>
<a class='timestamp' href='#492219'><time timestamp='2016-09-08T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, and it may be harder to maining if we parallellize/asynchronize things more
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492220'>
<a class='timestamp' href='#492220'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wallet block processing should be async at some point
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492221'>
<a class='timestamp' href='#492221'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so this would be a temporary fix that we should consider something which will happen on a background thread...lets not get too focused on blocking block processing with it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492222'>
<a class='timestamp' href='#492222'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: do you think there is a problem with showing the transactions from the being-processed-block as unconfirmed during the update?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492223'>
<a class='timestamp' href='#492223'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: hmmm, yes i suppose while thats in the main thread thats a bad idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492224'>
<a class='timestamp' href='#492224'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
IMO the wallet should process a copy of the block on its own, own thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492225'>
<a class='timestamp' href='#492225'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: yes yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492226'>
<a class='timestamp' href='#492226'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
^]
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492227'>
<a class='timestamp' href='#492227'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: probably it will already be in the wallet as unconfirmed anyhow
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492228'>
<a class='timestamp' href='#492228'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: i think everyone agrees on that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363300' id='492229'>
<a class='timestamp' href='#492229'><time timestamp='2016-09-08T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: I&#x27;m fine with temporary fixes, I&#x27;m just confused as to why anything needs to be fixed here except some unrealistic expectations in the tests.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492230'>
<a class='timestamp' href='#492230'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: i believe the current situation is broken
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492231'>
<a class='timestamp' href='#492231'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: great. I&#x27;d like to understand why.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492232'>
<a class='timestamp' href='#492232'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
mid-update you can see half of the block reflected as confirmed transactions, and miss other transactions from that same block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492233'>
<a class='timestamp' href='#492233'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: two issues: getbalance, by default, shows your <b>*confirmed*</b> balance, so you expect that to be consistent...right now it is not clear (I maybe wrong) that it might not show <b>*half*</b> of your actually confirmed balance
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492234'>
<a class='timestamp' href='#492234'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i think i need to go look more carefully at what SyncWithWallets does with txs from the block, but for instance, coudl you end up removing a conflicted tx, then showing a balance, without having addd the replacement tx yet.  i think yes, and i think thats would be confusing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363360' id='492235'>
<a class='timestamp' href='#492235'><time timestamp='2016-09-08T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
okay, I agree showing confirmed for some and not others is odd. Showing some and not others, however I think is fine, and consistent with the normal behavior.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363420' id='492236'>
<a class='timestamp' href='#492236'><time timestamp='2016-09-08T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
let&#x27;s not focus on the details here. The question at hand (mine, anyway), is whether the blocking behavior from 0.13 is considered part of the api, or if it&#x27;s ok to deviate. If the answer is the latter, we can just fix the tests and move on.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363420' id='492237'>
<a class='timestamp' href='#492237'><time timestamp='2016-09-08T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: blocking what behaviour?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363420' id='492238'>
<a class='timestamp' href='#492238'><time timestamp='2016-09-08T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
0.13 does not have this change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363420' id='492239'>
<a class='timestamp' href='#492239'><time timestamp='2016-09-08T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: i think there is something that needs to be fixed in master, that is deeper than fixing up tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363420' id='492240'>
<a class='timestamp' href='#492240'><time timestamp='2016-09-08T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: but it may not be much
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492241'>
<a class='timestamp' href='#492241'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: right, 0.13 doesn&#x27;t give up the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492242'>
<a class='timestamp' href='#492242'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
indeed, 0.13 is totally fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492243'>
<a class='timestamp' href='#492243'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: second, we are making an API change here, which it seems to me is probably going to break clients: previously if you called getblockheigh, and then getbalance, getbalance will be up-to-date at least as of that block...this is no longer true. I can absolutely see clients having assumed this
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492244'>
<a class='timestamp' href='#492244'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;okay, I agree showing confirmed for some and not others is odd&quot; absolutely. This would break the assumption that curtip-block which tx was confirmed in is the number of confirmations
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492245'>
<a class='timestamp' href='#492245'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields: That the wallet blocks shouldn&#x27;t be part of the api. Certian consistency properties might reasonably be.  I&#x27;m actually dubious that seeing confirmations incrementally is actually a problem.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363480' id='492246'>
<a class='timestamp' href='#492246'><time timestamp='2016-09-08T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: no, thats not really true either, since the chain can reorg between those two calls.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492247'>
<a class='timestamp' href='#492247'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: right. and now master has changed that behavior. So if the behavior is considered to be part of the api, we need to revert it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492248'>
<a class='timestamp' href='#492248'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Why can&#x27;t we not just use SyncWithWallets or mempool and add a SyncBlockWithWallet(blockcopy) for added and removed tips? Process it in a wallet-thread (similar to periodic flushes) and use cs_wallet there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492249'>
<a class='timestamp' href='#492249'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, how about i write up an issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492250'>
<a class='timestamp' href='#492250'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
(I don&#x27;t believe that and I&#x27;d -1 it. Just clarifying)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492251'>
<a class='timestamp' href='#492251'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i don&#x27;t think we should revert the change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363540' id='492252'>
<a class='timestamp' href='#492252'><time timestamp='2016-09-08T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we shouldn&#x27;t revert anything that prevents future paralellization/concurrency
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492253'>
<a class='timestamp' href='#492253'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think the step was a step in the right direction, and we should continue it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492254'>
<a class='timestamp' href='#492254'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but we have time in 0.14 to figure out exactly how
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492255'>
<a class='timestamp' href='#492255'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if there is a need to &#x27;force everything to wait for thewallet&#x27; that&#x27;s a big -1 from me too
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492256'>
<a class='timestamp' href='#492256'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think we should make it so that the existing rpc calls returns omething that make sense.  two issues 1) once you&#x27;ve waited for a certain height, that once you ask for balance you get a balance of at least that height 2) whether mid-block updates are ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492257'>
<a class='timestamp' href='#492257'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
how does this concurrency interact with the wallet&#x27;s mempool interaction. The wallet cares if tx are in mempool or not, will a wallet look unconfirmed and fallen out of the mempool briefly while it&#x27;s confirming?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492258'>
<a class='timestamp' href='#492258'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
1) needs fixing, 2) needs more investigation
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363600' id='492259'>
<a class='timestamp' href='#492259'><time timestamp='2016-09-08T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
agreed. ok, that answers my question.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492260'>
<a class='timestamp' href='#492260'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
1) can be fixed with cfields existing code from 8680 without harming any concurrency
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492261'>
<a class='timestamp' href='#492261'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: 1) is easily fixed by reporting the wallet height rather than the core height
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492262'>
<a class='timestamp' href='#492262'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
morcos: isn&#x27;t 1) and 2) solvable from the wallet side?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492263'>
<a class='timestamp' href='#492263'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wallet height and core height are different things
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492264'>
<a class='timestamp' href='#492264'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: yes, but that would be api-breaking right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492265'>
<a class='timestamp' href='#492265'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it has always been possible to confound these, but that has to change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492266'>
<a class='timestamp' href='#492266'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: i believe not
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492267'>
<a class='timestamp' href='#492267'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i think that&#x27;s the right idea though
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363660' id='492268'>
<a class='timestamp' href='#492268'><time timestamp='2016-09-08T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Well it means that someone might need to look in a different place for the wallet height, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492269'>
<a class='timestamp' href='#492269'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: if we make 0.14 report the wallet height,  i believe it will look equivalent to 0.13
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492270'>
<a class='timestamp' href='#492270'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: yes, it&#x27;d need to be a wallet RPC
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492271'>
<a class='timestamp' href='#492271'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: the issue is people probably already use getblockcount and then ask for balances
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492272'>
<a class='timestamp' href='#492272'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
either on getwalletinfo or getwalletblockcount
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492273'>
<a class='timestamp' href='#492273'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but they do that in their code
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492274'>
<a class='timestamp' href='#492274'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: so, make getblockcount by default report the wallet height
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492275'>
<a class='timestamp' href='#492275'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bah
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492276'>
<a class='timestamp' href='#492276'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that seems like a crazy change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492277'>
<a class='timestamp' href='#492277'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: thats okay, we would release note that in 0.14. If it&#x27;s the right behavior to change we shouldn&#x27;t hesitate to do so here.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363720' id='492278'>
<a class='timestamp' href='#492278'><time timestamp='2016-09-08T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
why? it&#x27;s exactly what we&#x27;ve been doing all the time
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492279'>
<a class='timestamp' href='#492279'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
change getblockcount to a wallet call?!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492280'>
<a class='timestamp' href='#492280'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492281'>
<a class='timestamp' href='#492281'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
that means you need wallet support to use that rpc?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492282'>
<a class='timestamp' href='#492282'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
bad idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492283'>
<a class='timestamp' href='#492283'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think we&#x27;re getting a bit too worked up
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492284'>
<a class='timestamp' href='#492284'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
blech
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492285'>
<a class='timestamp' href='#492285'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what if there is no wallet built in?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492286'>
<a class='timestamp' href='#492286'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sigh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492287'>
<a class='timestamp' href='#492287'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
no blockcount!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492288'>
<a class='timestamp' href='#492288'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
that woudl be kind of odd, but it&#x27;s 99% of the time used as a wallet call, ... and we have getblockchaininfo....
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492289'>
<a class='timestamp' href='#492289'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what if there are multiple wallets? ask them all, return the max value?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492290'>
<a class='timestamp' href='#492290'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: certain people have reorg handling code, this api change will not trigger their reorg handling code and will still break clients!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492291'>
<a class='timestamp' href='#492291'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so deprepcate the RPC
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492292'>
<a class='timestamp' href='#492292'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Just give out the bestblockhash in getwalletinfo
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492293'>
<a class='timestamp' href='#492293'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it is absolutely not unreasonable for this change to break rpc clients
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492294'>
<a class='timestamp' href='#492294'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and introduce a wallet-specific one and main-specific one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492295'>
<a class='timestamp' href='#492295'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its easy enough to make wallet balance calls wait on their own until either the wallet reports a height that matches chainactive height or using cfields mechanism, that slows nothing other than that wallet call and solves 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363780' id='492296'>
<a class='timestamp' href='#492296'><time timestamp='2016-09-08T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
why not just have getblockcount block until the block is finished processing (all signals, not wallet specific)? New apis can be async
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492297'>
<a class='timestamp' href='#492297'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, there needs to be a wallet-specific one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492298'>
<a class='timestamp' href='#492298'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: that&#x27;s just delaying the problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492299'>
<a class='timestamp' href='#492299'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
what morcos said
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492300'>
<a class='timestamp' href='#492300'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: look, the API is not, should not, and cannot be a suicide pact. We&#x27;re talking about an change in a major version, and one that would only require minor changes. _WE CAN CHANGE THE API_. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492301'>
<a class='timestamp' href='#492301'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: because that&#x27;s no longer possible if the wallet works asynchronously
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492302'>
<a class='timestamp' href='#492302'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
just block wallet calls until they are caught up
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492303'>
<a class='timestamp' href='#492303'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Especially in a minor way like &quot;get your height for purpose X this way instead of that&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492304'>
<a class='timestamp' href='#492304'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wallet processing blocking wallet calls is OK
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492305'>
<a class='timestamp' href='#492305'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
there is a simple solution to this that doesnt require all the users audit their codebase
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492306'>
<a class='timestamp' href='#492306'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
that isnt even a big deal
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363840' id='492307'>
<a class='timestamp' href='#492307'><time timestamp='2016-09-08T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wallet processing blocking core calls is not
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492308'>
<a class='timestamp' href='#492308'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but you&#x27;re arguing we change the api because its simpler?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492309'>
<a class='timestamp' href='#492309'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
just block wallet rpc calls until its caught up at the start of the cs_wallet lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492310'>
<a class='timestamp' href='#492310'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yes, wumpus, dont think anyone is arguing for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492311'>
<a class='timestamp' href='#492311'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I haven&#x27;t heard anything suggested that doesn&#x27;t require having the wallet and block processing block each other.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492312'>
<a class='timestamp' href='#492312'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
noooo
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492313'>
<a class='timestamp' href='#492313'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
wait, wut?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363900' id='492314'>
<a class='timestamp' href='#492314'><time timestamp='2016-09-08T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: yes, see cory&#x27;s code in 8680, can easily adopt all wallet calls to use that (or ask the wallet for its height but then they might have to poll) and weight until it hits what chainactive was at the start of the call
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492315'>
<a class='timestamp' href='#492315'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the proposal is that rpc calls might block until the wallet has caught up to where main chainstate is
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492316'>
<a class='timestamp' href='#492316'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yeah i think you&#x27;re misunderstanding
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492317'>
<a class='timestamp' href='#492317'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yup... but at some point we&#x27;d want to get rid of that too, i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492318'>
<a class='timestamp' href='#492318'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the wallet processing can still be in a background thread, or on the main thread, or whatever
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492319'>
<a class='timestamp' href='#492319'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: yes, that makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492320'>
<a class='timestamp' href='#492320'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and I think it&#x27;s insane to degrade concurrency for an obscure property that anyone who wants can retain by using an appropritate call to ask where the wallet is vs where the blockchain is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492321'>
<a class='timestamp' href='#492321'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it just has to catch up before the rpc will return
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492322'>
<a class='timestamp' href='#492322'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: we arent degregading concurrency except that rpc calls might block, afaict
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492323'>
<a class='timestamp' href='#492323'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and then we&#x27;re returning more up-to-date info anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492324'>
<a class='timestamp' href='#492324'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so thats not even so bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1473363960' id='492325'>
<a class='timestamp' href='#492325'><time timestamp='2016-09-08T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
might block but would still return before they would have in 0.13!!!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492326'>
<a class='timestamp' href='#492326'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
BlueMatt: and it only blocks as long sa it would&#x27;ve before
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492327'>
<a class='timestamp' href='#492327'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
true
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492328'>
<a class='timestamp' href='#492328'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
what was suggested above was the block processing taking the wallet lock; which would bidirectionally block each other.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492329'>
<a class='timestamp' href='#492329'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492330'>
<a class='timestamp' href='#492330'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: that was a proposal to solve problem 2 (the mid block)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492331'>
<a class='timestamp' href='#492331'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
that was to a different issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364020' id='492332'>
<a class='timestamp' href='#492332'><time timestamp='2016-09-08T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
there are two issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364080' id='492333'>
<a class='timestamp' href='#492333'><time timestamp='2016-09-08T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
well, potential issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364080' id='492334'>
<a class='timestamp' href='#492334'><time timestamp='2016-09-08T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the proposal was that <u>_the wallet_</u> would grab <u>_the wallet lock_</u> while it was updating its state for a new block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364080' id='492335'>
<a class='timestamp' href='#492335'><time timestamp='2016-09-08T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that problem needs more investigation to determine a) whether it needs solving and b) whether there is a simple solution.  i agree with your objection to my first suggested solution
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492336'>
<a class='timestamp' href='#492336'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: yes but thats only a good idea when thats not running in teh same thread as block processing in the middle of block processing, otherwise some other independent wallet call holds up block processing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492337'>
<a class='timestamp' href='#492337'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
are there other topics? i don&#x27;t think we need to figure this out completely right now
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492338'>
<a class='timestamp' href='#492338'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: Sounds fine to me.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492339'>
<a class='timestamp' href='#492339'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I think it&#x27;s better to take this outside the meeting. Any other topics?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492340'>
<a class='timestamp' href='#492340'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: ha , too late!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364140' id='492341'>
<a class='timestamp' href='#492341'><time timestamp='2016-09-08T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: heh same idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364200' id='492342'>
<a class='timestamp' href='#492342'><time timestamp='2016-09-08T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
this can be handled with signals btw, no need to grab actual locks. StartProcessing() -&gt; block rpc -&gt; FinishedProcessing() unblock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364200' id='492343'>
<a class='timestamp' href='#492343'><time timestamp='2016-09-08T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
yes, later is fine. That got more heated than I expected :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364200' id='492344'>
<a class='timestamp' href='#492344'><time timestamp='2016-09-08T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
though, we still have the question of what to do about the tests.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492345'>
<a class='timestamp' href='#492345'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yes, i&#x27;m not saying that&#x27;s what we should or shouldn&#x27;t do... just clarifying what the idea was
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492346'>
<a class='timestamp' href='#492346'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
does 8680 fix the tests or not really?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492347'>
<a class='timestamp' href='#492347'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
cfields: I think your pull is fine for that, as a temp fix at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492348'>
<a class='timestamp' href='#492348'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think 8680 seems reasonable to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492349'>
<a class='timestamp' href='#492349'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492350'>
<a class='timestamp' href='#492350'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
let&#x27;s merge 8680 to fix the annoyance with the test
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492351'>
<a class='timestamp' href='#492351'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: i believe so, but not 100% because of the nature
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492352'>
<a class='timestamp' href='#492352'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but open a tracker issue to reconsider
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492353'>
<a class='timestamp' href='#492353'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
(i&#x27;m not 100%, sorry)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492354'>
<a class='timestamp' href='#492354'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#action merge  8680 to fix the annoyance with the test
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364260' id='492355'>
<a class='timestamp' href='#492355'><time timestamp='2016-09-08T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
&lt;i&gt;8m warning&lt;/i&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492356'>
<a class='timestamp' href='#492356'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
michagogo: looks like we&#x27;re out of topics sooner than out of time
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492357'>
<a class='timestamp' href='#492357'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
ok, I can slim that down to only the rpc used by the tests then
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492358'>
<a class='timestamp' href='#492358'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
cfields: ack
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492359'>
<a class='timestamp' href='#492359'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492360'>
<a class='timestamp' href='#492360'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#endmeeting
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492361'>
<a class='timestamp' href='#492361'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Meeting ended Thu Sep  8 19:52:49 2016 UTC.  Information about MeetBot at <a href="http://wiki.debian.org/MeetBot" class="link" target="_blank">http://wiki.debian.org/MeetBot</a> . (v 0.1.4)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492362'>
<a class='timestamp' href='#492362'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Minutes:        <a href="http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.html" class="link" target="_blank">http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492363'>
<a class='timestamp' href='#492363'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Minutes (text): <a href="http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.txt" class="link" target="_blank">http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.txt</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364320' id='492364'>
<a class='timestamp' href='#492364'><time timestamp='2016-09-08T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-4'> lightningbot</span>&gt;
Log:            <a href="http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.log.html" class="link" target="_blank">http://www.erisian.com.au/meetbot/bitcoin-core-dev/2016/bitcoin-core-dev.2016-09-08-18.59.log.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364380' id='492365'>
<a class='timestamp' href='#492365'><time timestamp='2016-09-08T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-12'> * michagogo</span>&gt;
wishes he had more time lately
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364380' id='492366'>
<a class='timestamp' href='#492366'><time timestamp='2016-09-08T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
2-3 hour commutes are not very fun.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364380' id='492367'>
<a class='timestamp' href='#492367'><time timestamp='2016-09-08T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
michagogo: yes we&#x27;ve been missing you lately!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364440' id='492368'>
<a class='timestamp' href='#492368'><time timestamp='2016-09-08T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
(Where lately = &gt;1 year, I thinkâ€¦)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364440' id='492369'>
<a class='timestamp' href='#492369'><time timestamp='2016-09-08T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
michagogo: work from home, your hair will get fuller, and silkier with the reduced stress
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364440' id='492370'>
<a class='timestamp' href='#492370'><time timestamp='2016-09-08T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
michagogo: Let someone drive for you and use the time to catch up on stuff.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364440' id='492371'>
<a class='timestamp' href='#492371'><time timestamp='2016-09-08T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
It&#x27;s a good thing I scripted gitian builds, so at least I can kick those off and let them run at home
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364500' id='492372'>
<a class='timestamp' href='#492372'><time timestamp='2016-09-08T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
instagibbs_: unfortunately that&#x27;s not an option for various reasons
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364500' id='492373'>
<a class='timestamp' href='#492373'><time timestamp='2016-09-08T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
MarcoFalke: I wish that were feasible, but I&#x27;m provided with free public transportation and don&#x27;t have a car
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492374'>
<a class='timestamp' href='#492374'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
which pr changed the wallet handling to be background?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492375'>
<a class='timestamp' href='#492375'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Sorry for contributing to confusion above.  I probably misunderstood people, but it sounded to me that people were saying that the wallet operating non-concurrently was part of the API and that we couldn&#x27;t change it.  I agree its a minor part of the api but think we must change it.  Making all the blocks &#x27;confirmedness&#x27; updates to the wallet atomic seems reasonable to me (though I&#x27;m dubious anyt
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492376'>
<a class='timestamp' href='#492376'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hing would actually be broken by that which isn&#x27;t already broken)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492377'>
<a class='timestamp' href='#492377'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: i guess there is no PR for that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492378'>
<a class='timestamp' href='#492378'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I try to figure out how to get rides whenever I can, but that&#x27;s not very often
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364560' id='492379'>
<a class='timestamp' href='#492379'><time timestamp='2016-09-08T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jonasschnelli: o.O ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364620' id='492380'>
<a class='timestamp' href='#492380'><time timestamp='2016-09-08T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
It was just a discussion.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364680' id='492381'>
<a class='timestamp' href='#492381'><time timestamp='2016-09-08T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t think &quot;would be an api change&quot; should ever be an argument against something in a major release, and it was kind of worrying me to hear people talking that way... esp. since the current api stinks in a number of minor ways and needs improving. &quot;Would be a rather disruptive API change relative to the benefits&quot; would be a fine argument, but it wasn&#x27;t what I was hearing, maybe it was implici
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364680' id='492382'>
<a class='timestamp' href='#492382'><time timestamp='2016-09-08T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
t. Though I think making the wallet and block processing mutually concurrent has a lot of obvious benefits.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364680' id='492383'>
<a class='timestamp' href='#492383'><time timestamp='2016-09-08T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: 7964 (its not background, it just happens outside of cs_main now)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364740' id='492384'>
<a class='timestamp' href='#492384'><time timestamp='2016-09-08T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
gmaxwell: if it breaks deployed apps, it&#x27;s a potential issue - otherwise, it isn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364740' id='492385'>
<a class='timestamp' href='#492385'><time timestamp='2016-09-08T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: absolutely - i think everything that was proposed would never grab cs_main and cs_wallet at the same time (even though they&#x27;re in the same thread for now)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364740' id='492386'>
<a class='timestamp' href='#492386'><time timestamp='2016-09-08T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: i think thats a fair summary.   in the future it probably makes sense for someone (like me in this case) to write up a small issue before the meeting, so people aren&#x27;t trying to read about a somewhat nuanced issue in interlaced realtime chat
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364800' id='492387'>
<a class='timestamp' href='#492387'><time timestamp='2016-09-08T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
gmaxwell: I guess it depends from which angle you are looking at it. Current users expect (API) that getblockchaininfo represents the state of the wallet...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364800' id='492388'>
<a class='timestamp' href='#492388'><time timestamp='2016-09-08T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Which I agree we should keep for 0.13.x
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364800' id='492389'>
<a class='timestamp' href='#492389'><time timestamp='2016-09-08T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos: that seems to be something about c++11 consistency
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364860' id='492390'>
<a class='timestamp' href='#492390'><time timestamp='2016-09-08T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
But afterwards, I think is a good signal to have own wallet process state calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364860' id='492391'>
<a class='timestamp' href='#492391'><time timestamp='2016-09-08T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I&#x27;m in favor of any change that further decouples the wallet from the rest of the app ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364860' id='492392'>
<a class='timestamp' href='#492392'><time timestamp='2016-09-08T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
To slowly make people aware of that the wallet might gets more of its own state/processes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364920' id='492393'>
<a class='timestamp' href='#492393'><time timestamp='2016-09-08T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
??? <a href="https://usercontent.irccloud-cdn.com/file/JhPBIVrq/IMG_3841.PNG" class="link" target="_blank">https://usercontent.irccloud-cdn.com/file/JhPBIVrq/IMG_3841.PNG</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364980' id='492394'>
<a class='timestamp' href='#492394'><time timestamp='2016-09-08T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: sorry, indeed that was my implied argument
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364980' id='492395'>
<a class='timestamp' href='#492395'><time timestamp='2016-09-08T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: I agree, making an api change is generally fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364980' id='492396'>
<a class='timestamp' href='#492396'><time timestamp='2016-09-08T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but making one that is pervasive across the entire api for such a minor gain seems insane
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364980' id='492397'>
<a class='timestamp' href='#492397'><time timestamp='2016-09-08T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and generally making a massively pervasive change across the entire api isnt ideal unless its easy to explain how to change your clients to work with it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473364980' id='492398'>
<a class='timestamp' href='#492398'><time timestamp='2016-09-08T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: I think we should keep things for 0.13, sure.  though take care, there is no way to perform multiple RPCs atomically. So if you call getblockchaininfo then interact with the wallet, the world might have changed out from under you, .. in any version. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365040' id='492399'>
<a class='timestamp' href='#492399'><time timestamp='2016-09-08T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: and, generally, I&#x27;d prefer for things like that to have an -wrapentireapitomakeitbackwardscompatible option
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492400'>
<a class='timestamp' href='#492400'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: okay, my view is that having the wallet and node be concurrent is not a minor gain. (esp since that also means multiple wallets being concurrent with each other, ultimately)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492401'>
<a class='timestamp' href='#492401'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. Indeed. But users expect â€“ in normal non reorg operations â€“ that getblockchaininfo at least reports a height already processed by a wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492402'>
<a class='timestamp' href='#492402'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
*the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492403'>
<a class='timestamp' href='#492403'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well, one question is where do people &quot;wait&quot; for getblockcount to go up, and then take wallet action based on it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492404'>
<a class='timestamp' href='#492404'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess we don&#x27;t know
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492405'>
<a class='timestamp' href='#492405'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
I am fine with breaking the wallet api, but we should make it explicit and not silent.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492406'>
<a class='timestamp' href='#492406'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: oops, sure, I agree this case is a major gain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492407'>
<a class='timestamp' href='#492407'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it seems much more something unit tests do, because they now exactly what is going to happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492408'>
<a class='timestamp' href='#492408'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
Eg. include the blockhash/height in every wallet call
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492409'>
<a class='timestamp' href='#492409'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if it werent also trivial to keep the api consistent I might have a different view
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492410'>
<a class='timestamp' href='#492410'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gmaxwell: to be clear, I don&#x27;t think the concern (from me, anyway) was &quot;is this an api change&quot;, so I suppose I framed the question very poorly. The concern was more &quot;did we break reasonable assumptions by making this more async?&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365100' id='492411'>
<a class='timestamp' href='#492411'><time timestamp='2016-09-08T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I guess the problem really apperars when you listen to notifications (ZMQ)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492412'>
<a class='timestamp' href='#492412'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: it does not
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492413'>
<a class='timestamp' href='#492413'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Right.. we face the problem during the RPC tests...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492414'>
<a class='timestamp' href='#492414'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
if the wallet does its own block processing, that might be interesting, it could even consume the same notifications as third-party apps would be expected to (like zeromq or rpc communication)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492415'>
<a class='timestamp' href='#492415'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can control when the notification is sent out
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492416'>
<a class='timestamp' href='#492416'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
But I guess you will run more often into this concurrency issues when calling RPC off a ZMQ not.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365160' id='492417'>
<a class='timestamp' href='#492417'><time timestamp='2016-09-08T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: oops.  7946
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365220' id='492418'>
<a class='timestamp' href='#492418'><time timestamp='2016-09-08T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think it may be the case that the only ones affected by the asynchronicity is unit tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365220' id='492419'>
<a class='timestamp' href='#492419'><time timestamp='2016-09-08T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos: ty
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365220' id='492420'>
<a class='timestamp' href='#492420'><time timestamp='2016-09-08T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(that&#x27;s independent from the partial update thing, which we can fix in various other ways)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365280' id='492421'>
<a class='timestamp' href='#492421'><time timestamp='2016-09-08T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
wait why would anyone wait for getblockcount to go up...? there is no conceivable reason i could see to do that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365280' id='492422'>
<a class='timestamp' href='#492422'><time timestamp='2016-09-08T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
&quot;i do X, and i wait for Y to happen&quot; is something you can&#x27;t do in production env
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365280' id='492423'>
<a class='timestamp' href='#492423'><time timestamp='2016-09-08T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
we are talking about syncing two separate processes that are supposedly monitoring a blockchain right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492424'>
<a class='timestamp' href='#492424'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492425'>
<a class='timestamp' href='#492425'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields: basically the tests failing proved its an API change, maybe not an important one, but absolutely a change.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492426'>
<a class='timestamp' href='#492426'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;re even talking about something that happens entirely within one thread :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492427'>
<a class='timestamp' href='#492427'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: quick example: tracking how many confirmations your txs have and displaying on your site
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492428'>
<a class='timestamp' href='#492428'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
cfields: that would make sense to me, but sipa is talking about one thread?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365340' id='492429'>
<a class='timestamp' href='#492429'><time timestamp='2016-09-08T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
not saying it&#x27;s wise, but I can imagine that happening in the wild
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492430'>
<a class='timestamp' href='#492430'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure: you need more imagination
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492431'>
<a class='timestamp' href='#492431'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
kanzure: oh, ignoring the external process of course
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492432'>
<a class='timestamp' href='#492432'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
listsinceblock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492433'>
<a class='timestamp' href='#492433'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i have recently spent a bunch of time writing and validating software that does blockchain syncing between two stores where one is considered truthy and the other is considered a laggard
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492434'>
<a class='timestamp' href='#492434'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
kanzure: but all wallet updates and main updates happen within one thread in core
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365400' id='492435'>
<a class='timestamp' href='#492435'><time timestamp='2016-09-08T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
listsinceblock is also something you shouldn&#x27;t use. you should instead compute the most recent common block and then get the list of different blocks that your laggy side needs to consider.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365460' id='492436'>
<a class='timestamp' href='#492436'><time timestamp='2016-09-08T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure: listsinceblock is the thing people (not me) have been suggesting for years
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365460' id='492437'>
<a class='timestamp' href='#492437'><time timestamp='2016-09-08T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
looking at a block counter is backwards because it could go up and down
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365460' id='492438'>
<a class='timestamp' href='#492438'><time timestamp='2016-09-08T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
and treating it as a monotonic clock is what i would expect most application developers to do heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365520' id='492439'>
<a class='timestamp' href='#492439'><time timestamp='2016-09-08T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i didn&#x27;t look at the origiating issue that brought up this topic, so i&#x27;m sure my context is wrong here
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365520' id='492440'>
<a class='timestamp' href='#492440'><time timestamp='2016-09-08T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
here is a toy i was writing a few days ago <a href="https://gist.github.com/kanzure/2fa531afaf03fddd6568eb0212ac8c4c" class="link" target="_blank">https://gist.github.com/kanzure/2fa531afaf03fddd6568eb0212ac8c4c</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365580' id='492441'>
<a class='timestamp' href='#492441'><time timestamp='2016-09-08T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure: wallet processing of blocks is put into the background, wallet rpc calls can then return results reflecting a partial processing of a block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365580' id='492442'>
<a class='timestamp' href='#492442'><time timestamp='2016-09-08T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
fully async json-over-websockets API: <a href="https://github.com/ciphrex/CoinSocket" class="link" target="_blank">https://github.com/ciphrex/CoinSocket</a> ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365580' id='492443'>
<a class='timestamp' href='#492443'><time timestamp='2016-09-08T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ie tx a/b are both in block c but only a shows in the rpc calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365640' id='492444'>
<a class='timestamp' href='#492444'><time timestamp='2016-09-08T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
btw when people above are talking about &quot;unit tests&quot; they mean the rpc tests right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365640' id='492445'>
<a class='timestamp' href='#492445'><time timestamp='2016-09-08T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
kanzure: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365640' id='492446'>
<a class='timestamp' href='#492446'><time timestamp='2016-09-08T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: unit tests in bitcoind-speak :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365700' id='492447'>
<a class='timestamp' href='#492447'><time timestamp='2016-09-08T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
re: async, then yes i would suggest using zeromq notifications in the testing framework to get information about internal state or for how long to wait (instead of sleeps etc)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365700' id='492448'>
<a class='timestamp' href='#492448'><time timestamp='2016-09-08T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure: they&#x27;re talking about the functional tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365700' id='492449'>
<a class='timestamp' href='#492449'><time timestamp='2016-09-08T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
not the unit tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365820' id='492450'>
<a class='timestamp' href='#492450'><time timestamp='2016-09-08T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: the question isn&#x27;t about how to get the info, it&#x27;s about what the caller expects. you can query for the current height, then call into the wallet and expect to see tx&#x27;s from that height, only to find that they haven&#x27;t been processed yet.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365820' id='492451'>
<a class='timestamp' href='#492451'><time timestamp='2016-09-08T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
right... so you could naively sleep to wait for the wallet to be done, or you can query the wallet state (instead of chain height of the non-wallet components)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365820' id='492452'>
<a class='timestamp' href='#492452'><time timestamp='2016-09-08T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
so who&#x27;s wrong? the rpc for returning a height without fully processing? or the user for expecting them to be in sync?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365880' id='492453'>
<a class='timestamp' href='#492453'><time timestamp='2016-09-08T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
er in this case isn&#x27;t the rpc test also the user?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365880' id='492454'>
<a class='timestamp' href='#492454'><time timestamp='2016-09-08T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i believe there is a slight difference between normal users and the rpc tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365880' id='492455'>
<a class='timestamp' href='#492455'><time timestamp='2016-09-08T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
yea, i was just phrasing more generally
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365940' id='492456'>
<a class='timestamp' href='#492456'><time timestamp='2016-09-08T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in that rpc tests control the entire world, and use more simplistic means to measure progress
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365940' id='492457'>
<a class='timestamp' href='#492457'><time timestamp='2016-09-08T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: yes. i doubt many rpc users/scripts are hammering on block-height in tightish loops :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365940' id='492458'>
<a class='timestamp' href='#492458'><time timestamp='2016-09-08T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hope not, anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1473365940' id='492459'>
<a class='timestamp' href='#492459'><time timestamp='2016-09-08T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
so- for example- imagine you are operating a lot of bitcoin infrastructure. you do a bunch of per-block processing. when you are running functional/integration tests, you can&#x27;t run your test checks immediately after issuing a command because things take a while. so when do you expect to run? well you setup a hook and you ask your infrastructure to ping your tester as soon as the data&#x27;s available, or you poll for some internal state.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366000' id='492460'>
<a class='timestamp' href='#492460'><time timestamp='2016-09-08T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
(and polling is considered not ideal)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366000' id='492461'>
<a class='timestamp' href='#492461'><time timestamp='2016-09-08T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and non-polling methods exist
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366060' id='492462'>
<a class='timestamp' href='#492462'><time timestamp='2016-09-08T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we have -walletnotify for exactly this
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366060' id='492463'>
<a class='timestamp' href='#492463'><time timestamp='2016-09-08T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
walletnotify should certainly be used by the rpc tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366120' id='492464'>
<a class='timestamp' href='#492464'><time timestamp='2016-09-08T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
this raises another point: walletnotify should probably fire after all of a block&#x27;s transactions are processed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366180' id='492465'>
<a class='timestamp' href='#492465'><time timestamp='2016-09-08T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i would like zeromq notifications and -*notify notifications to be unified somehow, and eventually have much more distinct notifications for different events going on
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366180' id='492466'>
<a class='timestamp' href='#492466'><time timestamp='2016-09-08T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
changing walletnotify behavior and when it fires is sort of unkind to the users that rely on its existing behavior :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366180' id='492467'>
<a class='timestamp' href='#492467'><time timestamp='2016-09-08T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: and #8680 introduces blocking calls. So you could &quot;./bitcoin-cli waitfornewblock &amp;&amp; ./dosomething.sh&quot;, which would essentially be blocknotify. Obviously the same could be done for wallet stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366240' id='492468'>
<a class='timestamp' href='#492468'><time timestamp='2016-09-08T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I would like all pub/sub stuff in a separate layer ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366240' id='492469'>
<a class='timestamp' href='#492469'><time timestamp='2016-09-08T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
especially if it requires deep knowledge of account structure
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366240' id='492470'>
<a class='timestamp' href='#492470'><time timestamp='2016-09-08T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i feel like users are going to not understand how to use waitfornewblock. how are you going to stop them from treating that as a monotonic counter for each new lbock...?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366360' id='492471'>
<a class='timestamp' href='#492471'><time timestamp='2016-09-08T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: that&#x27;s a hack, hidden for users, just for tests. It&#x27;s a pretty bad idea to take action on an event so vague :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366360' id='492472'>
<a class='timestamp' href='#492472'><time timestamp='2016-09-08T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
btw i (sheepishly) made a one-line proposal about throwing a component into bitcoind to keep track of external application state, specifically to store a range or diff-set of blocks that an external application should be aware about, and then the implementation proposal would be &quot;please integrate against this&quot; and we give the user an endpoint for saying &quot;my application has processed the latest diff-workload x&quot;.  but this might be too ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366360' id='492473'>
<a class='timestamp' href='#492473'><time timestamp='2016-09-08T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
... kitchen-sinky.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366420' id='492474'>
<a class='timestamp' href='#492474'><time timestamp='2016-09-08T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
oh it&#x27;s for testing. hm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366420' id='492475'>
<a class='timestamp' href='#492475'><time timestamp='2016-09-08T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i was just using it as an example of an async approach.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366540' id='492476'>
<a class='timestamp' href='#492476'><time timestamp='2016-09-08T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
(the &quot;diff-workload x&quot; is specifically referring to a set of new blocks some of hwich might override previous blocks the other application was aware about. this makes the interface explicitly expose a concept of reorgs.)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366600' id='492477'>
<a class='timestamp' href='#492477'><time timestamp='2016-09-08T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
CodeShark: in your link i&#x27;m not seeing any tests for that library...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366600' id='492478'>
<a class='timestamp' href='#492478'><time timestamp='2016-09-08T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
the whole thing needs to be repackaged
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366720' id='492479'>
<a class='timestamp' href='#492479'><time timestamp='2016-09-08T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
just giving it as an example of how I think an API should work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366720' id='492480'>
<a class='timestamp' href='#492480'><time timestamp='2016-09-08T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
cfields: fwiw once i switched to notifications inside my own tests (for some external infrastructure) re: bitcoind integration, everything went much faster and i had much more information about failures. far less timeouts too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366720' id='492481'>
<a class='timestamp' href='#492481'><time timestamp='2016-09-08T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: what would bitcoind do with the knowledge that the application is done processing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366720' id='492482'>
<a class='timestamp' href='#492482'><time timestamp='2016-09-08T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
can we talk about solutions instead of vague design concerns?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366780' id='492483'>
<a class='timestamp' href='#492483'><time timestamp='2016-09-08T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
cfields: nothing. it&#x27;s for the benefit of the application. once bitcoind is informed about the application&#x27;s new state, it can discard the old diff information. that&#x27;s about all it would do...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366840' id='492484'>
<a class='timestamp' href='#492484'><time timestamp='2016-09-08T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
two subscription layers - one low level, the other much higher level
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366900' id='492485'>
<a class='timestamp' href='#492485'><time timestamp='2016-09-08T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
the low level layer only gives you basic events like new tip or new tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366900' id='492486'>
<a class='timestamp' href='#492486'><time timestamp='2016-09-08T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
dunno why sipa doesn&#x27;t like to discuss architecture :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366960' id='492487'>
<a class='timestamp' href='#492487'><time timestamp='2016-09-08T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473366960' id='492488'>
<a class='timestamp' href='#492488'><time timestamp='2016-09-08T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
it&#x27;s a serious problem for the ecosystem right now that there&#x27;s no good way for people to build apps
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367200' id='492489'>
<a class='timestamp' href='#492489'><time timestamp='2016-09-08T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: the more I think about it, the more I think that there needs to be a wallet rpc for getbalanceat(height)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367260' id='492490'>
<a class='timestamp' href='#492490'><time timestamp='2016-09-08T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i can&#x27;t think of anything that doesn&#x27;t introduce more problems except for explicit/atomic calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367260' id='492491'>
<a class='timestamp' href='#492491'><time timestamp='2016-09-08T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
should be a blockhash not a height
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367320' id='492492'>
<a class='timestamp' href='#492492'><time timestamp='2016-09-08T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367380' id='492493'>
<a class='timestamp' href='#492493'><time timestamp='2016-09-08T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: that makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367380' id='492494'>
<a class='timestamp' href='#492494'><time timestamp='2016-09-08T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
I think the reason today&#x27;s discussion devolved so quickly is because &quot;getblockcount&quot; is impossible to define, because there&#x27;s no global height. So the only fix is to ensure that we&#x27;re asking a specific interface a specific question. Then there&#x27;s no way of being out of sync because you&#x27;ve specified your constraints
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367380' id='492495'>
<a class='timestamp' href='#492495'><time timestamp='2016-09-08T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-4'> * sipa</span>&gt;
goes for a walk, without phonr
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367440' id='492496'>
<a class='timestamp' href='#492496'><time timestamp='2016-09-08T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
be back in a while
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367440' id='492497'>
<a class='timestamp' href='#492497'><time timestamp='2016-09-08T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
cya
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367500' id='492498'>
<a class='timestamp' href='#492498'><time timestamp='2016-09-08T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
cfields: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367560' id='492499'>
<a class='timestamp' href='#492499'><time timestamp='2016-09-08T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
there&#x27;s no such thing as &quot;what&#x27;s the current state of the network?&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367560' id='492500'>
<a class='timestamp' href='#492500'><time timestamp='2016-09-08T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
then it&#x27;s just a matter of how to handle the api. returning &quot;come back later&quot;, blocking until there&#x27;s an answer, or some callback mechanism.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367620' id='492501'>
<a class='timestamp' href='#492501'><time timestamp='2016-09-08T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
arguably if you need a callback, you should be using a different interface. as kanzure suggested above. I&#x27;m of the opinion that blocking is the way to go because that lets the user chain his own callback
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367680' id='492502'>
<a class='timestamp' href='#492502'><time timestamp='2016-09-08T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
blocking in what context? rpc ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367680' id='492503'>
<a class='timestamp' href='#492503'><time timestamp='2016-09-08T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
depends on what model you&#x27;re after - I think async is generally cleaner but requires a bit more clientside framework
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367740' id='492504'>
<a class='timestamp' href='#492504'><time timestamp='2016-09-08T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: yes, rpc blocks for a specified time (or forever) and returns when it has an answer, or timeout, or shutdown
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367740' id='492505'>
<a class='timestamp' href='#492505'><time timestamp='2016-09-08T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
oh. i&#x27;ve had so may issues with rpc socket timeouts that i haven&#x27;t traced down yet that i would recommend not considering that direction heh.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367740' id='492506'>
<a class='timestamp' href='#492506'><time timestamp='2016-09-08T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
(but also i haven&#x27;t been able to make good reports about these problems, so they don&#x27;t really count.)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367800' id='492507'>
<a class='timestamp' href='#492507'><time timestamp='2016-09-08T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: heh, i was actually surprised i didn&#x27;t bump into those during testing. good to know :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367800' id='492508'>
<a class='timestamp' href='#492508'><time timestamp='2016-09-08T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
well i think what i was doing could be considered &quot;torture testing&quot; and weird stuff, so.... yeah..
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367860' id='492509'>
<a class='timestamp' href='#492509'><time timestamp='2016-09-08T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
to some degree aren&#x27;t we already tracking peer state on the p2p layer? e.g. like which chains the peers seem to be following lately?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367860' id='492510'>
<a class='timestamp' href='#492510'><time timestamp='2016-09-08T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
or is that purely a function of the banning behavior heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367980' id='492511'>
<a class='timestamp' href='#492511'><time timestamp='2016-09-08T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
lately?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473367980' id='492512'>
<a class='timestamp' href='#492512'><time timestamp='2016-09-08T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
(by virtue that you could ban everyone feeding you unhelpful data, as opposed to tracking which blocks you think peers have already)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473368040' id='492513'>
<a class='timestamp' href='#492513'><time timestamp='2016-09-08T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
nevermind. just an abstract thought, it&#x27;s not important, i was thinking that &quot;peer communication&quot; is sometimes similar to &quot;application communication&quot; but more one-way. anyway, just a minor distraction.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473368160' id='492514'>
<a class='timestamp' href='#492514'><time timestamp='2016-09-08T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
we keep tabs on what they shouldn&#x27;t be sending, but i don&#x27;t remember to what extent
<br>
</div>

<div class='talk op-msg' data-timestamp='1473368340' id='492515'>
<a class='timestamp' href='#492515'><time timestamp='2016-09-08T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
a peer can query for inventory at any time regardless of whether it is in agreement with the node&#x27;s best chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473368400' id='492516'>
<a class='timestamp' href='#492516'><time timestamp='2016-09-08T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I think peers get sent invs whenever there are tip changes regardless
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371580' id='492517'>
<a class='timestamp' href='#492517'><time timestamp='2016-09-08T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
&quot;(and polling is considered not ideal)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371580' id='492518'>
<a class='timestamp' href='#492518'><time timestamp='2016-09-08T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371580' id='492519'>
<a class='timestamp' href='#492519'><time timestamp='2016-09-08T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
This bugs me. Polling is highly reliable. And we&#x27;re taking about things that have inherent latencies in real of seconds to tends of minutes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371640' id='492520'>
<a class='timestamp' href='#492520'><time timestamp='2016-09-08T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
polling is the correct way to interact with the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371640' id='492521'>
<a class='timestamp' href='#492521'><time timestamp='2016-09-08T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I do not know why people eschew polling as often as they do... there are contexts where its exactly the right tool and keeping track of a wallet state is likely one of them.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473371640' id='492522'>
<a class='timestamp' href='#492522'><time timestamp='2016-09-08T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
if you&#x27;re not polling you&#x27;re doing it wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372480' id='492523'>
<a class='timestamp' href='#492523'><time timestamp='2016-09-08T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
well one trivial example is in scenarios where you have long-term polling, you will miss the update and spend extra time waiting
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372480' id='492524'>
<a class='timestamp' href='#492524'><time timestamp='2016-09-08T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
this is apparent in scenarios with, say, exponential backoff
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372660' id='492525'>
<a class='timestamp' href='#492525'><time timestamp='2016-09-08T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure, call listtransactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372660' id='492526'>
<a class='timestamp' href='#492526'><time timestamp='2016-09-08T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
does the list contain a transaction you have previously seen?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372660' id='492527'>
<a class='timestamp' href='#492527'><time timestamp='2016-09-08T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
instead of hoping you catch wallet state transitions by polling, what about just having the wallet notify you directly of each change event? then you consume the feed/queue of events.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372660' id='492528'>
<a class='timestamp' href='#492528'><time timestamp='2016-09-08T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yes? great do nothing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372660' id='492529'>
<a class='timestamp' href='#492529'><time timestamp='2016-09-08T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
no? increase the list size
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372720' id='492530'>
<a class='timestamp' href='#492530'><time timestamp='2016-09-08T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
handle reorgs? need to call the blockchain things and do a bunch of work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372720' id='492531'>
<a class='timestamp' href='#492531'><time timestamp='2016-09-08T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
which application are you imagining for listtransactions in particular?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372780' id='492532'>
<a class='timestamp' href='#492532'><time timestamp='2016-09-08T22:13:00Z'>22:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
anything which needs to know that a payment has been made
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372780' id='492533'>
<a class='timestamp' href='#492533'><time timestamp='2016-09-08T22:13:00Z'>22:13</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i don&#x27;t know what the behavior of listtransactions is. how does it behave when a transaction has been removed from your chaintip..?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372900' id='492534'>
<a class='timestamp' href='#492534'><time timestamp='2016-09-08T22:15:00Z'>22:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure: it&#x27;s buried in the list and has -1 confirmations
<br>
</div>

<div class='talk op-msg' data-timestamp='1473372900' id='492535'>
<a class='timestamp' href='#492535'><time timestamp='2016-09-08T22:15:00Z'>22:15</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
for how long...? it occurs to me that listtransactions is probably a wallet-specific rpc command and that&#x27;s why i know so little about it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373020' id='492536'>
<a class='timestamp' href='#492536'><time timestamp='2016-09-08T22:17:00Z'>22:17</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
getting notified when a transaction is about to be permanently removed from that list sonuds like a useful thing, but you could probably infer that detail from polling regularly and knowing the lifecycle i guess.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373020' id='492537'>
<a class='timestamp' href='#492537'><time timestamp='2016-09-08T22:17:00Z'>22:17</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure, listtransactions only shows you transactions in your wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373020' id='492538'>
<a class='timestamp' href='#492538'><time timestamp='2016-09-08T22:17:00Z'>22:17</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
nothing is ever removed from the list there&#x27;s just a parameter which truncates the list
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373080' id='492539'>
<a class='timestamp' href='#492539'><time timestamp='2016-09-08T22:18:00Z'>22:18</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
listtransactions &quot;*&quot; 4294967295
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373080' id='492540'>
<a class='timestamp' href='#492540'><time timestamp='2016-09-08T22:18:00Z'>22:18</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
will give you all the transactions your wallet has ever seen
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373140' id='492541'>
<a class='timestamp' href='#492541'><time timestamp='2016-09-08T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
incremental updates and messaging would not require so much data transfer all at once. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373140' id='492542'>
<a class='timestamp' href='#492542'><time timestamp='2016-09-08T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
kanzure, messaging is unreliable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373140' id='492543'>
<a class='timestamp' href='#492543'><time timestamp='2016-09-08T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
polling is inherently reliable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373140' id='492544'>
<a class='timestamp' href='#492544'><time timestamp='2016-09-08T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
fin
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373200' id='492545'>
<a class='timestamp' href='#492545'><time timestamp='2016-09-08T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we shouldn&#x27;t make assumptions about how people use the api
<br>
</div>

<div class='talk op-msg' data-timestamp='1473373380' id='492546'>
<a class='timestamp' href='#492546'><time timestamp='2016-09-08T22:23:00Z'>22:23</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
my above concerns are mostly about polling interval
<br>
</div>

<div class='talk op-msg' data-timestamp='1473374040' id='492547'>
<a class='timestamp' href='#492547'><time timestamp='2016-09-08T22:34:00Z'>22:34</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
and blockheight can&#x27;t be a heartbeat
<br>
</div>

<div class='talk op-msg' data-timestamp='1473375240' id='492548'>
<a class='timestamp' href='#492548'><time timestamp='2016-09-08T22:54:00Z'>22:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: <a href="https://github.com/TheBlueMatt/bitcoin/commit/96cef326f9184aefd1c562f64a21298a15f0adde" class="link" target="_blank">https://github.com/TheBlueMatt/bitcoin/commit/96cef326f9184aefd1c562f64a21298a15f0adde</a> simplifies the total diff from master to be more readable, to me...it matches the bip, but another way to look at it is that you have two booleans: which version of compact blocks they want (which you use to send to them) and whether they will send us segwit cmpctblocks...you simply introduce the the do-they-support-v2 bool as an additional 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473375240' id='492549'>
<a class='timestamp' href='#492549'><time timestamp='2016-09-08T22:54:00Z'>22:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
check before requesting cmpcblocks and otherwise dont need the complicated other semantics
<br>
</div>

<div class='talk op-msg' data-timestamp='1473375240' id='492550'>
<a class='timestamp' href='#492550'><time timestamp='2016-09-08T22:54:00Z'>22:54</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(warning: mostly untested...it compiles, though :p)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473375720' id='492551'>
<a class='timestamp' href='#492551'><time timestamp='2016-09-08T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ehh, nvm, need to fix a bug there, but I&#x27;m tired so will do it later/tomorrow
<br>
</div>

</div>
</section>

</body>
</html>
