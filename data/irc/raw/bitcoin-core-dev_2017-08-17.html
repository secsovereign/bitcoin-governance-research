<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2017-08-17
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2017-08-17' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:23 UTC</pre>
<pre><a href="/bitcoin-core-dev/2017-07-17">&lt;</a><span class='header'>   August 2017    </span><a href="/bitcoin-core-dev/2017-09-17">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;       <a class="" href="/bitcoin-core-dev/2017-08-01">1</a>  <a class="" href="/bitcoin-core-dev/2017-08-02">2</a>  <a class="" href="/bitcoin-core-dev/2017-08-03">3</a>  <a class="" href="/bitcoin-core-dev/2017-08-04">4</a>  <a class="" href="/bitcoin-core-dev/2017-08-05">5</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2017-08-06">6</a>  <a class="" href="/bitcoin-core-dev/2017-08-07">7</a>  <a class="" href="/bitcoin-core-dev/2017-08-08">8</a>  <a class="" href="/bitcoin-core-dev/2017-08-09">9</a> <a class="" href="/bitcoin-core-dev/2017-08-10">10</a> <a class="" href="/bitcoin-core-dev/2017-08-11">11</a> <a class="" href="/bitcoin-core-dev/2017-08-12">12</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-13">13</a> <a class="" href="/bitcoin-core-dev/2017-08-14">14</a> <a class="" href="/bitcoin-core-dev/2017-08-15">15</a> <a class="" href="/bitcoin-core-dev/2017-08-16">16</a> <a class="current" href="/bitcoin-core-dev/2017-08-17">17</a> <a class="" href="/bitcoin-core-dev/2017-08-18">18</a> <a class="" href="/bitcoin-core-dev/2017-08-19">19</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-20">20</a> <a class="" href="/bitcoin-core-dev/2017-08-21">21</a> <a class="" href="/bitcoin-core-dev/2017-08-22">22</a> <a class="" href="/bitcoin-core-dev/2017-08-23">23</a> <a class="" href="/bitcoin-core-dev/2017-08-24">24</a> <a class="" href="/bitcoin-core-dev/2017-08-25">25</a> <a class="" href="/bitcoin-core-dev/2017-08-26">26</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-08-27">27</a> <a class="" href="/bitcoin-core-dev/2017-08-28">28</a> <a class="" href="/bitcoin-core-dev/2017-08-29">29</a> <a class="" href="/bitcoin-core-dev/2017-08-30">30</a> <a class="" href="/bitcoin-core-dev/2017-08-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1502928000' id='564775'>
<a class='timestamp' href='#564775'><time timestamp='2017-08-17T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats a lot, time for a reback.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928000' id='564776'>
<a class='timestamp' href='#564776'><time timestamp='2017-08-17T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
repack.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928000' id='564777'>
<a class='timestamp' href='#564777'><time timestamp='2017-08-17T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
also other unmerged branches though
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928000' id='564778'>
<a class='timestamp' href='#564778'><time timestamp='2017-08-17T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
sipa might even have elements.git branches in there
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928120' id='564779'>
<a class='timestamp' href='#564779'><time timestamp='2017-08-17T00:02:00Z'>00:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no     
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928180' id='564780'>
<a class='timestamp' href='#564780'><time timestamp='2017-08-17T00:03:00Z'>00:03</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
welp.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502928600' id='564781'>
<a class='timestamp' href='#564781'><time timestamp='2017-08-17T00:10:00Z'>00:10</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
cfields: it occurs to me the reason the dir is dirty, is because it&#x27;s missing files; so if we want to defer doing a real fix, we can alternatively fix the missing-files issue instead, by generating the tarball from git-archive
<br>
</div>

<div class='talk op-msg' data-timestamp='1502929740' id='564782'>
<a class='timestamp' href='#564782'><time timestamp='2017-08-17T00:29:00Z'>00:29</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
luke-jr: I believe the dir is dirty because we extract the tarball into it
<br>
</div>

<div class='talk op-msg' data-timestamp='1502929860' id='564783'>
<a class='timestamp' href='#564783'><time timestamp='2017-08-17T00:31:00Z'>00:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
that doesn&#x27;t make sense..
<br>
</div>

<div class='talk op-msg' data-timestamp='1502931360' id='564784'>
<a class='timestamp' href='#564784'><time timestamp='2017-08-17T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
<a href="https://medium.com/@DCGco/bitcoin-scaling-agreement-at-consensus-2017-133521fe9a77" class="link" target="_blank">https://medium.com/@DCGco/bitcoin-scaling-agreement-at-consensus-2017-133521fe9a77</a> 
<br>
</div>

<div class='talk op-msg' data-timestamp='1502931360' id='564785'>
<a class='timestamp' href='#564785'><time timestamp='2017-08-17T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
sorry my 2yo grabbed my mouse
<br>
</div>

<div class='talk op-msg' data-timestamp='1502931780' id='564195'>
<a class='timestamp' href='#564195'><time timestamp='2017-08-17T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Wow, this is super dishonest <a href="https://segwit2x.github.io/segwit2x-announce.html" class="link" target="_blank">https://segwit2x.github.io/segwit2x-announce.html</a>  ... &quot;Bitcoin Upgrade&quot; is untrue... it claims Bitcoin &quot;Classic&quot; and unlimited are compatible &quot;Compatible Fully-Validating Node Software&quot; but they don&#x27;t implement the S2X rules and don&#x27;t even implement segwit!
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932080' id='564786'>
<a class='timestamp' href='#564786'><time timestamp='2017-08-17T01:08:00Z'>01:08</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
luke-jr: I see what you mean
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932080' id='564787'>
<a class='timestamp' href='#564787'><time timestamp='2017-08-17T01:08:00Z'>01:08</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
praxeology: I feel you too
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932560' id='564788'>
<a class='timestamp' href='#564788'><time timestamp='2017-08-17T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-7'> Cryptocide</span>&gt;
Abra|BitClub Network|Bitcoin.com|BitFury|BitGo|Bitmain|BitPay Blockchain|Bloq|BTCC|Circle|Ledger|RSK Labs|Xapo, no thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932620' id='564196'>
<a class='timestamp' href='#564196'><time timestamp='2017-08-17T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: Classic and BU merged 2X code
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932620' id='564789'>
<a class='timestamp' href='#564789'><time timestamp='2017-08-17T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
why XORing them? i don&#x27;t get it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932620' id='564790'>
<a class='timestamp' href='#564790'><time timestamp='2017-08-17T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
er, ORing
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932680' id='564197'>
<a class='timestamp' href='#564197'><time timestamp='2017-08-17T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
funny how they didn&#x27;t include XT, Knots, btcsuite, et al on their lists
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932680' id='564791'>
<a class='timestamp' href='#564791'><time timestamp='2017-08-17T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
yes. anyway.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564198'>
<a class='timestamp' href='#564198'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: they merged segwit?!
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564199'>
<a class='timestamp' href='#564199'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: no, just 2X
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564200'>
<a class='timestamp' href='#564200'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
it&#x27;s still super dishonest, just not <b>*totally*</b> bogus
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564201'>
<a class='timestamp' href='#564201'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
then they&#x27;re not compatible fully validating s2x nodes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564202'>
<a class='timestamp' href='#564202'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
remember that crowd thinks SPV is fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932740' id='564203'>
<a class='timestamp' href='#564203'><time timestamp='2017-08-17T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
they don&#x27;t list bitcoinj
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932800' id='564204'>
<a class='timestamp' href='#564204'><time timestamp='2017-08-17T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or any other SPV client.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932800' id='564205'>
<a class='timestamp' href='#564205'><time timestamp='2017-08-17T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
‎[01:19:28] ‎&lt;‎luke-jr‎&gt;‎ it&#x27;s still super dishonest, just not <b>*totally*</b> bogus
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932860' id='564206'>
<a class='timestamp' href='#564206'><time timestamp='2017-08-17T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
if they said &quot;[compatible fully validating nodes] btc1 \n [compatible wallet software] bitcoin classic\n&quot; it would n... oh okay, well I suppose because it&#x27;s not a lie in every possible sense it&#x27;s okay. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1502932860' id='564207'>
<a class='timestamp' href='#564207'><time timestamp='2017-08-17T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
in other news, Texas Bitcoin conference is promoting 2X as if it&#x27;s Bitcoin, so I think that makes the decision to go simple (ie, not to)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934120' id='564792'>
<a class='timestamp' href='#564792'><time timestamp='2017-08-17T01:42:00Z'>01:42</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
I&#x27;m running a modified Bitcoin Core node to do some profiling on where resources are spent (CPU cycles and bandwidth in particular) and am seeing some really weird stuff. E.g:
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934120' id='564793'>
<a class='timestamp' href='#564793'><time timestamp='2017-08-17T01:42:00Z'>01:42</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
 0.77877            27892        282511326         24083459                0 131703419 SendMessages.inventory.trickle (tx-relay).LOCK(cs)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934180' id='564794'>
<a class='timestamp' href='#564794'><time timestamp='2017-08-17T01:43:00Z'>01:43</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
The columns are &quot;portion of CPU used&quot;, &quot;min CPU cycles&quot;, &quot;max CPU cycles&quot;, &quot;medium CPU cycles per call&quot;, &quot;bandwidth per call&quot;, &quot;# of calls&quot;, &quot;code path&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934240' id='564795'>
<a class='timestamp' href='#564795'><time timestamp='2017-08-17T01:44:00Z'>01:44</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
So the LOCK(cs) in SendMessages for inventory for trickle for the tx relay part is taking 78% of all CPU cycles for my node. Does that seem normal?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934300' id='564796'>
<a class='timestamp' href='#564796'><time timestamp='2017-08-17T01:45:00Z'>01:45</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Also baffled by the number of calls. 131 million. I started profiling yesterday.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934540' id='564797'>
<a class='timestamp' href='#564797'><time timestamp='2017-08-17T01:49:00Z'>01:49</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
This is probably from the mempool.info(hash) call in the while loop btw. That probably explains the high # of calls, but 131 million in 24 hours is 1500/second. Maybe my profiling code is broken.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934660' id='564798'>
<a class='timestamp' href='#564798'><time timestamp='2017-08-17T01:51:00Z'>01:51</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
... Actually, it rose by 38k from 01:48:49 to 01:50:00, so doesn&#x27;t seem improbable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502934780' id='564208'>
<a class='timestamp' href='#564208'><time timestamp='2017-08-17T01:53:00Z'>01:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
BlueMatt: is there an ascii middle finger? 3- or something?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936100' id='564209'>
<a class='timestamp' href='#564209'><time timestamp='2017-08-17T02:15:00Z'>02:15</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
This grant doesn&#x27;t appear to be checked in ThreadOpenConnections. <a href="https://github.com/bitcoin/bitcoin/blob/master/src/net.cpp#L1712" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/net.cpp#L1712</a>. Only the one in ProcessOneShot is. Why is that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936220' id='564210'>
<a class='timestamp' href='#564210'><time timestamp='2017-08-17T02:17:00Z'>02:17</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
Ah, got it. It&#x27;s the fTry constructor param.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936580' id='564799'>
<a class='timestamp' href='#564799'><time timestamp='2017-08-17T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sometimes profiling is confused by locks. (and/or moderately condented locks in an otherwise inactive process can be a high percentage due to spinning).
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936580' id='564800'>
<a class='timestamp' href='#564800'><time timestamp='2017-08-17T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Sounds like it might be interesting.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936580' id='564801'>
<a class='timestamp' href='#564801'><time timestamp='2017-08-17T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
Re: <a href="https://docs.google.com/document/d/1y6Hsqdg1xBrJY4dFeKP6y05XCceJoVMs0_M_VwKFReM/edit" class="link" target="_blank">https://docs.google.com/document/d/1y6Hsqdg1xBrJY4dFeKP6y05XCceJoVMs0_M_VwKFReM/edit</a>  Maybe it would be a good idea to communicate with the exchanges and check and see who will continue to support Bitcoin Core&#x27;s chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936580' id='564802'>
<a class='timestamp' href='#564802'><time timestamp='2017-08-17T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Everyone okay with me doing a presentation on 0.15 improvements to a local group in 1.5 weeks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936760' id='564803'>
<a class='timestamp' href='#564803'><time timestamp='2017-08-17T02:26:00Z'>02:26</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
Like... I know that BitPay and Coinbase are declaring that they will support Segwit2x... has any exchange declared that they will continue to support Bitcoin (Bitcoin Core&#x27;s rules)?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936820' id='564804'>
<a class='timestamp' href='#564804'><time timestamp='2017-08-17T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
gmaxwell: there is some amount of overhead as I am doing the profiling on my own. Maybe that&#x27;s the cause for the high portion of time spent there, but it still seems like a lot of LOCK calls, regardless of actual CPU cycle count. Would be cool if the mempool could be copied once and then not lock cs at all. Code is here btw: <a href="https://github.com/kallewoof/bitcoin/tree/profile-resources" class="link" target="_blank">https://github.com/kallewoof/bitcoin/tree/profile-resources</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936880' id='564805'>
<a class='timestamp' href='#564805'><time timestamp='2017-08-17T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
copying the whole mempool?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936880' id='564806'>
<a class='timestamp' href='#564806'><time timestamp='2017-08-17T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Only the hashes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936880' id='564807'>
<a class='timestamp' href='#564807'><time timestamp='2017-08-17T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936940' id='564808'>
<a class='timestamp' href='#564808'><time timestamp='2017-08-17T02:29:00Z'>02:29</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Actually that wouldn&#x27;t work. It uses txinfo for feeRate and tx etc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502936940' id='564809'>
<a class='timestamp' href='#564809'><time timestamp='2017-08-17T02:29:00Z'>02:29</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
kallewoof: does your bitcoin process have enough memory to hold the entire chainstate?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937000' id='564810'>
<a class='timestamp' href='#564810'><time timestamp='2017-08-17T02:30:00Z'>02:30</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
err, what -dbcache are you using?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937000' id='564811'>
<a class='timestamp' href='#564811'><time timestamp='2017-08-17T02:30:00Z'>02:30</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
it has 16 GB of RAM. 223 MB free atm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937000' id='564812'>
<a class='timestamp' href='#564812'><time timestamp='2017-08-17T02:30:00Z'>02:30</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Default
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937000' id='564813'>
<a class='timestamp' href='#564813'><time timestamp='2017-08-17T02:30:00Z'>02:30</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
(dbcache)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937060' id='564814'>
<a class='timestamp' href='#564814'><time timestamp='2017-08-17T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
are you profiling while synching from genesis, or from the latest tip, or what?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937060' id='564815'>
<a class='timestamp' href='#564815'><time timestamp='2017-08-17T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
praxeology: he&#x27;s talking about inv relay
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937060' id='564816'>
<a class='timestamp' href='#564816'><time timestamp='2017-08-17T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not about sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937060' id='564817'>
<a class='timestamp' href='#564817'><time timestamp='2017-08-17T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
The node is fully synced up. I restarted it with profiling enabled so it&#x27;s from tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937180' id='564818'>
<a class='timestamp' href='#564818'><time timestamp='2017-08-17T02:33:00Z'>02:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jonasnick opened pull request #11083: Fix combinerawtransaction RPC help result section (master...fix-combinerawtransaction-help) <a href="https://github.com/bitcoin/bitcoin/pull/11083" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11083</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937300' id='564819'>
<a class='timestamp' href='#564819'><time timestamp='2017-08-17T02:35:00Z'>02:35</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
kallewoof: is your profiler sampling instruction pointer positions, or is it timing each function call?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937420' id='564820'>
<a class='timestamp' href='#564820'><time timestamp='2017-08-17T02:37:00Z'>02:37</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
It&#x27;s using rdtsc. Not sure which that falls under.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937420' id='564821'>
<a class='timestamp' href='#564821'><time timestamp='2017-08-17T02:37:00Z'>02:37</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
the latter can really mess up measurements
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937480' id='564822'>
<a class='timestamp' href='#564822'><time timestamp='2017-08-17T02:38:00Z'>02:38</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
and potentially the profile is not actually measuring cpu usage... that could be misleading, instead it could just be saying where a thread is sleeping
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937600' id='564823'>
<a class='timestamp' href='#564823'><time timestamp='2017-08-17T02:40:00Z'>02:40</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Right. It definitely keeps ticking even while waiting for locks. I was more intereted in the # of LOCK() calls/second rather than the actual CPU usage in this case, though.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937660' id='564824'>
<a class='timestamp' href='#564824'><time timestamp='2017-08-17T02:41:00Z'>02:41</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Since the code is auto-profiling all locks, I can simply reduct the lock times from the parent to get &quot;time spent excluding lock wait times&quot;, if that seemed useful.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937780' id='564825'>
<a class='timestamp' href='#564825'><time timestamp='2017-08-17T02:43:00Z'>02:43</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
is it measuring the number of lock calls? or the number of times it sampled with the thread being at the Lock() call?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502937780' id='564826'>
<a class='timestamp' href='#564826'><time timestamp='2017-08-17T02:43:00Z'>02:43</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
# of calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938020' id='564827'>
<a class='timestamp' href='#564827'><time timestamp='2017-08-17T02:47:00Z'>02:47</time></a>
&lt;<span class='nick nick-3'> praxeology</span>&gt;
Does bitcoin&#x27;s networking code operate on polling or interrupt?
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938020' id='564828'>
<a class='timestamp' href='#564828'><time timestamp='2017-08-17T02:47:00Z'>02:47</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
I logged every entry into the tx relay loop and logged the size of vInvTx. I don&#x27;t have a lot of connections yet (14 or so) but I&#x27;m seeing 4-5 per second. Example of vInvTx sizes: 5, 0, 5, 0, 4, 4, 5, 1, 0, 1, 5, 1, 2, 0, 26, 6, 5, 0, 5, 5, 0, 5, 0, 2, 2, 13, 52, 0, 0, 0, 4, 4, 11, 21
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938080' id='564829'>
<a class='timestamp' href='#564829'><time timestamp='2017-08-17T02:48:00Z'>02:48</time></a>
&lt;<span class='nick nick-4'> Fibonacci</span>&gt;
o/     
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938140' id='564830'>
<a class='timestamp' href='#564830'><time timestamp='2017-08-17T02:49:00Z'>02:49</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
That doesn&#x27;t match up with 1500/second at all, but maybe with more connections. Or maybe there was a bunch of txs in the last 24 hours.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938380' id='564831'>
<a class='timestamp' href='#564831'><time timestamp='2017-08-17T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Actually, for comparison, the path into &quot;trickle (tx-relay)&quot; only has 543732 instances, which would mean there are on average 133867681/543732=246 calls to LOCK(cs) per entry. Huh.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938560' id='564832'>
<a class='timestamp' href='#564832'><time timestamp='2017-08-17T02:56:00Z'>02:56</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kallewoof: you can use my lock dumper to profile: <a href="https://github.com/theuni/bitcoin/commit/be49a294a240ec81a901af1aaabbba2172d38dc1" class="link" target="_blank">https://github.com/theuni/bitcoin/commit/be49a294a240ec81a901af1aaabbba2172d38dc1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938620' id='564833'>
<a class='timestamp' href='#564833'><time timestamp='2017-08-17T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
it should cherry-pick cleanly
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938620' id='564834'>
<a class='timestamp' href='#564834'><time timestamp='2017-08-17T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
lock stats are dumped at shutdown
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938620' id='564835'>
<a class='timestamp' href='#564835'><time timestamp='2017-08-17T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i should really clean that up and PR it
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938620' id='564836'>
<a class='timestamp' href='#564836'><time timestamp='2017-08-17T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-15'> * cfields</span>&gt;
throws it on the pile
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938620' id='564837'>
<a class='timestamp' href='#564837'><time timestamp='2017-08-17T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Nice :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938680' id='564838'>
<a class='timestamp' href='#564838'><time timestamp='2017-08-17T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
should tell you how long it&#x27;s locked, and what percentage of the thread time it spent in it
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938680' id='564839'>
<a class='timestamp' href='#564839'><time timestamp='2017-08-17T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
I sort of already know that. What is confusing me is the # of times it is locking.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938680' id='564840'>
<a class='timestamp' href='#564840'><time timestamp='2017-08-17T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
350 million in &lt;24h is a lot of LOCK()s.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502938680' id='564841'>
<a class='timestamp' href='#564841'><time timestamp='2017-08-17T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
heh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940420' id='564842'>
<a class='timestamp' href='#564842'><time timestamp='2017-08-17T03:27:00Z'>03:27</time></a>
&lt;<span class='nick nick-4'> Fibonacci</span>&gt;
Bitcointalk will soon be irrelevant in the cryptoverse. Alternative methods for coin legitimization are popping up that will more carefully scrutinize developers intentions and identities, while at the same time allowing for an influx of new blood not associated with the corrupt financial institutions. Keep your eyes open for this shifting to a new paradigm 
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940480' id='564843'>
<a class='timestamp' href='#564843'><time timestamp='2017-08-17T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
!ops spammer
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940480' id='564844'>
<a class='timestamp' href='#564844'><time timestamp='2017-08-17T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-4'> Fibonacci</span>&gt;
That wasn&#x27;t spam Luke-jr
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940480' id='564845'>
<a class='timestamp' href='#564845'><time timestamp='2017-08-17T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sure looks like it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940480' id='564846'>
<a class='timestamp' href='#564846'><time timestamp='2017-08-17T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-4'> Fibonacci</span>&gt;
I typed that myself
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940540' id='564847'>
<a class='timestamp' href='#564847'><time timestamp='2017-08-17T03:29:00Z'>03:29</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
considering this channel has nothing to do with bitcointalk, altcoins, etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940540' id='564848'>
<a class='timestamp' href='#564848'><time timestamp='2017-08-17T03:29:00Z'>03:29</time></a>
&lt;<span class='nick nick-4'> Fibonacci</span>&gt;
well I think it&#x27;s time
<br>
</div>

<div class='talk op-msg' data-timestamp='1502940900' id='564849'>
<a class='timestamp' href='#564849'><time timestamp='2017-08-17T03:35:00Z'>03:35</time></a>
&lt;<span class='nick nick-7'> Cryptocide</span>&gt;
People can code whatever they want wherever, and if they have great coding skills they will shine, what is the issue we all agree on this
<br>
</div>

<div class='talk op-msg' data-timestamp='1502941680' id='564850'>
<a class='timestamp' href='#564850'><time timestamp='2017-08-17T03:48:00Z'>03:48</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Found part of why there are so many locks. It&#x27;s locking cs twice for every entry in vInvTx, which is anything from a few up to 100+. With 4-5 per sec that adds up fast. The first lock is for the CompareInvMempoolOrder (std::pop_heap call at start of loop), and the second is for the actual mempool.info(hash) call.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502942100' id='564851'>
<a class='timestamp' href='#564851'><time timestamp='2017-08-17T03:55:00Z'>03:55</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Actually, since the CompareInvMempoolOrder is a sorter, and each sort calls CompareDepthAndScore which locks cs, the number of lock calls are dependent on the size of the vector. That definitely explains things...
<br>
</div>

<div class='talk op-msg' data-timestamp='1502942220' id='564852'>
<a class='timestamp' href='#564852'><time timestamp='2017-08-17T03:57:00Z'>03:57</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
I think this could all be solved by making a sub-mempool which takes a list of hashes and simply pulls them out of the mempool once. These operations could then be done on the sub-mempool without locking anything or at least without locking cs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502942700' id='564211'>
<a class='timestamp' href='#564211'><time timestamp='2017-08-17T04:05:00Z'>04:05</time></a>
&lt;<span class='nick nick-12'> shesek</span>&gt;
gmaxwell, luke-jr: I mentioned that to them: <a href="https://github.com/segwit2x/segwit2x.github.io/pull/6#discussion_r132615997" class="link" target="_blank">https://github.com/segwit2x/segwit2x.github.io/pull/6#discussion_r132615997</a> <a href="https://github.com/segwit2x/segwit2x.github.io/pull/6#discussion_r132616222" class="link" target="_blank">https://github.com/segwit2x/segwit2x.github.io/pull/6#discussion_r132616222</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1502942700' id='564212'>
<a class='timestamp' href='#564212'><time timestamp='2017-08-17T04:05:00Z'>04:05</time></a>
&lt;<span class='nick nick-12'> shesek</span>&gt;
they ignored me.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502942820' id='564213'>
<a class='timestamp' href='#564213'><time timestamp='2017-08-17T04:07:00Z'>04:07</time></a>
&lt;<span class='nick nick-7'> chainhead</span>&gt;
I also mentioned it, multiple times and they deny that it is even possibly misleading
<br>
</div>

<div class='talk op-msg' data-timestamp='1502946120' id='564853'>
<a class='timestamp' href='#564853'><time timestamp='2017-08-17T05:02:00Z'>05:02</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Woah.. size of vInvTx after running for a bit (grabbed latest bunch in order): 4596, 4, 0, 7, 2, 8, 3836, 4370, 21, 2, 3, 3806, 1, 5, 4340, 16, 16, 0, 4121, 7, 4478, 11, 16, 0, 4095, 4452, 4264, 5, 9, 6, 1, 4061, 11, 11, 4579, 4544, 7, 10, 1, 1, 0, 4318, 18, 54, 3, 3, 1, 1, 0, 0, 4421, 13. 4+k entries would definitely result in a lot of locking.
<br>
</div>

<div class='talk op-msg' data-timestamp='1502946180' id='564854'>
<a class='timestamp' href='#564854'><time timestamp='2017-08-17T05:03:00Z'>05:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
kallewoof: wow
<br>
</div>

</div>
</section>

</body>
</html>
