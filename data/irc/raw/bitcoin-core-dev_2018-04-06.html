<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2018-04-06
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2018-04-06' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:22 UTC</pre>
<pre><a href="/bitcoin-core-dev/2018-03-06">&lt;</a><span class='header'>    April 2018    </span><a href="/bitcoin-core-dev/2018-05-06">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A; <a class="" href="/bitcoin-core-dev/2018-04-01">1</a>  <a class="" href="/bitcoin-core-dev/2018-04-02">2</a>  <a class="" href="/bitcoin-core-dev/2018-04-03">3</a>  <a class="" href="/bitcoin-core-dev/2018-04-04">4</a>  <a class="" href="/bitcoin-core-dev/2018-04-05">5</a>  <a class="current" href="/bitcoin-core-dev/2018-04-06">6</a>  <a class="" href="/bitcoin-core-dev/2018-04-07">7</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-04-08">8</a>  <a class="" href="/bitcoin-core-dev/2018-04-09">9</a> <a class="" href="/bitcoin-core-dev/2018-04-10">10</a> <a class="" href="/bitcoin-core-dev/2018-04-11">11</a> <a class="" href="/bitcoin-core-dev/2018-04-12">12</a> <a class="" href="/bitcoin-core-dev/2018-04-13">13</a> <a class="" href="/bitcoin-core-dev/2018-04-14">14</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-04-15">15</a> <a class="" href="/bitcoin-core-dev/2018-04-16">16</a> <a class="" href="/bitcoin-core-dev/2018-04-17">17</a> <a class="" href="/bitcoin-core-dev/2018-04-18">18</a> <a class="" href="/bitcoin-core-dev/2018-04-19">19</a> <a class="" href="/bitcoin-core-dev/2018-04-20">20</a> <a class="" href="/bitcoin-core-dev/2018-04-21">21</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-04-22">22</a> <a class="" href="/bitcoin-core-dev/2018-04-23">23</a> <a class="" href="/bitcoin-core-dev/2018-04-24">24</a> <a class="" href="/bitcoin-core-dev/2018-04-25">25</a> <a class="" href="/bitcoin-core-dev/2018-04-26">26</a> <a class="" href="/bitcoin-core-dev/2018-04-27">27</a> <a class="" href="/bitcoin-core-dev/2018-04-28">28</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-04-29">29</a> <a class="" href="/bitcoin-core-dev/2018-04-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1522977600' id='606843'>
<a class='timestamp' href='#606843'><time timestamp='2018-04-06T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
right, different VMs, but same test_bitcion.exe, under wine coinselector_tests/knapsack_solver_test takes 581.8 seconds, under windows server 2016 w/ updates it takes 31.4s
<br>
</div>

<div class='talk op-msg' data-timestamp='1522977660' id='606844'>
<a class='timestamp' href='#606844'><time timestamp='2018-04-06T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
is there a way to do profiling in wine?
<br>
</div>

<div class='talk op-msg' data-timestamp='1522977720' id='606845'>
<a class='timestamp' href='#606845'><time timestamp='2018-04-06T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
i figure i&#x27;ll try a newer version of wine than what&#x27;s in trusty first
<br>
</div>

<div class='talk op-msg' data-timestamp='1522978740' id='606846'>
<a class='timestamp' href='#606846'><time timestamp='2018-04-06T01:39:00Z'>01:39</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
same version of wine on xenial seems no better, unsurprisingly; but, wine 3.0 at home seems much faster
<br>
</div>

<div class='talk op-msg' data-timestamp='1522978980' id='606847'>
<a class='timestamp' href='#606847'><time timestamp='2018-04-06T01:43:00Z'>01:43</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
total of 236s for the entire test suite under wine 3.0 vs 193s under windows server; different hardware though
<br>
</div>

<div class='talk op-msg' data-timestamp='1522980420' id='606848'>
<a class='timestamp' href='#606848'><time timestamp='2018-04-06T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
wine1.8 from some random ppa on xenial also gets the entire test suite in 377s or so, different hardware yet again
<br>
</div>

<div class='talk op-msg' data-timestamp='1522980480' id='606849'>
<a class='timestamp' href='#606849'><time timestamp='2018-04-06T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
oh, bugger, that&#x27;s wine3.0 as well, should have paid more attention when installing
<br>
</div>

<div class='talk op-msg' data-timestamp='1522980600' id='606850'>
<a class='timestamp' href='#606850'><time timestamp='2018-04-06T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] lachlangreenbank opened pull request #12898: Comment cleanup and consistency (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/12898" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12898</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1522990920' id='606851'>
<a class='timestamp' href='#606851'><time timestamp='2018-04-06T05:02:00Z'>05:02</time></a>
&lt;<span class='nick nick-11'> karl2</span>&gt;
sipa: you can use gprof with wine binaries as normal, I found out the other day. It wasn&#x27;t particularly exciting stuff when I tried to track down job #2 timeout thing the other day, though. Maybe running different wine versions will trigger it, like aj is saying!
<br>
</div>

<div class='talk op-msg' data-timestamp='1522990920' id='606852'>
<a class='timestamp' href='#606852'><time timestamp='2018-04-06T05:02:00Z'>05:02</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/2" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/2</a> | Long-term, safe, store-of-value · Issue #2 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1522991280' id='606853'>
<a class='timestamp' href='#606853'><time timestamp='2018-04-06T05:08:00Z'>05:08</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] AkioNak opened pull request #12899: macOS: Prevent Xcode 9.3 build warnings (master...preventxcodebuildwarnings) <a href="https://github.com/bitcoin/bitcoin/pull/12899" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12899</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1522995420' id='606854'>
<a class='timestamp' href='#606854'><time timestamp='2018-04-06T06:17:00Z'>06:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] martintibor40 opened pull request #12900: Update README.md (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/12900" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12900</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1522995420' id='606855'>
<a class='timestamp' href='#606855'><time timestamp='2018-04-06T06:17:00Z'>06:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake closed pull request #12900: Update README.md (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/12900" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12900</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523005860' id='606856'>
<a class='timestamp' href='#606856'><time timestamp='2018-04-06T09:11:00Z'>09:11</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] practicalswift opened pull request #12901: build: Show enabled sanitizers in configure output (master...print-enabled-sanitizers-in-configure-output) <a href="https://github.com/bitcoin/bitcoin/pull/12901" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12901</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523009880' id='606857'>
<a class='timestamp' href='#606857'><time timestamp='2018-04-06T10:18:00Z'>10:18</time></a>
&lt;<span class='nick nick-4'> maxmatics</span>&gt;
hello world.
<br>
</div>

<div class='talk op-msg' data-timestamp='1523020200' id='606858'>
<a class='timestamp' href='#606858'><time timestamp='2018-04-06T13:10:00Z'>13:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #12898: Comment cleanup and consistency (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/12898" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12898</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523022600' id='606859'>
<a class='timestamp' href='#606859'><time timestamp='2018-04-06T13:50:00Z'>13:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sdaftuar opened pull request #12902: [qa] Handle potential cookie race when starting node (master...2018-04-improve-dbcrash-restarts) <a href="https://github.com/bitcoin/bitcoin/pull/12902" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12902</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025360' id='606860'>
<a class='timestamp' href='#606860'><time timestamp='2018-04-06T14:36:00Z'>14:36</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
Does bitcoin core have a utxo cache? If so, could anyone point me to the file where it is defined?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025480' id='606861'>
<a class='timestamp' href='#606861'><time timestamp='2018-04-06T14:38:00Z'>14:38</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
Aha, I found -dbcache, which is the size in MiB for the utxo db cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025600' id='606862'>
<a class='timestamp' href='#606862'><time timestamp='2018-04-06T14:40:00Z'>14:40</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I thought the cuckoocache was used as a sigcache.
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025600' id='606863'>
<a class='timestamp' href='#606863'><time timestamp='2018-04-06T14:40:00Z'>14:40</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
Is it also used for the utxo cache?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025660' id='606864'>
<a class='timestamp' href='#606864'><time timestamp='2018-04-06T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
stevenroose: no, it is not.  see src/coins.h and src/coins.cpp for more information about the utxo cache.
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025840' id='606865'>
<a class='timestamp' href='#606865'><time timestamp='2018-04-06T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sdaftuar: thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1523025900' id='606866'>
<a class='timestamp' href='#606866'><time timestamp='2018-04-06T14:45:00Z'>14:45</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
from the init code, I see that the -dbcache is split in 3, of which one is &quot;chain state cache&quot;, what is that one for?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523027340' id='606867'>
<a class='timestamp' href='#606867'><time timestamp='2018-04-06T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sdaftuar opened pull request #12904: [qa] Ensure bitcoind processes are cleaned up when tests end (master...2018-04-always-kill-bitcoind) <a href="https://github.com/bitcoin/bitcoin/pull/12904" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12904</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523028960' id='606868'>
<a class='timestamp' href='#606868'><time timestamp='2018-04-06T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: for the UTXO set the layers are: (1) disk (with OS cache etc) (2) LevelDB&#x27;s cache (3) Bitcoin Core&#x27;s pcoinsTip (a CCoinsViewCache object)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523028960' id='606869'>
<a class='timestamp' href='#606869'><time timestamp='2018-04-06T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
is there any way to actively check for conflicting transactions in the mempool for a given tx?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523029020' id='606870'>
<a class='timestamp' href='#606870'><time timestamp='2018-04-06T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: there is another data set, the block index which is loaded entirely in memory, but is stored in a separate LevelDB database
<br>
</div>

<div class='talk op-msg' data-timestamp='1523029080' id='606871'>
<a class='timestamp' href='#606871'><time timestamp='2018-04-06T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the 3 pieces -dbcache is split over is the blockindex leveldb cache, the chainstate leveldb cache (=utxo), and pcoinTip
<br>
</div>

<div class='talk op-msg' data-timestamp='1523029080' id='606872'>
<a class='timestamp' href='#606872'><time timestamp='2018-04-06T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
i suppose trying to rebroadcast would give an error in some cases, but i am not sure how reliable that is, and i would prefer just simply checking without broadcasting
<br>
</div>

<div class='talk op-msg' data-timestamp='1523039280' id='606873'>
<a class='timestamp' href='#606873'><time timestamp='2018-04-06T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sdaftuar opened pull request #12905: [rpcwallet] Clamp walletpassphrase value at 100M seconds (master...2018-04-wallet-encryption-timeout) <a href="https://github.com/bitcoin/bitcoin/pull/12905" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12905</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523040600' id='606874'>
<a class='timestamp' href='#606874'><time timestamp='2018-04-06T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
setpill: unfortunately i don&#x27;t think we have great tools right now. in the next release, we&#x27;ll have an rpc called &quot;testmempoolaccept&quot; which you could use to determine whether a given transaction would be accepted to your mempool, which might be along the lines of what you&#x27;d want?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523040660' id='606875'>
<a class='timestamp' href='#606875'><time timestamp='2018-04-06T18:51:00Z'>18:51</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
but it&#x27;s tricky in general, because dealing with transaction chains is not easy
<br>
</div>

<div class='talk op-msg' data-timestamp='1523040720' id='606876'>
<a class='timestamp' href='#606876'><time timestamp='2018-04-06T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
for instance, if someone sends you a transaction that depends on another unconfirmed transaction, and then a third transaction conflicts with the parent and evicts it from the mempool, it&#x27;s hard to tell that your transaction is indirectly conflicted as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1523041380' id='606877'>
<a class='timestamp' href='#606877'><time timestamp='2018-04-06T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: the block index I understand
<br>
</div>

<div class='talk op-msg' data-timestamp='1523041440' id='606878'>
<a class='timestamp' href='#606878'><time timestamp='2018-04-06T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&quot;the chainstate leveldb cache (=utxo), and pcoinTip&quot; -&gt; so what exactly is the difference there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523041440' id='606879'>
<a class='timestamp' href='#606879'><time timestamp='2018-04-06T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
they are both used to cache the utxo set, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523041800' id='606880'>
<a class='timestamp' href='#606880'><time timestamp='2018-04-06T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
does POTENTIAL DEADLOCK DETECTED being logged by a node during functional test runs indicate something is definitely out of the ordinary?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523042460' id='606881'>
<a class='timestamp' href='#606881'><time timestamp='2018-04-06T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: oh you meant with (=utxo) that it&#x27;s just the leveldb cache for the store that has the utxo data
<br>
</div>

<div class='talk op-msg' data-timestamp='1523042460' id='606882'>
<a class='timestamp' href='#606882'><time timestamp='2018-04-06T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ok, so the only thing core maintains itself is the CCoinsViewCache, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044020' id='606883'>
<a class='timestamp' href='#606883'><time timestamp='2018-04-06T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: yes, but that&#x27;s thr most important source of speedups
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044020' id='606884'>
<a class='timestamp' href='#606884'><time timestamp='2018-04-06T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the leveldb cache helps ob systems with very slow i/o
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044080' id='606885'>
<a class='timestamp' href='#606885'><time timestamp='2018-04-06T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: the coinsCache map is from outpoint to utxo entry, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044080' id='606886'>
<a class='timestamp' href='#606886'><time timestamp='2018-04-06T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
Doesn&#x27;t that mean that for a new tx, the txhash is potentially added a lot of times?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044140' id='606887'>
<a class='timestamp' href='#606887'><time timestamp='2018-04-06T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
in btcd, we have a structure where we map txid to utxoentry that has a (potentially sparse) map from index to output
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044140' id='606888'>
<a class='timestamp' href='#606888'><time timestamp='2018-04-06T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
but it
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044140' id='606889'>
<a class='timestamp' href='#606889'><time timestamp='2018-04-06T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&#x27;s currently not cached, and indeed, that&#x27;s one of the mayor performance bottlenecks
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044260' id='606890'>
<a class='timestamp' href='#606890'><time timestamp='2018-04-06T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-10'> drexl</span>&gt;
when an opcode has inputs, do these come from the stack?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044320' id='606891'>
<a class='timestamp' href='#606891'><time timestamp='2018-04-06T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: i believe btcd&#x27;s design was based on bitcoin core&#x27;s previous
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044320' id='606892'>
<a class='timestamp' href='#606892'><time timestamp='2018-04-06T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we switched from per-tx to per-txout in 0.15
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044380' id='606893'>
<a class='timestamp' href='#606893'><time timestamp='2018-04-06T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
leveldb deduplicates multiple key-value pairs with keys that share a prefix anyway, so on disk it&#x27;s not all that impactful
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044440' id='606894'>
<a class='timestamp' href='#606894'><time timestamp='2018-04-06T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and it simplifies the in-memory cache and serialization overhead for read/writes significantly
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044440' id='606895'>
<a class='timestamp' href='#606895'><time timestamp='2018-04-06T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
simplifies it a lot indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044500' id='606896'>
<a class='timestamp' href='#606896'><time timestamp='2018-04-06T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
any numbers on extra memory usage /utxo stored?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044500' id='606897'>
<a class='timestamp' href='#606897'><time timestamp='2018-04-06T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
500 MB on disk extra
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606898'>
<a class='timestamp' href='#606898'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
is disk more important than memory?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606899'>
<a class='timestamp' href='#606899'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
imho, no
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606900'>
<a class='timestamp' href='#606900'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s a small constant factor extra disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606901'>
<a class='timestamp' href='#606901'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I mean for initila sync mostly, a big memory cache can be very significant, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606902'>
<a class='timestamp' href='#606902'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it makes memory usage for the cache faster, more effective, and more efficient
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044560' id='606903'>
<a class='timestamp' href='#606903'><time timestamp='2018-04-06T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
hmm     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044620' id='606904'>
<a class='timestamp' href='#606904'><time timestamp='2018-04-06T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because now we don&#x27;t need to load unrelated other unspent outputs into memory 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044620' id='606905'>
<a class='timestamp' href='#606905'><time timestamp='2018-04-06T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
when one output is being spent
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044740' id='606906'>
<a class='timestamp' href='#606906'><time timestamp='2018-04-06T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh, but you don&#x27;t have to do that anyway, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044740' id='606907'>
<a class='timestamp' href='#606907'><time timestamp='2018-04-06T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
the entry map (index -&gt; output) is sparce
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044740' id='606908'>
<a class='timestamp' href='#606908'><time timestamp='2018-04-06T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
also on disk, you don&#x27;t store entire txs, only the unspent outputs
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044740' id='606909'>
<a class='timestamp' href='#606909'><time timestamp='2018-04-06T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044800' id='606910'>
<a class='timestamp' href='#606910'><time timestamp='2018-04-06T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but then you need a complex operation to write changes to disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044800' id='606911'>
<a class='timestamp' href='#606911'><time timestamp='2018-04-06T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and i don&#x27;t see how you can easily perform the freshness optimization on that
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044860' id='606912'>
<a class='timestamp' href='#606912'><time timestamp='2018-04-06T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(that&#x27;s the idea that if you create a utxo in memory, and then later spend it, in memory, it can be deleted from the cache, and nothing ever needs to hit disk, because both the create-txout and spent-txout operations are idempotent)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044920' id='606913'>
<a class='timestamp' href='#606913'><time timestamp='2018-04-06T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
hmm, I only just started looking into this more deeply, but I don&#x27;t see how storing utxos grouped per tx change that
<br>
</div>

<div class='talk op-msg' data-timestamp='1523044920' id='606914'>
<a class='timestamp' href='#606914'><time timestamp='2018-04-06T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well it means you can only do that optimization if all utxos of a tx are spent before a flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045040' id='606915'>
<a class='timestamp' href='#606915'><time timestamp='2018-04-06T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess you can have a hybrid where you store them per-txout on disk, but with shared txids in memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045040' id='606916'>
<a class='timestamp' href='#606916'><time timestamp='2018-04-06T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i looked into doing that, but the memory usage savings are tiny
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045100' id='606917'>
<a class='timestamp' href='#606917'><time timestamp='2018-04-06T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I don&#x27;t know what optimization you talk about tbh. let&#x27;s say you add a tx with two outputs (you always add whole txs right? I don&#x27;t think single outpoints make much sense), so you git txid -&gt; (o1, o2)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045100' id='606918'>
<a class='timestamp' href='#606918'><time timestamp='2018-04-06T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045160' id='606919'>
<a class='timestamp' href='#606919'><time timestamp='2018-04-06T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
then, before a flush, o2 gets spent, so you keep txid -&gt; (o1) and then when you flush, I don&#x27;t see the overhead over writing txid1 -&gt; o over txid -&gt; (o1)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045160' id='606920'>
<a class='timestamp' href='#606920'><time timestamp='2018-04-06T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(opposite overhead)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045160' id='606921'>
<a class='timestamp' href='#606921'><time timestamp='2018-04-06T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s actually a pretty significant overhead
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045160' id='606922'>
<a class='timestamp' href='#606922'><time timestamp='2018-04-06T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you need a dynamically allocated structure for variable-length output array
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045220' id='606923'>
<a class='timestamp' href='#606923'><time timestamp='2018-04-06T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s hard to compare what we&#x27;re talking about because there are so many variations, depending on how you do things in memory vs on disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045400' id='606924'>
<a class='timestamp' href='#606924'><time timestamp='2018-04-06T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I realize, trying to see if it&#x27;s worth turning the whole structure here upside down :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045460' id='606925'>
<a class='timestamp' href='#606925'><time timestamp='2018-04-06T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/pull/10195" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10195</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523045880' id='606926'>
<a class='timestamp' href='#606926'><time timestamp='2018-04-06T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
Hmm, not reassuring :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046000' id='606927'>
<a class='timestamp' href='#606927'><time timestamp='2018-04-06T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what could be done is change the in-memory representation slightly where you have two maps, one txid-&gt;(int,coinbase,height,#unspents) and another (int,vout)-&gt;(amount,script)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046000' id='606928'>
<a class='timestamp' href='#606928'><time timestamp='2018-04-06T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
rather than the single map we currently have (txid,vout)-&gt;(amount,script,coinbase,height)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046060' id='606929'>
<a class='timestamp' href='#606929'><time timestamp='2018-04-06T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it becomes a lot more complicated in the presence of more complicated cache flushing strategies
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046120' id='606930'>
<a class='timestamp' href='#606930'><time timestamp='2018-04-06T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
perhaps if average txn over time gain more txouts this becomes better
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046180' id='606931'>
<a class='timestamp' href='#606931'><time timestamp='2018-04-06T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
well, mostly to avoid changing all the db code etc, I will probably start with a cache on the current system
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046240' id='606932'>
<a class='timestamp' href='#606932'><time timestamp='2018-04-06T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
the argument of txs becoming bigger could make sense, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046240' id='606933'>
<a class='timestamp' href='#606933'><time timestamp='2018-04-06T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
if we want actual unlinkability with CT, coinjoin-like structures will become increasingly common
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046300' id='606934'>
<a class='timestamp' href='#606934'><time timestamp='2018-04-06T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
but yeah the simplicity of a txout based structure is also very compelling
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046360' id='606935'>
<a class='timestamp' href='#606935'><time timestamp='2018-04-06T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in any case, i&#x27;m very skeptical that any attempts to share the txids and other tx metadata in memory are worthwhile
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046360' id='606936'>
<a class='timestamp' href='#606936'><time timestamp='2018-04-06T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and unfortunately the CCoinsViewCache code is pretty complicated as it takes advantage of a bunch of tricks that are specific to utxo data
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046420' id='606937'>
<a class='timestamp' href='#606937'><time timestamp='2018-04-06T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so it&#x27;s not trivial to just drop in another cache design
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046420' id='606938'>
<a class='timestamp' href='#606938'><time timestamp='2018-04-06T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you may want to talk to eklitzke 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046480' id='606939'>
<a class='timestamp' href='#606939'><time timestamp='2018-04-06T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&quot;a bunch of tricks that are specific to utxo data&quot; hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046480' id='606940'>
<a class='timestamp' href='#606940'><time timestamp='2018-04-06T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well in particular the freshness optimization
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046480' id='606941'>
<a class='timestamp' href='#606941'><time timestamp='2018-04-06T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that i mentioned above
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046540' id='606942'>
<a class='timestamp' href='#606942'><time timestamp='2018-04-06T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I was going through it a bit, will certainly do some more consideration before i dive into coding
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046540' id='606943'>
<a class='timestamp' href='#606943'><time timestamp='2018-04-06T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah, I&#x27;ll look into that
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046540' id='606944'>
<a class='timestamp' href='#606944'><time timestamp='2018-04-06T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it seems like a very hard first project if you&#x27;re not already somewhat familiar with the codebase :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046540' id='606945'>
<a class='timestamp' href='#606945'><time timestamp='2018-04-06T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
how does it handle crashes? keeping latest flushed height or so and rebuilding newer blocks from disk in  case of crash?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046540' id='606946'>
<a class='timestamp' href='#606946'><time timestamp='2018-04-06T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah!     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046660' id='606947'>
<a class='timestamp' href='#606947'><time timestamp='2018-04-06T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/pull/10148" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10148</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046720' id='606948'>
<a class='timestamp' href='#606948'><time timestamp='2018-04-06T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046780' id='606949'>
<a class='timestamp' href='#606949'><time timestamp='2018-04-06T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
when talking about cached &quot;chain state&quot;, I suppose new blocks are always directly written to disk, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046780' id='606950'>
<a class='timestamp' href='#606950'><time timestamp='2018-04-06T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the chain state is the utxo set
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046780' id='606951'>
<a class='timestamp' href='#606951'><time timestamp='2018-04-06T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
blocks are stored completely independently
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046780' id='606952'>
<a class='timestamp' href='#606952'><time timestamp='2018-04-06T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ok, that clears it up
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046840' id='606953'>
<a class='timestamp' href='#606953'><time timestamp='2018-04-06T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
basically on disk there is a marker with a hash of a block that means &quot;utxos created or spent after this block MAY be present&quot; and another that means &quot;all utxos created or spent before this block MUST be on disk&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046900' id='606954'>
<a class='timestamp' href='#606954'><time timestamp='2018-04-06T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and at startup all blocks before the first and the second hash are replayed and applied to the UTXO set
<br>
</div>

<div class='talk op-msg' data-timestamp='1523046900' id='606955'>
<a class='timestamp' href='#606955'><time timestamp='2018-04-06T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
this approach means we don&#x27;t need to write the whole cache utxo set in one atomic operation, and also don&#x27;t need to remember old deleted entries
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047080' id='606956'>
<a class='timestamp' href='#606956'><time timestamp='2018-04-06T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-4'> ThinkOfANick</span>&gt;
sipa: Wait, why not remember old entries?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047080' id='606957'>
<a class='timestamp' href='#606957'><time timestamp='2018-04-06T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ThinkOfANick: because you want to save memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047080' id='606958'>
<a class='timestamp' href='#606958'><time timestamp='2018-04-06T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: I&#x27;m having difficulty to see how those two block locators are not the same
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047140' id='606959'>
<a class='timestamp' href='#606959'><time timestamp='2018-04-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
sdaftuar: perhaps ill have to resort to adding all the &quot;from&quot; addresses of the entire chain as watch-only addresses...
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047140' id='606960'>
<a class='timestamp' href='#606960'><time timestamp='2018-04-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: you have 1 million modified UTXO entries in memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047140' id='606961'>
<a class='timestamp' href='#606961'><time timestamp='2018-04-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: you can&#x27;t construct a single batch to write them all at once to memory, as that batch would be gigabytes in side
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047140' id='606962'>
<a class='timestamp' href='#606962'><time timestamp='2018-04-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so you write part of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047140' id='606963'>
<a class='timestamp' href='#606963'><time timestamp='2018-04-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*size
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606964'>
<a class='timestamp' href='#606964'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
say you last full flush was at block 400000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606965'>
<a class='timestamp' href='#606965'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the current tip is 450000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606966'>
<a class='timestamp' href='#606966'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that means your cache may include entries from up to block 450000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606967'>
<a class='timestamp' href='#606967'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(partial flush, right?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606968'>
<a class='timestamp' href='#606968'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ah full
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047200' id='606969'>
<a class='timestamp' href='#606969'><time timestamp='2018-04-06T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
srry didn&#x27;t see
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047260' id='606970'>
<a class='timestamp' href='#606970'><time timestamp='2018-04-06T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you&#x27;re now doing a partial flush, writing just some subset of UTXO cache entries to disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047260' id='606971'>
<a class='timestamp' href='#606971'><time timestamp='2018-04-06T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that may include UTXOs created up to block 450000 (or may miss things that were created between 400000 and 450000)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047260' id='606972'>
<a class='timestamp' href='#606972'><time timestamp='2018-04-06T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it&#x27;s not guaranteed to contain everything up to 450000 (in fact, because you know it&#x27;s partial, it can&#x27;t be)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047320' id='606973'>
<a class='timestamp' href='#606973'><time timestamp='2018-04-06T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the range you write is 400000..450000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047320' id='606974'>
<a class='timestamp' href='#606974'><time timestamp='2018-04-06T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and if a crash happens then and there
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047320' id='606975'>
<a class='timestamp' href='#606975'><time timestamp='2018-04-06T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at startup you&#x27;ll need to replay everything between 400000 and 450000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606976'>
<a class='timestamp' href='#606976'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because all utxo creation and spending operations are idempotent, it never hurts to replay an operation that was already applied
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606977'>
<a class='timestamp' href='#606977'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I see, I just don&#x27;t see how the 450000 is not just the same as the tip.. you also said &quot;utxos created or spent after this block MAY be present&quot; that must have been &quot;before&quot; then?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606978'>
<a class='timestamp' href='#606978'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
450000 is the tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606979'>
<a class='timestamp' href='#606979'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in this scenario
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606980'>
<a class='timestamp' href='#606980'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047380' id='606981'>
<a class='timestamp' href='#606981'><time timestamp='2018-04-06T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606982'>
<a class='timestamp' href='#606982'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
utxos created or spent after 400000 MAY be present
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606983'>
<a class='timestamp' href='#606983'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
utxos created or spent before 450000 MUSt be present
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606984'>
<a class='timestamp' href='#606984'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the range is 400000..450000
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606985'>
<a class='timestamp' href='#606985'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, i guess this is vague
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606986'>
<a class='timestamp' href='#606986'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&gt; utxos created or spent before 450000 MUSt be present
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606987'>
<a class='timestamp' href='#606987'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah that&#x27;s where you lost me
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047440' id='606988'>
<a class='timestamp' href='#606988'><time timestamp='2018-04-06T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
let me reformulate
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606989'>
<a class='timestamp' href='#606989'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
all operations up to block 400000 are guaranteed to be on disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606990'>
<a class='timestamp' href='#606990'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
you said &quot;MUST be before&quot; and &quot;MAY be after&quot; so I assume that is the same one
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606991'>
<a class='timestamp' href='#606991'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
all operations between 400000 and 450000 may be present on disk, but are not guaranteed to be
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606992'>
<a class='timestamp' href='#606992'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
my &quot;may&quot; and &quot;must&quot; were very confusing before
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606993'>
<a class='timestamp' href='#606993'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah, that&#x27;s what confused me
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047500' id='606994'>
<a class='timestamp' href='#606994'><time timestamp='2018-04-06T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but things after 450000 are guaranteed to not be on disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='606995'>
<a class='timestamp' href='#606995'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
so now let&#x27;s assume there is already a persistent chain tip indicator, then you only need to keep one, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='606996'>
<a class='timestamp' href='#606996'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well this is the chain tip indicator
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='606997'>
<a class='timestamp' href='#606997'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
instead of a tip, it&#x27;s a range
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='606998'>
<a class='timestamp' href='#606998'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
that&#x27;s why I was confused for it to be two. ok ok, yeah I got it. I just assumed you would always need a chaintip anyways
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='606999'>
<a class='timestamp' href='#606999'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in the ideal scenario the two are the same
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047560' id='607000'>
<a class='timestamp' href='#607000'><time timestamp='2018-04-06T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
after a full flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047620' id='607001'>
<a class='timestamp' href='#607001'><time timestamp='2018-04-06T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
one last thing I&#x27;m missing
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047620' id='607002'>
<a class='timestamp' href='#607002'><time timestamp='2018-04-06T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
how to know when to update that consistence height
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047620' id='607003'>
<a class='timestamp' href='#607003'><time timestamp='2018-04-06T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(the first one of the range)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047620' id='607004'>
<a class='timestamp' href='#607004'><time timestamp='2018-04-06T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, right now it&#x27;s very simple
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047680' id='607005'>
<a class='timestamp' href='#607005'><time timestamp='2018-04-06T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
when we start a flush operation, we check what the previous lower-height (the 400000) was, and update it to (that lower height, current tip)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047680' id='607006'>
<a class='timestamp' href='#607006'><time timestamp='2018-04-06T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
after a flush operation completes, it&#x27;s replaced with (current tip, current tip)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047740' id='607007'>
<a class='timestamp' href='#607007'><time timestamp='2018-04-06T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh, but then you still need full flushes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047740' id='607008'>
<a class='timestamp' href='#607008'><time timestamp='2018-04-06T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
so you can&#x27;t update in partial writes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047740' id='607009'>
<a class='timestamp' href='#607009'><time timestamp='2018-04-06T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well we only have full flushes now
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047740' id='607010'>
<a class='timestamp' href='#607010'><time timestamp='2018-04-06T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but they&#x27;re implemented as a sequence of partial flushes
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047740' id='607011'>
<a class='timestamp' href='#607011'><time timestamp='2018-04-06T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
longer term i want a system where we have a background thread that&#x27;s constantly flushing
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047800' id='607012'>
<a class='timestamp' href='#607012'><time timestamp='2018-04-06T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and is always &quot;running behind&quot; on the tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047800' id='607013'>
<a class='timestamp' href='#607013'><time timestamp='2018-04-06T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to give the memory db a chance to cache creates/spends that cancel each other out before writing
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047800' id='607014'>
<a class='timestamp' href='#607014'><time timestamp='2018-04-06T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but keeping track of which is the lower hash in the range in that system is more complicated
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047860' id='607015'>
<a class='timestamp' href='#607015'><time timestamp='2018-04-06T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s basically the lowest height of which you either have an unwritten create or unwritten spend
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047860' id='607016'>
<a class='timestamp' href='#607016'><time timestamp='2018-04-06T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it&#x27;s more tricky in the presence of reorganizations
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047860' id='607017'>
<a class='timestamp' href='#607017'><time timestamp='2018-04-06T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/blob/master/src/txdb.cpp#L102L137" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/txdb.cpp#L102L137</a> &lt;- current flushing to disk logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047920' id='607018'>
<a class='timestamp' href='#607018'><time timestamp='2018-04-06T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oooooooh
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607019'>
<a class='timestamp' href='#607019'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ok, I thought you were doing a partial flush when the cache was full
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607020'>
<a class='timestamp' href='#607020'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(like LRI fashion or so) 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607021'>
<a class='timestamp' href='#607021'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
nope
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607022'>
<a class='timestamp' href='#607022'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
but it&#x27;s just a way to reduce the size of the transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607023'>
<a class='timestamp' href='#607023'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ldb transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607024'>
<a class='timestamp' href='#607024'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;ve experimented with various approaches for MRU eviction from the cache etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1523047980' id='607025'>
<a class='timestamp' href='#607025'><time timestamp='2018-04-06T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh yeah than you can just do all batches and update the pointer
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048040' id='607026'>
<a class='timestamp' href='#607026'><time timestamp='2018-04-06T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but they&#x27;re basically all slower than what we&#x27;re doing now (on fast hw at least)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048100' id='607027'>
<a class='timestamp' href='#607027'><time timestamp='2018-04-06T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: yeah you&#x27;d have the problem of knowing to what hash it&#x27;s consistent. you&#x27;d need to keep heights in entries and iterate over all entries once and a while to see what the most recent dirty one is
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048100' id='607028'>
<a class='timestamp' href='#607028'><time timestamp='2018-04-06T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the <b>*least*</b> recent dirty one, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048100' id='607029'>
<a class='timestamp' href='#607029'><time timestamp='2018-04-06T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
thankfully, utxo entries already have a height
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048100' id='607030'>
<a class='timestamp' href='#607030'><time timestamp='2018-04-06T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
excuseer :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048160' id='607031'>
<a class='timestamp' href='#607031'><time timestamp='2018-04-06T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
unfortunately, that&#x27;s the creation height and not really the modification height (which may differ in the case of a spend or a reorg)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048160' id='607032'>
<a class='timestamp' href='#607032'><time timestamp='2018-04-06T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah I keep having a hard time picturing reorg handling there
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048220' id='607033'>
<a class='timestamp' href='#607033'><time timestamp='2018-04-06T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
because when you don&#x27;t have a txindex and you delete an entry, it&#x27;s impossible to get it back :D
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048220' id='607034'>
<a class='timestamp' href='#607034'><time timestamp='2018-04-06T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, we have undo data
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048220' id='607035'>
<a class='timestamp' href='#607035'><time timestamp='2018-04-06T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the *.rev files
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048220' id='607036'>
<a class='timestamp' href='#607036'><time timestamp='2018-04-06T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
do you keep like &quot;revert objects&quot; for the last X blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048220' id='607037'>
<a class='timestamp' href='#607037'><time timestamp='2018-04-06T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048280' id='607038'>
<a class='timestamp' href='#607038'><time timestamp='2018-04-06T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
how many are there? (thinking hardfork races here where two chains constantly catch up with each other and fuck old nodes)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048280' id='607039'>
<a class='timestamp' href='#607039'><time timestamp='2018-04-06T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is one per block
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048280' id='607040'>
<a class='timestamp' href='#607040'><time timestamp='2018-04-06T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and we prune them along with the blocks themselves
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048340' id='607041'>
<a class='timestamp' href='#607041'><time timestamp='2018-04-06T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(technically wouldnt be a hardfork in that case though)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048340' id='607042'>
<a class='timestamp' href='#607042'><time timestamp='2018-04-06T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
wait, why keep for all? or are they only like pointers to the actual data?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048400' id='607043'>
<a class='timestamp' href='#607043'><time timestamp='2018-04-06T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because we need to be able to reorg?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048400' id='607044'>
<a class='timestamp' href='#607044'><time timestamp='2018-04-06T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I haven&#x27;t seen any of that data in btcd&#x27;s codebase, let me dig to that tomorrow :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048400' id='607045'>
<a class='timestamp' href='#607045'><time timestamp='2018-04-06T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah I know, but well, reorging over half the chain is kinda unlikely, isn&#x27;t it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048400' id='607046'>
<a class='timestamp' href='#607046'><time timestamp='2018-04-06T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048400' id='607047'>
<a class='timestamp' href='#607047'><time timestamp='2018-04-06T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I&#x27;d say at least before the last checkpoint makes no sense..
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607048'>
<a class='timestamp' href='#607048'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
checkpoints need to go away
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607049'>
<a class='timestamp' href='#607049'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607050'>
<a class='timestamp' href='#607050'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but yes, sure, it&#x27;s unlikely that deep reorgs happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607051'>
<a class='timestamp' href='#607051'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
what&#x27;s the fundamental problem with checkpoints?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607052'>
<a class='timestamp' href='#607052'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
they confuse people
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048460' id='607053'>
<a class='timestamp' href='#607053'><time timestamp='2018-04-06T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
:)     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048520' id='607054'>
<a class='timestamp' href='#607054'><time timestamp='2018-04-06T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
they&#x27;re seen as a security measure
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048520' id='607055'>
<a class='timestamp' href='#607055'><time timestamp='2018-04-06T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
more as an efficiency tool :p I mean you can skip verification up to that point
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048580' id='607056'>
<a class='timestamp' href='#607056'><time timestamp='2018-04-06T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we have assumevalid for that now, which is far less invasive
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048580' id='607057'>
<a class='timestamp' href='#607057'><time timestamp='2018-04-06T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
(f.e. when syncing a node I always &quot;ask my friends for the latest block they trust&quot; (i.e. check some explorers) and do --addcheckpoint
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048580' id='607058'>
<a class='timestamp' href='#607058'><time timestamp='2018-04-06T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it doesn&#x27;t restrict which chain is valid
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048580' id='607059'>
<a class='timestamp' href='#607059'><time timestamp='2018-04-06T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it just skips validation for any block that is an ancestor of a known valid block
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048580' id='607060'>
<a class='timestamp' href='#607060'><time timestamp='2018-04-06T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but if the best chain we see is different than the assumevalid one, we&#x27;ll accept it (after validating)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048640' id='607061'>
<a class='timestamp' href='#607061'><time timestamp='2018-04-06T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ok yeah that&#x27;s a better version of a checkpoint
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048640' id='607062'>
<a class='timestamp' href='#607062'><time timestamp='2018-04-06T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, assumevalid is updated from time to time, but we haven&#x27;t modified checkpoints in years
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048640' id='607063'>
<a class='timestamp' href='#607063'><time timestamp='2018-04-06T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
but checkpoints are also usefull against eclipse attacks when you&#x27;re just getting started
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048640' id='607064'>
<a class='timestamp' href='#607064'><time timestamp='2018-04-06T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048700' id='607065'>
<a class='timestamp' href='#607065'><time timestamp='2018-04-06T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
at least they let you know something is up, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048700' id='607066'>
<a class='timestamp' href='#607066'><time timestamp='2018-04-06T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
they&#x27;re useful against being spammed with low difficulty headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048700' id='607067'>
<a class='timestamp' href='#607067'><time timestamp='2018-04-06T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that&#x27;s independent of eclipse attacks 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048700' id='607068'>
<a class='timestamp' href='#607068'><time timestamp='2018-04-06T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we need backward headers sync to remove that dependency on checkpoints
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048760' id='607069'>
<a class='timestamp' href='#607069'><time timestamp='2018-04-06T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
backward header sync?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048760' id='607070'>
<a class='timestamp' href='#607070'><time timestamp='2018-04-06T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
first learn the best header, and only then download headers along that path
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048760' id='607071'>
<a class='timestamp' href='#607071'><time timestamp='2018-04-06T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as opposed to downloading whatever header people give you, hoping that indeed it&#x27;ll turn out to be one with more work than your current one
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048820' id='607072'>
<a class='timestamp' href='#607072'><time timestamp='2018-04-06T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(that&#x27;s how it works now)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048820' id='607073'>
<a class='timestamp' href='#607073'><time timestamp='2018-04-06T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
how can you learn the best header? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048880' id='607074'>
<a class='timestamp' href='#607074'><time timestamp='2018-04-06T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
using a yet to be devised protocol :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048880' id='607075'>
<a class='timestamp' href='#607075'><time timestamp='2018-04-06T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
asking all peers? (heighest checkpoint? :p)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048880' id='607076'>
<a class='timestamp' href='#607076'><time timestamp='2018-04-06T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048940' id='607077'>
<a class='timestamp' href='#607077'><time timestamp='2018-04-06T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there are some ideas about random sampling, where someone can send you a merkle sum tree over all their headers, and then you randomly query it a number of times to see if they indeed have the distribution of pow they claim
<br>
</div>

<div class='talk op-msg' data-timestamp='1523048940' id='607078'>
<a class='timestamp' href='#607078'><time timestamp='2018-04-06T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I recently thought about a backwards sync mechanism for initila utxo building. but I guess it&#x27;s kinda not worth the effort when there is a good utxo cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049000' id='607079'>
<a class='timestamp' href='#607079'><time timestamp='2018-04-06T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and once you&#x27;ve done enough queries, you know they actually have a chain with a certain amount of work
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049000' id='607080'>
<a class='timestamp' href='#607080'><time timestamp='2018-04-06T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and if that amount of work is good enough, you can start downloading the actual headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049000' id='607081'>
<a class='timestamp' href='#607081'><time timestamp='2018-04-06T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
sipa: wouldn&#x27;t just believing the claimed amount of accumulated work + ban on lie work?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049060' id='607082'>
<a class='timestamp' href='#607082'><time timestamp='2018-04-06T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
are checkpoints really that bad? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049060' id='607083'>
<a class='timestamp' href='#607083'><time timestamp='2018-04-06T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: people seem to misunderstand that if checkpoints ever have an effect, bitcoin is broken
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049060' id='607084'>
<a class='timestamp' href='#607084'><time timestamp='2018-04-06T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m much more comfortable to have much weaker assumptions about correctness of the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049120' id='607085'>
<a class='timestamp' href='#607085'><time timestamp='2018-04-06T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(which includes the checkpoints)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049120' id='607086'>
<a class='timestamp' href='#607086'><time timestamp='2018-04-06T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
setpill: how is that better than what we have now?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049180' id='607087'>
<a class='timestamp' href='#607087'><time timestamp='2018-04-06T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: i don&#x27;t think they&#x27;re terrible, but we also don&#x27;t really need them anymore, except for this tiny DoS concern
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049180' id='607088'>
<a class='timestamp' href='#607088'><time timestamp='2018-04-06T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
sipa: last blocks are likely to have more pow behind them so are more expensive to maliciously craft
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049180' id='607089'>
<a class='timestamp' href='#607089'><time timestamp='2018-04-06T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&quot;if checkpoints ever have an effect, bitcoin is broken&quot; you mean that when code breaks validity of an old block that no one will validate because checkpoints?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049240' id='607090'>
<a class='timestamp' href='#607090'><time timestamp='2018-04-06T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: i mean that if checkpoints ever prevent the network from reorging to an attacker chain, it&#x27;s clear that the concept of PoW itself is brokenb
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049300' id='607091'>
<a class='timestamp' href='#607091'><time timestamp='2018-04-06T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
and what if they prevent <b>*a new node*</b> from syncing a wrong chain? that&#x27;s what their main use is imho
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049360' id='607092'>
<a class='timestamp' href='#607092'><time timestamp='2018-04-06T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: that&#x27;s not what they do
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049360' id='607093'>
<a class='timestamp' href='#607093'><time timestamp='2018-04-06T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
stevenroose: they just prevent OOM
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049360' id='607094'>
<a class='timestamp' href='#607094'><time timestamp='2018-04-06T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I mean even as a spam vector, a decent miner right now can prob create a quite significantly long chain that is use in size (1MB blocks) and has legit work
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049360' id='607095'>
<a class='timestamp' href='#607095'><time timestamp='2018-04-06T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
s/use/huge/
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049360' id='607096'>
<a class='timestamp' href='#607096'><time timestamp='2018-04-06T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, absolutely - that&#x27;s exactly the one thing they still do
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049420' id='607097'>
<a class='timestamp' href='#607097'><time timestamp='2018-04-06T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
OOM?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049420' id='607098'>
<a class='timestamp' href='#607098'><time timestamp='2018-04-06T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
out of memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049420' id='607099'>
<a class='timestamp' href='#607099'><time timestamp='2018-04-06T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, not actually blocks, just headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049420' id='607100'>
<a class='timestamp' href='#607100'><time timestamp='2018-04-06T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we don&#x27;t download block data until a chain of validated headers is actually the best chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049480' id='607101'>
<a class='timestamp' href='#607101'><time timestamp='2018-04-06T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
yeah true, so that would only work if eclipsed
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049480' id='607102'>
<a class='timestamp' href='#607102'><time timestamp='2018-04-06T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, and there is a known min amount of work
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049480' id='607103'>
<a class='timestamp' href='#607103'><time timestamp='2018-04-06T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
independently of checkpoints
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049480' id='607104'>
<a class='timestamp' href='#607104'><time timestamp='2018-04-06T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
&quot;min amount of work at height x&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049480' id='607105'>
<a class='timestamp' href='#607105'><time timestamp='2018-04-06T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so we never accept a headers chain until it passes that point
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049540' id='607106'>
<a class='timestamp' href='#607106'><time timestamp='2018-04-06T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
oh llike that
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049540' id='607107'>
<a class='timestamp' href='#607107'><time timestamp='2018-04-06T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
cumulative
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049540' id='607108'>
<a class='timestamp' href='#607108'><time timestamp='2018-04-06T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
thats neat
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049540' id='607109'>
<a class='timestamp' href='#607109'><time timestamp='2018-04-06T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
sipa: interesting, i hadnt heard of that; is that documented somewhere?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049660' id='607110'>
<a class='timestamp' href='#607110'><time timestamp='2018-04-06T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
-minimumchainwork cmdline option
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049720' id='607111'>
<a class='timestamp' href='#607111'><time timestamp='2018-04-06T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
well, thanks for the insights :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049780' id='607112'>
<a class='timestamp' href='#607112'><time timestamp='2018-04-06T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yw!     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523049960' id='607113'>
<a class='timestamp' href='#607113'><time timestamp='2018-04-06T21:26:00Z'>21:26</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
sipa: ahh, so its another &quot;checkpoint-esque&quot; thing, as in a hardcoded value that gets updated periodically?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050020' id='607114'>
<a class='timestamp' href='#607114'><time timestamp='2018-04-06T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
for a second i was under the impression pow inflation somehow had a lower bound ^^&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050020' id='607115'>
<a class='timestamp' href='#607115'><time timestamp='2018-04-06T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
setpill: there is a minimum difficulty, but it&#x27;s trivial
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050080' id='607116'>
<a class='timestamp' href='#607116'><time timestamp='2018-04-06T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
yeah and wont help much against a malicious chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050140' id='607117'>
<a class='timestamp' href='#607117'><time timestamp='2018-04-06T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a single modern CPU thread can create a minimum-difficulty block in a few minute
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050140' id='607118'>
<a class='timestamp' href='#607118'><time timestamp='2018-04-06T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
modern HW miners can make 1000s per second
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050200' id='607119'>
<a class='timestamp' href='#607119'><time timestamp='2018-04-06T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-5'> setpill</span>&gt;
yeah, so i thought there was a higher-than-that, actually useful lower bound on difficulty based on something i was unaware of
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050260' id='607120'>
<a class='timestamp' href='#607120'><time timestamp='2018-04-06T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is also the max-divide-by-4 rule for difficulty changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607121'>
<a class='timestamp' href='#607121'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: is that a consensus rule??
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607122'>
<a class='timestamp' href='#607122'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607123'>
<a class='timestamp' href='#607123'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
was not aware of that
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607124'>
<a class='timestamp' href='#607124'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
always has been
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607125'>
<a class='timestamp' href='#607125'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
is there a max-multiply-by-x one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050380' id='607126'>
<a class='timestamp' href='#607126'><time timestamp='2018-04-06T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, by 4
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050440' id='607127'>
<a class='timestamp' href='#607127'><time timestamp='2018-04-06T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
aha     
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050440' id='607128'>
<a class='timestamp' href='#607128'><time timestamp='2018-04-06T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
neither rule has ever been hit
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050440' id='607129'>
<a class='timestamp' href='#607129'><time timestamp='2018-04-06T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
on mainnet at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607130'>
<a class='timestamp' href='#607130'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I hate the zero-diff-after-20-mins testnet rule
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607131'>
<a class='timestamp' href='#607131'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607132'>
<a class='timestamp' href='#607132'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I used to try and testnet mine with an old butterfly labs jalapeno but somehow was never hitting one 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607133'>
<a class='timestamp' href='#607133'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you need to set your timestamp in the future :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607134'>
<a class='timestamp' href='#607134'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
btcd didn&#x27;t notify gbt long polls on the 20 minute hit 
<br>
</div>

<div class='talk op-msg' data-timestamp='1523050500' id='607135'>
<a class='timestamp' href='#607135'><time timestamp='2018-04-06T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
also
<br>
</div>

<div class='talk op-msg' data-timestamp='1523055900' id='607136'>
<a class='timestamp' href='#607136'><time timestamp='2018-04-06T23:05:00Z'>23:05</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: re protocol to know the best chain: couldn&#x27;t compact pow proofs be better for that than random sampling?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523055960' id='607137'>
<a class='timestamp' href='#607137'><time timestamp='2018-04-06T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
hi stevenroose
<br>
</div>

<div class='talk op-msg' data-timestamp='1523056080' id='607138'>
<a class='timestamp' href='#607138'><time timestamp='2018-04-06T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: compact pow proofs need consensus rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1523056080' id='607139'>
<a class='timestamp' href='#607139'><time timestamp='2018-04-06T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
bitcoin doesn&#x27;t have those
<br>
</div>

<div class='talk op-msg' data-timestamp='1523056140' id='607140'>
<a class='timestamp' href='#607140'><time timestamp='2018-04-06T23:09:00Z'>23:09</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sure, I mean assuming a compact proofs sf
<br>
</div>

<div class='talk op-msg' data-timestamp='1523056560' id='607141'>
<a class='timestamp' href='#607141'><time timestamp='2018-04-06T23:16:00Z'>23:16</time></a>
&lt;<span class='nick nick-14'> intcat</span>&gt;
is there any (u)txo commitment design (close to becoming) a BIP?
<br>
</div>

<div class='talk op-msg' data-timestamp='1523056560' id='607142'>
<a class='timestamp' href='#607142'><time timestamp='2018-04-06T23:16:00Z'>23:16</time></a>
&lt;<span class='nick nick-14'> intcat</span>&gt;
ive read some ml interaction between peter todd and bram cohen but it&#x27;s a few years old and im not sure how much has happened on that since
<br>
</div>

</div>
</section>

</body>
</html>
