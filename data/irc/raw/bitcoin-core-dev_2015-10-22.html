<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-10-22
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-10-22' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:28 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-09-22">&lt;</a><span class='header'>   October 2015   </span><a href="/bitcoin-core-dev/2015-11-22">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2015-10-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-10-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2015-10-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-10-09">9</a> <a class="" href="/bitcoin-core-dev/2015-10-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-11">11</a> <a class="" href="/bitcoin-core-dev/2015-10-12">12</a> <a class="" href="/bitcoin-core-dev/2015-10-13">13</a> <a class="" href="/bitcoin-core-dev/2015-10-14">14</a> <a class="" href="/bitcoin-core-dev/2015-10-15">15</a> <a class="" href="/bitcoin-core-dev/2015-10-16">16</a> <a class="" href="/bitcoin-core-dev/2015-10-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-18">18</a> <a class="" href="/bitcoin-core-dev/2015-10-19">19</a> <a class="" href="/bitcoin-core-dev/2015-10-20">20</a> <a class="" href="/bitcoin-core-dev/2015-10-21">21</a> <a class="current" href="/bitcoin-core-dev/2015-10-22">22</a> <a class="" href="/bitcoin-core-dev/2015-10-23">23</a> <a class="" href="/bitcoin-core-dev/2015-10-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-25">25</a> <a class="" href="/bitcoin-core-dev/2015-10-26">26</a> <a class="" href="/bitcoin-core-dev/2015-10-27">27</a> <a class="" href="/bitcoin-core-dev/2015-10-28">28</a> <a class="" href="/bitcoin-core-dev/2015-10-29">29</a> <a class="" href="/bitcoin-core-dev/2015-10-30">30</a> <a class="" href="/bitcoin-core-dev/2015-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1445472720' id='430762'>
<a class='timestamp' href='#430762'><time timestamp='2015-10-22T00:12:00Z'>00:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
re sigop-limit flooding, can we just merge acceptnonstdtxn (mainnet option, off by default) finally? this would not be a problem if people were using code with it merged..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445472900' id='430763'>
<a class='timestamp' href='#430763'><time timestamp='2015-10-22T00:15:00Z'>00:15</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/pull/559" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/559</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473140' id='430764'>
<a class='timestamp' href='#430764'><time timestamp='2015-10-22T00:19:00Z'>00:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: explain your logic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473140' id='430765'>
<a class='timestamp' href='#430765'><time timestamp='2015-10-22T00:19:00Z'>00:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: the top commit limits (in policy) tx sigop count based on its size
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473140' id='430766'>
<a class='timestamp' href='#430766'><time timestamp='2015-10-22T00:19:00Z'>00:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
so the spam would need to be larger for it to use 15 sigops
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473200' id='430767'>
<a class='timestamp' href='#430767'><time timestamp='2015-10-22T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
thus hitting the block size limit approximately at the same time as the sigop limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473200' id='430768'>
<a class='timestamp' href='#430768'><time timestamp='2015-10-22T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I ~think~ the suggestion I made of max(size, sigops*1e6/20000) is more general than the limit thing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473200' id='430769'>
<a class='timestamp' href='#430769'><time timestamp='2015-10-22T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
(and triggering higher fees, of course)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445473260' id='430770'>
<a class='timestamp' href='#430770'><time timestamp='2015-10-22T00:21:00Z'>00:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: yes, my point is that the bug wouldn&#x27;t exist in the first place had this already been merged
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476200' id='430771'>
<a class='timestamp' href='#430771'><time timestamp='2015-10-22T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: you asked about tx cache? <a href="https://github.com/TheBlueMatt/bitcoin/tree/limitucache" class="link" target="_blank">https://github.com/TheBlueMatt/bitcoin/tree/limitucache</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476200' id='430772'>
<a class='timestamp' href='#430772'><time timestamp='2015-10-22T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
actually, I&#x27;ll just pr
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476260' id='430773'>
<a class='timestamp' href='#430773'><time timestamp='2015-10-22T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-16'> GitHub110</span>&gt;
[bitcoin] TheBlueMatt opened pull request #6868: Limit txn cache growth (master...limitucache) <a href="https://github.com/bitcoin/bitcoin/pull/6868" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6868</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476380' id='430774'>
<a class='timestamp' href='#430774'><time timestamp='2015-10-22T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
BlueMatt: for your don&#x27;t fork from here-- I suggest <a href="https://github.com/gmaxwell/secp256k1" class="link" target="_blank">https://github.com/gmaxwell/secp256k1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476380' id='430775'>
<a class='timestamp' href='#430775'><time timestamp='2015-10-22T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: yes, but that takes effort....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476440' id='430776'>
<a class='timestamp' href='#430776'><time timestamp='2015-10-22T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well if someone does it to the repo first you can check out theirs and force push it into yours. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476440' id='430777'>
<a class='timestamp' href='#430777'><time timestamp='2015-10-22T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I guess I should do bitcoin core too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445476560' id='430778'>
<a class='timestamp' href='#430778'><time timestamp='2015-10-22T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-9'> GitHub26</span>&gt;
[bitcoin] TheBlueMatt closed pull request #6868: Limit txn cache growth (master...limitucache) <a href="https://github.com/bitcoin/bitcoin/pull/6868" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6868</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445478360' id='430779'>
<a class='timestamp' href='#430779'><time timestamp='2015-10-22T01:46:00Z'>01:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
BlueMatt: interesting idea.. i&#x27;m not sure what i think of it yet...  you don&#x27;t thinks also potentially inefficient
<br>
</div>

<div class='talk op-msg' data-timestamp='1445478480' id='430780'>
<a class='timestamp' href='#430780'><time timestamp='2015-10-22T01:48:00Z'>01:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
did you see the conversation wumpus and I were having earlier
<br>
</div>

<div class='talk op-msg' data-timestamp='1445478480' id='430781'>
<a class='timestamp' href='#430781'><time timestamp='2015-10-22T01:48:00Z'>01:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
one thing we could do in ATMP, is not pull into the pcoinstip cache coins for txs which aren&#x27;t actually accepted into the memory pool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445478960' id='430782'>
<a class='timestamp' href='#430782'><time timestamp='2015-10-22T01:56:00Z'>01:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yeah, we should do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445478960' id='430783'>
<a class='timestamp' href='#430783'><time timestamp='2015-10-22T01:56:00Z'>01:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i see sometimes huge increases in utxo cache size after a transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479080' id='430784'>
<a class='timestamp' href='#430784'><time timestamp='2015-10-22T01:58:00Z'>01:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
however, with bith limited utxo cache and mempool, memory usage actually remains <b>*very*</b> low
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479080' id='430785'>
<a class='timestamp' href='#430785'><time timestamp='2015-10-22T01:58:00Z'>01:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
have a node with 100 MB utxo and 200 MB mempool, and total memory is staying below 570 M
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479260' id='430786'>
<a class='timestamp' href='#430786'><time timestamp='2015-10-22T02:01:00Z'>02:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
just don&#x27;t run GetBlockTemplate! :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479320' id='430787'>
<a class='timestamp' href='#430787'><time timestamp='2015-10-22T02:02:00Z'>02:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: why does CreateNewBlock need to hold cs_main the whole time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479320' id='430788'>
<a class='timestamp' href='#430788'><time timestamp='2015-10-22T02:02:00Z'>02:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479320' id='430789'>
<a class='timestamp' href='#430789'><time timestamp='2015-10-22T02:02:00Z'>02:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also no idea why it actually needs to verify the result
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479380' id='430790'>
<a class='timestamp' href='#430790'><time timestamp='2015-10-22T02:03:00Z'>02:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems like after the first round of calling HaveCoins on all the txins of all the txs.. you now have a view with all of of your coins in it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479380' id='430791'>
<a class='timestamp' href='#430791'><time timestamp='2015-10-22T02:03:00Z'>02:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and you could release cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479380' id='430792'>
<a class='timestamp' href='#430792'><time timestamp='2015-10-22T02:03:00Z'>02:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mempool could change then, though?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479380' id='430793'>
<a class='timestamp' href='#430793'><time timestamp='2015-10-22T02:03:00Z'>02:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i took a first stab at a background miner, but realized its useless if its holding cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479440' id='430794'>
<a class='timestamp' href='#430794'><time timestamp='2015-10-22T02:04:00Z'>02:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well... what do you mean change?  i think we don&#x27;t want to lose txs that we might be trying to mine
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479440' id='430795'>
<a class='timestamp' href='#430795'><time timestamp='2015-10-22T02:04:00Z'>02:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but maybe you can handle that by not removing things
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479500' id='430796'>
<a class='timestamp' href='#430796'><time timestamp='2015-10-22T02:05:00Z'>02:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
a smaller lock that just guards actually removing txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430797'>
<a class='timestamp' href='#430797'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
why would it not need to verify the result, you mean because it shouldn&#x27;t have been able to create something invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430798'>
<a class='timestamp' href='#430798'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430799'>
<a class='timestamp' href='#430799'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i do think thats a nice double check 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430800'>
<a class='timestamp' href='#430800'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think it&#x27;s worth the cost
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430801'>
<a class='timestamp' href='#430801'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
given that it hasn&#x27;t failed in years
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430802'>
<a class='timestamp' href='#430802'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well it will be if we&#x27;re chaning the mining algorithm!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430803'>
<a class='timestamp' href='#430803'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
changing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479560' id='430804'>
<a class='timestamp' href='#430804'><time timestamp='2015-10-22T02:06:00Z'>02:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe a spot check would be useful
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479620' id='430805'>
<a class='timestamp' href='#430805'><time timestamp='2015-10-22T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
run it once every 1000 calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479620' id='430806'>
<a class='timestamp' href='#430806'><time timestamp='2015-10-22T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
since it&#x27;s in the background the cost is mitigated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479620' id='430807'>
<a class='timestamp' href='#430807'><time timestamp='2015-10-22T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
holds cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479620' id='430808'>
<a class='timestamp' href='#430808'><time timestamp='2015-10-22T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
block validation will not be background
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479620' id='430809'>
<a class='timestamp' href='#430809'><time timestamp='2015-10-22T02:07:00Z'>02:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it needs the utxo set
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430810'>
<a class='timestamp' href='#430810'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
though i guess you are right that of it actually does make a full copy of all inlits, it can release the lock afterwards
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430811'>
<a class='timestamp' href='#430811'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
yes it needs utxo set but doesn&#x27;t need cs_main long term
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430812'>
<a class='timestamp' href='#430812'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well it needs the utxo lock, whatever that is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430813'>
<a class='timestamp' href='#430813'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i think we could be smart about it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430814'>
<a class='timestamp' href='#430814'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think it shouldn&#x27;t need the utxo set or copies at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479680' id='430815'>
<a class='timestamp' href='#430815'><time timestamp='2015-10-22T02:08:00Z'>02:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mempool should be consistent
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430816'>
<a class='timestamp' href='#430816'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do a spot check occasionally to make sure the code isn&#x27;t broken
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430817'>
<a class='timestamp' href='#430817'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
right now it already pulls the potentially used utxos into caches TWICE.  so you could use one for creation and the other for validation without needing to grab cs_main again
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430818'>
<a class='timestamp' href='#430818'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430819'>
<a class='timestamp' href='#430819'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it should be 0, imho
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430820'>
<a class='timestamp' href='#430820'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430821'>
<a class='timestamp' href='#430821'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
thats what you mean by mempool should be consistent
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430822'>
<a class='timestamp' href='#430822'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mempool is known to not double spend
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479740' id='430823'>
<a class='timestamp' href='#430823'><time timestamp='2015-10-22T02:09:00Z'>02:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yikes!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430824'>
<a class='timestamp' href='#430824'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not contain invalid transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430825'>
<a class='timestamp' href='#430825'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but thats also been broken
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430826'>
<a class='timestamp' href='#430826'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so we should fix it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430827'>
<a class='timestamp' href='#430827'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but what i&#x27;m saying is that breaks often enough that you wouldn&#x27;t want it to cause you to mine an invalid block?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430828'>
<a class='timestamp' href='#430828'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
at least one check should still exist
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430829'>
<a class='timestamp' href='#430829'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s like saying &quot;we&#x27;re not sure about the utxo cache, let&#x27;s run checkblockchain on every update&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479800' id='430830'>
<a class='timestamp' href='#430830'><time timestamp='2015-10-22T02:10:00Z'>02:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sure the check should exist
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479860' id='430831'>
<a class='timestamp' href='#430831'><time timestamp='2015-10-22T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it should not be slowing down GBT by seconds!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479860' id='430832'>
<a class='timestamp' href='#430832'><time timestamp='2015-10-22T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479860' id='430833'>
<a class='timestamp' href='#430833'><time timestamp='2015-10-22T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
every single call
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479920' id='430834'>
<a class='timestamp' href='#430834'><time timestamp='2015-10-22T02:12:00Z'>02:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its just scary when you have a giant block of code protected by cs_main..  trying to reason about what in there really cares about it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479920' id='430835'>
<a class='timestamp' href='#430835'><time timestamp='2015-10-22T02:12:00Z'>02:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well you don&#x27;t want the best block or the mempool to change underneath it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479920' id='430836'>
<a class='timestamp' href='#430836'><time timestamp='2015-10-22T02:12:00Z'>02:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or you will be pulling in transactions that may conflict with each other
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430837'>
<a class='timestamp' href='#430837'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: GBT verifies the result because it&#x27;s worth it. No miner wants to find out after the fact they mined an invalid block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430838'>
<a class='timestamp' href='#430838'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if the best block changes i&#x27;ve got other problems..  i don&#x27;t want to be calculating this block anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430839'>
<a class='timestamp' href='#430839'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: the code should not produce invalid blocks, period
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430840'>
<a class='timestamp' href='#430840'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
also, spot checking just leads to people /expecting/ a lower time than they can rely on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430841'>
<a class='timestamp' href='#430841'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: if you run the check once every 1000 calls you will equally well detect broken code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430842'>
<a class='timestamp' href='#430842'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
not equally well, no.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445479980' id='430843'>
<a class='timestamp' href='#430843'><time timestamp='2015-10-22T02:13:00Z'>02:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the code is broken, it will fail badly
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430844'>
<a class='timestamp' href='#430844'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and it will mislead people into thinking it&#x27;s faster than it&#x27;s necessarily
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430845'>
<a class='timestamp' href='#430845'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
an edge case will not necessarily fail badly.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430846'>
<a class='timestamp' href='#430846'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so run with -checkmempool on then
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430847'>
<a class='timestamp' href='#430847'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
without the verification, there is no consensus code involved in producing blocks here..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430848'>
<a class='timestamp' href='#430848'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
valid transactions != valid block
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480040' id='430849'>
<a class='timestamp' href='#430849'><time timestamp='2015-10-22T02:14:00Z'>02:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then you will also not get an invalid memlool state
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480100' id='430850'>
<a class='timestamp' href='#430850'><time timestamp='2015-10-22T02:15:00Z'>02:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just get that check out of the mining path
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480100' id='430851'>
<a class='timestamp' href='#430851'><time timestamp='2015-10-22T02:15:00Z'>02:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i wonder how much gbt delay has encourage validationless mining...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480100' id='430852'>
<a class='timestamp' href='#430852'><time timestamp='2015-10-22T02:15:00Z'>02:15</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
removing the check <b>*is*</b> validationless.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430853'>
<a class='timestamp' href='#430853'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I&#x27;m with Luke-Jr that I think consensus code should happen at least once in the path
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430854'>
<a class='timestamp' href='#430854'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it is not if the code is not broken
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430855'>
<a class='timestamp' href='#430855'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but it doesn&#x27;t have to happen twice as it does now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430856'>
<a class='timestamp' href='#430856'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: wait, twice?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430857'>
<a class='timestamp' href='#430857'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
once for building, once for checking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480160' id='430858'>
<a class='timestamp' href='#430858'><time timestamp='2015-10-22T02:16:00Z'>02:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
CheckInputs on the transactions and TestBlockValidity
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480220' id='430859'>
<a class='timestamp' href='#430859'><time timestamp='2015-10-22T02:17:00Z'>02:17</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
CheckInputs doesn&#x27;t check the entire block, but maybe it can be removed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480220' id='430860'>
<a class='timestamp' href='#430860'><time timestamp='2015-10-22T02:17:00Z'>02:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it does check the whole block eventually, as it&#x27;s called for all transactions that end up in it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430861'>
<a class='timestamp' href='#430861'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: no, because all the transactions can be valid without the block itself being valid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430862'>
<a class='timestamp' href='#430862'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i think we&#x27;re talking about different things here
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430863'>
<a class='timestamp' href='#430863'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: i know that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430864'>
<a class='timestamp' href='#430864'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m concerned with having the block-template thread hold cs_main too much...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430865'>
<a class='timestamp' href='#430865'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
CheckInputs doesn&#x27;t need cs_main once you have a view
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430866'>
<a class='timestamp' href='#430866'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but checkinputs is called for the equivalent amount of work of validating the whole block
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430867'>
<a class='timestamp' href='#430867'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa your concern seems to be latency in GBT
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430868'>
<a class='timestamp' href='#430868'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but thats solvable in other ways
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480280' id='430869'>
<a class='timestamp' href='#430869'><time timestamp='2015-10-22T02:18:00Z'>02:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480340' id='430870'>
<a class='timestamp' href='#430870'><time timestamp='2015-10-22T02:19:00Z'>02:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480340' id='430871'>
<a class='timestamp' href='#430871'><time timestamp='2015-10-22T02:19:00Z'>02:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
as long as you think its ok to have brief periods of mining on an empty block or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480340' id='430872'>
<a class='timestamp' href='#430872'><time timestamp='2015-10-22T02:19:00Z'>02:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
GBT isn&#x27;t supposed to be time-critical anyway (but I already plan to improve it)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480400' id='430873'>
<a class='timestamp' href='#430873'><time timestamp='2015-10-22T02:20:00Z'>02:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well it can&#x27;t take seconds...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480400' id='430874'>
<a class='timestamp' href='#430874'><time timestamp='2015-10-22T02:20:00Z'>02:20</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
maybe ideally it wouldn&#x27;t, but it shouldn&#x27;t hurt much
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480400' id='430875'>
<a class='timestamp' href='#430875'><time timestamp='2015-10-22T02:20:00Z'>02:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
forget about how long it takes, what you care about is how long after a new block comes in that you have a header you can mine that builds off it right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430876'>
<a class='timestamp' href='#430876'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
also afaik right now it only takes seconds when the miner is neglecting to keep a clean mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430877'>
<a class='timestamp' href='#430877'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it doesn&#x27;t matter if it then takes seconds to generate a new one with txs right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430878'>
<a class='timestamp' href='#430878'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
since it needs to go over every tx in the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430879'>
<a class='timestamp' href='#430879'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
not because of the test afterward
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430880'>
<a class='timestamp' href='#430880'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: as long as fees are negligablez yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430881'>
<a class='timestamp' href='#430881'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
although seconds is really absurdly slow and we should be able to get it under that even for that case
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480460' id='430882'>
<a class='timestamp' href='#430882'><time timestamp='2015-10-22T02:21:00Z'>02:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: yeah thats one of the problems, is that now it loops all the txs twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430883'>
<a class='timestamp' href='#430883'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
once putting them all in vecPriority
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430884'>
<a class='timestamp' href='#430884'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and then trying to go through vecPriority and put them all in a block
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430885'>
<a class='timestamp' href='#430885'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430886'>
<a class='timestamp' href='#430886'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
with a sorted mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430887'>
<a class='timestamp' href='#430887'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
both become unnecessary (the 2nd was already unnecessary)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430888'>
<a class='timestamp' href='#430888'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sorted mempool is essentially what I&#x27;m working on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430889'>
<a class='timestamp' href='#430889'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
although I need to rebase on top of the packages stuff I expect
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480520' id='430890'>
<a class='timestamp' href='#430890'><time timestamp='2015-10-22T02:22:00Z'>02:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sdaftuar is very close to finishing the ancestor package tracking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480580' id='430891'>
<a class='timestamp' href='#430891'><time timestamp='2015-10-22T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if you want to build a more general sorting priority score, thats probably what you should build off of
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480580' id='430892'>
<a class='timestamp' href='#430892'><time timestamp='2015-10-22T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
not priority score
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480580' id='430893'>
<a class='timestamp' href='#430893'><time timestamp='2015-10-22T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sorting based on the user-defined policy ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480580' id='430894'>
<a class='timestamp' href='#430894'><time timestamp='2015-10-22T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah thats what i meant
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480640' id='430895'>
<a class='timestamp' href='#430895'><time timestamp='2015-10-22T02:24:00Z'>02:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
don&#x27;t you have to somehow turn their policy into a score?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480640' id='430896'>
<a class='timestamp' href='#430896'><time timestamp='2015-10-22T02:24:00Z'>02:24</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480640' id='430897'>
<a class='timestamp' href='#430897'><time timestamp='2015-10-22T02:24:00Z'>02:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
how can you sort without a score?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480640' id='430898'>
<a class='timestamp' href='#430898'><time timestamp='2015-10-22T02:24:00Z'>02:24</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
the policy is implemented mostly by a method that compares two transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480700' id='430899'>
<a class='timestamp' href='#430899'><time timestamp='2015-10-22T02:25:00Z'>02:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and if  A &lt; B and B &lt; C then A &lt; C right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480820' id='430900'>
<a class='timestamp' href='#430900'><time timestamp='2015-10-22T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480820' id='430901'>
<a class='timestamp' href='#430901'><time timestamp='2015-10-22T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
or at least, that&#x27;s assumed by the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480820' id='430902'>
<a class='timestamp' href='#430902'><time timestamp='2015-10-22T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it might be fun to some day make blocks with a policy that just returns rand() :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480820' id='430903'>
<a class='timestamp' href='#430903'><time timestamp='2015-10-22T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok well the point i was going to make was that if you could look at it as a score
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480820' id='430904'>
<a class='timestamp' href='#430904'><time timestamp='2015-10-22T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and A has child A2 and B has child B2
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480880' id='430905'>
<a class='timestamp' href='#430905'><time timestamp='2015-10-22T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you&#x27;re defining a total ordering, that is equivalent to a score function
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480880' id='430906'>
<a class='timestamp' href='#430906'><time timestamp='2015-10-22T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
yes, you could look at it that way; my point was that actually using a score is overcomplex
<br>
</div>

<div class='talk op-msg' data-timestamp='1445480880' id='430907'>
<a class='timestamp' href='#430907'><time timestamp='2015-10-22T02:28:00Z'>02:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then if you use suhas&#x27;s ancestor package tracking with your score instead of fee you&#x27;ll get CPFP in terms of your policy
<br>
</div>

<div class='talk op-msg' data-timestamp='1445481060' id='430908'>
<a class='timestamp' href='#430908'><time timestamp='2015-10-22T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: what are your thoughts on maintaining ancestor package tracking on nodes that aren&#x27;t mining
<br>
</div>

<div class='talk op-msg' data-timestamp='1445481060' id='430909'>
<a class='timestamp' href='#430909'><time timestamp='2015-10-22T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its not totally useless and it hopefully shouldn&#x27;t be too expensive.  but certainly adds more mememory/cpu for something they are basically not using
<br>
</div>

<div class='talk op-msg' data-timestamp='1445481120' id='430910'>
<a class='timestamp' href='#430910'><time timestamp='2015-10-22T02:32:00Z'>02:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the one thing i think it could be used for is fee estimation?  but thats only a maybe, i haven&#x27;t really figured out how or if that would be worth it.  but estimating what miners are going to do seems like potentially a valuable tool for fee estimation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445485140' id='430911'>
<a class='timestamp' href='#430911'><time timestamp='2015-10-22T03:39:00Z'>03:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields_: good catch, apparently it&#x27;s not inhereted reliably and there is a bunch of broken software out there.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445485800' id='430912'>
<a class='timestamp' href='#430912'><time timestamp='2015-10-22T03:50:00Z'>03:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(by reliably I mean it&#x27;s system dependant)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445501580' id='430913'>
<a class='timestamp' href='#430913'><time timestamp='2015-10-22T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
can confirm bitcoin core requires reindex on power failure under windows
<br>
</div>

<div class='talk op-msg' data-timestamp='1445501640' id='430914'>
<a class='timestamp' href='#430914'><time timestamp='2015-10-22T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
probably leveldb env driver is stupid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445501700' id='430915'>
<a class='timestamp' href='#430915'><time timestamp='2015-10-22T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: fixy fixy?  unfortunately I think it&#x27;s unmaintained.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445501700' id='430916'>
<a class='timestamp' href='#430916'><time timestamp='2015-10-22T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
as chrome uses some chrome specific abstractions for IO. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1445501940' id='430917'>
<a class='timestamp' href='#430917'><time timestamp='2015-10-22T08:19:00Z'>08:19</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, i can take a look at it, probably it should just be replaced with the current posix version which is just fopen/fread/fwrite basically
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502240' id='430918'>
<a class='timestamp' href='#430918'><time timestamp='2015-10-22T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/0fbfc5106cd9...a09297010e17" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/0fbfc5106cd9...a09297010e17</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502240' id='430919'>
<a class='timestamp' href='#430919'><time timestamp='2015-10-22T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
bitcoin/master 579b863 Wladimir J. van der Laan: devtools: Add security-check.py...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502240' id='430920'>
<a class='timestamp' href='#430920'><time timestamp='2015-10-22T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-12'> GitHub16</span>&gt;
bitcoin/master a092970 Wladimir J. van der Laan: Merge pull request #6854...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502240' id='430921'>
<a class='timestamp' href='#430921'><time timestamp='2015-10-22T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-9'> GitHub129</span>&gt;
[bitcoin] laanwj closed pull request #6854: devtools: Add security-check.py (master...2015_10_security_checks) <a href="https://github.com/bitcoin/bitcoin/pull/6854" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6854</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502360' id='430922'>
<a class='timestamp' href='#430922'><time timestamp='2015-10-22T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit: yeah <a href="https://github.com/bitcoin/bitcoin/issues/5610" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/5610</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502360' id='430923'>
<a class='timestamp' href='#430923'><time timestamp='2015-10-22T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no clue on solving it though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502360' id='430924'>
<a class='timestamp' href='#430924'><time timestamp='2015-10-22T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for some reason most people with a clue about windows internals seem to be blackhats, and they like things broken :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502420' id='430925'>
<a class='timestamp' href='#430925'><time timestamp='2015-10-22T08:27:00Z'>08:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, it&#x27;s using windows memory mapping
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502420' id='430926'>
<a class='timestamp' href='#430926'><time timestamp='2015-10-22T08:27:00Z'>08:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: reports went up astronomically after 0.10 and some users reported it worked fine for them before them and fails every time since.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502420' id='430927'>
<a class='timestamp' href='#430927'><time timestamp='2015-10-22T08:27:00Z'>08:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
im going to assume it&#x27;s that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502480' id='430928'>
<a class='timestamp' href='#430928'><time timestamp='2015-10-22T08:28:00Z'>08:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: oh it&#x27;s writing via mmap too?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502480' id='430929'>
<a class='timestamp' href='#430929'><time timestamp='2015-10-22T08:28:00Z'>08:28</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i just checked and there&#x27;s a Win32Map something or other 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502480' id='430930'>
<a class='timestamp' href='#430930'><time timestamp='2015-10-22T08:28:00Z'>08:28</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i assume it&#x27;s using that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502540' id='430931'>
<a class='timestamp' href='#430931'><time timestamp='2015-10-22T08:29:00Z'>08:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
<a href="https://litteration.files.wordpress.com/2013/05/science-dog.jpg" class="link" target="_blank">https://litteration.files.wordpress.com/2013/05/science-dog.jpg</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502540' id='430932'>
<a class='timestamp' href='#430932'><time timestamp='2015-10-22T08:29:00Z'>08:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it has been a while since we updated leveldb, maybe some things got fixed since?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502600' id='430933'>
<a class='timestamp' href='#430933'><time timestamp='2015-10-22T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502600' id='430934'>
<a class='timestamp' href='#430934'><time timestamp='2015-10-22T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, that&#x27;s about right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502660' id='430935'>
<a class='timestamp' href='#430935'><time timestamp='2015-10-22T08:31:00Z'>08:31</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it&#x27;s windows... how do you even begin to debug this
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502720' id='430936'>
<a class='timestamp' href='#430936'><time timestamp='2015-10-22T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s a dark art
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502780' id='430937'>
<a class='timestamp' href='#430937'><time timestamp='2015-10-22T08:33:00Z'>08:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wouldn&#x27;t be surprised if it requieres at least some, possibly expensive, proprietary software applications
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502900' id='430938'>
<a class='timestamp' href='#430938'><time timestamp='2015-10-22T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
debugging-by-mutating-the-code may be the most promising approach, extract a bare bones program that uses leveldb and crashes, then change it (adding flushes everywhere) until it manages to not corrupt anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502960' id='430939'>
<a class='timestamp' href='#430939'><time timestamp='2015-10-22T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s 100% reproducable it seems, which helps.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502960' id='430940'>
<a class='timestamp' href='#430940'><time timestamp='2015-10-22T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this is the approach that works for fixing problems with underdocumented hardware, it should work for windows too...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445502960' id='430941'>
<a class='timestamp' href='#430941'><time timestamp='2015-10-22T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the fact that it went way up when we turned up checking suggests to me that it&#x27;s something like a truncated record at the end that was otherwise silently recoverable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503020' id='430942'>
<a class='timestamp' href='#430942'><time timestamp='2015-10-22T08:37:00Z'>08:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
e.g. something like the osx bug.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503080' id='430943'>
<a class='timestamp' href='#430943'><time timestamp='2015-10-22T08:38:00Z'>08:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes good point - can you send me a database that is corrupted by this problem?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503140' id='430944'>
<a class='timestamp' href='#430944'><time timestamp='2015-10-22T08:39:00Z'>08:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: you would be you, as I don&#x27;t have a repro.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503200' id='430945'>
<a class='timestamp' href='#430945'><time timestamp='2015-10-22T08:40:00Z'>08:40</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430946'>
<a class='timestamp' href='#430946'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, i suspect you&#x27;re right that it&#x27;s similar to the OSX bug
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430947'>
<a class='timestamp' href='#430947'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i also suspect it would be easier to replace leveldb with lmdb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430948'>
<a class='timestamp' href='#430948'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit:  can you send me a database that is corrupted by this problem?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430949'>
<a class='timestamp' href='#430949'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
mmap only, goodbye 32 bit hosts.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430950'>
<a class='timestamp' href='#430950'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Among other limitations. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503260' id='430951'>
<a class='timestamp' href='#430951'><time timestamp='2015-10-22T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
It&#x27;s funny because if you ask Windows devs they&#x27;ll tell you the dev tooling on Windows is far better than on Linux
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430952'>
<a class='timestamp' href='#430952'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, i mindlessly clicked the reindex button
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430953'>
<a class='timestamp' href='#430953'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Arnavion: there is some aspect of &quot;tools you know are always better than ones you don&#x27;t&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430954'>
<a class='timestamp' href='#430954'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i can certainly try to do so though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430955'>
<a class='timestamp' href='#430955'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
Arnavion: it may be more user friendly on windows, but it&#x27;s harder to get insight about what is happening on a system
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430956'>
<a class='timestamp' href='#430956'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
There&#x27;s also the aspect of GUI tools that don&#x27;t suck
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430957'>
<a class='timestamp' href='#430957'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
but I&#x27;m biased
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503320' id='430958'>
<a class='timestamp' href='#430958'><time timestamp='2015-10-22T08:42:00Z'>08:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Arnavion: you mean GUI tools inherently sucking? :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503380' id='430959'>
<a class='timestamp' href='#430959'><time timestamp='2015-10-22T08:43:00Z'>08:43</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
Oh, but that&#x27;s what WinDbg is for
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503380' id='430960'>
<a class='timestamp' href='#430960'><time timestamp='2015-10-22T08:43:00Z'>08:43</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
You can do everything with a keyboard if you wish
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503380' id='430961'>
<a class='timestamp' href='#430961'><time timestamp='2015-10-22T08:43:00Z'>08:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyhow this is not constructive
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503440' id='430962'>
<a class='timestamp' href='#430962'><time timestamp='2015-10-22T08:44:00Z'>08:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you feel helpful, please demonstrate your skills by solving the leveldb corruption issue Arnavion :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503440' id='430963'>
<a class='timestamp' href='#430963'><time timestamp='2015-10-22T08:44:00Z'>08:44</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
I have no skills
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503500' id='430964'>
<a class='timestamp' href='#430964'><time timestamp='2015-10-22T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
but I can take a look
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503500' id='430965'>
<a class='timestamp' href='#430965'><time timestamp='2015-10-22T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
demonstrate the great capability of windows debugging tools, then
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503560' id='430966'>
<a class='timestamp' href='#430966'><time timestamp='2015-10-22T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit: but you can reproduce it! just start a new datadir, crash the thing, and send it to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1445503860' id='430967'>
<a class='timestamp' href='#430967'><time timestamp='2015-10-22T08:51:00Z'>08:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
lmdb is not the panacea some people think - but if you feel like patching bitcoind to use it, that&#x27;d be pretty neat as we could run some benchmarks and comparisons
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504340' id='430968'>
<a class='timestamp' href='#430968'><time timestamp='2015-10-22T08:59:00Z'>08:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, the main thing that&#x27;s missing from leveldb is... sequence numbers in the journal
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504340' id='430969'>
<a class='timestamp' href='#430969'><time timestamp='2015-10-22T08:59:00Z'>08:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
if you miss a full record of writes it doesn&#x27;t know
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504400' id='430970'>
<a class='timestamp' href='#430970'><time timestamp='2015-10-22T09:00:00Z'>09:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
still, we need to debug this issue, as it is clearly windows specific, so not fundamental to leveldb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504400' id='430971'>
<a class='timestamp' href='#430971'><time timestamp='2015-10-22T09:00:00Z'>09:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if this was broken on all platforms I&#x27;d agree that looking for a replacement would be advisable...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504460' id='430972'>
<a class='timestamp' href='#430972'><time timestamp='2015-10-22T09:01:00Z'>09:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, it <b>*is*</b> broken on all platforms
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504460' id='430973'>
<a class='timestamp' href='#430973'><time timestamp='2015-10-22T09:01:00Z'>09:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the failure rate is simply much lower
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504520' id='430974'>
<a class='timestamp' href='#430974'><time timestamp='2015-10-22T09:02:00Z'>09:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
one step at a time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504520' id='430975'>
<a class='timestamp' href='#430975'><time timestamp='2015-10-22T09:02:00Z'>09:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
lets making the bleeding stop on windows first.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504580' id='430976'>
<a class='timestamp' href='#430976'><time timestamp='2015-10-22T09:03:00Z'>09:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s a nihilistic way of looking at it phantomcircuit, I like that, yes, it&#x27;s all broken, some things with a very low failure rate... but it doesn&#x27;t help solving the issue :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504700' id='430977'>
<a class='timestamp' href='#430977'><time timestamp='2015-10-22T09:05:00Z'>09:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m sure lmdb is also broken in some subtle ways
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504760' id='430978'>
<a class='timestamp' href='#430978'><time timestamp='2015-10-22T09:06:00Z'>09:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyhow, if you&#x27;re not going to send me a corrupted datbase I&#x27;m going to start working on something else
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504820' id='430979'>
<a class='timestamp' href='#430979'><time timestamp='2015-10-22T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I assume he has to wait for the reindex to complete to reproduce. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504880' id='430980'>
<a class='timestamp' href='#430980'><time timestamp='2015-10-22T09:08:00Z'>09:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wha?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504880' id='430981'>
<a class='timestamp' href='#430981'><time timestamp='2015-10-22T09:08:00Z'>09:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I assumed it would also happen when crashing during reindex?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504880' id='430982'>
<a class='timestamp' href='#430982'><time timestamp='2015-10-22T09:08:00Z'>09:08</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: what is Windows specfic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504940' id='430983'>
<a class='timestamp' href='#430983'><time timestamp='2015-10-22T09:09:00Z'>09:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
[08:13:52] &lt;phantomcircuit&gt; can confirm bitcoin core requires reindex on power failure under windows &lt;-- I can confirm it requires reindex on power failure under Linux..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445504940' id='430984'>
<a class='timestamp' href='#430984'><time timestamp='2015-10-22T09:09:00Z'>09:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in that case, sorry, no hurry implied
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505000' id='430985'>
<a class='timestamp' href='#430985'><time timestamp='2015-10-22T09:10:00Z'>09:10</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: if you in fact want such a corrupt bitcoin dir, I can probably get one for oyu
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505000' id='430986'>
<a class='timestamp' href='#430986'><time timestamp='2015-10-22T09:10:00Z'>09:10</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
ponders where he put his USB Armory
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505060' id='430987'>
<a class='timestamp' href='#430987'><time timestamp='2015-10-22T09:11:00Z'>09:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
oh, it&#x27;s plugged in
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505060' id='430988'>
<a class='timestamp' href='#430988'><time timestamp='2015-10-22T09:11:00Z'>09:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
Luke-Jr: great!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505120' id='430989'>
<a class='timestamp' href='#430989'><time timestamp='2015-10-22T09:12:00Z'>09:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
Luke-Jr, ive never had that issue on linux
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505120' id='430990'>
<a class='timestamp' href='#430990'><time timestamp='2015-10-22T09:12:00Z'>09:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s interesting that the usb armory corrupts, perhaps not the same issue as windows though (though perhaps also worth fixing) 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505240' id='430991'>
<a class='timestamp' href='#430991'><time timestamp='2015-10-22T09:14:00Z'>09:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
indeed, may be a different issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505720' id='430992'>
<a class='timestamp' href='#430992'><time timestamp='2015-10-22T09:22:00Z'>09:22</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
FWIW, removing power immediately after IBD started did NOT reproduce it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505720' id='430993'>
<a class='timestamp' href='#430993'><time timestamp='2015-10-22T09:22:00Z'>09:22</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
anything in debug.log to look for to know when it does the first flush to disk?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505780' id='430994'>
<a class='timestamp' href='#430994'><time timestamp='2015-10-22T09:23:00Z'>09:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
set a low dbcache to force lots of flushes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445505780' id='430995'>
<a class='timestamp' href='#430995'><time timestamp='2015-10-22T09:23:00Z'>09:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
AFAIK it doesn&#x27;t flush unless necessary until the initial block download is complete
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506020' id='430996'>
<a class='timestamp' href='#430996'><time timestamp='2015-10-22T09:27:00Z'>09:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
&#x27;often&#x27; is too slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506080' id='430997'>
<a class='timestamp' href='#430997'><time timestamp='2015-10-22T09:28:00Z'>09:28</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
2015-10-22 09:27:59 UpdateTip: new best=000000003f7e074587fa1684ac863519fea3c64040b05ddd04948a13f7b19b42  height=415  log2_work=40.700462  tx=423  date=2009-01-14 05:56:05 progress=0.000002  cache=419
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506380' id='430998'>
<a class='timestamp' href='#430998'><time timestamp='2015-10-22T09:33:00Z'>09:33</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
From just lazy-mode browsing the code, Win32MapFile::Sync() flushes but Win32MapFile::Flush() is a no-op, whereas the equivalent functions for posix both do things
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506440' id='430999'>
<a class='timestamp' href='#430999'><time timestamp='2015-10-22T09:34:00Z'>09:34</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
I did not see how they are called from common code to see if that matters
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506620' id='431000'>
<a class='timestamp' href='#431000'><time timestamp='2015-10-22T09:37:00Z'>09:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it all depends on whether this map file is used for writing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506680' id='431001'>
<a class='timestamp' href='#431001'><time timestamp='2015-10-22T09:38:00Z'>09:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
AFAIK on other OSes, writing uses normal file system commands, whereas reading can use mmap
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506680' id='431002'>
<a class='timestamp' href='#431002'><time timestamp='2015-10-22T09:38:00Z'>09:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if t his is different on windows that would explain something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506740' id='431003'>
<a class='timestamp' href='#431003'><time timestamp='2015-10-22T09:39:00Z'>09:39</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
Windows has a dedicated FlushViewOfFile function to flush a mapped region
<br>
</div>

<div class='talk op-msg' data-timestamp='1445506740' id='431004'>
<a class='timestamp' href='#431004'><time timestamp='2015-10-22T09:39:00Z'>09:39</time></a>
&lt;<span class='nick nick-4'> Arnavion</span>&gt;
That is called by Sync(), but not by Flush()
<br>
</div>

<div class='talk op-msg' data-timestamp='1445507880' id='431005'>
<a class='timestamp' href='#431005'><time timestamp='2015-10-22T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445507880' id='431006'>
<a class='timestamp' href='#431006'><time timestamp='2015-10-22T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it seems I can&#x27;t reproduce during IBD or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445508420' id='431007'>
<a class='timestamp' href='#431007'><time timestamp='2015-10-22T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and a fully synced state is huge :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445508480' id='431008'>
<a class='timestamp' href='#431008'><time timestamp='2015-10-22T10:08:00Z'>10:08</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
Luke-Jr: you&#x27;re reproducing on a Windows OS?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445508480' id='431009'>
<a class='timestamp' href='#431009'><time timestamp='2015-10-22T10:08:00Z'>10:08</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
midnightmagic: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1445509500' id='431010'>
<a class='timestamp' href='#431010'><time timestamp='2015-10-22T10:25:00Z'>10:25</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
ponders
<br>
</div>

<div class='talk op-msg' data-timestamp='1445509560' id='431011'>
<a class='timestamp' href='#431011'><time timestamp='2015-10-22T10:26:00Z'>10:26</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: well, the last chainstate I had before today is 922 MB and demanded a reindex.. not sure if that&#x27;s good enough, because I can&#x27;t upload 44 GB :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445509620' id='431012'>
<a class='timestamp' href='#431012'><time timestamp='2015-10-22T10:27:00Z'>10:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s kind of huge - do you perhaps know what ldb file the corruption is in?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445509620' id='431013'>
<a class='timestamp' href='#431013'><time timestamp='2015-10-22T10:27:00Z'>10:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
no, I have no idea how leveldb works :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445509680' id='431014'>
<a class='timestamp' href='#431014'><time timestamp='2015-10-22T10:28:00Z'>10:28</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I could probably just give you access to the device?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510340' id='431015'>
<a class='timestamp' href='#431015'><time timestamp='2015-10-22T10:39:00Z'>10:39</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: see PM for login info
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510340' id='431016'>
<a class='timestamp' href='#431016'><time timestamp='2015-10-22T10:39:00Z'>10:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510400' id='431017'>
<a class='timestamp' href='#431017'><time timestamp='2015-10-22T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
setup auth for your github ssh key; let me know if there&#x27;s a better one
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510400' id='431018'>
<a class='timestamp' href='#431018'><time timestamp='2015-10-22T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: the leveldb in question is under ~/.bitcoin.bak
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510460' id='431019'>
<a class='timestamp' href='#431019'><time timestamp='2015-10-22T10:41:00Z'>10:41</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
perhaps relevant: tar: /home/usbarmory/.bitcoin.bak/chainstate/1463292.ldb: File shrank by 2020259 bytes; padding with zeros
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510520' id='431020'>
<a class='timestamp' href='#431020'><time timestamp='2015-10-22T10:42:00Z'>10:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
uh...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510520' id='431021'>
<a class='timestamp' href='#431021'><time timestamp='2015-10-22T10:42:00Z'>10:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, that doesn&#x27;t sound good. Were you tarring while bitcoin running?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510580' id='431022'>
<a class='timestamp' href='#431022'><time timestamp='2015-10-22T10:43:00Z'>10:43</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
not sure if bitcoind is running, but if it is, it&#x27;s not running on <b>*this*</b> database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510580' id='431023'>
<a class='timestamp' href='#431023'><time timestamp='2015-10-22T10:43:00Z'>10:43</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
wonders what it&#x27;s doing so much to hang SSH
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510640' id='431024'>
<a class='timestamp' href='#431024'><time timestamp='2015-10-22T10:44:00Z'>10:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok, it would not be strange if it is happening while running tar on the datadir that bitcoin was running in, those files are deleted and recreated all the time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510640' id='431025'>
<a class='timestamp' href='#431025'><time timestamp='2015-10-22T10:44:00Z'>10:44</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510700' id='431026'>
<a class='timestamp' href='#431026'><time timestamp='2015-10-22T10:45:00Z'>10:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: leveldb seems unmaintained
<br>
</div>

<div class='talk op-msg' data-timestamp='1445510820' id='431027'>
<a class='timestamp' href='#431027'><time timestamp='2015-10-22T10:47:00Z'>10:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bleh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511120' id='431028'>
<a class='timestamp' href='#431028'><time timestamp='2015-10-22T10:52:00Z'>10:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m happy we at least never decided to use it for the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511180' id='431029'>
<a class='timestamp' href='#431029'><time timestamp='2015-10-22T10:53:00Z'>10:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe we should switch to sqlite... at least that&#x27;s very well tested and maintained
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511240' id='431030'>
<a class='timestamp' href='#431030'><time timestamp='2015-10-22T10:54:00Z'>10:54</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it is, but it&#x27;s not very fast for key/value storage, and I don&#x27;t think it handles such large databases very well
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511300' id='431031'>
<a class='timestamp' href='#431031'><time timestamp='2015-10-22T10:55:00Z'>10:55</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: sqlite is very slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511360' id='431032'>
<a class='timestamp' href='#431032'><time timestamp='2015-10-22T10:56:00Z'>10:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you need more advanced query features it is very nice though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511420' id='431033'>
<a class='timestamp' href='#431033'><time timestamp='2015-10-22T10:57:00Z'>10:57</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
it would be so much easier and flexible if we were using SQL of some kind...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511420' id='431034'>
<a class='timestamp' href='#431034'><time timestamp='2015-10-22T10:57:00Z'>10:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what would be easier?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511420' id='431035'>
<a class='timestamp' href='#431035'><time timestamp='2015-10-22T10:57:00Z'>10:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
btcdrak: leveldb&#x27;s own benchmark says that sqlite is faster for random reads
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511420' id='431036'>
<a class='timestamp' href='#431036'><time timestamp='2015-10-22T10:57:00Z'>10:57</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511420' id='431037'>
<a class='timestamp' href='#431037'><time timestamp='2015-10-22T10:57:00Z'>10:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for wallet metadata sql would be reasonably useful
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431038'>
<a class='timestamp' href='#431038'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
writes are much slower, but we do very few writes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431039'>
<a class='timestamp' href='#431039'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: well you get a lot of stuff for free with a SQL database stack.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431040'>
<a class='timestamp' href='#431040'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
such as?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431041'>
<a class='timestamp' href='#431041'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
# dmesg
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431042'>
<a class='timestamp' href='#431042'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
Segmentation fault
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511480' id='431043'>
<a class='timestamp' href='#431043'><time timestamp='2015-10-22T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
-.-
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511540' id='431044'>
<a class='timestamp' href='#431044'><time timestamp='2015-10-22T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
during initial sync we do quite a lot of writes (every coin that is touched is written back), after that, most are reads
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511540' id='431045'>
<a class='timestamp' href='#431045'><time timestamp='2015-10-22T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: indexes for a start. the ability to query the dataset externally from bitcoind etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511540' id='431046'>
<a class='timestamp' href='#431046'><time timestamp='2015-10-22T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
using database indexes would mean using a very verbose format
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511540' id='431047'>
<a class='timestamp' href='#431047'><time timestamp='2015-10-22T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
btcdrak: we&#x27;re not storing any data in a way that&#x27;s useful to index
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511600' id='431048'>
<a class='timestamp' href='#431048'><time timestamp='2015-10-22T11:00:00Z'>11:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;d lose massive performance by expanding the data
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511600' id='431049'>
<a class='timestamp' href='#431049'><time timestamp='2015-10-22T11:00:00Z'>11:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that kind of defeats the purpose - bitcoind&#x27;s database should optimized for its own purposes as running a node, not external ones
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511600' id='431050'>
<a class='timestamp' href='#431050'><time timestamp='2015-10-22T11:00:00Z'>11:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
I had wondered about leveldb&#x27;s ongoing support. it really looks like an orphaned project at this time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511660' id='431051'>
<a class='timestamp' href='#431051'><time timestamp='2015-10-22T11:01:00Z'>11:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511660' id='431052'>
<a class='timestamp' href='#431052'><time timestamp='2015-10-22T11:01:00Z'>11:01</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
btcdrak, the expanded dataset in SQL is something like 40GB at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511660' id='431053'>
<a class='timestamp' href='#431053'><time timestamp='2015-10-22T11:01:00Z'>11:01</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
not including the block data itself
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511720' id='431054'>
<a class='timestamp' href='#431054'><time timestamp='2015-10-22T11:02:00Z'>11:02</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, worse comes to worse, we can do our own key/value store...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511720' id='431055'>
<a class='timestamp' href='#431055'><time timestamp='2015-10-22T11:02:00Z'>11:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
also bitcoin&#x27;s databases are not an external interface, don&#x27;t query them directly unless it&#x27;s to write troubleshooting/recovery tools
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511780' id='431056'>
<a class='timestamp' href='#431056'><time timestamp='2015-10-22T11:03:00Z'>11:03</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
there are actually a few optimizations you can make if you assume your keys are hashes already
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511780' id='431057'>
<a class='timestamp' href='#431057'><time timestamp='2015-10-22T11:03:00Z'>11:03</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
not that seeks matter these days, but some seeks can be eliminated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511840' id='431058'>
<a class='timestamp' href='#431058'><time timestamp='2015-10-22T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
reinventing the wheel should be  the last recourse
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511840' id='431059'>
<a class='timestamp' href='#431059'><time timestamp='2015-10-22T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: whatever just happened appears to have fried the device, so I guess it&#x27;ll be a while :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511840' id='431060'>
<a class='timestamp' href='#431060'><time timestamp='2015-10-22T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
&lt;grin&gt; <a href="https://github.com/jgarzik/pgdb" class="link" target="_blank">https://github.com/jgarzik/pgdb</a> <a href="https://github.com/jgarzik/pagedb" class="link" target="_blank">https://github.com/jgarzik/pagedb</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511840' id='431061'>
<a class='timestamp' href='#431061'><time timestamp='2015-10-22T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
Luke-Jr: I hope it wasn&#x27;t me logging in! :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431062'>
<a class='timestamp' href='#431062'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
heh, I don&#x27;t see how that could do it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431063'>
<a class='timestamp' href='#431063'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
leveldb does have a benchmark about batch write performance
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431064'>
<a class='timestamp' href='#431064'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
where sqlite is much slower
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431065'>
<a class='timestamp' href='#431065'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t see either, I didn&#x27;t even get a prompt
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431066'>
<a class='timestamp' href='#431066'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;ve disconnected now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511900' id='431067'>
<a class='timestamp' href='#431067'><time timestamp='2015-10-22T11:05:00Z'>11:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
though sqlite does win in synchronous write speed, which we also do frequently
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511960' id='431068'>
<a class='timestamp' href='#431068'><time timestamp='2015-10-22T11:06:00Z'>11:06</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: makes me wonder if it&#x27;s just a bad microSD card, which could make the failures invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511960' id='431069'>
<a class='timestamp' href='#431069'><time timestamp='2015-10-22T11:06:00Z'>11:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
would be interesting to patch sqlite into bitcoind and compare and do benchmarks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445511960' id='431070'>
<a class='timestamp' href='#431070'><time timestamp='2015-10-22T11:06:00Z'>11:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the only reason i&#x27;m suggesting sqlite is because it is <b>*very*</b> well tested afaik
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512020' id='431071'>
<a class='timestamp' href='#431071'><time timestamp='2015-10-22T11:07:00Z'>11:07</time></a>
&lt;<span class='nick nick-3'> * wumpus</span>&gt;
says that for the second time today about a different database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512020' id='431072'>
<a class='timestamp' href='#431072'><time timestamp='2015-10-22T11:07:00Z'>11:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: also on windows? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512020' id='431073'>
<a class='timestamp' href='#431073'><time timestamp='2015-10-22T11:07:00Z'>11:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
leveldb is also very well tested, it is used by many companies in production... just mostly on linux/unix servers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512080' id='431074'>
<a class='timestamp' href='#431074'><time timestamp='2015-10-22T11:08:00Z'>11:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512200' id='431075'>
<a class='timestamp' href='#431075'><time timestamp='2015-10-22T11:10:00Z'>11:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
do you know, how does sqlite do at caching?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512200' id='431076'>
<a class='timestamp' href='#431076'><time timestamp='2015-10-22T11:10:00Z'>11:10</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: wumpus: maintenance is probably more of a concern than anything else. I do remember wondering about leveldb&#x27;s longevity. sqlite is way too popular to disappear.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512200' id='431077'>
<a class='timestamp' href='#431077'><time timestamp='2015-10-22T11:10:00Z'>11:10</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sqlite leans a lot of OS caching, temporary files etc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512200' id='431078'>
<a class='timestamp' href='#431078'><time timestamp='2015-10-22T11:10:00Z'>11:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jgarzik: it can&#x27;t do a much worse job than leveldb at that at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512260' id='431079'>
<a class='timestamp' href='#431079'><time timestamp='2015-10-22T11:11:00Z'>11:11</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
if we&#x27;re just doing key/value what about all those database that do that sort of thing, like those nosql stacks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512320' id='431080'>
<a class='timestamp' href='#431080'><time timestamp='2015-10-22T11:12:00Z'>11:12</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I&#x27;m a big fan of sqlite, and used it in my DNS server project.   I don&#x27;t know that sqlite has batch update - does begin/commit suffice given our workflow?  They are -mostly- equivalent but not 100% equiv
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512320' id='431081'>
<a class='timestamp' href='#431081'><time timestamp='2015-10-22T11:12:00Z'>11:12</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
still. sqlite would be a better choice. But here&#x27;s the thing, if we use sqlite then you&#x27;re opening up the door for just about any database backend. specially if we made an abstraction layer
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512320' id='431082'>
<a class='timestamp' href='#431082'><time timestamp='2015-10-22T11:12:00Z'>11:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;The maximum size of a database file is 2147483646 pages. At the maximum page size of 65536 bytes, this translates into a maximum database size of approximately 1.4e+14 bytes &quot;   ok, apparently I misremembered
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431083'>
<a class='timestamp' href='#431083'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
btcdrak: there aren&#x27;t that much embeddable key/value stores 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431084'>
<a class='timestamp' href='#431084'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: true.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431085'>
<a class='timestamp' href='#431085'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
and sqlite wins in terms of support/maintenance.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431086'>
<a class='timestamp' href='#431086'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I certainly wouldn&#x27;t suggest expanding the bitcoind db in SQL, but using it as a dumb blob datastore shouldn&#x27;t be a big issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431087'>
<a class='timestamp' href='#431087'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and most of them are likely one-off projects, even worsely maintained than leveldb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431088'>
<a class='timestamp' href='#431088'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431089'>
<a class='timestamp' href='#431089'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jgarzik: +1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512380' id='431090'>
<a class='timestamp' href='#431090'><time timestamp='2015-10-22T11:13:00Z'>11:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
+!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512440' id='431091'>
<a class='timestamp' href='#431091'><time timestamp='2015-10-22T11:14:00Z'>11:14</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
+1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512440' id='431092'>
<a class='timestamp' href='#431092'><time timestamp='2015-10-22T11:14:00Z'>11:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
reminder: UTXO db is consensus-critical.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431093'>
<a class='timestamp' href='#431093'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
very aware
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431094'>
<a class='timestamp' href='#431094'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sqlite is extremely easy to embed in a project, it&#x27;s just one C file
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431095'>
<a class='timestamp' href='#431095'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
kv datastores off the top of my head: leveldb, gdbm, [n]dbm, tokyo cabinet, kyoto cabinet, berkeley db
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431096'>
<a class='timestamp' href='#431096'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
wumpus, er huh?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431097'>
<a class='timestamp' href='#431097'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: surely one <b>*big*</b> C file. all of SQL can&#x27;t be trivial.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512500' id='431098'>
<a class='timestamp' href='#431098'><time timestamp='2015-10-22T11:15:00Z'>11:15</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
wumpus, sqlite is quite bigger than one C file
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512560' id='431099'>
<a class='timestamp' href='#431099'><time timestamp='2015-10-22T11:16:00Z'>11:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
hm it used to be at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512560' id='431100'>
<a class='timestamp' href='#431100'><time timestamp='2015-10-22T11:16:00Z'>11:16</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
berkeley db is well maintained :) :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512620' id='431101'>
<a class='timestamp' href='#431101'><time timestamp='2015-10-22T11:17:00Z'>11:17</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sqlite is like 140kLOC
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512680' id='431102'>
<a class='timestamp' href='#431102'><time timestamp='2015-10-22T11:18:00Z'>11:18</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
for sqlite, if you pre-compile the SQL queries, it goes pretty fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512680' id='431103'>
<a class='timestamp' href='#431103'><time timestamp='2015-10-22T11:18:00Z'>11:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
of course we&#x27;d precompile them...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512740' id='431104'>
<a class='timestamp' href='#431104'><time timestamp='2015-10-22T11:19:00Z'>11:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i din&#x27;t think git subtreeing sqlite is reasonable
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512800' id='431105'>
<a class='timestamp' href='#431105'><time timestamp='2015-10-22T11:20:00Z'>11:20</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
oh this is why I thought it was one C file, yes it&#x27;s a very large one with everything pasted together: <a href="https://www.sqlite.org/amalgamation.html" class="link" target="_blank">https://www.sqlite.org/amalgamation.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512800' id='431106'>
<a class='timestamp' href='#431106'><time timestamp='2015-10-22T11:20:00Z'>11:20</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: license-wise?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512800' id='431107'>
<a class='timestamp' href='#431107'><time timestamp='2015-10-22T11:20:00Z'>11:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
size wise
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512860' id='431108'>
<a class='timestamp' href='#431108'><time timestamp='2015-10-22T11:21:00Z'>11:21</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sqlite is public domain, one of the few
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512920' id='431109'>
<a class='timestamp' href='#431109'><time timestamp='2015-10-22T11:22:00Z'>11:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, that amalgation is pretty awesome
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512920' id='431110'>
<a class='timestamp' href='#431110'><time timestamp='2015-10-22T11:22:00Z'>11:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can compile it with various flags for extensions disabled
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512920' id='431111'>
<a class='timestamp' href='#431111'><time timestamp='2015-10-22T11:22:00Z'>11:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
apparantly leveldb is 26kLOC in total
<br>
</div>

<div class='talk op-msg' data-timestamp='1445512920' id='431112'>
<a class='timestamp' href='#431112'><time timestamp='2015-10-22T11:22:00Z'>11:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: yep
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513040' id='431113'>
<a class='timestamp' href='#431113'><time timestamp='2015-10-22T11:24:00Z'>11:24</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
imo LOC and size are secondary factors
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513040' id='431114'>
<a class='timestamp' href='#431114'><time timestamp='2015-10-22T11:24:00Z'>11:24</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
primary is on going maintenance, reliability, ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513040' id='431115'>
<a class='timestamp' href='#431115'><time timestamp='2015-10-22T11:24:00Z'>11:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
LOC would be important if there is the chance we end up having to maintain/troubleshoot it ourself
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513040' id='431116'>
<a class='timestamp' href='#431116'><time timestamp='2015-10-22T11:24:00Z'>11:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(like now for leveldb)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513100' id='431117'>
<a class='timestamp' href='#431117'><time timestamp='2015-10-22T11:25:00Z'>11:25</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513100' id='431118'>
<a class='timestamp' href='#431118'><time timestamp='2015-10-22T11:25:00Z'>11:25</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I think pgdb will likely be 10k loc when finished
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513220' id='431119'>
<a class='timestamp' href='#431119'><time timestamp='2015-10-22T11:27:00Z'>11:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;SQlite as a  key-value database&quot; <a href="https://www.sqlite.org/cvstrac/wiki?p=KeyValueDatabase" class="link" target="_blank">https://www.sqlite.org/cvstrac/wiki?p=KeyValueDatabase</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513280' id='431120'>
<a class='timestamp' href='#431120'><time timestamp='2015-10-22T11:28:00Z'>11:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
looks very easy to do, the only question is indeed jgarzik&#x27;s whether the TRANSACTION/COMMIT is equivalent to batching as we use it now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431121'>
<a class='timestamp' href='#431121'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
another sql caveat - based on experience - you have to be careful that your &#x27;strings&#x27; are not translated in any way by the engine via unicode etc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431122'>
<a class='timestamp' href='#431122'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jgarzik: nobody is going to maintain consensus-critical behaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431123'>
<a class='timestamp' href='#431123'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sql injections? <b>*ducks*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431124'>
<a class='timestamp' href='#431124'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I used sqlite to store binary DNS records
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431125'>
<a class='timestamp' href='#431125'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sqlite is fully transactional
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513340' id='431126'>
<a class='timestamp' href='#431126'><time timestamp='2015-10-22T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
no matter what we use, we will need to maintain it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513400' id='431127'>
<a class='timestamp' href='#431127'><time timestamp='2015-10-22T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
even if that just means reviewing each upstream release
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513400' id='431128'>
<a class='timestamp' href='#431128'><time timestamp='2015-10-22T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or just reviewing their test practices
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513400' id='431129'>
<a class='timestamp' href='#431129'><time timestamp='2015-10-22T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sqlite is very well hammered
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513400' id='431130'>
<a class='timestamp' href='#431130'><time timestamp='2015-10-22T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(no, sqlite has proper parametrized queries, and from my experience its BLOBs are binary clean)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513400' id='431131'>
<a class='timestamp' href='#431131'><time timestamp='2015-10-22T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
few maintain software to consensus critical standards though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513460' id='431132'>
<a class='timestamp' href='#431132'><time timestamp='2015-10-22T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree, but a database interface clearly should... it&#x27;s perfectly specified in both dirextion: it should find every record that exist, and not find any reorc that doesn&#x27;t exist
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513460' id='431133'>
<a class='timestamp' href='#431133'><time timestamp='2015-10-22T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
another bit - make sure there are no limitations on rows-modified-at-once
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513460' id='431134'>
<a class='timestamp' href='#431134'><time timestamp='2015-10-22T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so anything that is nkt consensus compatible is a bug
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513460' id='431135'>
<a class='timestamp' href='#431135'><time timestamp='2015-10-22T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
otherwise we re-introduce the BDB fork issue (locks)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513520' id='431136'>
<a class='timestamp' href='#431136'><time timestamp='2015-10-22T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: fixing bugs is a consensus compatibility bug!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513520' id='431137'>
<a class='timestamp' href='#431137'><time timestamp='2015-10-22T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: the &quot;bug&quot; in the bdb case was that we didn&#x27;t chefk tue bdb return value, and regarded failure to write as a block validation failure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513580' id='431138'>
<a class='timestamp' href='#431138'><time timestamp='2015-10-22T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: fully agree there
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513580' id='431139'>
<a class='timestamp' href='#431139'><time timestamp='2015-10-22T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
anyhow, I need to go to sleep, but I think we will regret it if we import sqlite to consensus-critical code.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513580' id='431140'>
<a class='timestamp' href='#431140'><time timestamp='2015-10-22T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, well there was an issue where we were hitting BDB max lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513580' id='431141'>
<a class='timestamp' href='#431141'><time timestamp='2015-10-22T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, the point still stands - sql engines do somethings have max-rows-updated-in-one-transaction type limits
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513580' id='431142'>
<a class='timestamp' href='#431142'><time timestamp='2015-10-22T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: sure, but that wouldn&#x27;t have been a consensus failure threat if we didn&#x27;t treat out-of-locks as invalid-block
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513640' id='431143'>
<a class='timestamp' href='#431143'><time timestamp='2015-10-22T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
*sometimes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513640' id='431144'>
<a class='timestamp' href='#431144'><time timestamp='2015-10-22T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: it was us who turned an administrative restriction into a consensus problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513640' id='431145'>
<a class='timestamp' href='#431145'><time timestamp='2015-10-22T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
so, sql transaction limits is another one for the eval list
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431146'>
<a class='timestamp' href='#431146'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if we would just have gone &quot;oops! can&#x27;t write! quitting&quot;, like we do for out of disk, bdb would not have caused forks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431147'>
<a class='timestamp' href='#431147'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right, if it would treat database errors as a fatal error instead of rejection, it&#x27;d wouldn&#x27;t have been as bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431148'>
<a class='timestamp' href='#431148'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
nod
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431149'>
<a class='timestamp' href='#431149'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it would have been a bad DoS attack, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431150'>
<a class='timestamp' href='#431150'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
yep
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431151'>
<a class='timestamp' href='#431151'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but not a fork
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431152'>
<a class='timestamp' href='#431152'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but fairly easy to resolve
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513700' id='431153'>
<a class='timestamp' href='#431153'><time timestamp='2015-10-22T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513760' id='431154'>
<a class='timestamp' href='#431154'><time timestamp='2015-10-22T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
of course, you are absolutely right we need to be aware of such limits in sqlite or whatever we&#x27;re incestigating
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513760' id='431155'>
<a class='timestamp' href='#431155'><time timestamp='2015-10-22T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, investigating
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513760' id='431156'>
<a class='timestamp' href='#431156'><time timestamp='2015-10-22T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513760' id='431157'>
<a class='timestamp' href='#431157'><time timestamp='2015-10-22T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the keys are like right nezt to each other
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513820' id='431158'>
<a class='timestamp' href='#431158'><time timestamp='2015-10-22T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, sqlite databases are single files, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513880' id='431159'>
<a class='timestamp' href='#431159'><time timestamp='2015-10-22T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
yes*
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513880' id='431160'>
<a class='timestamp' href='#431160'><time timestamp='2015-10-22T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
* some temporary files such as journals are created along the way, and must exist for recovery post-crash
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513880' id='431161'>
<a class='timestamp' href='#431161'><time timestamp='2015-10-22T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, similar to bdb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513940' id='431162'>
<a class='timestamp' href='#431162'><time timestamp='2015-10-22T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s fine for application database stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513940' id='431163'>
<a class='timestamp' href='#431163'><time timestamp='2015-10-22T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe not wantes for wallets
<br>
</div>

<div class='talk op-msg' data-timestamp='1445513940' id='431164'>
<a class='timestamp' href='#431164'><time timestamp='2015-10-22T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*wanted
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514000' id='431165'>
<a class='timestamp' href='#431165'><time timestamp='2015-10-22T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sqlite files do want periodic maintenance via &#x27;VACUUM&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514060' id='431166'>
<a class='timestamp' href='#431166'><time timestamp='2015-10-22T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we can do that in our flushtodisk function
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514060' id='431167'>
<a class='timestamp' href='#431167'><time timestamp='2015-10-22T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
they get fragmented, old records cluttered, performance degrades a bit over time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514060' id='431168'>
<a class='timestamp' href='#431168'><time timestamp='2015-10-22T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
it is a very, very heavyweight operation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514120' id='431169'>
<a class='timestamp' href='#431169'><time timestamp='2015-10-22T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
info: <a href="https://sqlite.org/lang_vacuum.html" class="link" target="_blank">https://sqlite.org/lang_vacuum.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514120' id='431170'>
<a class='timestamp' href='#431170'><time timestamp='2015-10-22T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
auto_vacuum handles large deletes, but not fragments over time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514180' id='431171'>
<a class='timestamp' href='#431171'><time timestamp='2015-10-22T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
could just run it at startup and then auto_vacuum
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514180' id='431172'>
<a class='timestamp' href='#431172'><time timestamp='2015-10-22T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445514960' id='431173'>
<a class='timestamp' href='#431173'><time timestamp='2015-10-22T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
I&#x27;ve not seen everyone get so excited about something for a long time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445515260' id='431174'>
<a class='timestamp' href='#431174'><time timestamp='2015-10-22T12:01:00Z'>12:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;The author disclaims copyright to this source code.  In place ofa legal notice, here is a blessing:   May you do good and not evil.  May you find forgiveness for yourself and forgive others.  May you share freely, never taking more than you give.&quot; I love sqlite&#x27;s appraoch to licensing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445515860' id='431175'>
<a class='timestamp' href='#431175'><time timestamp='2015-10-22T12:11:00Z'>12:11</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
wumpus: if only there were more like that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519160' id='431176'>
<a class='timestamp' href='#431176'><time timestamp='2015-10-22T13:06:00Z'>13:06</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
At <a href="https://www.sqlite.org/cvstrac/wiki?p=KeyValueDatabase" class="link" target="_blank">https://www.sqlite.org/cvstrac/wiki?p=KeyValueDatabase</a> sqlite seems across the board worse... except for large numbers of records (our use case)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519160' id='431177'>
<a class='timestamp' href='#431177'><time timestamp='2015-10-22T13:06:00Z'>13:06</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I&#x27;m happy to create an sqlite branch for bitcoind, if nobody else is working on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519400' id='431178'>
<a class='timestamp' href='#431178'><time timestamp='2015-10-22T13:10:00Z'>13:10</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jgarzik: go for it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519580' id='431179'>
<a class='timestamp' href='#431179'><time timestamp='2015-10-22T13:13:00Z'>13:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
how mature is sqlite4?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519640' id='431180'>
<a class='timestamp' href='#431180'><time timestamp='2015-10-22T13:14:00Z'>13:14</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
good question
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519640' id='431181'>
<a class='timestamp' href='#431181'><time timestamp='2015-10-22T13:14:00Z'>13:14</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
vast majority in field is 3
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519640' id='431182'>
<a class='timestamp' href='#431182'><time timestamp='2015-10-22T13:14:00Z'>13:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
its design seems much closer to leveldb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519640' id='431183'>
<a class='timestamp' href='#431183'><time timestamp='2015-10-22T13:14:00Z'>13:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as it is... a key/value store internally
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519700' id='431184'>
<a class='timestamp' href='#431184'><time timestamp='2015-10-22T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i wonder if there is an api to access that key/value store interface
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519700' id='431185'>
<a class='timestamp' href='#431185'><time timestamp='2015-10-22T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i have read before that you can
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519700' id='431186'>
<a class='timestamp' href='#431186'><time timestamp='2015-10-22T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I was starting on it, but will happily leave it to you jgarzik
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519700' id='431187'>
<a class='timestamp' href='#431187'><time timestamp='2015-10-22T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
The default built-in storage engine is a log-structured merge database. It is very fast, faster than LevelDB, supports nested transactions, and stores all content in a single disk file.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519760' id='431188'>
<a class='timestamp' href='#431188'><time timestamp='2015-10-22T13:16:00Z'>13:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
^ from the sqlite4 design
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519760' id='431189'>
<a class='timestamp' href='#431189'><time timestamp='2015-10-22T13:16:00Z'>13:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
where do you seea nything about sqlite4? at least the download page only has 3
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519760' id='431190'>
<a class='timestamp' href='#431190'><time timestamp='2015-10-22T13:16:00Z'>13:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, sqlite4 is far from released
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519820' id='431191'>
<a class='timestamp' href='#431191'><time timestamp='2015-10-22T13:17:00Z'>13:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
oh, &quot;trunk&quot; :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519820' id='431192'>
<a class='timestamp' href='#431192'><time timestamp='2015-10-22T13:17:00Z'>13:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not an option at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519820' id='431193'>
<a class='timestamp' href='#431193'><time timestamp='2015-10-22T13:17:00Z'>13:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sounds great though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519820' id='431194'>
<a class='timestamp' href='#431194'><time timestamp='2015-10-22T13:17:00Z'>13:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
alsoz sqlite3 does not promise backward write compatibility... so it is like bdb, and we need to guarantee only increases in version
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519880' id='431195'>
<a class='timestamp' href='#431195'><time timestamp='2015-10-22T13:18:00Z'>13:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it does promise backward read compatibility?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519880' id='431196'>
<a class='timestamp' href='#431196'><time timestamp='2015-10-22T13:18:00Z'>13:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519940' id='431197'>
<a class='timestamp' href='#431197'><time timestamp='2015-10-22T13:19:00Z'>13:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well then it&#x27;s not too bad, if it detects a downgrade, it could export|import the database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519940' id='431198'>
<a class='timestamp' href='#431198'><time timestamp='2015-10-22T13:19:00Z'>13:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wait
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519940' id='431199'>
<a class='timestamp' href='#431199'><time timestamp='2015-10-22T13:19:00Z'>13:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
berkeleydb doesn&#x27;t even guarantee that much
<br>
</div>

<div class='talk op-msg' data-timestamp='1445519940' id='431200'>
<a class='timestamp' href='#431200'><time timestamp='2015-10-22T13:19:00Z'>13:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
databases created by 3.3 can&#x27;t be read by earlier 3.x versions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520000' id='431201'>
<a class='timestamp' href='#431201'><time timestamp='2015-10-22T13:20:00Z'>13:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
lol, and this caused so much problems they reverted to the old format by default in 3.3.6
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520060' id='431202'>
<a class='timestamp' href='#431202'><time timestamp='2015-10-22T13:21:00Z'>13:21</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
note - single file db implies large file support req
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520120' id='431203'>
<a class='timestamp' href='#431203'><time timestamp='2015-10-22T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
is that not available on every platform these days?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520120' id='431204'>
<a class='timestamp' href='#431204'><time timestamp='2015-10-22T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
is that unreasonable these days?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520120' id='431205'>
<a class='timestamp' href='#431205'><time timestamp='2015-10-22T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
every platform, but some filesystems may be e.g. fat32 for weird reasons
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520120' id='431206'>
<a class='timestamp' href='#431206'><time timestamp='2015-10-22T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
... and has been for 10 years or so
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431207'>
<a class='timestamp' href='#431207'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I think it&#x27;s reasonable
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431208'>
<a class='timestamp' href='#431208'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh: a database created by version X will always be read/write compatible with version X, even if modified by later versions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431209'>
<a class='timestamp' href='#431209'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
just noting
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431210'>
<a class='timestamp' href='#431210'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
fat32 is pretty much dead
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431211'>
<a class='timestamp' href='#431211'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so it&#x27;s not an auto-update to whatever the format in the later version is, like bdb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431212'>
<a class='timestamp' href='#431212'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, yeah, kernel filesystem rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431213'>
<a class='timestamp' href='#431213'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it also doesn&#x27;t support bigger disks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520180' id='431214'>
<a class='timestamp' href='#431214'><time timestamp='2015-10-22T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
wumpus, sadly very much alive on USB sticks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520240' id='431215'>
<a class='timestamp' href='#431215'><time timestamp='2015-10-22T13:24:00Z'>13:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
put bitcoind&#x27;d chainstate on a USB stick: you are eaten by a grue
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520240' id='431216'>
<a class='timestamp' href='#431216'><time timestamp='2015-10-22T13:24:00Z'>13:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
<b>*small*</b> USB sticks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520240' id='431217'>
<a class='timestamp' href='#431217'><time timestamp='2015-10-22T13:24:00Z'>13:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also: for now the chainstate still fits in 2 GB...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520240' id='431218'>
<a class='timestamp' href='#431218'><time timestamp='2015-10-22T13:24:00Z'>13:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
... for now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520300' id='431219'>
<a class='timestamp' href='#431219'><time timestamp='2015-10-22T13:25:00Z'>13:25</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
as I said... just making a note because it&#x27;s something of which people should be aware.  continuing to hack on it :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520300' id='431220'>
<a class='timestamp' href='#431220'><time timestamp='2015-10-22T13:25:00Z'>13:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
awesome, thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520300' id='431221'>
<a class='timestamp' href='#431221'><time timestamp='2015-10-22T13:25:00Z'>13:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
great
<br>
</div>

<div class='talk op-msg' data-timestamp='1445520420' id='431222'>
<a class='timestamp' href='#431222'><time timestamp='2015-10-22T13:27:00Z'>13:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
32GB is pretty much the limit for FAT32 devices, it&#x27;s possible to have larger volumes, but it becomes really ineffiecient and at least windows doesn&#x27;t allow formatting them
<br>
</div>

<div class='talk op-msg' data-timestamp='1445525640' id='431223'>
<a class='timestamp' href='#431223'><time timestamp='2015-10-22T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-1'> GitHub122</span>&gt;
[bitcoin] MarcoFalke closed pull request #6866: [trivial] fix white space in rpc help messages (master...MarcoFalke-2015-rpcWhitespace) <a href="https://github.com/bitcoin/bitcoin/pull/6866" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6866</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445525640' id='431224'>
<a class='timestamp' href='#431224'><time timestamp='2015-10-22T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i&#x27;m trying to think about how to preserve the state of the mempool while generating block templates
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526120' id='431225'>
<a class='timestamp' href='#431225'><time timestamp='2015-10-22T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: how about being able to mark mempool txn as locked?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526180' id='431226'>
<a class='timestamp' href='#431226'><time timestamp='2015-10-22T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
individual transactions, that is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526180' id='431227'>
<a class='timestamp' href='#431227'><time timestamp='2015-10-22T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: how do you mean?  the block template generation code needs to mark all of them as locked?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526180' id='431228'>
<a class='timestamp' href='#431228'><time timestamp='2015-10-22T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or do you mean if you need to delete something, such as with RBF, then you mark it as deleted and go ahead and add the new one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526240' id='431229'>
<a class='timestamp' href='#431229'><time timestamp='2015-10-22T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: while the template generator runs, it locks transactions one by one as they are added to the template
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526240' id='431230'>
<a class='timestamp' href='#431230'><time timestamp='2015-10-22T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the next transactions it fetches are guaranteed to be not conflicting with the ones it already has
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526300' id='431231'>
<a class='timestamp' href='#431231'><time timestamp='2015-10-22T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you want a new incoming block to override that though, and cancel the generator to make it start over
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526300' id='431232'>
<a class='timestamp' href='#431232'><time timestamp='2015-10-22T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes agreed with that last part, i&#x27;ll tackle that later
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526360' id='431233'>
<a class='timestamp' href='#431233'><time timestamp='2015-10-22T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i&#x27;m not sure how to just lock txs one by one, you&#x27;d have to lock the mempool.cs each time you went to look up a tx to decide to add it to the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526360' id='431234'>
<a class='timestamp' href='#431234'><time timestamp='2015-10-22T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m starting off by trying to modify the existing CNB to hold locks a lot less
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526420' id='431235'>
<a class='timestamp' href='#431235'><time timestamp='2015-10-22T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so i&#x27;m imagning it basically copies ptrs to all the txs in the mempool and the score it needs for them
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526420' id='431236'>
<a class='timestamp' href='#431236'><time timestamp='2015-10-22T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then it doesn&#x27;t need to hold mempool.cs any more as long as the ptr does not become invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526420' id='431237'>
<a class='timestamp' href='#431237'><time timestamp='2015-10-22T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which would only happne if the txn is deleted
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431238'>
<a class='timestamp' href='#431238'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess transactions would get a refcount
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431239'>
<a class='timestamp' href='#431239'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and the refcount value itself would be protected by mempool.cs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431240'>
<a class='timestamp' href='#431240'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i think that has to be for all of the txs as you&#x27;re running the logic of figuring out which ones need to be in the template
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431241'>
<a class='timestamp' href='#431241'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, but i was imagining it was a singular refcount
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431242'>
<a class='timestamp' href='#431242'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm, does the mempool not hold some index sorted by template inclusion preference?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526480' id='431243'>
<a class='timestamp' href='#431243'><time timestamp='2015-10-22T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instead of per tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526540' id='431244'>
<a class='timestamp' href='#431244'><time timestamp='2015-10-22T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah so thats where my approach might not be the best approach b/c the new template generation code will have such an index
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526540' id='431245'>
<a class='timestamp' href='#431245'><time timestamp='2015-10-22T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
another idea is to remove the storage if txn from the mempool entirely
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526600' id='431246'>
<a class='timestamp' href='#431246'><time timestamp='2015-10-22T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but even still you need to iterate far past the size of a block 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526600' id='431247'>
<a class='timestamp' href='#431247'><time timestamp='2015-10-22T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you just get a transaction store manager, which you give transactions, and it returns a refcounted pointer
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526600' id='431248'>
<a class='timestamp' href='#431248'><time timestamp='2015-10-22T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mempool stores the pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526600' id='431249'>
<a class='timestamp' href='#431249'><time timestamp='2015-10-22T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess that&#x27;s just smart pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526660' id='431250'>
<a class='timestamp' href='#431250'><time timestamp='2015-10-22T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so the template generator would grab pointers to the top N (some multiple of a block), increase their refcount, release memlool.cs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526660' id='431251'>
<a class='timestamp' href='#431251'><time timestamp='2015-10-22T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then goes off to build a block, verify if wanted, ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526660' id='431252'>
<a class='timestamp' href='#431252'><time timestamp='2015-10-22T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and then release the pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526720' id='431253'>
<a class='timestamp' href='#431253'><time timestamp='2015-10-22T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mempool can change during that time... you just know that the set you grabbed at that point while holding the lock is internally consistent
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526720' id='431254'>
<a class='timestamp' href='#431254'><time timestamp='2015-10-22T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and consistent with the block is was building on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526720' id='431255'>
<a class='timestamp' href='#431255'><time timestamp='2015-10-22T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes thats what i&#x27;m going for
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431256'>
<a class='timestamp' href='#431256'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i guess it depends on how big the set is compared to the whole mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431257'>
<a class='timestamp' href='#431257'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so my idea was that rather than marking individual txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431258'>
<a class='timestamp' href='#431258'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you just tell the mempool, hey, referring to things, don&#x27;t delete
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431259'>
<a class='timestamp' href='#431259'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and then occasionally that gets freed, and anything marked for deletion can happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431260'>
<a class='timestamp' href='#431260'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431261'>
<a class='timestamp' href='#431261'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431262'>
<a class='timestamp' href='#431262'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
since deletes are rarer and smaller than adds
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526780' id='431263'>
<a class='timestamp' href='#431263'><time timestamp='2015-10-22T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sounds more complicated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526840' id='431264'>
<a class='timestamp' href='#431264'><time timestamp='2015-10-22T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, maybe i&#x27;ll explore both
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526900' id='431265'>
<a class='timestamp' href='#431265'><time timestamp='2015-10-22T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
next question and this might be related to CSV
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526900' id='431266'>
<a class='timestamp' href='#431266'><time timestamp='2015-10-22T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
really annoying that CheckInputs needs cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526900' id='431267'>
<a class='timestamp' href='#431267'><time timestamp='2015-10-22T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
doesn&#x27;t seem like it should have to?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526960' id='431268'>
<a class='timestamp' href='#431268'><time timestamp='2015-10-22T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i think it&#x27;s relative easy this way: turn the storage of txn in the mempool into smart pointers, and you can very cheaply and efficiently ask the mempool for the set of all its transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526960' id='431269'>
<a class='timestamp' href='#431269'><time timestamp='2015-10-22T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you&#x27;re storing the hashblock that its valid at, and that can&#x27;t change height
<br>
</div>

<div class='talk op-msg' data-timestamp='1445526960' id='431270'>
<a class='timestamp' href='#431270'><time timestamp='2015-10-22T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it shouldn&#x27;t be needed, indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527020' id='431271'>
<a class='timestamp' href='#431271'><time timestamp='2015-10-22T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: not that easy, you need stuff from the mempool entries, thats where fees are stored
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527020' id='431272'>
<a class='timestamp' href='#431272'><time timestamp='2015-10-22T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so you still have to iterate to figure out which pointers you need and copy the meta information
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527020' id='431273'>
<a class='timestamp' href='#431273'><time timestamp='2015-10-22T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, so that fee information needs to be inside the smart pointed-to objects
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527080' id='431274'>
<a class='timestamp' href='#431274'><time timestamp='2015-10-22T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so all you&#x27;ve done now is taken the multi-index approach and say ehh forget that, lets just have multiple indexes referring to this same set of pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527140' id='431275'>
<a class='timestamp' href='#431275'><time timestamp='2015-10-22T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i may be missing something
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527140' id='431276'>
<a class='timestamp' href='#431276'><time timestamp='2015-10-22T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think the only complication from my idea is damn RBF... otherwise you just don&#x27;t call any eviction code except periodically...  and there is no problem running it only periodically
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527140' id='431277'>
<a class='timestamp' href='#431277'><time timestamp='2015-10-22T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and you don&#x27;t even have to track anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527200' id='431278'>
<a class='timestamp' href='#431278'><time timestamp='2015-10-22T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what i&#x27;m suggesting is a way to make cheap snapshots of subsets of the mempool at a given time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527200' id='431279'>
<a class='timestamp' href='#431279'><time timestamp='2015-10-22T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
those snapshots themselves don&#x27;t have an index, but can be ordered by one at the time they are created
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527200' id='431280'>
<a class='timestamp' href='#431280'><time timestamp='2015-10-22T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
isn&#x27;t that enough?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527260' id='431281'>
<a class='timestamp' href='#431281'><time timestamp='2015-10-22T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah maybe, i think i&#x27;m just leary of the double indirection now where the multi-index is a multi-index of ptrs, but maybe thats something stupid to worry about
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527500' id='431282'>
<a class='timestamp' href='#431282'><time timestamp='2015-10-22T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the transactions inside the mempool already have a dozen or so indirections
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527560' id='431283'>
<a class='timestamp' href='#431283'><time timestamp='2015-10-22T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, more like 6
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527560' id='431284'>
<a class='timestamp' href='#431284'><time timestamp='2015-10-22T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but still!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527620' id='431285'>
<a class='timestamp' href='#431285'><time timestamp='2015-10-22T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so something like a boost::shared_ptr
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527680' id='431286'>
<a class='timestamp' href='#431286'><time timestamp='2015-10-22T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, that specifically :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527680' id='431287'>
<a class='timestamp' href='#431287'><time timestamp='2015-10-22T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sorry, i thought it was called smart_ptr :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527740' id='431288'>
<a class='timestamp' href='#431288'><time timestamp='2015-10-22T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you probably want to wrap CTransaction inside something that also contains its (direct) fee and perhaps other immutable statistics
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527740' id='431289'>
<a class='timestamp' href='#431289'><time timestamp='2015-10-22T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and then have sharee_ptrs to those inside the mempool entries
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527740' id='431290'>
<a class='timestamp' href='#431290'><time timestamp='2015-10-22T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
heh, we could even serialize the transactions inside to reduce memory usage...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527860' id='431291'>
<a class='timestamp' href='#431291'><time timestamp='2015-10-22T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, so then it&#x27;ll get a bit more complicated with ancestor package tracking when you have mutable state like ancestor fee rate that you want to copy to your template generation code, but that was going to be difficult period
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527920' id='431292'>
<a class='timestamp' href='#431292'><time timestamp='2015-10-22T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
why do you need it in the template generator code?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527920' id='431293'>
<a class='timestamp' href='#431293'><time timestamp='2015-10-22T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
thats the sort the logic uses
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527980' id='431294'>
<a class='timestamp' href='#431294'><time timestamp='2015-10-22T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yikes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527980' id='431295'>
<a class='timestamp' href='#431295'><time timestamp='2015-10-22T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sort the list of copied pointers according to the sorting criterion you want while creating it (so while holding mempool.cs)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527980' id='431296'>
<a class='timestamp' href='#431296'><time timestamp='2015-10-22T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then release mempool.cs and you can forget it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527980' id='431297'>
<a class='timestamp' href='#431297'><time timestamp='2015-10-22T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, but see thats the complicated part that takes a long time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445527980' id='431298'>
<a class='timestamp' href='#431298'><time timestamp='2015-10-22T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528040' id='431299'>
<a class='timestamp' href='#431299'><time timestamp='2015-10-22T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the tx thats sorted at the top , really links to a lot of other txs , whose ptrs you have to grab to
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528040' id='431300'>
<a class='timestamp' href='#431300'><time timestamp='2015-10-22T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm, right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528040' id='431301'>
<a class='timestamp' href='#431301'><time timestamp='2015-10-22T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but then how do you solve the problem of once you include that in your template
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528040' id='431302'>
<a class='timestamp' href='#431302'><time timestamp='2015-10-22T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
everything elses sort changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528040' id='431303'>
<a class='timestamp' href='#431303'><time timestamp='2015-10-22T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i wouldn&#x27;t bother with changing sorts
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528160' id='431304'>
<a class='timestamp' href='#431304'><time timestamp='2015-10-22T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well that&#x27;ll be the magic of the algorithm, it&#x27;ll probably have to be some heuristic, but its very easy to have expensive chain A-B-C and so C is sorted first, but then cheap C2 is still sorted quite high.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528160' id='431305'>
<a class='timestamp' href='#431305'><time timestamp='2015-10-22T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
uh not exactly but close
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528160' id='431306'>
<a class='timestamp' href='#431306'><time timestamp='2015-10-22T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but yes, i agree we don&#x27;t have to be perfect
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528220' id='431307'>
<a class='timestamp' href='#431307'><time timestamp='2015-10-22T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok you&#x27;ve given me some ideas... let me see what i come up with
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528400' id='431308'>
<a class='timestamp' href='#431308'><time timestamp='2015-10-22T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
great
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528400' id='431309'>
<a class='timestamp' href='#431309'><time timestamp='2015-10-22T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
feel free to completely disregard my ideas :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528880' id='431310'>
<a class='timestamp' href='#431310'><time timestamp='2015-10-22T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
RE locking transactions one-by-one - that is the typical parallelism solution
<br>
</div>

<div class='talk op-msg' data-timestamp='1445528880' id='431311'>
<a class='timestamp' href='#431311'><time timestamp='2015-10-22T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
just need a gatekeeper (core struct lock) for insert/delete/move
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529180' id='431312'>
<a class='timestamp' href='#431312'><time timestamp='2015-10-22T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-1'> GitHub181</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/a09297010e17...2cd020d054d6" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/a09297010e17...2cd020d054d6</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529180' id='431313'>
<a class='timestamp' href='#431313'><time timestamp='2015-10-22T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-1'> GitHub181</span>&gt;
bitcoin/master 3cb56f3 Daniel Cousens: *: alias -h for --help
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529180' id='431314'>
<a class='timestamp' href='#431314'><time timestamp='2015-10-22T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-1'> GitHub181</span>&gt;
bitcoin/master 2cd020d Wladimir J. van der Laan: Merge pull request #6846...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529180' id='431315'>
<a class='timestamp' href='#431315'><time timestamp='2015-10-22T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-12'> GitHub119</span>&gt;
[bitcoin] laanwj closed pull request #6846: [Trivial] bitcoind: alias -h for -help (master...aliash) <a href="https://github.com/bitcoin/bitcoin/pull/6846" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6846</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529720' id='431316'>
<a class='timestamp' href='#431316'><time timestamp='2015-10-22T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-6'> GitHub145</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2cd020d054d6...f2c869aef2e7" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2cd020d054d6...f2c869aef2e7</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529720' id='431317'>
<a class='timestamp' href='#431317'><time timestamp='2015-10-22T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-6'> GitHub145</span>&gt;
bitcoin/master c6824f8 J Ross Nicoll: Add DERSIG transaction test cases...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529720' id='431318'>
<a class='timestamp' href='#431318'><time timestamp='2015-10-22T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-6'> GitHub145</span>&gt;
bitcoin/master f2c869a Wladimir J. van der Laan: Merge pull request #6848...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445529720' id='431319'>
<a class='timestamp' href='#431319'><time timestamp='2015-10-22T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-12'> GitHub77</span>&gt;
[bitcoin] laanwj closed pull request #6848: Add DERSIG transaction test cases (master...bip66-tests) <a href="https://github.com/bitcoin/bitcoin/pull/6848" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6848</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445530680' id='431320'>
<a class='timestamp' href='#431320'><time timestamp='2015-10-22T16:18:00Z'>16:18</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
FYI: git HEAD master isn&#x27;t working for me on OSX.  Running make check gets me:
<br>
</div>

<div class='talk op-msg' data-timestamp='1445530680' id='431321'>
<a class='timestamp' href='#431321'><time timestamp='2015-10-22T16:18:00Z'>16:18</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
libc++abi.dylib: terminating with uncaught exception of type boost::exception_detail::clone_impl&lt;boost::exception_detail::error_info_injector&lt;boost::lock_error&gt; &gt;: boost: mutex lock failed in pthread_mutex_lock: Invalid argument
<br>
</div>

<div class='talk op-msg' data-timestamp='1445530800' id='431322'>
<a class='timestamp' href='#431322'><time timestamp='2015-10-22T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
I&#x27;m very confused, because git bisect blames a commit that works....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445530800' id='431323'>
<a class='timestamp' href='#431323'><time timestamp='2015-10-22T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gavinandresen: sounds like your boost may be built against the wrong stdlib? checking master on osx here now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445530860' id='431324'>
<a class='timestamp' href='#431324'><time timestamp='2015-10-22T16:21:00Z'>16:21</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
cfields: I thought that too, did a brew uninstall / brew install of boost
<br>
</div>

<div class='talk op-msg' data-timestamp='1445531100' id='431325'>
<a class='timestamp' href='#431325'><time timestamp='2015-10-22T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
morcos: sorry was afk. My other question was how does mempool evictions play into the mix? I assume one doesnt want to evict a txn that you&#x27;re trying to mine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445531160' id='431326'>
<a class='timestamp' href='#431326'><time timestamp='2015-10-22T16:26:00Z'>16:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
btcdrak: yes, thats what my concern was.  the only way a pointer to a tx becomes invalid now is if the tx is deleted.  A) throught being mined, in which case you want to abort block template generation anyway or B) through eviction or RBF
<br>
</div>

<div class='talk op-msg' data-timestamp='1445531220' id='431327'>
<a class='timestamp' href='#431327'><time timestamp='2015-10-22T16:27:00Z'>16:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
for B1) eviction, i thought it would just be easy to just skip eviction if the template_tx_lock is held, and just make sure eviction gets to run every so often.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445531280' id='431328'>
<a class='timestamp' href='#431328'><time timestamp='2015-10-22T16:28:00Z'>16:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but B2) RBF, doesn&#x27;t have an ideal solution,  i wanted to just flag those txs, but maybe sipas idea with shared_ptrs is cleaner
<br>
</div>

<div class='talk op-msg' data-timestamp='1445531640' id='431329'>
<a class='timestamp' href='#431329'><time timestamp='2015-10-22T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gavinandresen: ok here. What compiler/boost/osx version?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445532300' id='431330'>
<a class='timestamp' href='#431330'><time timestamp='2015-10-22T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
cfields: Apple LLVM version 7.0.0 (clang-700.0.72), boost /usr/local/Cellar/boost/1.58.0, osx 10.10.5  ....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445532360' id='431331'>
<a class='timestamp' href='#431331'><time timestamp='2015-10-22T16:46:00Z'>16:46</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
... but it is very possible my machine is in some weird state, I upgraded my XCode yesterday.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445532420' id='431332'>
<a class='timestamp' href='#431332'><time timestamp='2015-10-22T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gavinandresen: first rule of fight club - &quot;never upgrade XCode&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445532960' id='431333'>
<a class='timestamp' href='#431333'><time timestamp='2015-10-22T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445532960' id='431334'>
<a class='timestamp' href='#431334'><time timestamp='2015-10-22T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
just did last night...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533140' id='431335'>
<a class='timestamp' href='#431335'><time timestamp='2015-10-22T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gmaxwell / jgarzik: ping. I must be going crazy. From what I can tell experimentally (and backed by man pages), on Linux, our incoming connections are being treated as blocking.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533140' id='431336'>
<a class='timestamp' href='#431336'><time timestamp='2015-10-22T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
cfields, post-accept(2) you set sockets to non-blocking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533140' id='431337'>
<a class='timestamp' href='#431337'><time timestamp='2015-10-22T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
because O_NONBLOCK isn&#x27;t inherited by accept
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533200' id='431338'>
<a class='timestamp' href='#431338'><time timestamp='2015-10-22T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
nod
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533200' id='431339'>
<a class='timestamp' href='#431339'><time timestamp='2015-10-22T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jgarzik: should, sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533200' id='431340'>
<a class='timestamp' href='#431340'><time timestamp='2015-10-22T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
but we don&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533200' id='431341'>
<a class='timestamp' href='#431341'><time timestamp='2015-10-22T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
oops
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533200' id='431342'>
<a class='timestamp' href='#431342'><time timestamp='2015-10-22T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
seems surprising, seems like it would have been well noticed before now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533260' id='431343'>
<a class='timestamp' href='#431343'><time timestamp='2015-10-22T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that would imply that the &quot;opportunistic write&quot; always succeeds
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533260' id='431344'>
<a class='timestamp' href='#431344'><time timestamp='2015-10-22T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
for the most part it should be ok because reads wait for select(), but i&#x27;m surprised it hasn&#x27;t caused issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533260' id='431345'>
<a class='timestamp' href='#431345'><time timestamp='2015-10-22T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that should be trivial to test?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533260' id='431346'>
<a class='timestamp' href='#431346'><time timestamp='2015-10-22T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
no wait - send/recv have per-call NB flags
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533320' id='431347'>
<a class='timestamp' href='#431347'><time timestamp='2015-10-22T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jgarzik: ah right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533380' id='431348'>
<a class='timestamp' href='#431348'><time timestamp='2015-10-22T17:03:00Z'>17:03</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jgarzik: still though, i&#x27;ve read about select() acting funny on linux with blocking sockets
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533440' id='431349'>
<a class='timestamp' href='#431349'><time timestamp='2015-10-22T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
like haha, that&#x27;s a laugh funny?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533500' id='431350'>
<a class='timestamp' href='#431350'><time timestamp='2015-10-22T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-7'> * jgarzik</span>&gt;
attempts to implement db iteration without brute force &#x27;select * from table&#x27; into RAM ;p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533560' id='431351'>
<a class='timestamp' href='#431351'><time timestamp='2015-10-22T17:06:00Z'>17:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
&quot;Under Linux, select() may report a socket file descriptor as &quot;ready for reading&quot;, while nevertheless a subsequent read blocks... Thus it may be safer to use O_NONBLOCK on sockets that should not block.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533560' id='431352'>
<a class='timestamp' href='#431352'><time timestamp='2015-10-22T17:06:00Z'>17:06</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
recv() will fail in that case
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533560' id='431353'>
<a class='timestamp' href='#431353'><time timestamp='2015-10-22T17:06:00Z'>17:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
Either way, forcing them to nonblock after accept can&#x27;t hurt, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533560' id='431354'>
<a class='timestamp' href='#431354'><time timestamp='2015-10-22T17:06:00Z'>17:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533620' id='431355'>
<a class='timestamp' href='#431355'><time timestamp='2015-10-22T17:07:00Z'>17:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: i guess you can get some sort of object/state which you can ask for &quot;more results&quot; ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533620' id='431356'>
<a class='timestamp' href='#431356'><time timestamp='2015-10-22T17:07:00Z'>17:07</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
it wouldn&#x27;t just block?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533680' id='431357'>
<a class='timestamp' href='#431357'><time timestamp='2015-10-22T17:08:00Z'>17:08</time></a>
&lt;<span class='nick nick-2'> GitHub132</span>&gt;
[bitcoin] MarcoFalke opened pull request #6870: [trivial] Misc cleanup and translations (master...MarcoFalke-2015-trivial3) <a href="https://github.com/bitcoin/bitcoin/pull/6870" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6870</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533680' id='431358'>
<a class='timestamp' href='#431358'><time timestamp='2015-10-22T17:08:00Z'>17:08</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jgarzik: er, the DONTWAIT. nm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533920' id='431359'>
<a class='timestamp' href='#431359'><time timestamp='2015-10-22T17:12:00Z'>17:12</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, you can &#x27;select *&#x27; and iterate in one direction (forwards; next-result), whereas the CDBIterator wants Next, Prev and Seek operations
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533980' id='431360'>
<a class='timestamp' href='#431360'><time timestamp='2015-10-22T17:13:00Z'>17:13</time></a>
&lt;<span class='nick nick-7'> * jgarzik</span>&gt;
is studying the callers/users of CDBIterator now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445533980' id='431361'>
<a class='timestamp' href='#431361'><time timestamp='2015-10-22T17:13:00Z'>17:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: i don&#x27;t think we use prev
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534100' id='431362'>
<a class='timestamp' href='#431362'><time timestamp='2015-10-22T17:15:00Z'>17:15</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
so it seems
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534160' id='431363'>
<a class='timestamp' href='#431363'><time timestamp='2015-10-22T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and seek would be equivalent to just starting the search
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534160' id='431364'>
<a class='timestamp' href='#431364'><time timestamp='2015-10-22T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gavinandresen: that&#x27;s no good. i&#x27;m confused about that error, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534220' id='431365'>
<a class='timestamp' href='#431365'><time timestamp='2015-10-22T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, well seek-start, seek-end and seek-key are all different
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534220' id='431366'>
<a class='timestamp' href='#431366'><time timestamp='2015-10-22T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: i think the abstraction can be changed so we have a few &#x27;entry types&#x27; (which would translate to separate sqlite tables)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534220' id='431367'>
<a class='timestamp' href='#431367'><time timestamp='2015-10-22T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jgarzik: and only have iterators for all-data-within-one-entry-type
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534220' id='431368'>
<a class='timestamp' href='#431368'><time timestamp='2015-10-22T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534280' id='431369'>
<a class='timestamp' href='#431369'><time timestamp='2015-10-22T17:18:00Z'>17:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which would be compatible with both leveldb and sqlite
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534460' id='431370'>
<a class='timestamp' href='#431370'><time timestamp='2015-10-22T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
ah a few of these db ops are like Prev(), unused.  job easier++
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534640' id='431371'>
<a class='timestamp' href='#431371'><time timestamp='2015-10-22T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
hrm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534640' id='431372'>
<a class='timestamp' href='#431372'><time timestamp='2015-10-22T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
sipa, lex order?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445534700' id='431373'>
<a class='timestamp' href='#431373'><time timestamp='2015-10-22T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
seems so
<br>
</div>

<div class='talk op-msg' data-timestamp='1445535780' id='431374'>
<a class='timestamp' href='#431374'><time timestamp='2015-10-22T17:43:00Z'>17:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
some things need lex order, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445538480' id='431375'>
<a class='timestamp' href='#431375'><time timestamp='2015-10-22T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
FYI: my build-failing-on-OSX problem went away with a &#x27;git clean -dxf&#x27; then re-autogen/configure/build....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445538960' id='431376'>
<a class='timestamp' href='#431376'><time timestamp='2015-10-22T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-12'> * jonasschnelli</span>&gt;
did accidentally sent untracked files to nirvana serval times with `git clean -dxf`...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445538960' id='431377'>
<a class='timestamp' href='#431377'><time timestamp='2015-10-22T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-4'> * sipa</span>&gt;
too
<br>
</div>

<div class='talk op-msg' data-timestamp='1445539020' id='431378'>
<a class='timestamp' href='#431378'><time timestamp='2015-10-22T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540280' id='431379'>
<a class='timestamp' href='#431379'><time timestamp='2015-10-22T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I haven&#x27;t tried it on bitcoin core yet, but the latest functionality in rr (replay debugger) looks pretty great: <a href="http://robert.ocallahan.org/2015/10/rr-40-released-with-reverse-execution.html" class="link" target="_blank">http://robert.ocallahan.org/2015/10/rr-40-released-with-reverse-execution.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540520' id='431380'>
<a class='timestamp' href='#431380'><time timestamp='2015-10-22T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
did i hear rumblings about switching to sqlite?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540580' id='431381'>
<a class='timestamp' href='#431381'><time timestamp='2015-10-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
i wish there was a &#x27;git stage --clean&#x27; command
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540580' id='431382'>
<a class='timestamp' href='#431382'><time timestamp='2015-10-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
meeting over at #bitcoin-dev now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540580' id='431383'>
<a class='timestamp' href='#431383'><time timestamp='2015-10-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
isn&#x27;t it git checkout . ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540580' id='431384'>
<a class='timestamp' href='#431384'><time timestamp='2015-10-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jcorgan: yes, jgarzik is working on it now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540640' id='431385'>
<a class='timestamp' href='#431385'><time timestamp='2015-10-22T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
oh sweet.  then we can use sqlcipher and get full db ondisk encryption
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540640' id='431386'>
<a class='timestamp' href='#431386'><time timestamp='2015-10-22T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
it&#x27;s a drop-in replacement/fork for sqlite that operates at the db page level, like dmcrypte for block devices
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540700' id='431387'>
<a class='timestamp' href='#431387'><time timestamp='2015-10-22T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
why do you need encryption for public data? :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540700' id='431388'>
<a class='timestamp' href='#431388'><time timestamp='2015-10-22T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
sipa: i presume he&#x27;s talking about wallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540700' id='431389'>
<a class='timestamp' href='#431389'><time timestamp='2015-10-22T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i wouldn&#x27;t use sqlite for the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540700' id='431390'>
<a class='timestamp' href='#431390'><time timestamp='2015-10-22T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jcorgan: you saw that discussion, but I expect it won&#x27;t happen (At least with sqllite3) as-- if I&#x27;m not mistaken-- btcd tried it and found the performance unacceptable.  (but we should anyways, both to have a comparison point, and because sqllite4 might be faster even if 3 is too slow)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540760' id='431391'>
<a class='timestamp' href='#431391'><time timestamp='2015-10-22T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
encrypt ALL THE THINGS
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540820' id='431392'>
<a class='timestamp' href='#431392'><time timestamp='2015-10-22T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
RE: switching to sqlite: this CACM article was very interesting:  <a href="http://cacm.acm.org/magazines/2015/10/192379-crash-consistency/abstract" class="link" target="_blank">http://cacm.acm.org/magazines/2015/10/192379-crash-consistency/abstract</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540820' id='431393'>
<a class='timestamp' href='#431393'><time timestamp='2015-10-22T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
... bashes on leveldb a bit, praises sqlite ....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540880' id='431394'>
<a class='timestamp' href='#431394'><time timestamp='2015-10-22T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-10'> * maaku</span>&gt;
is very confused as to what the benefit of switching to sqlite would be for this particular use case
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540880' id='431395'>
<a class='timestamp' href='#431395'><time timestamp='2015-10-22T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
maaku: it&#x27;s maintained and reliable
<br>
</div>

<div class='talk op-msg' data-timestamp='1445540940' id='431396'>
<a class='timestamp' href='#431396'><time timestamp='2015-10-22T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
maaku: assuming sqlite is better about crash consistency (and from all I&#x27;ve read, it is), would cut down on the &quot;core sucks, because my PC crashed and then eleven days to reindex...&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541000' id='431397'>
<a class='timestamp' href='#431397'><time timestamp='2015-10-22T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, that&#x27;s the only reason
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541000' id='431398'>
<a class='timestamp' href='#431398'><time timestamp='2015-10-22T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sqlite is known to be rock solid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541000' id='431399'>
<a class='timestamp' href='#431399'><time timestamp='2015-10-22T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
however, performance would need to be acceptable
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541240' id='431400'>
<a class='timestamp' href='#431400'><time timestamp='2015-10-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
sipa: well, also interop and the ease of using a different sql backend
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541360' id='431401'>
<a class='timestamp' href='#431401'><time timestamp='2015-10-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
i would definitely advocate making a sql abstraction layer with pluggable back ends, with sqlite as the default
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541420' id='431402'>
<a class='timestamp' href='#431402'><time timestamp='2015-10-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-12'> CodeShark__</span>&gt;
I&#x27;m using ODB in my stack for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541420' id='431403'>
<a class='timestamp' href='#431403'><time timestamp='2015-10-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jcorgan: to be clear, i think SQL is a downside
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431404'>
<a class='timestamp' href='#431404'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;re not looking for a database, and turning things into a database is against what we&#x27;re trying to achieve
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431405'>
<a class='timestamp' href='#431405'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
nod
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431406'>
<a class='timestamp' href='#431406'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
my secret plan revealed, again
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431407'>
<a class='timestamp' href='#431407'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
our database is not designed to be accessible by multiple processes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431408'>
<a class='timestamp' href='#431408'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
nor do we need any fancy indexes or queries
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431409'>
<a class='timestamp' href='#431409'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
if there&#x27;s a key-val store as well-supported and rock solid as sqlite..... that&#x27;s the right answer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541480' id='431410'>
<a class='timestamp' href='#431410'><time timestamp='2015-10-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I still like the custom db approach, but I&#x27;m highly biased
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541540' id='431411'>
<a class='timestamp' href='#431411'><time timestamp='2015-10-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if sqlite offered a mechanism to just use its low-level key-value store, i would
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541540' id='431412'>
<a class='timestamp' href='#431412'><time timestamp='2015-10-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(because it&#x27;s a database layer built on top of a key-value store)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541540' id='431413'>
<a class='timestamp' href='#431413'><time timestamp='2015-10-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
program in sqlite VM assembler and you can...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541540' id='431414'>
<a class='timestamp' href='#431414'><time timestamp='2015-10-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-7'> * jgarzik</span>&gt;
runs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541540' id='431415'>
<a class='timestamp' href='#431415'><time timestamp='2015-10-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
imho the answer would be to switch to a better maintained descendent of leveldb (there are many)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541600' id='431416'>
<a class='timestamp' href='#431416'><time timestamp='2015-10-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
also minimizes risk of fork
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541600' id='431417'>
<a class='timestamp' href='#431417'><time timestamp='2015-10-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Its unhelpful to have this conversation in parallel with the meeting.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541960' id='431418'>
<a class='timestamp' href='#431418'><time timestamp='2015-10-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-3'> kanzure_</span>&gt;
upstream maintainers, apparently
<br>
</div>

<div class='talk op-msg' data-timestamp='1445541960' id='431419'>
<a class='timestamp' href='#431419'><time timestamp='2015-10-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-3'> kanzure_</span>&gt;
oops, bad scrollback
<br>
</div>

<div class='talk op-msg' data-timestamp='1445542320' id='431420'>
<a class='timestamp' href='#431420'><time timestamp='2015-10-22T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
Don&#x27;t want to interject in the meeting, but I re-ran the SQLite vs. libdb benchmarks sipa mentioned (because they were 6 years old).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445542320' id='431421'>
<a class='timestamp' href='#431421'><time timestamp='2015-10-22T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
Results here: <a href="https://gist.github.com/mcelrath/6952eab246a7c705a0fb" class="link" target="_blank">https://gist.github.com/mcelrath/6952eab246a7c705a0fb</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445542500' id='431422'>
<a class='timestamp' href='#431422'><time timestamp='2015-10-22T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-3'> kanzure_</span>&gt;
huh? why should that not be mentioned?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445542560' id='431423'>
<a class='timestamp' href='#431423'><time timestamp='2015-10-22T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
Because the topic has moved on, and the conclusion was to continue research.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445543040' id='431424'>
<a class='timestamp' href='#431424'><time timestamp='2015-10-22T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
Above link updated with 500k records, transactional DB.  (Took a few minutes to run)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544180' id='431425'>
<a class='timestamp' href='#431425'><time timestamp='2015-10-22T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
IIRC gmaxwell was gonna ask the crash consistency guys for their test harness?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544240' id='431426'>
<a class='timestamp' href='#431426'><time timestamp='2015-10-22T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so we could test other dbs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544240' id='431427'>
<a class='timestamp' href='#431427'><time timestamp='2015-10-22T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
or maybe I&#x27;m crazy
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544240' id='431428'>
<a class='timestamp' href='#431428'><time timestamp='2015-10-22T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
someone should do that, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544240' id='431429'>
<a class='timestamp' href='#431429'><time timestamp='2015-10-22T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
before we decide
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544360' id='431430'>
<a class='timestamp' href='#431430'><time timestamp='2015-10-22T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maaku: sqlite is better at large writes than leveldb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544360' id='431431'>
<a class='timestamp' href='#431431'><time timestamp='2015-10-22T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
btcdrak: sqlite4 maybe matches leveldb ... because it&#x27;s basically using leveldb&#x27;s datastructure under the hood
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544360' id='431432'>
<a class='timestamp' href='#431432'><time timestamp='2015-10-22T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as leveldb writes everything twice tovdisk
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544480' id='431433'>
<a class='timestamp' href='#431433'><time timestamp='2015-10-22T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: this was the discussion earlier today about sqlite: <a href="https://botbot.me/freenode/bitcoin-core-dev/2015-10-22/?msg=52492157&amp;page=2" class="link" target="_blank">https://botbot.me/freenode/bitcoin-core-dev/2015-10-22/?msg=52492157&amp;page=2</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544480' id='431434'>
<a class='timestamp' href='#431434'><time timestamp='2015-10-22T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: yes I read it. I am confident from expirence that its incorrect, but I still think jeff&#x27;s work is very useful.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544540' id='431435'>
<a class='timestamp' href='#431435'><time timestamp='2015-10-22T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: yeah, I was also surprised, but fingers crossed something impressive comes out of jeff&#x27;s research.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544540' id='431436'>
<a class='timestamp' href='#431436'><time timestamp='2015-10-22T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(in part because sqllite4 may be faster)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544540' id='431437'>
<a class='timestamp' href='#431437'><time timestamp='2015-10-22T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sqlite4 is still in development though isnt it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544600' id='431438'>
<a class='timestamp' href='#431438'><time timestamp='2015-10-22T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sure, not useful yet.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544600' id='431439'>
<a class='timestamp' href='#431439'><time timestamp='2015-10-22T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
i wonder how far on they are and if they have a release schedule yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544600' id='431440'>
<a class='timestamp' href='#431440'><time timestamp='2015-10-22T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
am I missing something? why is this being treated as a non-consensus thing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544600' id='431441'>
<a class='timestamp' href='#431441'><time timestamp='2015-10-22T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it obviously is consensus critical
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544600' id='431442'>
<a class='timestamp' href='#431442'><time timestamp='2015-10-22T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s not a consensus change though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544660' id='431443'>
<a class='timestamp' href='#431443'><time timestamp='2015-10-22T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
we don&#x27;t and can&#x27;t know that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544660' id='431444'>
<a class='timestamp' href='#431444'><time timestamp='2015-10-22T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
recompiling with a different libc is also consensus critical
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544660' id='431445'>
<a class='timestamp' href='#431445'><time timestamp='2015-10-22T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
replacing 26kLOC to 140kLOC is impossible to be sure on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544660' id='431446'>
<a class='timestamp' href='#431446'><time timestamp='2015-10-22T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
Luke-Jr: we should be confident that it is not before anything moves forward
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544660' id='431447'>
<a class='timestamp' href='#431447'><time timestamp='2015-10-22T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or running on a new linix kernel
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431448'>
<a class='timestamp' href='#431448'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
BlueMatt: I don&#x27;t think we can.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431449'>
<a class='timestamp' href='#431449'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-13'> helo</span>&gt;
i really appreciate the meetings, great idea (btcdrak?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431450'>
<a class='timestamp' href='#431450'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
helo
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431451'>
<a class='timestamp' href='#431451'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we are making certain assumptions from other software we are using
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431452'>
<a class='timestamp' href='#431452'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
Luke-Jr: then we&#x27;re stuck with a shitty db that corrupts randomly and isnt self-consistent (ie not consensus-compatible)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431453'>
<a class='timestamp' href='#431453'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
best I can see happening, is knowing it&#x27;s unlikely to have any accidentally-triggered failures
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544720' id='431454'>
<a class='timestamp' href='#431454'><time timestamp='2015-10-22T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: it&#x27;s not being treated as anything right now, it&#x27;s just a test.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431455'>
<a class='timestamp' href='#431455'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that includes compilers, libraries, and operation systems with <u>_well specified_</u> behaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431456'>
<a class='timestamp' href='#431456'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: by that basis we don&#x27;t know that leveldb is self-consistent, or consistent between windows / unix, etc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431457'>
<a class='timestamp' href='#431457'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
Other than Windows corruption errors, is this solving any real problems right now?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431458'>
<a class='timestamp' href='#431458'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
Luke-Jr: research is a good thing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431459'>
<a class='timestamp' href='#431459'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maaku: we have durability problems on all platforms, though the windows ones are very severe. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544780' id='431460'>
<a class='timestamp' href='#431460'><time timestamp='2015-10-22T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
btcdrak: yes, if this is just research fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544840' id='431461'>
<a class='timestamp' href='#431461'><time timestamp='2015-10-22T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
The performance of leveldb is also problematic already, (well reported for very large databases), enough that our fat caching layer is very very criticial for performance, and thats causing us other problems.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544840' id='431462'>
<a class='timestamp' href='#431462'><time timestamp='2015-10-22T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maaku: durability problems in this database are incompatible with the survival of a network where puning is widely used.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544840' id='431463'>
<a class='timestamp' href='#431463'><time timestamp='2015-10-22T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
puny network
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544900' id='431464'>
<a class='timestamp' href='#431464'><time timestamp='2015-10-22T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hah
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544900' id='431465'>
<a class='timestamp' href='#431465'><time timestamp='2015-10-22T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
pruning*
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544900' id='431466'>
<a class='timestamp' href='#431466'><time timestamp='2015-10-22T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
LOL
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544960' id='431467'>
<a class='timestamp' href='#431467'><time timestamp='2015-10-22T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in general leveldb works fine; greatest concern is that it seems to be no longer maintained, so any bugs (like corruption on crashes in windows) is unlikely to get solved
<br>
</div>

<div class='talk op-msg' data-timestamp='1445544960' id='431468'>
<a class='timestamp' href='#431468'><time timestamp='2015-10-22T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
i thought gmaxwell was declaring sipa a risk to bitcoin there
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545020' id='431469'>
<a class='timestamp' href='#431469'><time timestamp='2015-10-22T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maaku: well that much is obvious.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545020' id='431470'>
<a class='timestamp' href='#431470'><time timestamp='2015-10-22T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we couls try to find another win env for leveldb
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545020' id='431471'>
<a class='timestamp' href='#431471'><time timestamp='2015-10-22T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there may be bugs in that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545080' id='431472'>
<a class='timestamp' href='#431472'><time timestamp='2015-10-22T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
i know this sounds hard: but did we never consider to stop supporting windows? Would this be so wrong?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545080' id='431473'>
<a class='timestamp' href='#431473'><time timestamp='2015-10-22T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m sure it is possible to fix the windows issue, but it&#x27;s not really nice to inherit a dependency and suddenly have to maintain it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545140' id='431474'>
<a class='timestamp' href='#431474'><time timestamp='2015-10-22T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: I think it would be problematic to do so right now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545140' id='431475'>
<a class='timestamp' href='#431475'><time timestamp='2015-10-22T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: as bad as it is, many people still use it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545140' id='431476'>
<a class='timestamp' href='#431476'><time timestamp='2015-10-22T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: I think it would be a bad idea, its a very widely used platform and dropping it would be a major move against the ability of people to independnantly run, audit, etc. the bitcoin system.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545140' id='431477'>
<a class='timestamp' href='#431477'><time timestamp='2015-10-22T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: well I&#x27;ve been close to declaring that. it wouldn&#x27;t be pretty but we have zero active developers for windows.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431478'>
<a class='timestamp' href='#431478'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
The security problems of windows stink, but hardware wallets are a tidy tool to address that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431479'>
<a class='timestamp' href='#431479'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: then again, the software is working for a lot of people also on windows
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431480'>
<a class='timestamp' href='#431480'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
not even speaking for the wallet. Just the node/core itself.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431481'>
<a class='timestamp' href='#431481'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
we are in a state right now where it is is almost constructively non-supported by our failure to do a a great job about it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431482'>
<a class='timestamp' href='#431482'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
well to be clear, gmaxwell&#x27;s concerns about a pruned network wouldn&#x27;t apply if the durability issues were wholly isolated to the windows platform
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545200' id='431483'>
<a class='timestamp' href='#431483'><time timestamp='2015-10-22T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: then people will just stop running a node :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431484'>
<a class='timestamp' href='#431484'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: I disagree
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431485'>
<a class='timestamp' href='#431485'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
before we drop Windows support, we would ideally want the alternative to be &quot;run a node on Linux&quot;, not &quot;stop running a node altogether&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431486'>
<a class='timestamp' href='#431486'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maaku: they are not wholly isolated to windows, though perhaps its safe enough elsewhere that my concern is less of an issue.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431487'>
<a class='timestamp' href='#431487'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: Agree. It&#x27;s running. But i think we should not move away form leveldb because of windows... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431488'>
<a class='timestamp' href='#431488'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: many people are running it on windows, and not complaining at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431489'>
<a class='timestamp' href='#431489'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: no need to blow this issue out of proportion
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431490'>
<a class='timestamp' href='#431490'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: and many people have stopped running it too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545260' id='431491'>
<a class='timestamp' href='#431491'><time timestamp='2015-10-22T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: obviously
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431492'>
<a class='timestamp' href='#431492'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I believe more people have stopped running bitcoin core on windows than currently run it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431493'>
<a class='timestamp' href='#431493'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(stopped due to corruption issues of varrious forms)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431494'>
<a class='timestamp' href='#431494'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well this is an open source project - if we don&#x27;t have developers supporting windows, we can&#x27;t support windows
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431495'>
<a class='timestamp' href='#431495'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
are most corruption issues caused by leveldbs layer?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431496'>
<a class='timestamp' href='#431496'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(not just leveldb but also AV)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545320' id='431497'>
<a class='timestamp' href='#431497'><time timestamp='2015-10-22T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: we don&#x27;t know
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431498'>
<a class='timestamp' href='#431498'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We know there is leveldb corruption on unclean shutdown, and we know about antivirus mediated corruption. But there may be more things we don&#x27;t know about.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431499'>
<a class='timestamp' href='#431499'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if the corruption issues are as bad as you say they are, and no one is fixing them,  then we should indeed drop windows support
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431500'>
<a class='timestamp' href='#431500'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
maybe if we stop supporting Windows &quot;officially&quot;, but leave it open, others will step up to do it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431501'>
<a class='timestamp' href='#431501'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but I don&#x27;t believe you
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431502'>
<a class='timestamp' href='#431502'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: or we should get more windows developers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431503'>
<a class='timestamp' href='#431503'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: well, good luck with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545380' id='431504'>
<a class='timestamp' href='#431504'><time timestamp='2015-10-22T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Which can be done.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431505'>
<a class='timestamp' href='#431505'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: I mean I can <u>_hire_</u> people for this, but it hasn&#x27;t been on my radar.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431506'>
<a class='timestamp' href='#431506'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in any case, this is not constructive <b>*goes back to sleep*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431507'>
<a class='timestamp' href='#431507'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
we could ship it together with a vmbox ubuntu. <b>*duck*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431508'>
<a class='timestamp' href='#431508'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
wonders if Diapolo is good enough at C++ that he could transition to more than just GUI if he gets funding
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431509'>
<a class='timestamp' href='#431509'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-12'> * jonasschnelli</span>&gt;
looks strange at Luke-Jr
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431510'>
<a class='timestamp' href='#431510'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: :-/ I think you&#x27;re misunderstanding my perspective, sorry I&#x27;ve communicated poorly.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545440' id='431511'>
<a class='timestamp' href='#431511'><time timestamp='2015-10-22T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: got a better suggestion? :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545500' id='431512'>
<a class='timestamp' href='#431512'><time timestamp='2015-10-22T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I don&#x27;t know many Windows developers..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545500' id='431513'>
<a class='timestamp' href='#431513'><time timestamp='2015-10-22T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Luke-Jr: hah. No. Not really. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545500' id='431514'>
<a class='timestamp' href='#431514'><time timestamp='2015-10-22T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
serious: what would be the overhead to run bitcoin-qt/core in a vm on windows?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545500' id='431515'>
<a class='timestamp' href='#431515'><time timestamp='2015-10-22T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
maybe the people who did those libconsensus bindings?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545560' id='431516'>
<a class='timestamp' href='#431516'><time timestamp='2015-10-22T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: it&#x27;s not impossible to just solve the windows crash corruption issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545560' id='431517'>
<a class='timestamp' href='#431517'><time timestamp='2015-10-22T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
10% CPU loss, 512MB ram overhead?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545560' id='431518'>
<a class='timestamp' href='#431518'><time timestamp='2015-10-22T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: I would be surprised if a VM kill reproduced the problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545560' id='431519'>
<a class='timestamp' href='#431519'><time timestamp='2015-10-22T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: I even proposed to help with it today if someone can send me a corrupted database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545560' id='431520'>
<a class='timestamp' href='#431520'><time timestamp='2015-10-22T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: yup. did anyone do that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545620' id='431521'>
<a class='timestamp' href='#431521'><time timestamp='2015-10-22T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545620' id='431522'>
<a class='timestamp' href='#431522'><time timestamp='2015-10-22T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Luke-Jr: the idea would be to bundle bitcoin-qt/core on windows together with vbox and a tiny distro. This would eliminate some ugly platform dependents.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545620' id='431523'>
<a class='timestamp' href='#431523'><time timestamp='2015-10-22T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: I tried to, but couldn&#x27;t reproduce it with IBD, and shortly thereafter my USB Armory died entirely. So it seems likely my problem was a bad microSD
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545620' id='431524'>
<a class='timestamp' href='#431524'><time timestamp='2015-10-22T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: that sounds like a terrible UX
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545680' id='431525'>
<a class='timestamp' href='#431525'><time timestamp='2015-10-22T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Luke-Jr: the UX could still be native (once it&#x27;s decoupled)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545680' id='431526'>
<a class='timestamp' href='#431526'><time timestamp='2015-10-22T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
Luke-Jr: yes, your problem is likely adifferent one. You&#x27;re the only one reporting it on linu
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545680' id='431527'>
<a class='timestamp' href='#431527'><time timestamp='2015-10-22T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: if you go that far to make a bundle you may as well fix the windows version :-) (it would be about as much development work)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545740' id='431528'>
<a class='timestamp' href='#431528'><time timestamp='2015-10-22T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: doesn&#x27;t jive really well with the resource costs of running a node.... VM with the constantly expanding storage is no fun. :P plus overheads. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545740' id='431529'>
<a class='timestamp' href='#431529'><time timestamp='2015-10-22T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
does UML support Windows? ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545740' id='431530'>
<a class='timestamp' href='#431530'><time timestamp='2015-10-22T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Fixing the windows shouldn&#x27;t be a big deal once we get enough repros and data, similar to OSX.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545740' id='431531'>
<a class='timestamp' href='#431531'><time timestamp='2015-10-22T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sounded like it might be the same issue.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545800' id='431532'>
<a class='timestamp' href='#431532'><time timestamp='2015-10-22T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yeah, let&#x27;s just solve the database problem instead of trying to work around it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545800' id='431533'>
<a class='timestamp' href='#431533'><time timestamp='2015-10-22T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
even if we have to put a flush after every line in leveldb ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545800' id='431534'>
<a class='timestamp' href='#431534'><time timestamp='2015-10-22T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I considered the exploration of other options to be orthorgonal with windows being on fire FWIW.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545800' id='431535'>
<a class='timestamp' href='#431535'><time timestamp='2015-10-22T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
gmaxwell: nowadays VM overhead is tiny... it&#x27;s not perfect. But better a solution that works with a lost of 10-20% in overhead than unsolved corrupted databases.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545800' id='431536'>
<a class='timestamp' href='#431536'><time timestamp='2015-10-22T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: sure, I still like the idea of exploring other databases
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431537'>
<a class='timestamp' href='#431537'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but yes, orthogonally
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431538'>
<a class='timestamp' href='#431538'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i really like the idea of just being able to use a maintained and tested database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431539'>
<a class='timestamp' href='#431539'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(also the attempt may turn up bugs elsewhere in our codebase)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431540'>
<a class='timestamp' href='#431540'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
don&#x27;t we all
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431541'>
<a class='timestamp' href='#431541'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and not a hack we had to pull together
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431542'>
<a class='timestamp' href='#431542'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-3'> * wumpus</span>&gt;
thought leveldb was that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431543'>
<a class='timestamp' href='#431543'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
a bug bounty worked for the last leveldb corruption issue we had (if i recall correctly). I&#x27;m still holding some bitcoin in the core dev expenses fund
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545860' id='431544'>
<a class='timestamp' href='#431544'><time timestamp='2015-10-22T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: leveldb windows certainly isn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545920' id='431545'>
<a class='timestamp' href='#431545'><time timestamp='2015-10-22T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonasschnelli: if someone really wants to investigate VM stuff, I&#x27;d suggest instead a thin OS that runs <b>*Windows*</b> in the VM, and provides a hardwarewallet-like interface on top
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545920' id='431546'>
<a class='timestamp' href='#431546'><time timestamp='2015-10-22T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
is there an approach to test sqlites performance which represents our db-style?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545920' id='431547'>
<a class='timestamp' href='#431547'><time timestamp='2015-10-22T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: we have local modifications to the win env
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545920' id='431548'>
<a class='timestamp' href='#431548'><time timestamp='2015-10-22T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: best would be to just try it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545920' id='431549'>
<a class='timestamp' href='#431549'><time timestamp='2015-10-22T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: yes, testing bitcoin core using &lt;alternative database&gt; :P  it shouldn&#x27;t be that much work; presumably jeff will report back on that soon
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545980' id='431550'>
<a class='timestamp' href='#431550'><time timestamp='2015-10-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sqlite could initially be slower. But it&#x27;s better maintained and much more portable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545980' id='431551'>
<a class='timestamp' href='#431551'><time timestamp='2015-10-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: there is slower and slower
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545980' id='431552'>
<a class='timestamp' href='#431552'><time timestamp='2015-10-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545980' id='431553'>
<a class='timestamp' href='#431553'><time timestamp='2015-10-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if it&#x27;s slower for things our caches compensates for, who cares
<br>
</div>

<div class='talk op-msg' data-timestamp='1445545980' id='431554'>
<a class='timestamp' href='#431554'><time timestamp='2015-10-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: speed is a security consideration for us currently, if you were talking about 5% or something I&#x27;d agree. but thats now what I expect.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431555'>
<a class='timestamp' href='#431555'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
s/now/not/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431556'>
<a class='timestamp' href='#431556'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if it&#x27;s slower to the point that it affects block propagation, it&#x27;s a no go
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431557'>
<a class='timestamp' href='#431557'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
s/currently/sadly/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431558'>
<a class='timestamp' href='#431558'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-3'> * wumpus</span>&gt;
doubts it will make much of a difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431559'>
<a class='timestamp' href='#431559'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Quote from sqlite4: The default built-in storage engine is a log-structured merge database. It is very fast, faster than LevelDB, supports nested transactions, and stores all content in a single disk file. Future versions of SQLite4 might also include a built-in B-Tree storage engine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546040' id='431560'>
<a class='timestamp' href='#431560'><time timestamp='2015-10-22T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
promising. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546100' id='431561'>
<a class='timestamp' href='#431561'><time timestamp='2015-10-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
there are so many factors influencing performance of bitcoind, that a slightly slower database won&#x27;t be a big issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546100' id='431562'>
<a class='timestamp' href='#431562'><time timestamp='2015-10-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, sqlite4 sounds awesome <u>_once_</u> it has had the same amount of testing and battle hardending as sqlite3
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546100' id='431563'>
<a class='timestamp' href='#431563'><time timestamp='2015-10-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: yes that was pasted before today :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546100' id='431564'>
<a class='timestamp' href='#431564'><time timestamp='2015-10-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
ha.. okay. I&#x27;d love to play around with it. But my stack of things to work down is just to big right now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546160' id='431565'>
<a class='timestamp' href='#431565'><time timestamp='2015-10-22T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
we might also want to maintain a patch for sqllite4 and use it to try to get the sqllite devs to use us as a test harness. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546160' id='431566'>
<a class='timestamp' href='#431566'><time timestamp='2015-10-22T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: sqlite is widely used, also in almost every browser (local dbs) and smartphone (android and iOS IIRC). They very likely to update once to sqlite4... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546280' id='431567'>
<a class='timestamp' href='#431567'><time timestamp='2015-10-22T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but quote from one of the sqlite devs a few months ago &quot;sqlite4 is a dev toy&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546280' id='431568'>
<a class='timestamp' href='#431568'><time timestamp='2015-10-22T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: that sounds perfect for our bitcoin &lt;1.0 version. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546340' id='431569'>
<a class='timestamp' href='#431569'><time timestamp='2015-10-22T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: if only we didn&#x27;t have this pesky economy thing that relies on bitcoin
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546340' id='431570'>
<a class='timestamp' href='#431570'><time timestamp='2015-10-22T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: na... that are just some fiat exchange bubbles.. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546340' id='431571'>
<a class='timestamp' href='#431571'><time timestamp='2015-10-22T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Lets fix that first then. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546400' id='431572'>
<a class='timestamp' href='#431572'><time timestamp='2015-10-22T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
trying it out doesn&#x27;t hurt, no one is talking about releasing with it...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546400' id='431573'>
<a class='timestamp' href='#431573'><time timestamp='2015-10-22T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: exactly
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546400' id='431574'>
<a class='timestamp' href='#431574'><time timestamp='2015-10-22T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
dev toy :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546400' id='431575'>
<a class='timestamp' href='#431575'><time timestamp='2015-10-22T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: +1 ... and a such pr would at least take 1/2 year to get in.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546400' id='431576'>
<a class='timestamp' href='#431576'><time timestamp='2015-10-22T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well as I said, might even be possible to get the sqllite developers to test using us. We&#x27;re a pretty cool load generator (esp with signatures off)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546460' id='431577'>
<a class='timestamp' href='#431577'><time timestamp='2015-10-22T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: we&#x27;re boring
<br>
</div>

<div class='talk op-msg' data-timestamp='1445546460' id='431578'>
<a class='timestamp' href='#431578'><time timestamp='2015-10-22T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
single-threaded access, only bulk writes and small random reads
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548200' id='431579'>
<a class='timestamp' href='#431579'><time timestamp='2015-10-22T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
&lt; Luke-Jr&gt; jonasschnelli: if someone really wants to investigate VM stuff, I&#x27;d suggest instead a thin OS that runs <b>*Windows*</b> in the VM
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548260' id='431580'>
<a class='timestamp' href='#431580'><time timestamp='2015-10-22T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
<b>*cough*</b> Qubes OS <b>*cough*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548260' id='431581'>
<a class='timestamp' href='#431581'><time timestamp='2015-10-22T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jcorgan: Qubes OS is not very thin, and doesn&#x27;t do GPU passthrough
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548320' id='431582'>
<a class='timestamp' href='#431582'><time timestamp='2015-10-22T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
didn&#x27;t think about GPU
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548320' id='431583'>
<a class='timestamp' href='#431583'><time timestamp='2015-10-22T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
but thinness is poorly defined
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548320' id='431584'>
<a class='timestamp' href='#431584'><time timestamp='2015-10-22T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: are the tests in #6816 (versionbits) enough? I was thinking it would be good to have some rpc-tests there as well, generating blocks and running through a couple of scenarios.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548380' id='431585'>
<a class='timestamp' href='#431585'><time timestamp='2015-10-22T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
or is that overkill?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548860' id='431586'>
<a class='timestamp' href='#431586'><time timestamp='2015-10-22T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
btcdrak: I think we should probably do some regtests with the integration, not necessarily over RPC
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548860' id='431587'>
<a class='timestamp' href='#431587'><time timestamp='2015-10-22T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
well...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548860' id='431588'>
<a class='timestamp' href='#431588'><time timestamp='2015-10-22T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
other than just generating blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445548860' id='431589'>
<a class='timestamp' href='#431589'><time timestamp='2015-10-22T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I guess just calling generate and getblockchaininfo
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549160' id='431590'>
<a class='timestamp' href='#431590'><time timestamp='2015-10-22T21:26:00Z'>21:26</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
CodeShark: I mean tests like <a href="https://github.com/bitcoin/bitcoin/blob/master/qa/rpc-tests/bipdersig.py" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/qa/rpc-tests/bipdersig.py</a> etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549220' id='431591'>
<a class='timestamp' href='#431591'><time timestamp='2015-10-22T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
It builds: <a href="https://github.com/jgarzik/bitcoin/tree/2015_sqlite" class="link" target="_blank">https://github.com/jgarzik/bitcoin/tree/2015_sqlite</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549280' id='431592'>
<a class='timestamp' href='#431592'><time timestamp='2015-10-22T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jgarzik: That was fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549280' id='431593'>
<a class='timestamp' href='#431593'><time timestamp='2015-10-22T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
jgarzik: nicely done :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549280' id='431594'>
<a class='timestamp' href='#431594'><time timestamp='2015-10-22T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, but does it run linyx?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549400' id='431595'>
<a class='timestamp' href='#431595'><time timestamp='2015-10-22T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
btcdrak: the -blockversion thing will probably not be a good idea anymore using versionbits
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549400' id='431596'>
<a class='timestamp' href='#431596'><time timestamp='2015-10-22T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
it will be better to provide a list of BIPs you don&#x27;t want to set the bit for
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549400' id='431597'>
<a class='timestamp' href='#431597'><time timestamp='2015-10-22T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
a few bits can be forwarded upstream immediately, like Seek* and Prev() removal
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549460' id='431598'>
<a class='timestamp' href='#431598'><time timestamp='2015-10-22T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
CodeShark: well obviously the bipdersig.py tests are for an ISM sf.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549520' id='431599'>
<a class='timestamp' href='#431599'><time timestamp='2015-10-22T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
CodeShark: I&#x27;m just saying a set of tests like that which generate blocks and simulate a sf rollout but using versionbits protocol.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549520' id='431600'>
<a class='timestamp' href='#431600'><time timestamp='2015-10-22T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I suppose we can just use VERSION_HIGH_BITS and VERSION_HIGH_BITS | 0x1 instead of versions 2 and 3 :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431601'>
<a class='timestamp' href='#431601'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
CodeShark: does versionbits sanitise the encoding btw? ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431602'>
<a class='timestamp' href='#431602'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
ie, define the first 32-bits to be a big endian number
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431603'>
<a class='timestamp' href='#431603'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
Luke-Jr: it&#x27;s little endian
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431604'>
<a class='timestamp' href='#431604'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
would be nice to fix that at the same time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431605'>
<a class='timestamp' href='#431605'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
encoding? versionbits doesn&#x27;t deal with serialization stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549580' id='431606'>
<a class='timestamp' href='#431606'><time timestamp='2015-10-22T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
CodeShark: it makes the most conclusive tests that it works, and provides some protection against regressions.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431607'>
<a class='timestamp' href='#431607'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
Luke-Jr: why? nothing else is big endian
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431608'>
<a class='timestamp' href='#431608'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
CodeShark: anything consensus-relevant must deal with encoding
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431609'>
<a class='timestamp' href='#431609'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-8'> maaku</span>&gt;
Luke-Jr: he means versionbits doesn&#x27;t touch serialization
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431610'>
<a class='timestamp' href='#431610'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
Luke-Jr: versionbits deals with block header data that has already been deserialized
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431611'>
<a class='timestamp' href='#431611'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
maaku: big endian is standard for protocols; and hashes at least are
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549640' id='431612'>
<a class='timestamp' href='#431612'><time timestamp='2015-10-22T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: please
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549700' id='431613'>
<a class='timestamp' href='#431613'><time timestamp='2015-10-22T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;re not changing the serialization of block headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549760' id='431614'>
<a class='timestamp' href='#431614'><time timestamp='2015-10-22T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
big endian is dead
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549820' id='431615'>
<a class='timestamp' href='#431615'><time timestamp='2015-10-22T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no endianness flamewar please
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549820' id='431616'>
<a class='timestamp' href='#431616'><time timestamp='2015-10-22T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
in any case, the serialization format is entirely a separate issue...versionbits will play no part in that either way
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549940' id='431617'>
<a class='timestamp' href='#431617'><time timestamp='2015-10-22T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
so the bits are numbered 7 6 5 4 3 2 1 15 14 13 12 11 10 9 8 23 22 21 20 19 18 17 16 31 30 29 28 27 26 25 24 ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549940' id='431618'>
<a class='timestamp' href='#431618'><time timestamp='2015-10-22T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
irrelevant
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549940' id='431619'>
<a class='timestamp' href='#431619'><time timestamp='2015-10-22T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
â€¦
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549940' id='431620'>
<a class='timestamp' href='#431620'><time timestamp='2015-10-22T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
versionbits deals with ints, uint32_t, etc...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445549940' id='431621'>
<a class='timestamp' href='#431621'><time timestamp='2015-10-22T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it&#x27;s relevant because if I set the wrong BIP, it won&#x27;t work.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550000' id='431622'>
<a class='timestamp' href='#431622'><time timestamp='2015-10-22T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the block header serialization defines nVersion as a 32-bit little-endian signed integer
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550000' id='431623'>
<a class='timestamp' href='#431623'><time timestamp='2015-10-22T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wrong bit*
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550000' id='431624'>
<a class='timestamp' href='#431624'><time timestamp='2015-10-22T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
it doesn&#x27;t care what the underlying representation is for the particular architecture
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550000' id='431625'>
<a class='timestamp' href='#431625'><time timestamp='2015-10-22T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
versionbits changes the semantics of the nVersion integer
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550000' id='431626'>
<a class='timestamp' href='#431626'><time timestamp='2015-10-22T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
by the time versionbits comes into play, the version field has already been decoded into an int
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550060' id='431627'>
<a class='timestamp' href='#431627'><time timestamp='2015-10-22T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
CodeShark: that is an implementation detail. the whole point of version bits is that it is no longer an int, but a bit array
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550060' id='431628'>
<a class='timestamp' href='#431628'><time timestamp='2015-10-22T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
to test a bit, you do (nVersion &gt;&gt; bit) &amp; 0x1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550060' id='431629'>
<a class='timestamp' href='#431629'><time timestamp='2015-10-22T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: it&#x27;s still an int; an int in which particular bits are set
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550060' id='431630'>
<a class='timestamp' href='#431630'><time timestamp='2015-10-22T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
sighs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550120' id='431631'>
<a class='timestamp' href='#431631'><time timestamp='2015-10-22T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
now please stop this silly discussion, we&#x27;re not redefining how integers work
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550120' id='431632'>
<a class='timestamp' href='#431632'><time timestamp='2015-10-22T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but, base-3!!!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550120' id='431633'>
<a class='timestamp' href='#431633'><time timestamp='2015-10-22T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
fine, not worth the time to argue about this stupid design decision.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550300' id='431634'>
<a class='timestamp' href='#431634'><time timestamp='2015-10-22T21:45:00Z'>21:45</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
base-3 would allow us to do yea/nay/abstain :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550720' id='431635'>
<a class='timestamp' href='#431635'><time timestamp='2015-10-22T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
the annoying part will be having to answer questions in a few years why it&#x27;s misordered such. like I had to do with the getwork data for years
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550900' id='431636'>
<a class='timestamp' href='#431636'><time timestamp='2015-10-22T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jgarzik, you have benchmarks for sqlite?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550900' id='431637'>
<a class='timestamp' href='#431637'><time timestamp='2015-10-22T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
my experience using it in the past has been that it&#x27;s slow as hell for inserts or any kind of concurrent access
<br>
</div>

<div class='talk op-msg' data-timestamp='1445550960' id='431638'>
<a class='timestamp' href='#431638'><time timestamp='2015-10-22T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
probably time would be better spent on building an interface spec for databases
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551080' id='431639'>
<a class='timestamp' href='#431639'><time timestamp='2015-10-22T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
for insertions we could just use a raw file - the blockchain is a linear structure anyhow. then all we would need to do in sqlite is keep track of file positions ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551380' id='431640'>
<a class='timestamp' href='#431640'><time timestamp='2015-10-22T22:03:00Z'>22:03</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
CodeShark, utxo only
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551440' id='431641'>
<a class='timestamp' href='#431641'><time timestamp='2015-10-22T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
yeah, so we maintain a utxo index
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551440' id='431642'>
<a class='timestamp' href='#431642'><time timestamp='2015-10-22T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
or are you talking about a pruned node?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551440' id='431643'>
<a class='timestamp' href='#431643'><time timestamp='2015-10-22T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the index would be roughly the same size as the utxo data :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551440' id='431644'>
<a class='timestamp' href='#431644'><time timestamp='2015-10-22T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551500' id='431645'>
<a class='timestamp' href='#431645'><time timestamp='2015-10-22T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
ok, for a utxo database perhaps it doesn&#x27;t make so much sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551500' id='431646'>
<a class='timestamp' href='#431646'><time timestamp='2015-10-22T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah the actual data is really small
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551560' id='431647'>
<a class='timestamp' href='#431647'><time timestamp='2015-10-22T22:06:00Z'>22:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
CodeShark: txindex works like you suggest there.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551620' id='431648'>
<a class='timestamp' href='#431648'><time timestamp='2015-10-22T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but for utxo set we get benefits from reducing the working set. saving 20 bytes of scriptpubkey/value in exchange for another random seek to the middle of some huge block file where 2/3rd of the data is not utxo relevant, basically defeates disk caching entirely. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445551920' id='431649'>
<a class='timestamp' href='#431649'><time timestamp='2015-10-22T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-9'> GitHub160</span>&gt;
[bitcoin] petertodd opened pull request #6871: Full-RBF with opt-out (master...2015-10-rbf-with-opt-out) <a href="https://github.com/bitcoin/bitcoin/pull/6871" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6871</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445553180' id='431650'>
<a class='timestamp' href='#431650'><time timestamp='2015-10-22T22:33:00Z'>22:33</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
G
<br>
</div>

<div class='talk op-msg' data-timestamp='1445554380' id='431651'>
<a class='timestamp' href='#431651'><time timestamp='2015-10-22T22:53:00Z'>22:53</time></a>
&lt;<span class='nick nick-13'> GitHub51</span>&gt;
[bitcoin] TheBlueMatt opened pull request #6872: Remove UTXO cache entries when the tx they were added for is removed/does not enter mempool (master...limitucache) <a href="https://github.com/bitcoin/bitcoin/pull/6872" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6872</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555100' id='431652'>
<a class='timestamp' href='#431652'><time timestamp='2015-10-22T23:05:00Z'>23:05</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
petertodd: I hope you don&#x27;t mind my questions :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555160' id='431653'>
<a class='timestamp' href='#431653'><time timestamp='2015-10-22T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, the last commit on #6872 seems to evict from the cache things which other transactions in the mempool want cached
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555160' id='431654'>
<a class='timestamp' href='#431654'><time timestamp='2015-10-22T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ie AcceptToMempool fails because it&#x27;s a double spend of something with a higher feerate
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431655'>
<a class='timestamp' href='#431655'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
dcousens: no worries!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431656'>
<a class='timestamp' href='#431656'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
scratch that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431657'>
<a class='timestamp' href='#431657'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i missed the check
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431658'>
<a class='timestamp' href='#431658'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
dcousens: I&#x27;m doing three things at once so the responses are probably sounding a bit terse :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431659'>
<a class='timestamp' href='#431659'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: ahh, ok, good, i was about to say
<br>
</div>

<div class='talk op-msg' data-timestamp='1445555280' id='431660'>
<a class='timestamp' href='#431660'><time timestamp='2015-10-22T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
petertodd: all good, I read everything in good spirit, just hope it comes across the same :)
<br>
</div>

</div>
</section>

</body>
</html>
