<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-02-10
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-02-10' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-01-10">&lt;</a><span class='header'>  February 2016   </span><a href="/bitcoin-core-dev/2016-03-10">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;    <a class="" href="/bitcoin-core-dev/2016-02-01">1</a>  <a class="" href="/bitcoin-core-dev/2016-02-02">2</a>  <a class="" href="/bitcoin-core-dev/2016-02-03">3</a>  <a class="" href="/bitcoin-core-dev/2016-02-04">4</a>  <a class="" href="/bitcoin-core-dev/2016-02-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-02-06">6</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-02-07">7</a>  <a class="" href="/bitcoin-core-dev/2016-02-08">8</a>  <a class="" href="/bitcoin-core-dev/2016-02-09">9</a> <a class="current" href="/bitcoin-core-dev/2016-02-10">10</a> <a class="" href="/bitcoin-core-dev/2016-02-11">11</a> <a class="" href="/bitcoin-core-dev/2016-02-12">12</a> <a class="" href="/bitcoin-core-dev/2016-02-13">13</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-02-14">14</a> <a class="" href="/bitcoin-core-dev/2016-02-15">15</a> <a class="" href="/bitcoin-core-dev/2016-02-16">16</a> <a class="" href="/bitcoin-core-dev/2016-02-17">17</a> <a class="" href="/bitcoin-core-dev/2016-02-18">18</a> <a class="" href="/bitcoin-core-dev/2016-02-19">19</a> <a class="" href="/bitcoin-core-dev/2016-02-20">20</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-02-21">21</a> <a class="" href="/bitcoin-core-dev/2016-02-22">22</a> <a class="" href="/bitcoin-core-dev/2016-02-23">23</a> <a class="" href="/bitcoin-core-dev/2016-02-24">24</a> <a class="" href="/bitcoin-core-dev/2016-02-25">25</a> <a class="" href="/bitcoin-core-dev/2016-02-26">26</a> <a class="" href="/bitcoin-core-dev/2016-02-27">27</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-02-28">28</a> <a class="" href="/bitcoin-core-dev/2016-02-29">29</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1455082260' id='451292'>
<a class='timestamp' href='#451292'><time timestamp='2016-02-10T05:31:00Z'>05:31</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gitian builders: rc4 sigs pushed
<br>
</div>

<div class='talk op-msg' data-timestamp='1455086160' id='451293'>
<a class='timestamp' href='#451293'><time timestamp='2016-02-10T06:36:00Z'>06:36</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
cfields: poke, can you get Travis&#x27;s IPs added to the OSX dl? btcdrak said the info should be the same, just need the dev. hostname
<br>
</div>

<div class='talk op-msg' data-timestamp='1455088140' id='451294'>
<a class='timestamp' href='#451294'><time timestamp='2016-02-10T07:09:00Z'>07:09</time></a>
&lt;<span class='nick nick-13'> GitHub176</span>&gt;
[bitcoin] luke-jr closed pull request #7483: Render icons from SVG (master...svg_icon) <a href="https://github.com/bitcoin/bitcoin/pull/7483" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7483</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455093300' id='451295'>
<a class='timestamp' href='#451295'><time timestamp='2016-02-10T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-9'> GitHub101</span>&gt;
[bitcoin] Flowdalic opened pull request #7495: Make genbuild.sh check for &#x27;.git&#x27;  (master...5902) <a href="https://github.com/bitcoin/bitcoin/pull/7495" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7495</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455102480' id='451296'>
<a class='timestamp' href='#451296'><time timestamp='2016-02-10T11:08:00Z'>11:08</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: is there a good reason for -qt keeping a second copy of every setting somewhere else?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455103920' id='451297'>
<a class='timestamp' href='#451297'><time timestamp='2016-02-10T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-15'> GitHub71</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/b49a62379900...d007511ebdfa" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/b49a62379900...d007511ebdfa</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455103920' id='451298'>
<a class='timestamp' href='#451298'><time timestamp='2016-02-10T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-15'> GitHub71</span>&gt;
bitcoin/master acf5983 Wladimir J. van der Laan: tests: Remove May15 test...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455103920' id='451299'>
<a class='timestamp' href='#451299'><time timestamp='2016-02-10T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-15'> GitHub71</span>&gt;
bitcoin/master d007511 Wladimir J. van der Laan: Merge #7490: tests: Remove May15 test...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455103920' id='451300'>
<a class='timestamp' href='#451300'><time timestamp='2016-02-10T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
[bitcoin] laanwj closed pull request #7490: tests: Remove May15 test (master...2016_02_may12forkdat) <a href="https://github.com/bitcoin/bitcoin/pull/7490" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7490</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455104580' id='451301'>
<a class='timestamp' href='#451301'><time timestamp='2016-02-10T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
Luke-Jr: yes, it makes it possible to change the settings through the GUI without having to do something ugly like write a bitcoin.conf
<br>
</div>

<div class='talk op-msg' data-timestamp='1455109200' id='451302'>
<a class='timestamp' href='#451302'><time timestamp='2016-02-10T13:00:00Z'>13:00</time></a>
&lt;<span class='nick nick-15'> GitHub161</span>&gt;
[bitcoin] promag opened pull request #7498: [WIP][RPC] Add createtransaction (master...feature/rpc-createtransaction) <a href="https://github.com/bitcoin/bitcoin/pull/7498" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7498</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455110520' id='451303'>
<a class='timestamp' href='#451303'><time timestamp='2016-02-10T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-6'> GitHub113</span>&gt;
[bitcoin] sipa opened pull request #7500: Correctly report high-S violations (master...reporthighs) <a href="https://github.com/bitcoin/bitcoin/pull/7500" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7500</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455115680' id='451304'>
<a class='timestamp' href='#451304'><time timestamp='2016-02-10T14:48:00Z'>14:48</time></a>
&lt;<span class='nick nick-9'> GitHub58</span>&gt;
[bitcoin] sipa opened pull request #7502: Update the wallet best block marker before pruning (master...betterflush) <a href="https://github.com/bitcoin/bitcoin/pull/7502" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7502</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455116820' id='451305'>
<a class='timestamp' href='#451305'><time timestamp='2016-02-10T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: you there to discuss 7502?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455116880' id='451306'>
<a class='timestamp' href='#451306'><time timestamp='2016-02-10T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m not sure how we made that mistake in the first place, we explicitly discussed this problem in IRC on 5/5, but in any case, i&#x27;m not loving your solution.   
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117060' id='451307'>
<a class='timestamp' href='#451307'><time timestamp='2016-02-10T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: oh, what&#x27;s the problem with it? (i can&#x27;t remember the discussion about it)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117120' id='451308'>
<a class='timestamp' href='#451308'><time timestamp='2016-02-10T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think there is too much complication around settingbestchain that caused this to happen in the first place.  setbestchain is not expensive, lets just call it whenever we flush the utxo set, then we&#x27;re only worried about keepign one thing in sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117180' id='451309'>
<a class='timestamp' href='#451309'><time timestamp='2016-02-10T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but also i don&#x27;t like moving the unlinking of files down to where you moved it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117180' id='451310'>
<a class='timestamp' href='#451310'><time timestamp='2016-02-10T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
once you modify the blockindex database, they are useless anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117180' id='451311'>
<a class='timestamp' href='#451311'><time timestamp='2016-02-10T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117180' id='451312'>
<a class='timestamp' href='#451312'><time timestamp='2016-02-10T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and its slightly beneficial to delete them before the CheckDiskSpace call
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117240' id='451313'>
<a class='timestamp' href='#451313'><time timestamp='2016-02-10T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right, i started writing this under the assumption that UnlinkPrunedFiles modified the block index
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117300' id='451314'>
<a class='timestamp' href='#451314'><time timestamp='2016-02-10T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i feel there is a cyclic dependency here
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117300' id='451315'>
<a class='timestamp' href='#451315'><time timestamp='2016-02-10T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the wallet shouldn&#x27;t be updated until the chainstate is updated
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117300' id='451316'>
<a class='timestamp' href='#451316'><time timestamp='2016-02-10T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the chainstate needs to have the block index flushed first
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117360' id='451317'>
<a class='timestamp' href='#451317'><time timestamp='2016-02-10T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
pruning deleted files, so should be done after updating any reference to them
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117360' id='451318'>
<a class='timestamp' href='#451318'><time timestamp='2016-02-10T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
we already &quot;solved&quot; the problem of keeping the utxo state in sync with pruning files
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117360' id='451319'>
<a class='timestamp' href='#451319'><time timestamp='2016-02-10T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
lets reuse that solution
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117420' id='451320'>
<a class='timestamp' href='#451320'><time timestamp='2016-02-10T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
just move setbestchain inside the block above that&#x27;s if fDoFullFlush
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117420' id='451321'>
<a class='timestamp' href='#451321'><time timestamp='2016-02-10T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the utxoset and the wallet will then be permanently in sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117480' id='451322'>
<a class='timestamp' href='#451322'><time timestamp='2016-02-10T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well it means that the wallet can be ahead of the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117480' id='451323'>
<a class='timestamp' href='#451323'><time timestamp='2016-02-10T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that shouldn&#x27;t be a problem, i guess?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117540' id='451324'>
<a class='timestamp' href='#451324'><time timestamp='2016-02-10T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wait i&#x27;m confused by the terminology one of us is using
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117540' id='451325'>
<a class='timestamp' href='#451325'><time timestamp='2016-02-10T15:19:00Z'>15:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you&#x27;re suggesting to put the &quot;GetMainSignals().SetBestChain(chainActive.GetLocator());&quot; above the &quot;if (!pcoinsTip-&gt;Flush())&quot; line?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117600' id='451326'>
<a class='timestamp' href='#451326'><time timestamp='2016-02-10T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or right after, but in that code block
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117660' id='451327'>
<a class='timestamp' href='#451327'><time timestamp='2016-02-10T15:21:00Z'>15:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you put it after, the wallet can be behind the chainActive, and you get the pruned beyond error
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117720' id='451328'>
<a class='timestamp' href='#451328'><time timestamp='2016-02-10T15:22:00Z'>15:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but the wallet is allowed to be ahead of the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117780' id='451329'>
<a class='timestamp' href='#451329'><time timestamp='2016-02-10T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: no, i don&#x27;t think so
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117780' id='451330'>
<a class='timestamp' href='#451330'><time timestamp='2016-02-10T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if what you were saying was true, then it would be possible for your chainstate to be behind your pruned blocks as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117780' id='451331'>
<a class='timestamp' href='#451331'><time timestamp='2016-02-10T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which hopeuflly isn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117780' id='451332'>
<a class='timestamp' href='#451332'><time timestamp='2016-02-10T15:23:00Z'>15:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117840' id='451333'>
<a class='timestamp' href='#451333'><time timestamp='2016-02-10T15:24:00Z'>15:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you first write X, and then write Y, you only have a guarantee that the state on disk for X is &gt;= that of Y
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117900' id='451334'>
<a class='timestamp' href='#451334'><time timestamp='2016-02-10T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok so lets back up one second, what stops the problem of pruning and then not yet having written the chainstate , and crashing before you do
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117900' id='451335'>
<a class='timestamp' href='#451335'><time timestamp='2016-02-10T15:25:00Z'>15:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
nothing
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117960' id='451336'>
<a class='timestamp' href='#451336'><time timestamp='2016-02-10T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think the correct thing to do is to first do the blockchain AND chainstate write without considering pruning, then doing findfiles to prune, then potentially writing the blockindex again, and then deleting files
<br>
</div>

<div class='talk op-msg' data-timestamp='1455117960' id='451337'>
<a class='timestamp' href='#451337'><time timestamp='2016-02-10T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, perhaps, i think we didn&#x27;t do it that way because of wanting to free up space on disk with the pruning to make room for writing the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118020' id='451338'>
<a class='timestamp' href='#451338'><time timestamp='2016-02-10T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or we could remember the last written chainstate sync, and never prune beyond that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118020' id='451339'>
<a class='timestamp' href='#451339'><time timestamp='2016-02-10T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and then loop twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118080' id='451340'>
<a class='timestamp' href='#451340'><time timestamp='2016-02-10T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, the wallet beyond chainstate check will fail in case of a reorg...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118080' id='451341'>
<a class='timestamp' href='#451341'><time timestamp='2016-02-10T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it checks whether the wallet state is a descendant of the chainstate tip; that&#x27;s too strong
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118200' id='451342'>
<a class='timestamp' href='#451342'><time timestamp='2016-02-10T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: where is that wallet check?  i thought we call FindForkInGlobalIndex on the wallet locator versus chainActive.Tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118200' id='451343'>
<a class='timestamp' href='#451343'><time timestamp='2016-02-10T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
and rescan from there
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118260' id='451344'>
<a class='timestamp' href='#451344'><time timestamp='2016-02-10T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
OK, well to get back to a short term fix, I&#x27;d recommend not moving the UnlinkPrunedFiles call and changing the additional condition in the existing if block to be fDoFullFlush instead of fFlushForPrune
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118260' id='451345'>
<a class='timestamp' href='#451345'><time timestamp='2016-02-10T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: oh, yes!
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118320' id='451346'>
<a class='timestamp' href='#451346'><time timestamp='2016-02-10T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Then we can fix it more completely later, but we&#x27;ll at least have reduced the problem to catastrophic crashes in the middle of FlushStateToDisk
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118440' id='451347'>
<a class='timestamp' href='#451347'><time timestamp='2016-02-10T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: ack
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118500' id='451348'>
<a class='timestamp' href='#451348'><time timestamp='2016-02-10T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: actually, i think that flushing the wallet may be more expensive than chainstate flushes in some cases
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118500' id='451349'>
<a class='timestamp' href='#451349'><time timestamp='2016-02-10T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah thats what i was just getting confused about
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118500' id='451350'>
<a class='timestamp' href='#451350'><time timestamp='2016-02-10T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
setbestchain only writes the locator
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118500' id='451351'>
<a class='timestamp' href='#451351'><time timestamp='2016-02-10T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
we&#x27;re just writing one locator to the db, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118500' id='451352'>
<a class='timestamp' href='#451352'><time timestamp='2016-02-10T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
how does the rest of the wallet keep in sync with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118620' id='451353'>
<a class='timestamp' href='#451353'><time timestamp='2016-02-10T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the wallet is regularly checkpointed
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118680' id='451354'>
<a class='timestamp' href='#451354'><time timestamp='2016-02-10T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and any change to the wallet is written immediately
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118680' id='451355'>
<a class='timestamp' href='#451355'><time timestamp='2016-02-10T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that&#x27;s not a problem, because the wallet is allowed to be ahead of the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118680' id='451356'>
<a class='timestamp' href='#451356'><time timestamp='2016-02-10T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and it used to also be allowed to be behind... until pruning
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118740' id='451357'>
<a class='timestamp' href='#451357'><time timestamp='2016-02-10T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah sorry, i&#x27;m not familiar with the wallet database, but it seems to me that there are lots of writes to the wallet that aren&#x27;t immediately written, what causes those to be flushed?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118740' id='451358'>
<a class='timestamp' href='#451358'><time timestamp='2016-02-10T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is a thread that occasionally flushes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118800' id='451359'>
<a class='timestamp' href='#451359'><time timestamp='2016-02-10T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so what stops setbestchain from being ahead of that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118800' id='451360'>
<a class='timestamp' href='#451360'><time timestamp='2016-02-10T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
nothing, i guess...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118860' id='451361'>
<a class='timestamp' href='#451361'><time timestamp='2016-02-10T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
actually there are a lot of flushes to the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118860' id='451362'>
<a class='timestamp' href='#451362'><time timestamp='2016-02-10T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what the &#x27;flush thread&#x27; does is not actually flush, but make wallet.dat self-contained
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118860' id='451363'>
<a class='timestamp' href='#451363'><time timestamp='2016-02-10T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118860' id='451364'>
<a class='timestamp' href='#451364'><time timestamp='2016-02-10T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
wumpus: can you explain?  i am trying to read/understand that now
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118860' id='451365'>
<a class='timestamp' href='#451365'><time timestamp='2016-02-10T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sdaftuar: its in the documentation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451366'>
<a class='timestamp' href='#451366'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: writes to the wallet are synchronous i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451367'>
<a class='timestamp' href='#451367'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
:)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451368'>
<a class='timestamp' href='#451368'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but only to the db logfile; not to wallet.dat
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451369'>
<a class='timestamp' href='#451369'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
ah ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451370'>
<a class='timestamp' href='#451370'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes it&#x27;s best to check the berkeleydb documentation, but AFAIK we do a flush after almost every operation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451371'>
<a class='timestamp' href='#451371'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this is what made some things so slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451372'>
<a class='timestamp' href='#451372'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
there are some operations that are commented as not doing a flush, for performance reasons
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451373'>
<a class='timestamp' href='#451373'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: what about moving the wallet update to be above the chainstate write (and always triggering it in case of a pruning)?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118920' id='451374'>
<a class='timestamp' href='#451374'><time timestamp='2016-02-10T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this has been improved a bit for some commands in 0.12, but it&#x27;s still erring on the safe side not the unsafe one
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118980' id='451375'>
<a class='timestamp' href='#451375'><time timestamp='2016-02-10T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: that way the wallet will always be ahead of the chainstate when pruning
<br>
</div>

<div class='talk op-msg' data-timestamp='1455118980' id='451376'>
<a class='timestamp' href='#451376'><time timestamp='2016-02-10T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sdaftuar: as I understand it, every creation of a CWalletDB(strWalletFile) makes an operation, that will be flushed when the object is destroyed
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451377'>
<a class='timestamp' href='#451377'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: // Do not flush the wallet here for performance reasons // this is safe, as in case of a crash, we rescan the necessary blocks on startup through our SetBestChain-mechanism
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451378'>
<a class='timestamp' href='#451378'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
is a common comment
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451379'>
<a class='timestamp' href='#451379'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
wumpus: there&#x27;s an optional 3rd argument to the CWalletDB constructor, to avoid flushing on close
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451380'>
<a class='timestamp' href='#451380'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sure, there are some places where flushing is skipped, just trying to dispel the myth that the only flushing happens in the flush thread :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451381'>
<a class='timestamp' href='#451381'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
ah ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119040' id='451382'>
<a class='timestamp' href='#451382'><time timestamp='2016-02-10T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sdaftuar: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451383'>
<a class='timestamp' href='#451383'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it was added relatively recently
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451384'>
<a class='timestamp' href='#451384'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: no :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451385'>
<a class='timestamp' href='#451385'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think that trick existed in the 0.3.x codebase
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451386'>
<a class='timestamp' href='#451386'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451387'>
<a class='timestamp' href='#451387'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we should do that during keypool topup, btw
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119100' id='451388'>
<a class='timestamp' href='#451388'><time timestamp='2016-02-10T15:45:00Z'>15:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which is ridiculously slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119160' id='451389'>
<a class='timestamp' href='#451389'><time timestamp='2016-02-10T15:46:00Z'>15:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: but what i&#x27;m trying to understand is how in those places where it isn&#x27;t &quot;flushed&quot; is it supposed to be depending on SetBestChain to flush it?  
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119220' id='451390'>
<a class='timestamp' href='#451390'><time timestamp='2016-02-10T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
keypool topup has already been sped up in 0.12 afaik
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119220' id='451391'>
<a class='timestamp' href='#451391'><time timestamp='2016-02-10T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: the flush isn&#x27;t prevented; just delayed
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119220' id='451392'>
<a class='timestamp' href='#451392'><time timestamp='2016-02-10T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: it flushes when that CWalletDB object goes out of scope
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119220' id='451393'>
<a class='timestamp' href='#451393'><time timestamp='2016-02-10T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos:  on the next operation, or shutdown, whatever happens first
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119220' id='451394'>
<a class='timestamp' href='#451394'><time timestamp='2016-02-10T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: he means when the no-flush argument is set
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119280' id='451395'>
<a class='timestamp' href='#451395'><time timestamp='2016-02-10T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: there is no no-flush argument
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119280' id='451396'>
<a class='timestamp' href='#451396'><time timestamp='2016-02-10T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just a second CWalletDB object that lives longer; the flush only happens when there are no CWalletDB objects
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119280' id='451397'>
<a class='timestamp' href='#451397'><time timestamp='2016-02-10T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
CWalletDB(const std::string&amp; strFilename, const char* pszMode = &quot;r+&quot;, bool fFlushOnClose = true) : CDB(strFilename, pszMode, fFlushOnClose)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119340' id='451398'>
<a class='timestamp' href='#451398'><time timestamp='2016-02-10T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh!
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119340' id='451399'>
<a class='timestamp' href='#451399'><time timestamp='2016-02-10T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
TIL: nobody knows how the wallet works
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451400'>
<a class='timestamp' href='#451400'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
what now
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451401'>
<a class='timestamp' href='#451401'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: ok, i confused things
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451402'>
<a class='timestamp' href='#451402'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
heh, i was about to offer to shut up if it was just me beign confused
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451403'>
<a class='timestamp' href='#451403'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: that&#x27;s not news :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451404'>
<a class='timestamp' href='#451404'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
&lt;morcos&gt; if what you were saying was true, then it would be possible for your chainstate to be behind your pruned blocks as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451405'>
<a class='timestamp' href='#451405'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, that actually happens and causes a crash on restart
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119400' id='451406'>
<a class='timestamp' href='#451406'><time timestamp='2016-02-10T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: the long-living CWalletDb object exists to prevent the <u>_checkpointing_</u> thread (caled ThreadFlushWalletDb)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119460' id='451407'>
<a class='timestamp' href='#451407'><time timestamp='2016-02-10T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that no one really understands the wallet code is a common argument why people don&#x27;t like it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119460' id='451408'>
<a class='timestamp' href='#451408'><time timestamp='2016-02-10T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: the fFlushOnClose argument is to prevent flushing to the logfile
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119460' id='451409'>
<a class='timestamp' href='#451409'><time timestamp='2016-02-10T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: right!
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119460' id='451410'>
<a class='timestamp' href='#451410'><time timestamp='2016-02-10T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ThreadFlushWalletDb has a stupid name
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119460' id='451411'>
<a class='timestamp' href='#451411'><time timestamp='2016-02-10T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ThreadCheckpointWalletDb would be much better
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451412'>
<a class='timestamp' href='#451412'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
everyone gets confused on that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451413'>
<a class='timestamp' href='#451413'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, in practice virtually all operations actually compact the wallet since that background thread triggers within a few seconds of any operation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451414'>
<a class='timestamp' href='#451414'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I probably only learned it about a year ago too
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451415'>
<a class='timestamp' href='#451415'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you are using &quot;checkpoint&quot; to mean moving from logfiles to wallet.dat?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451416'>
<a class='timestamp' href='#451416'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yes, BDB terminology :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451417'>
<a class='timestamp' href='#451417'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
actually, i&#x27;m not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451418'>
<a class='timestamp' href='#451418'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but you are saying that all wallet writes are synchronously flushed to log files?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451419'>
<a class='timestamp' href='#451419'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, same term is used in all sane sql databases
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451420'>
<a class='timestamp' href='#451420'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: yes that is the assumption
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451421'>
<a class='timestamp' href='#451421'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, that they are, it&#x27;s why the thing is so slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119520' id='451422'>
<a class='timestamp' href='#451422'><time timestamp='2016-02-10T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: flushing to logfiles is prevented with the CWalletDb fFlushOnClose bool
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119580' id='451423'>
<a class='timestamp' href='#451423'><time timestamp='2016-02-10T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: if you can disprove it, we found a huge issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119580' id='451424'>
<a class='timestamp' href='#451424'><time timestamp='2016-02-10T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: flushing to wallet.dat is prevented by having a concurrent long-lived CWalletDb object
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119580' id='451425'>
<a class='timestamp' href='#451425'><time timestamp='2016-02-10T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so SetBestChain synchronously writes to the logfile
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119640' id='451426'>
<a class='timestamp' href='#451426'><time timestamp='2016-02-10T15:54:00Z'>15:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, trust me virtually all wallet functions cause <b>*multiple*</b> fsync calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119640' id='451427'>
<a class='timestamp' href='#451427'><time timestamp='2016-02-10T15:54:00Z'>15:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: yes, writing to the log file causes an fsync
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119700' id='451428'>
<a class='timestamp' href='#451428'><time timestamp='2016-02-10T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so can i walk through an example
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119700' id='451429'>
<a class='timestamp' href='#451429'><time timestamp='2016-02-10T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
new block comes in
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119700' id='451430'>
<a class='timestamp' href='#451430'><time timestamp='2016-02-10T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you call SyncTransaction for every tx in block
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451431'>
<a class='timestamp' href='#451431'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
this walletdb is opened with fFlushOnClose = false
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451432'>
<a class='timestamp' href='#451432'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then you call SetBestChain because its time to
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451433'>
<a class='timestamp' href='#451433'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, hmm actually the only places we dont flush might cause a problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451434'>
<a class='timestamp' href='#451434'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
does the call to SetBestChain, which just contains a write
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451435'>
<a class='timestamp' href='#451435'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
AddToWalletIfInvolvingMe doesn&#x27;t cause a flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451436'>
<a class='timestamp' href='#451436'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: that will flush all writes, including the new txn
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451437'>
<a class='timestamp' href='#451437'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
somehow cause the AddToWalletInvolvingMe calls (inside SyncTransaction)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119760' id='451438'>
<a class='timestamp' href='#451438'><time timestamp='2016-02-10T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok they get flushed to
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119820' id='451439'>
<a class='timestamp' href='#451439'><time timestamp='2016-02-10T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
so that could be a slow operation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119820' id='451440'>
<a class='timestamp' href='#451440'><time timestamp='2016-02-10T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so thats why it can be expensive is what you&#x27;re syaing
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119820' id='451441'>
<a class='timestamp' href='#451441'><time timestamp='2016-02-10T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
 // this is safe, as in case of a crash, we rescan the necessary blocks on startup through our SetBestChain-mechanism
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119820' id='451442'>
<a class='timestamp' href='#451442'><time timestamp='2016-02-10T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yeah, there is a single Db* object which is cached, and every CWalletDb updates gets redirected to that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119820' id='451443'>
<a class='timestamp' href='#451443'><time timestamp='2016-02-10T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
is that correct with pruning?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119880' id='451444'>
<a class='timestamp' href='#451444'><time timestamp='2016-02-10T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: all pruning requires is that the wallet is not behind the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119880' id='451445'>
<a class='timestamp' href='#451445'><time timestamp='2016-02-10T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i think we should first write the wallet.setchainstate, and then flush the chainstate
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119880' id='451446'>
<a class='timestamp' href='#451446'><time timestamp='2016-02-10T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
well i think in practice there&#x27;s little risk of that because SetBestChain causes a wallet flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119940' id='451447'>
<a class='timestamp' href='#451447'><time timestamp='2016-02-10T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: that sounds good to me, i doubt the order really matters b/c it seems like we have problems anyway if we crash inside FSTD but can&#x27;t hurt.  But i&#x27;d make the additional condition fDoFullFlush and not fFlushForPrune if it were me...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119940' id='451448'>
<a class='timestamp' href='#451448'><time timestamp='2016-02-10T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if nothing else, will help the wallet stay more close to caught up during a reindex
<br>
</div>

<div class='talk op-msg' data-timestamp='1455119940' id='451449'>
<a class='timestamp' href='#451449'><time timestamp='2016-02-10T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: in the current code, if you crash in between the chainstate update and the wallet update, you can see a wallet that refers to a pruned block
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120000' id='451450'>
<a class='timestamp' href='#451450'><time timestamp='2016-02-10T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, and actually CDB::Flush does a checkpoint also
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120000' id='451451'>
<a class='timestamp' href='#451451'><time timestamp='2016-02-10T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
txn_checkpoint
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120000' id='451452'>
<a class='timestamp' href='#451452'><time timestamp='2016-02-10T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: that&#x27;s a checkpoint to the logfile
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120000' id='451453'>
<a class='timestamp' href='#451453'><time timestamp='2016-02-10T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, it also flushes the log file
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120000' id='451454'>
<a class='timestamp' href='#451454'><time timestamp='2016-02-10T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: in i think a related question, did you see what i asked on #7491.   why do we even need to be calling MarkConflicted on loading the wallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451455'>
<a class='timestamp' href='#451455'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the bsb logic around this is all insanely confusing
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451456'>
<a class='timestamp' href='#451456'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: backward compatibility
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451457'>
<a class='timestamp' href='#451457'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451458'>
<a class='timestamp' href='#451458'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think (i haven&#x27;t looked)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451459'>
<a class='timestamp' href='#451459'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
when you load a wallet that was written by a pre-0.12, it won&#x27;t have conflict information
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451460'>
<a class='timestamp' href='#451460'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
for example DB-&gt;sync doesn&#x27;t always cause an fsync call
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120060' id='451461'>
<a class='timestamp' href='#451461'><time timestamp='2016-02-10T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
&gt;.&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451462'>
<a class='timestamp' href='#451462'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: bsb, that&#x27;s BDB on LSD?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451463'>
<a class='timestamp' href='#451463'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
er
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451464'>
<a class='timestamp' href='#451464'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
hmm...   but aren&#x27;t you only creating a weird subset of the conflict information
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451465'>
<a class='timestamp' href='#451465'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
they&#x27;re like, right next to each other mannn
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451466'>
<a class='timestamp' href='#451466'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yeah, it can&#x27;t be complete unless you rescan iirc
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451467'>
<a class='timestamp' href='#451467'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120120' id='451468'>
<a class='timestamp' href='#451468'><time timestamp='2016-02-10T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which is in the release notes, i think!
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120180' id='451469'>
<a class='timestamp' href='#451469'><time timestamp='2016-02-10T16:03:00Z'>16:03</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
so one question about the wallet being ahead of the chainstate: should we be checking that conflicted block information is for blocks that are on chainActive at startup?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120240' id='451470'>
<a class='timestamp' href='#451470'><time timestamp='2016-02-10T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
not sure i have a sepcific broken scenario in mind
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120240' id='451471'>
<a class='timestamp' href='#451471'><time timestamp='2016-02-10T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: that&#x27;s checked at runtime
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120240' id='451472'>
<a class='timestamp' href='#451472'><time timestamp='2016-02-10T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
ah okay
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120240' id='451473'>
<a class='timestamp' href='#451473'><time timestamp='2016-02-10T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the conflicted block hash refers to a non-active block, it&#x27;s considered to be non-conflicted
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120360' id='451474'>
<a class='timestamp' href='#451474'><time timestamp='2016-02-10T16:06:00Z'>16:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i&#x27;ve got a question
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120360' id='451475'>
<a class='timestamp' href='#451475'><time timestamp='2016-02-10T16:06:00Z'>16:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
does anybody actually use the conflict logic?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120420' id='451476'>
<a class='timestamp' href='#451476'><time timestamp='2016-02-10T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: it was originally created to distinguish between txs that just aren&#x27;t in your mempool and txs that are actually conflicted
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120480' id='451477'>
<a class='timestamp' href='#451477'><time timestamp='2016-02-10T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: <a href="https://github.com/bitcoin/bitcoin/pull/7105#issuecomment-160609039" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7105#issuecomment-160609039</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120480' id='451478'>
<a class='timestamp' href='#451478'><time timestamp='2016-02-10T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so that you wouldn&#x27;t be able to auto doublespend the first
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120540' id='451479'>
<a class='timestamp' href='#451479'><time timestamp='2016-02-10T16:09:00Z'>16:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: so i think moving the wallet flush doesn&#x27;t help, unless we also move the chainstate write to be ahead of pruning
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120600' id='451480'>
<a class='timestamp' href='#451480'><time timestamp='2016-02-10T16:10:00Z'>16:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just going to change the wallet write condition
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120660' id='451481'>
<a class='timestamp' href='#451481'><time timestamp='2016-02-10T16:11:00Z'>16:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: agreed, and unmove the Unlink?  
<br>
</div>

<div class='talk op-msg' data-timestamp='1455120660' id='451482'>
<a class='timestamp' href='#451482'><time timestamp='2016-02-10T16:11:00Z'>16:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455121620' id='451483'>
<a class='timestamp' href='#451483'><time timestamp='2016-02-10T16:27:00Z'>16:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: Should I change CheckSequenceLocks to take a CoinsViewCache instead of create its own so that it doesn&#x27;t need to be inside the mempool lock in ATMP?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455121620' id='451484'>
<a class='timestamp' href='#451484'><time timestamp='2016-02-10T16:27:00Z'>16:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or not bother
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123540' id='451485'>
<a class='timestamp' href='#451485'><time timestamp='2016-02-10T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
looks like travis isn&#x27;t running #7502 for some reason?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123600' id='451486'>
<a class='timestamp' href='#451486'><time timestamp='2016-02-10T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
never mind - it did
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123600' id='451487'>
<a class='timestamp' href='#451487'><time timestamp='2016-02-10T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sdaftuar, there&#x27;s a limited number of concurrent runs available
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123600' id='451488'>
<a class='timestamp' href='#451488'><time timestamp='2016-02-10T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
with heavy activity it can take a long time
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123660' id='451489'>
<a class='timestamp' href='#451489'><time timestamp='2016-02-10T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
oh does it take a while for it to even get queued?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123660' id='451490'>
<a class='timestamp' href='#451490'><time timestamp='2016-02-10T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
looks like sipa&#x27;s first commit in #7502 was run, but when he force pushed a new commit, that one hasn&#x27;t been run, and doesn&#x27;t seem to be queued that i can see 
<br>
</div>

<div class='talk op-msg' data-timestamp='1455123720' id='451491'>
<a class='timestamp' href='#451491'><time timestamp='2016-02-10T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sometimes it seems to throttle
<br>
</div>

<div class='talk op-msg' data-timestamp='1455126960' id='451492'>
<a class='timestamp' href='#451492'><time timestamp='2016-02-10T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-15'> GitHub10</span>&gt;
[bitcoin] Kammi6187 opened pull request #7503: Master (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/7503" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7503</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455127020' id='451493'>
<a class='timestamp' href='#451493'><time timestamp='2016-02-10T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-4'> GitHub186</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/d007511ebdfa...c9da9c4bd83c" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/d007511ebdfa...c9da9c4bd83c</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455127020' id='451494'>
<a class='timestamp' href='#451494'><time timestamp='2016-02-10T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-4'> GitHub186</span>&gt;
bitcoin/master 40e7b61 Wladimir J. van der Laan: wallet: Ignore MarkConflict if block hash is not known...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455127020' id='451495'>
<a class='timestamp' href='#451495'><time timestamp='2016-02-10T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-4'> GitHub186</span>&gt;
bitcoin/master c9da9c4 Wladimir J. van der Laan: Merge #7491: wallet: Ignore MarkConflict if block hash is not known...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455127020' id='451496'>
<a class='timestamp' href='#451496'><time timestamp='2016-02-10T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-10'> GitHub29</span>&gt;
[bitcoin] laanwj closed pull request #7491: wallet: Ignore MarkConflict if block hash is not known (master...2016_02_wallet_markconflict_assert) <a href="https://github.com/bitcoin/bitcoin/pull/7491" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7491</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455127020' id='451497'>
<a class='timestamp' href='#451497'><time timestamp='2016-02-10T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-6'> GitHub145</span>&gt;
[bitcoin] Kammi6187 closed pull request #7503: Master (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/7503" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7503</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455129600' id='451498'>
<a class='timestamp' href='#451498'><time timestamp='2016-02-10T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-10'> GitHub2</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/c9da9c4bd83c...b93f07849648" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c9da9c4bd83c...b93f07849648</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455129600' id='451499'>
<a class='timestamp' href='#451499'><time timestamp='2016-02-10T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-10'> GitHub2</span>&gt;
bitcoin/master e4eebb6 Pieter Wuille: Update the wallet best block marker when pruning
<br>
</div>

<div class='talk op-msg' data-timestamp='1455129600' id='451500'>
<a class='timestamp' href='#451500'><time timestamp='2016-02-10T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-10'> GitHub2</span>&gt;
bitcoin/master b93f078 Wladimir J. van der Laan: Merge #7502: Update the wallet best block marker when pruning...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455129600' id='451501'>
<a class='timestamp' href='#451501'><time timestamp='2016-02-10T18:40:00Z'>18:40</time></a>
&lt;<span class='nick nick-8'> GitHub75</span>&gt;
[bitcoin] laanwj closed pull request #7502: Update the wallet best block marker when pruning (master...betterflush) <a href="https://github.com/bitcoin/bitcoin/pull/7502" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7502</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130440' id='451502'>
<a class='timestamp' href='#451502'><time timestamp='2016-02-10T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: weird. the unit test passes for me but i don&#x27;t understand how. in any case, should i just LOCK(mempool.cs) in CheckSequenceLocks or leave it as AssertLockHeld and lock it in miner_tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130440' id='451503'>
<a class='timestamp' href='#451503'><time timestamp='2016-02-10T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the miner test do all kinds of messing with the mempool anyway, so wouldn&#x27;t be weird to lock it for the whole test
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130440' id='451504'>
<a class='timestamp' href='#451504'><time timestamp='2016-02-10T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but just want to think about moving these locks in the right direction
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130440' id='451505'>
<a class='timestamp' href='#451505'><time timestamp='2016-02-10T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its such a mess now without how much cs_main is used to protect mempool stuff already
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130500' id='451506'>
<a class='timestamp' href='#451506'><time timestamp='2016-02-10T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
s/without/with/
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130500' id='451507'>
<a class='timestamp' href='#451507'><time timestamp='2016-02-10T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i generally consider functions that optionally run in a locked context bad design
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130500' id='451508'>
<a class='timestamp' href='#451508'><time timestamp='2016-02-10T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i&#x27;d say leave the assert in CheckSequenceLocks, and add a LOCK in the tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130620' id='451509'>
<a class='timestamp' href='#451509'><time timestamp='2016-02-10T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
any idea why the unit test passes for sdaftuar and i?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130620' id='451510'>
<a class='timestamp' href='#451510'><time timestamp='2016-02-10T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do you run with -DDEBUG_LOCKORDER ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130680' id='451511'>
<a class='timestamp' href='#451511'><time timestamp='2016-02-10T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(no idea if that&#x27;s done by default or only specifically from travis)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130680' id='451512'>
<a class='timestamp' href='#451512'><time timestamp='2016-02-10T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
no..  so AssertLockHeld only applies with DEBUG_LOCKORDER?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130680' id='451513'>
<a class='timestamp' href='#451513'><time timestamp='2016-02-10T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i never knew that, i thought it was just an assert
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130740' id='451514'>
<a class='timestamp' href='#451514'><time timestamp='2016-02-10T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-2'> GitHub22</span>&gt;
[bitcoin] laanwj pushed 2 new commits to 0.12: <a href="https://github.com/bitcoin/bitcoin/compare/827a2b6736d0...132996300134" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/827a2b6736d0...132996300134</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130740' id='451515'>
<a class='timestamp' href='#451515'><time timestamp='2016-02-10T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-2'> GitHub22</span>&gt;
bitcoin/0.12 00ec73e Wladimir J. van der Laan: wallet: Ignore MarkConflict if block hash is not known...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130740' id='451516'>
<a class='timestamp' href='#451516'><time timestamp='2016-02-10T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-2'> GitHub22</span>&gt;
bitcoin/0.12 1329963 Pieter Wuille: Update the wallet best block marker when pruning...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130800' id='451517'>
<a class='timestamp' href='#451517'><time timestamp='2016-02-10T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i&#x27;m not sure i follow exactly what you&#x27;re saying about optionally running in a locked context.  you don&#x27;t like it when the locks take advantage of being reentrant?  
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130860' id='451518'>
<a class='timestamp' href='#451518'><time timestamp='2016-02-10T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130860' id='451519'>
<a class='timestamp' href='#451519'><time timestamp='2016-02-10T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: locks should be internal to some level of encapsulation, and not escape it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130860' id='451520'>
<a class='timestamp' href='#451520'><time timestamp='2016-02-10T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the downside to locking in the tests, is it&#x27;ll work fine now (i think) but what happens latter if CreateNewBlock spins off new threads to do things and can&#x27;t lock the mempool if we&#x27;ve got it locked for the whole test
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130920' id='451521'>
<a class='timestamp' href='#451521'><time timestamp='2016-02-10T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that would mean we&#x27;d need to separately lock for each call to CheckSequenceLocks in the test
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130920' id='451522'>
<a class='timestamp' href='#451522'><time timestamp='2016-02-10T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: if necessary, have two versions of a function; an internal one that asserts the lock and is not public, and an external one that just locks and grabs the internal one. non-reentrant locks are also signifciantly more efficient
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130920' id='451523'>
<a class='timestamp' href='#451523'><time timestamp='2016-02-10T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: that&#x27;s theory, of course...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130980' id='451524'>
<a class='timestamp' href='#451524'><time timestamp='2016-02-10T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: meh, just lock once; fixing tests can be done later
<br>
</div>

<div class='talk op-msg' data-timestamp='1455130980' id='451525'>
<a class='timestamp' href='#451525'><time timestamp='2016-02-10T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: see addrman.h :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131040' id='451526'>
<a class='timestamp' href='#451526'><time timestamp='2016-02-10T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ha!  thats how we got into such a messy locking situation in the first place.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131160' id='451527'>
<a class='timestamp' href='#451527'><time timestamp='2016-02-10T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: the messy situation is a result of: satoshi, who wrote unintelligable but working code with relatively smart but ugly locking design that was not written down anywhere; other people took over who didn&#x27;t understand that design, and race conditions appears; we got scared and added locking everywhere to be sure; now we&#x27;re slowly trying to push locks down to improve performance
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131160' id='451528'>
<a class='timestamp' href='#451528'><time timestamp='2016-02-10T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so if we&#x27;re pushing locks down, shouldn&#x27;t the lock be in CheckSequenceLocks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131220' id='451529'>
<a class='timestamp' href='#451529'><time timestamp='2016-02-10T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, are there no callers for CheckSequenceLocks that already have the lock?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131220' id='451530'>
<a class='timestamp' href='#451530'><time timestamp='2016-02-10T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well, there is, removeForReorg.  let me see if thats even necessary though
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131280' id='451531'>
<a class='timestamp' href='#451531'><time timestamp='2016-02-10T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i guess that is necessary b/c it iterates the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131340' id='451532'>
<a class='timestamp' href='#451532'><time timestamp='2016-02-10T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you can add a tiny wrapper around CheckSequenceLocks inside the test code that grabs the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131340' id='451533'>
<a class='timestamp' href='#451533'><time timestamp='2016-02-10T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok i don&#x27;t want to waste your time, i just wanted to help move things in the right direction..  
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131340' id='451534'>
<a class='timestamp' href='#451534'><time timestamp='2016-02-10T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t really care :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131400' id='451535'>
<a class='timestamp' href='#451535'><time timestamp='2016-02-10T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;ll just throw it at the top for now.. the tests are already broken with addUnchecked sitting there anyway, we can fix it when its a problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131400' id='451536'>
<a class='timestamp' href='#451536'><time timestamp='2016-02-10T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131400' id='451537'>
<a class='timestamp' href='#451537'><time timestamp='2016-02-10T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh that grabs it...  hmm ok i&#x27;ll do the wrapper..
<br>
</div>

<div class='talk op-msg' data-timestamp='1455131700' id='451538'>
<a class='timestamp' href='#451538'><time timestamp='2016-02-10T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-6'> GitHub0</span>&gt;
[bitcoin] paveljanik opened pull request #7504: Crystal clean make clean (master...20160210_crystal_clean_make_clean) <a href="https://github.com/bitcoin/bitcoin/pull/7504" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7504</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132720' id='451539'>
<a class='timestamp' href='#451539'><time timestamp='2016-02-10T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-10'> GitHub139</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/b93f07849648...2f3f4af4cc2b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/b93f07849648...2f3f4af4cc2b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132720' id='451540'>
<a class='timestamp' href='#451540'><time timestamp='2016-02-10T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-10'> GitHub139</span>&gt;
bitcoin/master 9d95187 Pieter Wuille: Correctly report high-S violations
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132720' id='451541'>
<a class='timestamp' href='#451541'><time timestamp='2016-02-10T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-10'> GitHub139</span>&gt;
bitcoin/master 2f3f4af Wladimir J. van der Laan: Merge #7500: Correctly report high-S violations...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132720' id='451542'>
<a class='timestamp' href='#451542'><time timestamp='2016-02-10T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-8'> GitHub165</span>&gt;
[bitcoin] laanwj closed pull request #7500: Correctly report high-S violations (master...reporthighs) <a href="https://github.com/bitcoin/bitcoin/pull/7500" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7500</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132840' id='451543'>
<a class='timestamp' href='#451543'><time timestamp='2016-02-10T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-4'> GitHub1</span>&gt;
[bitcoin] laanwj pushed 1 new commit to 0.12: <a href="https://github.com/bitcoin/bitcoin/commit/889e5b3050e78614acb45ea0845dc8fd33b157bf" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/889e5b3050e78614acb45ea0845dc8fd33b157bf</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455132840' id='451544'>
<a class='timestamp' href='#451544'><time timestamp='2016-02-10T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-4'> GitHub1</span>&gt;
bitcoin/0.12 889e5b3 Pieter Wuille: Correctly report high-S violations...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133200' id='451545'>
<a class='timestamp' href='#451545'><time timestamp='2016-02-10T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-14'> GitHub179</span>&gt;
[bitcoin] laanwj pushed 2 new commits to 0.12: <a href="https://github.com/bitcoin/bitcoin/compare/889e5b3050e7...947c4ff72495" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/889e5b3050e7...947c4ff72495</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133200' id='451546'>
<a class='timestamp' href='#451546'><time timestamp='2016-02-10T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-14'> GitHub179</span>&gt;
bitcoin/0.12 9cb31e6 Matt: Fix spelling: misbeha{b,v}ing...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133200' id='451547'>
<a class='timestamp' href='#451547'><time timestamp='2016-02-10T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-14'> GitHub179</span>&gt;
bitcoin/0.12 947c4ff mrbandrews: [rpc-tests] Change solve() to use rehash...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133560' id='451548'>
<a class='timestamp' href='#451548'><time timestamp='2016-02-10T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-8'> GitHub165</span>&gt;
[bitcoin] laanwj pushed 1 new commit to 0.12: <a href="https://github.com/bitcoin/bitcoin/commit/c3faf78c0e96a8c64a5ff8c37ef6fc4cfb35d125" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/c3faf78c0e96a8c64a5ff8c37ef6fc4cfb35d125</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133560' id='451549'>
<a class='timestamp' href='#451549'><time timestamp='2016-02-10T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-8'> GitHub165</span>&gt;
bitcoin/0.12 c3faf78 instagibbs: Changed getnetworkhps value to double to avoid overflow....
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133680' id='451550'>
<a class='timestamp' href='#451550'><time timestamp='2016-02-10T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
there we go, time for rc5...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133680' id='451551'>
<a class='timestamp' href='#451551'><time timestamp='2016-02-10T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: having two sets of settings is far uglier than writing bitcoin.conf IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133740' id='451552'>
<a class='timestamp' href='#451552'><time timestamp='2016-02-10T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t agree, but we&#x27;ve already had this argument before
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133920' id='451553'>
<a class='timestamp' href='#451553'><time timestamp='2016-02-10T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: any chance that would change if I&#x27;m looking at putting like 20 more options in there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133980' id='451554'>
<a class='timestamp' href='#451554'><time timestamp='2016-02-10T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well I don&#x27;t want the daemon nor GUI writing to bitcoin.conf. There should be no assumption that the configuration file is writing at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133980' id='451555'>
<a class='timestamp' href='#451555'><time timestamp='2016-02-10T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
writable*
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133980' id='451556'>
<a class='timestamp' href='#451556'><time timestamp='2016-02-10T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
how about a separate .conf writable loaded alongside bitcoin.conf?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133980' id='451557'>
<a class='timestamp' href='#451557'><time timestamp='2016-02-10T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the number of options doesn&#x27;t change that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455133980' id='451558'>
<a class='timestamp' href='#451558'><time timestamp='2016-02-10T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what&#x27;s wrong with the qsettings?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134040' id='451559'>
<a class='timestamp' href='#451559'><time timestamp='2016-02-10T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it is like a separate .conf writable alongside bitcoin.conf, except that it is the OS-sanctified way of storing application settings
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134040' id='451560'>
<a class='timestamp' href='#451560'><time timestamp='2016-02-10T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and the var names are all different
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134040' id='451561'>
<a class='timestamp' href='#451561'><time timestamp='2016-02-10T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and it won&#x27;t get picked up on bitcoind
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134100' id='451562'>
<a class='timestamp' href='#451562'><time timestamp='2016-02-10T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, the difference in naming is ugly, that could be solved with some kind of mapping for old settings + use the same name for new settings
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134100' id='451563'>
<a class='timestamp' href='#451563'><time timestamp='2016-02-10T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that naming is inherited from satoshi-ism, the old place for the settings used to be the wallet(!)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134100' id='451564'>
<a class='timestamp' href='#451564'><time timestamp='2016-02-10T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134280' id='451565'>
<a class='timestamp' href='#451565'><time timestamp='2016-02-10T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
wumpus: and no value in bitcoind using the same settings? ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134340' id='451566'>
<a class='timestamp' href='#451566'><time timestamp='2016-02-10T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and remember that whatever you do has to be backwards compatible, so what you imply is to add <b>*another*</b> source of settings. The initialization code (making sure that the option settings take precedence in the right order) is already complex enough. I&#x27;d really prefer not to tweak with it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134340' id='451567'>
<a class='timestamp' href='#451567'><time timestamp='2016-02-10T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we have enough actual issues to fix...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134400' id='451568'>
<a class='timestamp' href='#451568'><time timestamp='2016-02-10T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
well, not really another. I&#x27;d just load two conf files. :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455134460' id='451569'>
<a class='timestamp' href='#451569'><time timestamp='2016-02-10T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and start with just the new settings (which are mostly policy-related) in the new one
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135540' id='451570'>
<a class='timestamp' href='#451570'><time timestamp='2016-02-10T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> GitHub3</span>&gt;
[bitcoin] laanwj pushed 2 new commits to 0.12: <a href="https://github.com/bitcoin/bitcoin/compare/c3faf78c0e96...68134263e2bf" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c3faf78c0e96...68134263e2bf</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135540' id='451571'>
<a class='timestamp' href='#451571'><time timestamp='2016-02-10T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> GitHub3</span>&gt;
bitcoin/0.12 10be44a Wladimir J. van der Laan: doc: Release notes update pre-rc5
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135540' id='451572'>
<a class='timestamp' href='#451572'><time timestamp='2016-02-10T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> GitHub3</span>&gt;
bitcoin/0.12 6813426 Wladimir J. van der Laan: qt: Translation update pre-rc5
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135540' id='451573'>
<a class='timestamp' href='#451573'><time timestamp='2016-02-10T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Hurray RC5.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135660' id='451574'>
<a class='timestamp' href='#451574'><time timestamp='2016-02-10T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
 * [new tag]         v0.12.0rc5 -&gt; v0.12.0rc5
<br>
</div>

<div class='talk op-msg' data-timestamp='1455135660' id='451575'>
<a class='timestamp' href='#451575'><time timestamp='2016-02-10T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the really-really-really last rc :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136080' id='451576'>
<a class='timestamp' href='#451576'><time timestamp='2016-02-10T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Did rc4 detached sigs happen?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136140' id='451577'>
<a class='timestamp' href='#451577'><time timestamp='2016-02-10T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
michagogo: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136200' id='451578'>
<a class='timestamp' href='#451578'><time timestamp='2016-02-10T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: instagibbs == Gregory Sanders
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136200' id='451579'>
<a class='timestamp' href='#451579'><time timestamp='2016-02-10T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no binaries, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136200' id='451580'>
<a class='timestamp' href='#451580'><time timestamp='2016-02-10T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: ok!
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136260' id='451581'>
<a class='timestamp' href='#451581'><time timestamp='2016-02-10T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: looks like he is using different git author names
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136440' id='451582'>
<a class='timestamp' href='#451582'><time timestamp='2016-02-10T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
need a rc6 for .git problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136500' id='451583'>
<a class='timestamp' href='#451583'><time timestamp='2016-02-10T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
half-/s
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136500' id='451584'>
<a class='timestamp' href='#451584'><time timestamp='2016-02-10T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
half-/s ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136680' id='451585'>
<a class='timestamp' href='#451585'><time timestamp='2016-02-10T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
[bitcoin] laanwj pushed 1 new commit to 0.12: <a href="https://github.com/bitcoin/bitcoin/commit/772863583c35e4344c0020445ede04d7a2e5837b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/772863583c35e4344c0020445ede04d7a2e5837b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136680' id='451586'>
<a class='timestamp' href='#451586'><time timestamp='2016-02-10T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
bitcoin/0.12 7728635 Wladimir J. van der Laan: doc: fix author list in release notes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136980' id='451587'>
<a class='timestamp' href='#451587'><time timestamp='2016-02-10T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: half-sarcasm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455136980' id='451588'>
<a class='timestamp' href='#451588'><time timestamp='2016-02-10T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ha
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137040' id='451589'>
<a class='timestamp' href='#451589'><time timestamp='2016-02-10T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it&#x27;s a bug I absolutely need fixed to do Gentoo packaging, but I can throw it in with the system library stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137040' id='451590'>
<a class='timestamp' href='#451590'><time timestamp='2016-02-10T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
build system changes that don&#x27;t influence the executable don&#x27;t really warrant a new rc
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137160' id='451591'>
<a class='timestamp' href='#451591'><time timestamp='2016-02-10T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it might. I noticed there are weird circumstances over when the &#x27;g&#x27; prefixes the commit hash or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137160' id='451592'>
<a class='timestamp' href='#451592'><time timestamp='2016-02-10T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
then again, you still have to fight it out with cfields what the genbuild.sh check should do at all, no way that will make 0.12.0 in teh first place :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137160' id='451593'>
<a class='timestamp' href='#451593'><time timestamp='2016-02-10T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I didn&#x27;t think it was worth looking into further at the time
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137220' id='451594'>
<a class='timestamp' href='#451594'><time timestamp='2016-02-10T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t think so either, it works ok, any well-meant change will probably break it in some way again
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137220' id='451595'>
<a class='timestamp' href='#451595'><time timestamp='2016-02-10T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
are we really at the point that we need a test suite for the build system :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137220' id='451596'>
<a class='timestamp' href='#451596'><time timestamp='2016-02-10T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I mean the build difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137220' id='451597'>
<a class='timestamp' href='#451597'><time timestamp='2016-02-10T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I was wondering the other day..
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451598'>
<a class='timestamp' href='#451598'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
how can we add a test suite for the test suite? :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451599'>
<a class='timestamp' href='#451599'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451600'>
<a class='timestamp' href='#451600'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
seems we need a recursive test system
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451601'>
<a class='timestamp' href='#451601'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which is able to test itself
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451602'>
<a class='timestamp' href='#451602'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-1'> OxADADA</span>&gt;
we should also have 100% coverage of the test of the tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137280' id='451603'>
<a class='timestamp' href='#451603'><time timestamp='2016-02-10T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-1'> OxADADA</span>&gt;
:P
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137340' id='451604'>
<a class='timestamp' href='#451604'><time timestamp='2016-02-10T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
quine test
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137580' id='451605'>
<a class='timestamp' href='#451605'><time timestamp='2016-02-10T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-1'> OxADADA</span>&gt;
my favorite test runner is the one that when detecting errors, deletes the offending function from the source code; recursively until no error is thrown.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137640' id='451606'>
<a class='timestamp' href='#451606'><time timestamp='2016-02-10T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what if the error is in main() ? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137640' id='451607'>
<a class='timestamp' href='#451607'><time timestamp='2016-02-10T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-1'> OxADADA</span>&gt;
sipa: it will delete main()
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137640' id='451608'>
<a class='timestamp' href='#451608'><time timestamp='2016-02-10T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
it generates new one.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137700' id='451609'>
<a class='timestamp' href='#451609'><time timestamp='2016-02-10T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which will result in a linker error :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137700' id='451610'>
<a class='timestamp' href='#451610'><time timestamp='2016-02-10T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
complaining about the lack of main()
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137700' id='451611'>
<a class='timestamp' href='#451611'><time timestamp='2016-02-10T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-1'> OxADADA</span>&gt;
the most bug-free line of code is the line that was never written.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455137820' id='451612'>
<a class='timestamp' href='#451612'><time timestamp='2016-02-10T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I certainly prefer pulls that delete code to those that add code :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138360' id='451613'>
<a class='timestamp' href='#451613'><time timestamp='2016-02-10T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: on that note and Luke-Jr this is mostly directed at you.   are you guys ok with deleting the free transaction code from AcceptToMemoryPool then?  I agree deleting from wallet is a first step, and maybe in an ideal world would have happened in an earlier release.  But it seems to me by the time 0.13 is released its a lost cause anwyay.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138420' id='451614'>
<a class='timestamp' href='#451614'><time timestamp='2016-02-10T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: what do you think if I create a PR to remove sending free transactions first (i suspect it&#x27;ll probably be too big to back port to 0.12.1 though) and then follow on with a mempool cleanup.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138420' id='451615'>
<a class='timestamp' href='#451615'><time timestamp='2016-02-10T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: IMO one of the conditions must first be met 1) removal from wallet in prior release; 2) de facto never working for the forseeable future
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138420' id='451616'>
<a class='timestamp' href='#451616'><time timestamp='2016-02-10T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i think any reasonable adoption of 0.12 is going to cause it to just not work...   
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138420' id='451617'>
<a class='timestamp' href='#451617'><time timestamp='2016-02-10T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
although I would prefer maintaining relay of non-free txns as long as possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138420' id='451618'>
<a class='timestamp' href='#451618'><time timestamp='2016-02-10T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I tend to agree with Luke-Jr, sending them should be gone (or at least heavily discouraged) for a while then
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451619'>
<a class='timestamp' href='#451619'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: its been defaulted off for some time
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451620'>
<a class='timestamp' href='#451620'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451621'>
<a class='timestamp' href='#451621'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I still never use a fee myself FWIW
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451622'>
<a class='timestamp' href='#451622'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Ok, so lets break this into 2 parts
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451623'>
<a class='timestamp' href='#451623'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
as long as I can successfully do so, I plan to re-add it to my own wallet ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138480' id='451624'>
<a class='timestamp' href='#451624'><time timestamp='2016-02-10T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Part 1) you&#x27;re ok with removing the ability to send them?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138540' id='451625'>
<a class='timestamp' href='#451625'><time timestamp='2016-02-10T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yeah, free transactions still seem to be working at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138540' id='451626'>
<a class='timestamp' href='#451626'><time timestamp='2016-02-10T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: part 1, I prefer not to unless there is a good reason
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138540' id='451627'>
<a class='timestamp' href='#451627'><time timestamp='2016-02-10T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
may take a long time to be included though, but not everyone is in a hurry
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138540' id='451628'>
<a class='timestamp' href='#451628'><time timestamp='2016-02-10T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
(expecting it to stop working before the next release would be a good reason)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138540' id='451629'>
<a class='timestamp' href='#451629'><time timestamp='2016-02-10T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well the reason i&#x27;m asking is i feel like cleaning up stuff like this towards the beginning of a release cycle makes other work easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138600' id='451630'>
<a class='timestamp' href='#451630'><time timestamp='2016-02-10T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
removing features is not really cleaning up. :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138600' id='451631'>
<a class='timestamp' href='#451631'><time timestamp='2016-02-10T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
does it really make other work that much easier?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138600' id='451632'>
<a class='timestamp' href='#451632'><time timestamp='2016-02-10T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i find it hard to imagine its going to work.  i think the size of your 0.12 mempool would need to be multiple GB&#x27;s in order to not get full.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138660' id='451633'>
<a class='timestamp' href='#451633'><time timestamp='2016-02-10T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: yes, both in the wallet and in ATMP, you have to be careful around the special casing for free/priority stuff.  Maybe thats only a limited area, but I seem to end up in that area a lot.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138660' id='451634'>
<a class='timestamp' href='#451634'><time timestamp='2016-02-10T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I think we&#x27;ll be in a much better place to discuss this once 0.12 is released for a while
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138660' id='451635'>
<a class='timestamp' href='#451635'><time timestamp='2016-02-10T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
right now there&#x27;s just too much to speculate on
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138660' id='451636'>
<a class='timestamp' href='#451636'><time timestamp='2016-02-10T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
okey dokey (is that what I&#x27;m supposed to say)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138720' id='451637'>
<a class='timestamp' href='#451637'><time timestamp='2016-02-10T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138720' id='451638'>
<a class='timestamp' href='#451638'><time timestamp='2016-02-10T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: alright related question
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138720' id='451639'>
<a class='timestamp' href='#451639'><time timestamp='2016-02-10T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
do you care about priority estimation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138780' id='451640'>
<a class='timestamp' href='#451640'><time timestamp='2016-02-10T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
as things stand right now, I prefer gratis transactions to continue working as long as possible, but I won&#x27;t fight removal of it like I am with priority-mining ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138780' id='451641'>
<a class='timestamp' href='#451641'><time timestamp='2016-02-10T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138780' id='451642'>
<a class='timestamp' href='#451642'><time timestamp='2016-02-10T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think you are right that until and unless miners stop doing priority mining, fee estimation has the same problem with priority txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138780' id='451643'>
<a class='timestamp' href='#451643'><time timestamp='2016-02-10T21:13:00Z'>21:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
priority is a fallback and anti-spam measure, it shouldn&#x27;t be relied on for more than that IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138840' id='451644'>
<a class='timestamp' href='#451644'><time timestamp='2016-02-10T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i want to decide if maintaining the priority estimation code is worth the benefit it has to fee estimation.  its unclear at this point.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138840' id='451645'>
<a class='timestamp' href='#451645'><time timestamp='2016-02-10T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, so if improving fee estimation results in the removal of priority estimation, no big complaints from anyone?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138840' id='451646'>
<a class='timestamp' href='#451646'><time timestamp='2016-02-10T21:14:00Z'>21:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I wasn&#x27;t aware we had priority estimation code XD
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138900' id='451647'>
<a class='timestamp' href='#451647'><time timestamp='2016-02-10T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
unless you mean the priority display in coin control, which I find handy, but could live without if there&#x27;s a benefit to removing it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138900' id='451648'>
<a class='timestamp' href='#451648'><time timestamp='2016-02-10T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: so what do you think the Bitcoin Core wallet should do in the near future? always use fee estimation, and pay the estimated/chosen fee?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138900' id='451649'>
<a class='timestamp' href='#451649'><time timestamp='2016-02-10T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: hmm.. good point, that used to return some hardcoded value, i think now it returns something based off priority estimation
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138900' id='451650'>
<a class='timestamp' href='#451650'><time timestamp='2016-02-10T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
actually, I&#x27;d probably hack it back in..
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138960' id='451651'>
<a class='timestamp' href='#451651'><time timestamp='2016-02-10T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: by default at least.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138960' id='451652'>
<a class='timestamp' href='#451652'><time timestamp='2016-02-10T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: (this is already the case)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138960' id='451653'>
<a class='timestamp' href='#451653'><time timestamp='2016-02-10T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i&#x27;m confused by the question.  isn&#x27;t that what it currently does?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455138960' id='451654'>
<a class='timestamp' href='#451654'><time timestamp='2016-02-10T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: I did much prefer the pre-estimation priority estimates in coin control, actually
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139020' id='451655'>
<a class='timestamp' href='#451655'><time timestamp='2016-02-10T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: found it strange that priority changed with the slider..
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139080' id='451656'>
<a class='timestamp' href='#451656'><time timestamp='2016-02-10T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: i think it was a small change, might be easy to go back...   but i&#x27;m not going to remove priority estimation unless i significantly rework the estimation code which is unknown right now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139140' id='451657'>
<a class='timestamp' href='#451657'><time timestamp='2016-02-10T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i mean: should paying free transactions still be supported?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139140' id='451658'>
<a class='timestamp' href='#451658'><time timestamp='2016-02-10T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i never use Qt; i don&#x27;t actually know what the sending dialog looks like currently
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139200' id='451659'>
<a class='timestamp' href='#451659'><time timestamp='2016-02-10T21:20:00Z'>21:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Well thats what I was starting by asking him about.  Right now you can checkbox to sendfree if possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139200' id='451660'>
<a class='timestamp' href='#451660'><time timestamp='2016-02-10T21:20:00Z'>21:20</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
brb
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139200' id='451661'>
<a class='timestamp' href='#451661'><time timestamp='2016-02-10T21:20:00Z'>21:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr and wumpus would like to not remove that yet, but are open to doing it for 0.13 if they become useless anyway due to limited mempools (which seems likely IMO)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139260' id='451662'>
<a class='timestamp' href='#451662'><time timestamp='2016-02-10T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that seems reasonable
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139260' id='451663'>
<a class='timestamp' href='#451663'><time timestamp='2016-02-10T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but at least removing the priority estimation code could be done noe
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139260' id='451664'>
<a class='timestamp' href='#451664'><time timestamp='2016-02-10T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
note: also much less likely to be controversial if we wait until it breaks
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139260' id='451665'>
<a class='timestamp' href='#451665'><time timestamp='2016-02-10T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well, its a bit circular
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139260' id='451666'>
<a class='timestamp' href='#451666'><time timestamp='2016-02-10T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139320' id='451667'>
<a class='timestamp' href='#451667'><time timestamp='2016-02-10T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its actually the priority estimation code that stops you from doing something stupid and trying to send a free tx when your own mempool is limited
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139320' id='451668'>
<a class='timestamp' href='#451668'><time timestamp='2016-02-10T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it also won&#x27;t let you send a free tx with priority less than that returned from the estimates
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139320' id='451669'>
<a class='timestamp' href='#451669'><time timestamp='2016-02-10T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t think supporting sending free transactions, for people that really want to and understand the risks, is so much of a maintenance burden
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139320' id='451670'>
<a class='timestamp' href='#451670'><time timestamp='2016-02-10T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which haven&#x27;t quite disappeared entirely yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139320' id='451671'>
<a class='timestamp' href='#451671'><time timestamp='2016-02-10T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and it is already not the default, you could hide the checkbox further, etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451672'>
<a class='timestamp' href='#451672'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: I think the UI in the QT makes it a little too easy to try to do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451673'>
<a class='timestamp' href='#451673'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yep
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451674'>
<a class='timestamp' href='#451674'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but people seem to understand it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451675'>
<a class='timestamp' href='#451675'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
why remove free transaction? not being default? obviously. a warning message discouraging it? why not?, but why prohibit the functionality forcing people like luke to remove the unwanted restriction?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451676'>
<a class='timestamp' href='#451676'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you could use the coin control dialog is you really want to create a gratis transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451677'>
<a class='timestamp' href='#451677'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well except they are about to become way way more unreliable
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451678'>
<a class='timestamp' href='#451678'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
everyone seems to intuitively know that they need to attach a fee to get transactions confirm
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451679'>
<a class='timestamp' href='#451679'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jtimon: yeah, exactly
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139380' id='451680'>
<a class='timestamp' href='#451680'><time timestamp='2016-02-10T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jtimon: seems too much user babysitting
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139440' id='451681'>
<a class='timestamp' href='#451681'><time timestamp='2016-02-10T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i guess i&#x27;m confused as to what the purpose of them is since the current design of mempools doesn&#x27;t relay them 99% of the time
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139440' id='451682'>
<a class='timestamp' href='#451682'><time timestamp='2016-02-10T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i care much more about the complexity of priority sorting, priority-based relay acceptance, and priority estimation  than about the mere functionality of free transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139440' id='451683'>
<a class='timestamp' href='#451683'><time timestamp='2016-02-10T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sipa: coin control does not at this time allow overriding fees
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139500' id='451684'>
<a class='timestamp' href='#451684'><time timestamp='2016-02-10T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
adding it there makes sense though
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139500' id='451685'>
<a class='timestamp' href='#451685'><time timestamp='2016-02-10T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it could be moved there
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139500' id='451686'>
<a class='timestamp' href='#451686'><time timestamp='2016-02-10T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: aren&#x27;t those all intertwined.  if your own mempool won&#x27;t accept it, its bad to let you send it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139500' id='451687'>
<a class='timestamp' href='#451687'><time timestamp='2016-02-10T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it just ties up your inputs
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139560' id='451688'>
<a class='timestamp' href='#451688'><time timestamp='2016-02-10T21:26:00Z'>21:26</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
there used to be a &quot;no forced fees&quot; fork. if we just allow fee overriding in coin control, we can satisfy those people too :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139560' id='451689'>
<a class='timestamp' href='#451689'><time timestamp='2016-02-10T21:26:00Z'>21:26</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
are free transactions currently the default for the wallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139560' id='451690'>
<a class='timestamp' href='#451690'><time timestamp='2016-02-10T21:26:00Z'>21:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jtimon: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139620' id='451691'>
<a class='timestamp' href='#451691'><time timestamp='2016-02-10T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
then at most I would just discourage them
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139620' id='451692'>
<a class='timestamp' href='#451692'><time timestamp='2016-02-10T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139620' id='451693'>
<a class='timestamp' href='#451693'><time timestamp='2016-02-10T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: perhaps a valuable UI fix would be to make the checkbox clear after each tx or something.  the fact that the setting gets saved is a bit disturbing
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139620' id='451694'>
<a class='timestamp' href='#451694'><time timestamp='2016-02-10T21:27:00Z'>21:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
agreed. on the other hand that&#x27;s what people expect now, changing it is also going to disturb some people :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451695'>
<a class='timestamp' href='#451695'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
like sipa says, the hard part is the priority/separated space (not having a uniform metric to order all transactions) 
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451696'>
<a class='timestamp' href='#451696'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so just so we&#x27;re on the same page here
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451697'>
<a class='timestamp' href='#451697'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
replacing it with a fee override in coin control seems ideal to me now IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451698'>
<a class='timestamp' href='#451698'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes if you move the checkbox too you can change its behavior
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451699'>
<a class='timestamp' href='#451699'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you want to preserve the ability to send free txs, so that if you start your node and quickly send a tx before your mempool fills up you can send one (even though it likely won&#x27;t propagate far)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139680' id='451700'>
<a class='timestamp' href='#451700'><time timestamp='2016-02-10T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
fee override can ignore whether it&#x27;s &quot;safe&quot; or not, so you don&#x27;t need to calculate that anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139740' id='451701'>
<a class='timestamp' href='#451701'><time timestamp='2016-02-10T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it just seems a bit crazy to me that you can only do it in this race condition
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139740' id='451702'>
<a class='timestamp' href='#451702'><time timestamp='2016-02-10T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: it&#x27;s possible the spam stops after &gt;1 MB blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139740' id='451703'>
<a class='timestamp' href='#451703'><time timestamp='2016-02-10T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
some of it anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139740' id='451704'>
<a class='timestamp' href='#451704'><time timestamp='2016-02-10T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s more of a philosophical issue, people don&#x27;t want to be forced by their software to do something, even if it doesn&#x27;t really make sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139740' id='451705'>
<a class='timestamp' href='#451705'><time timestamp='2016-02-10T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
also, the new spam filtering based on descendents can help
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139800' id='451706'>
<a class='timestamp' href='#451706'><time timestamp='2016-02-10T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, well i just realized it might stop working entirely anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139800' id='451707'>
<a class='timestamp' href='#451707'><time timestamp='2016-02-10T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
morcos: who cares? don&#x27;t use the functionality if you think it&#x27;s stupid, just like I don&#x27;t &quot;echo asdgsdfgh &gt; /dev/null&quot; anymore 
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139860' id='451708'>
<a class='timestamp' href='#451708'><time timestamp='2016-02-10T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it used to be the case that if you couldn&#x27;t get priority estimates you defaulted to allowminfree priority
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139860' id='451709'>
<a class='timestamp' href='#451709'><time timestamp='2016-02-10T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
it will probably be a long time before non-spam can fill mempools
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139860' id='451710'>
<a class='timestamp' href='#451710'><time timestamp='2016-02-10T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
this caused people who hadn&#x27;t gotten estimates yet to send free txs with way too low priorities
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139860' id='451711'>
<a class='timestamp' href='#451711'><time timestamp='2016-02-10T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so i changed it so that if you have no priority estimates, it requires infinite priority (so you can&#x27;t send free txs)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139920' id='451712'>
<a class='timestamp' href='#451712'><time timestamp='2016-02-10T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i believe, although i can&#x27;t be sure, that once 0.12 is rolled out in enough places, priority estimates will not have enough data and will always return -1 
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139920' id='451713'>
<a class='timestamp' href='#451713'><time timestamp='2016-02-10T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
since that state is saved, it won&#x27;t matter what you do with restarting your node or your mempool, your node won&#x27;t let you send a free tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139920' id='451714'>
<a class='timestamp' href='#451714'><time timestamp='2016-02-10T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: I&#x27;m curious why you seem so sure that mempools will be full
<br>
</div>

<div class='talk op-msg' data-timestamp='1455139980' id='451715'>
<a class='timestamp' href='#451715'><time timestamp='2016-02-10T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
although arguably thats exactly what we want?   if you can configure your node in such a way that it receives enough data points to see free txs still being mined, it&#x27;ll let you send one
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140040' id='451716'>
<a class='timestamp' href='#451716'><time timestamp='2016-02-10T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so maybe that removes the concern of eliminating the sending ability a cycle before , and now we just have to wait and see what happens, and if it turns out no one can ever send them (bc limited mempools), then we can consider removing relay of them
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140040' id='451717'>
<a class='timestamp' href='#451717'><time timestamp='2016-02-10T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Luke-Jr: it depends on your minrelayfee i suppose.  certainly with 1000 sat/kB they fill up.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140040' id='451718'>
<a class='timestamp' href='#451718'><time timestamp='2016-02-10T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
morcos: and your spam filtering capabilities
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140100' id='451719'>
<a class='timestamp' href='#451719'><time timestamp='2016-02-10T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I have a 0.12 node up and running for about a week now with a 2GB mempool, its filled up to 1.8G so far
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140100' id='451720'>
<a class='timestamp' href='#451720'><time timestamp='2016-02-10T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
weird
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140160' id='451721'>
<a class='timestamp' href='#451721'><time timestamp='2016-02-10T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its all txs at the lowest fee rate.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140160' id='451722'>
<a class='timestamp' href='#451722'><time timestamp='2016-02-10T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I wonder if we have regressions; my 0.10 node never overflowed my 32-bit process space
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140160' id='451723'>
<a class='timestamp' href='#451723'><time timestamp='2016-02-10T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
and I didn&#x27;t set a minrelayfee on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140160' id='451724'>
<a class='timestamp' href='#451724'><time timestamp='2016-02-10T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we keep much larger utxo caches now
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140220' id='451725'>
<a class='timestamp' href='#451725'><time timestamp='2016-02-10T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in 0.10 nearly every block would flush it (past ibd)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140220' id='451726'>
<a class='timestamp' href='#451726'><time timestamp='2016-02-10T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
a related problem i discussed with gmaxwell a couple days ago is we need to stop inving all these txs that will fall below most nodes effective min
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140220' id='451727'>
<a class='timestamp' href='#451727'><time timestamp='2016-02-10T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i was thinking of implementing a p2p feefilter message
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140220' id='451728'>
<a class='timestamp' href='#451728'><time timestamp='2016-02-10T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
morcos, can you please post btc getrawmempool true | grep &#x27;&quot;fee&quot;&#x27; | sort | uniq -c | sort -rn | head from such node?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140280' id='451729'>
<a class='timestamp' href='#451729'><time timestamp='2016-02-10T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
paveljanik: sure but i&#x27;m outputting more detailed stats, what would you like to know
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140280' id='451730'>
<a class='timestamp' href='#451730'><time timestamp='2016-02-10T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
0.10&#x27;s minrelaytxfee is 5000
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140280' id='451731'>
<a class='timestamp' href='#451731'><time timestamp='2016-02-10T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
I&#x27;d like to see some oldest transactions coming from the most frequently used fee...
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140340' id='451732'>
<a class='timestamp' href='#451732'><time timestamp='2016-02-10T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
is it the remnant from the spam in July?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140340' id='451733'>
<a class='timestamp' href='#451733'><time timestamp='2016-02-10T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
hmm, I can maybe try it myself on some node.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140400' id='451734'>
<a class='timestamp' href='#451734'><time timestamp='2016-02-10T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
<a href="http://0bin.net/paste/R0vBCFDb3poeSK5O#i5IWrBXUvMBB6-zgfS4WoizXaGBBpL4pvIoAiRqcIXe" class="link" target="_blank">http://0bin.net/paste/R0vBCFDb3poeSK5O#i5IWrBXUvMBB6-zgfS4WoizXaGBBpL4pvIoAiRqcIXe</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140400' id='451735'>
<a class='timestamp' href='#451735'><time timestamp='2016-02-10T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that doesn&#x27;t seem like what you wanted?
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140400' id='451736'>
<a class='timestamp' href='#451736'><time timestamp='2016-02-10T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
but this is the same I investigated in Dec.
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140400' id='451737'>
<a class='timestamp' href='#451737'><time timestamp='2016-02-10T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
15000 and 192 satoshis
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140400' id='451738'>
<a class='timestamp' href='#451738'><time timestamp='2016-02-10T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
Thank you
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140520' id='451739'>
<a class='timestamp' href='#451739'><time timestamp='2016-02-10T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
anyway, idea of a feefilter is you tell other nodes not even to bother inv&#x27;ing you stuff below the feerate your accepting now
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140520' id='451740'>
<a class='timestamp' href='#451740'><time timestamp='2016-02-10T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
would save a lot of inv bandwidth
<br>
</div>

<div class='talk op-msg' data-timestamp='1455140520' id='451741'>
<a class='timestamp' href='#451741'><time timestamp='2016-02-10T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but only works in the situation that you&#x27;re not ALSO accepting free txs below your min fee rate (which is the case if your fee rate is caused by mempool limiting)
<br>
</div>

<div class='talk op-msg' data-timestamp='1455142200' id='451742'>
<a class='timestamp' href='#451742'><time timestamp='2016-02-10T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
weird, when the same setting is set multiple times in bitcoin.conf, it&#x27;s the first that has effect
<br>
</div>

<div class='talk op-msg' data-timestamp='1455142380' id='451743'>
<a class='timestamp' href='#451743'><time timestamp='2016-02-10T22:13:00Z'>22:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Luke-Jr: ha, i never knew that!
<br>
</div>

</div>
</section>

</body>
</html>
