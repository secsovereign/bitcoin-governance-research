<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-10-27
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-10-27' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-09-27">&lt;</a><span class='header'>   October 2015   </span><a href="/bitcoin-core-dev/2015-11-27">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2015-10-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-10-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2015-10-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-10-09">9</a> <a class="" href="/bitcoin-core-dev/2015-10-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-11">11</a> <a class="" href="/bitcoin-core-dev/2015-10-12">12</a> <a class="" href="/bitcoin-core-dev/2015-10-13">13</a> <a class="" href="/bitcoin-core-dev/2015-10-14">14</a> <a class="" href="/bitcoin-core-dev/2015-10-15">15</a> <a class="" href="/bitcoin-core-dev/2015-10-16">16</a> <a class="" href="/bitcoin-core-dev/2015-10-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-18">18</a> <a class="" href="/bitcoin-core-dev/2015-10-19">19</a> <a class="" href="/bitcoin-core-dev/2015-10-20">20</a> <a class="" href="/bitcoin-core-dev/2015-10-21">21</a> <a class="" href="/bitcoin-core-dev/2015-10-22">22</a> <a class="" href="/bitcoin-core-dev/2015-10-23">23</a> <a class="" href="/bitcoin-core-dev/2015-10-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-25">25</a> <a class="" href="/bitcoin-core-dev/2015-10-26">26</a> <a class="current" href="/bitcoin-core-dev/2015-10-27">27</a> <a class="" href="/bitcoin-core-dev/2015-10-28">28</a> <a class="" href="/bitcoin-core-dev/2015-10-29">29</a> <a class="" href="/bitcoin-core-dev/2015-10-30">30</a> <a class="" href="/bitcoin-core-dev/2015-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1445904300' id='432606'>
<a class='timestamp' href='#432606'><time timestamp='2015-10-27T00:05:00Z'>00:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, my huge sigcache is mostly fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904300' id='432607'>
<a class='timestamp' href='#432607'><time timestamp='2015-10-27T00:05:00Z'>00:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: i&#x27;m running with 1M now and its still noticeably slower (than infinite)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904300' id='432608'>
<a class='timestamp' href='#432608'><time timestamp='2015-10-27T00:05:00Z'>00:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
changing the max arena 100% fixed the problem without rewritting a bunch of stuff too :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904360' id='432609'>
<a class='timestamp' href='#432609'><time timestamp='2015-10-27T00:06:00Z'>00:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
hmm it really shouldn&#x27;t be
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904360' id='432610'>
<a class='timestamp' href='#432610'><time timestamp='2015-10-27T00:06:00Z'>00:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well i&#x27;m chaning the other stuff anyway  :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904360' id='432611'>
<a class='timestamp' href='#432611'><time timestamp='2015-10-27T00:06:00Z'>00:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well noticeably slower i mean just that...  say instead of taking 30us to verify a txin on average it takes 40us
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904420' id='432612'>
<a class='timestamp' href='#432612'><time timestamp='2015-10-27T00:07:00Z'>00:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but without a cache at all of course its 10x higher
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904540' id='432613'>
<a class='timestamp' href='#432613'><time timestamp='2015-10-27T00:09:00Z'>00:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its the process of filling up your 300M mempool for the first time that makes it slow...  i guess it should improve once its full and the mempool gets a minfee
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904600' id='432614'>
<a class='timestamp' href='#432614'><time timestamp='2015-10-27T00:10:00Z'>00:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
scarily fast filling up to 300M from starting from scratch.  like 45mins
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904660' id='432615'>
<a class='timestamp' href='#432615'><time timestamp='2015-10-27T00:11:00Z'>00:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, without the limiting
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904660' id='432616'>
<a class='timestamp' href='#432616'><time timestamp='2015-10-27T00:11:00Z'>00:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
im at about 2GB now
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904660' id='432617'>
<a class='timestamp' href='#432617'><time timestamp='2015-10-27T00:11:00Z'>00:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
3.168GB
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904720' id='432618'>
<a class='timestamp' href='#432618'><time timestamp='2015-10-27T00:12:00Z'>00:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m still disturbed by how this same backlog of txs is so readily rerelayed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904780' id='432619'>
<a class='timestamp' href='#432619'><time timestamp='2015-10-27T00:13:00Z'>00:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
esp since the network behavior is supposted to not relay transactions once they&#x27;ve already been relayed. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904780' id='432620'>
<a class='timestamp' href='#432620'><time timestamp='2015-10-27T00:13:00Z'>00:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
unfortunately there seem to be some abusive nodes out there that behave strangely, constantly resending transactions and such.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904840' id='432621'>
<a class='timestamp' href='#432621'><time timestamp='2015-10-27T00:14:00Z'>00:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i noticed that, i was wondering if they were nodes who considerd these wallet tx&#x27;s or if was specifically designed to retransmit them
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904900' id='432622'>
<a class='timestamp' href='#432622'><time timestamp='2015-10-27T00:15:00Z'>00:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok modulo the final TestBlockValidity check, i brought the time of CreateNewBlock from a bit over 1 second to under 10 ms.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904900' id='432623'>
<a class='timestamp' href='#432623'><time timestamp='2015-10-27T00:15:00Z'>00:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the ones I&#x27;ve caught doing it with an instrumented node appeared to regurgitate their whole mempool every block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904960' id='432624'>
<a class='timestamp' href='#432624'><time timestamp='2015-10-27T00:16:00Z'>00:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
unfortunately i wouldn&#x27;t feel good about dumping that check.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904960' id='432625'>
<a class='timestamp' href='#432625'><time timestamp='2015-10-27T00:16:00Z'>00:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that also doesn&#x27;t include adding any priority transactions.  i can add that back in, but i think it&#x27;ll be slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1445904960' id='432626'>
<a class='timestamp' href='#432626'><time timestamp='2015-10-27T00:16:00Z'>00:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: oh really?? thats bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905080' id='432627'>
<a class='timestamp' href='#432627'><time timestamp='2015-10-27T00:18:00Z'>00:18</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
fwiw, gmaxwell recall you wanted me to check and see whether any of those nodes were resending me tx dupes: across the entire time I was monitoring, none of them did that I could detect while parsing the debug.log.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905080' id='432628'>
<a class='timestamp' href='#432628'><time timestamp='2015-10-27T00:18:00Z'>00:18</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
I don&#x27;t think I actually got back to you about that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905080' id='432629'>
<a class='timestamp' href='#432629'><time timestamp='2015-10-27T00:18:00Z'>00:18</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
gmaxwell: What&#x27;s the periodicity of the resends?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905140' id='432630'>
<a class='timestamp' href='#432630'><time timestamp='2015-10-27T00:19:00Z'>00:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
midnightmagic: at least some were doing this after every block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905200' id='432631'>
<a class='timestamp' href='#432631'><time timestamp='2015-10-27T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
e.g. a bogus assumption that any transaction known would make it in a block, and if it didn&#x27;t you must have just &#x27;lost&#x27; it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905200' id='432632'>
<a class='timestamp' href='#432632'><time timestamp='2015-10-27T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or the like.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905200' id='432633'>
<a class='timestamp' href='#432633'><time timestamp='2015-10-27T00:20:00Z'>00:20</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
I wonder if some services are attempting to &quot;help&quot; the network by propagating tx in order to guarantee reach for nodes that have rebooted or something.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905740' id='432634'>
<a class='timestamp' href='#432634'><time timestamp='2015-10-27T00:29:00Z'>00:29</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
sending as in sending the actual transaction? or just an inv?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905920' id='432635'>
<a class='timestamp' href='#432635'><time timestamp='2015-10-27T00:32:00Z'>00:32</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
CodeShark, same thing for this purpose
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905920' id='432636'>
<a class='timestamp' href='#432636'><time timestamp='2015-10-27T00:32:00Z'>00:32</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
zombie transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445905980' id='432637'>
<a class='timestamp' href='#432637'><time timestamp='2015-10-27T00:33:00Z'>00:33</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
for what purpose? I would think sending the mempool (as in the actual txs, not just the inv) is MUCH worse for bandwidth
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906040' id='432638'>
<a class='timestamp' href='#432638'><time timestamp='2015-10-27T00:34:00Z'>00:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
would anybody else find useful a feature which split the minimum fee for acceptance to your mempool and the min fee for relay?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906040' id='432639'>
<a class='timestamp' href='#432639'><time timestamp='2015-10-27T00:34:00Z'>00:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
often during this testing, i either hack up my node to not relay, or i feel bad about the fact that i&#x27;m helping propogate these low fee txs all over again
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906040' id='432640'>
<a class='timestamp' href='#432640'><time timestamp='2015-10-27T00:34:00Z'>00:34</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I would find really useful a feature that would allow you to get paid for running a validator/relay node :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906100' id='432641'>
<a class='timestamp' href='#432641'><time timestamp='2015-10-27T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you get paid in food for your soul
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906100' id='432642'>
<a class='timestamp' href='#432642'><time timestamp='2015-10-27T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906100' id='432643'>
<a class='timestamp' href='#432643'><time timestamp='2015-10-27T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
CodeShark: i think that screws incentives completely
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906100' id='432644'>
<a class='timestamp' href='#432644'><time timestamp='2015-10-27T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
sipa: howso?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906100' id='432645'>
<a class='timestamp' href='#432645'><time timestamp='2015-10-27T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
CodeShark: if you can get paid to run a node, you can equally get paid to run a compromised node
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906160' id='432646'>
<a class='timestamp' href='#432646'><time timestamp='2015-10-27T00:36:00Z'>00:36</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
presumably you&#x27;d have to actually perform the function sufficiently well
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906160' id='432647'>
<a class='timestamp' href='#432647'><time timestamp='2015-10-27T00:36:00Z'>00:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you can&#x27;t prove that you are
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906220' id='432648'>
<a class='timestamp' href='#432648'><time timestamp='2015-10-27T00:37:00Z'>00:37</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
well, relay might be more easily amenable to micropayments - validation is a little trickier
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906280' id='432649'>
<a class='timestamp' href='#432649'><time timestamp='2015-10-27T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
but I think ultimately doable...not sure how, but my gut tells me at the very least some efficient probabilistic checks are possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906340' id='432650'>
<a class='timestamp' href='#432650'><time timestamp='2015-10-27T00:39:00Z'>00:39</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
without having to go to SNARKs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906340' id='432651'>
<a class='timestamp' href='#432651'><time timestamp='2015-10-27T00:39:00Z'>00:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
their validation is unobservable... it&#x27;s a feature they provide to their users, not to you
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906520' id='432652'>
<a class='timestamp' href='#432652'><time timestamp='2015-10-27T00:42:00Z'>00:42</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
it&#x27;s a feature they provide to the network
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906580' id='432653'>
<a class='timestamp' href='#432653'><time timestamp='2015-10-27T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906580' id='432654'>
<a class='timestamp' href='#432654'><time timestamp='2015-10-27T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
relay is what they provide to the network
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906580' id='432655'>
<a class='timestamp' href='#432655'><time timestamp='2015-10-27T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and you can&#x27;t observe that they validate before relay
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906580' id='432656'>
<a class='timestamp' href='#432656'><time timestamp='2015-10-27T00:43:00Z'>00:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
1) they may just be connected to honest nodes them selves, so they&#x27;ll only relay valid blocks through that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906640' id='432657'>
<a class='timestamp' href='#432657'><time timestamp='2015-10-27T00:44:00Z'>00:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
2) past performance is not an indicator for future success. One awesome way to sybil attack the network is to spin up many totally honest nodes, and then suddenly turn evil once you notice a sufficient portion of the network depends on you.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906700' id='432658'>
<a class='timestamp' href='#432658'><time timestamp='2015-10-27T00:45:00Z'>00:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
relay/ibd is a dumb service they offer to the network - which hopefully verifies what you tell them enough to not need to trust you
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906760' id='432659'>
<a class='timestamp' href='#432659'><time timestamp='2015-10-27T00:46:00Z'>00:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the power of validation is only through knowing that the person running it has economic activity depending on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445906880' id='432660'>
<a class='timestamp' href='#432660'><time timestamp='2015-10-27T00:48:00Z'>00:48</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
so I guess if the network is to subsidize it it would have to either require miners to be doing validation somehow...or to incentivize invalidation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445907000' id='432661'>
<a class='timestamp' href='#432661'><time timestamp='2015-10-27T00:50:00Z'>00:50</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
in any case, if we could just take care of incentives for relay for now I&#x27;d be happy :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445907000' id='432662'>
<a class='timestamp' href='#432662'><time timestamp='2015-10-27T00:50:00Z'>00:50</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
that would go a long ways towards solving the mempool issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1445907420' id='432663'>
<a class='timestamp' href='#432663'><time timestamp='2015-10-27T00:57:00Z'>00:57</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
providing SPV proofs could be incentivized...and perhaps nodes that can provide SPV proofs would also have to perform full validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445907600' id='432664'>
<a class='timestamp' href='#432664'><time timestamp='2015-10-27T01:00:00Z'>01:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
or it would be in their interest to, I suppose
<br>
</div>

<div class='talk op-msg' data-timestamp='1445908500' id='432665'>
<a class='timestamp' href='#432665'><time timestamp='2015-10-27T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, i always return early in relaytransaction when messing with mempool stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1445908920' id='432666'>
<a class='timestamp' href='#432666'><time timestamp='2015-10-27T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ha i can detect which peers are master by the order of their responses to the mempool command
<br>
</div>

<div class='talk op-msg' data-timestamp='1445908980' id='432667'>
<a class='timestamp' href='#432667'><time timestamp='2015-10-27T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
2015-10-27 01:23:33 CSignatureCache.setValid.size() 230249
<br>
</div>

<div class='talk op-msg' data-timestamp='1445908980' id='432668'>
<a class='timestamp' href='#432668'><time timestamp='2015-10-27T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
2015-10-27 01:23:33 AcceptToMemoryPool: peer=15: accepted 3f5cfddb91105914ddbe9dc8dd3f32542bd9b1c5fe6b73873b4b6a5c87b62f51 (poolsz 3360)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445908980' id='432669'>
<a class='timestamp' href='#432669'><time timestamp='2015-10-27T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1445909100' id='432670'>
<a class='timestamp' href='#432670'><time timestamp='2015-10-27T01:25:00Z'>01:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
whats interesting?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445909160' id='432671'>
<a class='timestamp' href='#432671'><time timestamp='2015-10-27T01:26:00Z'>01:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: is this a new node?  not the 3GB one?  its not surprising.  most of these spam txs have 100txins, so you&#x27;d assume about 100 to 1 ration of txs recieved to setValid size
<br>
</div>

<div class='talk op-msg' data-timestamp='1445909220' id='432672'>
<a class='timestamp' href='#432672'><time timestamp='2015-10-27T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, sigcache vs mempool size
<br>
</div>

<div class='talk op-msg' data-timestamp='1445909220' id='432673'>
<a class='timestamp' href='#432673'><time timestamp='2015-10-27T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, it&#x27;s currently talking upto being full
<br>
</div>

<div class='talk op-msg' data-timestamp='1445909220' id='432674'>
<a class='timestamp' href='#432674'><time timestamp='2015-10-27T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
takes ages
<br>
</div>

<div class='talk op-msg' data-timestamp='1445910780' id='432675'>
<a class='timestamp' href='#432675'><time timestamp='2015-10-27T01:53:00Z'>01:53</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ok so 1,000,000 sigcache ~= 300MiB mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445910840' id='432676'>
<a class='timestamp' href='#432676'><time timestamp='2015-10-27T01:54:00Z'>01:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
we should definitely try to switch to a single parameter &quot;-memlimit&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445910840' id='432677'>
<a class='timestamp' href='#432677'><time timestamp='2015-10-27T01:54:00Z'>01:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
and then split it out as percentages
<br>
</div>

<div class='talk op-msg' data-timestamp='1445920860' id='432678'>
<a class='timestamp' href='#432678'><time timestamp='2015-10-27T04:41:00Z'>04:41</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
hmph.    CXX      libbitcoin_server_a-init.o
<br>
</div>

<div class='talk op-msg' data-timestamp='1445920860' id='432679'>
<a class='timestamp' href='#432679'><time timestamp='2015-10-27T04:41:00Z'>04:41</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
g++: internal compiler error: Killed (program cc1plus)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445920860' id='432680'>
<a class='timestamp' href='#432680'><time timestamp='2015-10-27T04:41:00Z'>04:41</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Awesome :S
<br>
</div>

<div class='talk op-msg' data-timestamp='1445920980' id='432681'>
<a class='timestamp' href='#432681'><time timestamp='2015-10-27T04:43:00Z'>04:43</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
in my experience that is almost certainly an out-of-memory problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445920980' id='432682'>
<a class='timestamp' href='#432682'><time timestamp='2015-10-27T04:43:00Z'>04:43</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
jcorgan: interesting, I am trying to compile it on a device with only 1GB 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445921100' id='432683'>
<a class='timestamp' href='#432683'><time timestamp='2015-10-27T04:45:00Z'>04:45</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
look in dmesg for linux OOM killer action
<br>
</div>

<div class='talk op-msg' data-timestamp='1445921100' id='432684'>
<a class='timestamp' href='#432684'><time timestamp='2015-10-27T04:45:00Z'>04:45</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
yeah I did, you were right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445921160' id='432685'>
<a class='timestamp' href='#432685'><time timestamp='2015-10-27T04:46:00Z'>04:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
add swap. There are some options you can give g++ which will drastically reduce memory usage... but I have no idea what they are. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445921160' id='432686'>
<a class='timestamp' href='#432686'><time timestamp='2015-10-27T04:46:00Z'>04:46</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: easier to just put in another stick atm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927460' id='432687'>
<a class='timestamp' href='#432687'><time timestamp='2015-10-27T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
poop
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927460' id='432688'>
<a class='timestamp' href='#432688'><time timestamp='2015-10-27T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
2GB still dies lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927460' id='432689'>
<a class='timestamp' href='#432689'><time timestamp='2015-10-27T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
time to look up those g++ options...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927460' id='432690'>
<a class='timestamp' href='#432690'><time timestamp='2015-10-27T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
or swap... fk it I&#x27;ll add swap
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927520' id='432691'>
<a class='timestamp' href='#432691'><time timestamp='2015-10-27T06:32:00Z'>06:32</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
hmmm, dmesg not showing OOM this time
<br>
</div>

<div class='talk op-msg' data-timestamp='1445927520' id='432692'>
<a class='timestamp' href='#432692'><time timestamp='2015-10-27T06:32:00Z'>06:32</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
but same error
<br>
</div>

<div class='talk op-msg' data-timestamp='1445928960' id='432693'>
<a class='timestamp' href='#432693'><time timestamp='2015-10-27T06:56:00Z'>06:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
2GB should certainly be enough. See e.g. <a href="https://github.com/bitcoin/bitcoin/issues/6658" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/6658</a> , worst contender main.cpp uses 1.2MB while compiling (on gcc 4.8). Adding swap may help though, linux&#x27; memory management works better if swap is enabled even if you don&#x27;t need the extra memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1445928960' id='432694'>
<a class='timestamp' href='#432694'><time timestamp='2015-10-27T06:56:00Z'>06:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you want to build bitcoind for a smaller device I&#x27;d recommend cross compiling though, it&#x27;s easy with the depends system
<br>
</div>

<div class='talk op-msg' data-timestamp='1445928960' id='432695'>
<a class='timestamp' href='#432695'><time timestamp='2015-10-27T06:56:00Z'>06:56</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
I ended up `git clean -xdf`, re-configuring/autconf and it got past that second hurdle
<br>
</div>

<div class='talk op-msg' data-timestamp='1445928960' id='432696'>
<a class='timestamp' href='#432696'><time timestamp='2015-10-27T06:56:00Z'>06:56</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Guessing it configured something different when I only had 1GB?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929020' id='432697'>
<a class='timestamp' href='#432697'><time timestamp='2015-10-27T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it doesn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929020' id='432698'>
<a class='timestamp' href='#432698'><time timestamp='2015-10-27T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: some people are managing to run with no overcommit <u>_and_</u> no swap; ... dunno how anything at all works for them.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929020' id='432699'>
<a class='timestamp' href='#432699'><time timestamp='2015-10-27T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Then I have no idea, except that it worked this time,  but again, no OOM from dmesg so not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929020' id='432700'>
<a class='timestamp' href='#432700'><time timestamp='2015-10-27T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but it may be  possible for gcc, when it crashes, to generate a poop file that will crash it later
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929140' id='432701'>
<a class='timestamp' href='#432701'><time timestamp='2015-10-27T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: eh, on my own home nodes I always ran without swap
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929140' id='432702'>
<a class='timestamp' href='#432702'><time timestamp='2015-10-27T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
but, they always had a bit more hardware to play with
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929140' id='432703'>
<a class='timestamp' href='#432703'><time timestamp='2015-10-27T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
dcousens: note that I said both no swap and no overcommit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929320' id='432704'>
<a class='timestamp' href='#432704'><time timestamp='2015-10-27T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: I guess if the workload is very predictable
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929380' id='432705'>
<a class='timestamp' href='#432705'><time timestamp='2015-10-27T07:03:00Z'>07:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it sounds like the way to go for e.g. embedded devices
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929560' id='432706'>
<a class='timestamp' href='#432706'><time timestamp='2015-10-27T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but certainly not if you run desktop applications like browsers :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929620' id='432707'>
<a class='timestamp' href='#432707'><time timestamp='2015-10-27T07:07:00Z'>07:07</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
dcousens: note that Linux likes to OOM-kill processes long before it runs out of RAM, if you don&#x27;t have swap :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929620' id='432708'>
<a class='timestamp' href='#432708'><time timestamp='2015-10-27T07:07:00Z'>07:07</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: I know.  Eh, I&#x27;ve always kept that at the default, though, I&#x27;d be half tempted to turn it off if it meant I&#x27;d actually get std:error in my logs haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1445929680' id='432709'>
<a class='timestamp' href='#432709'><time timestamp='2015-10-27T07:08:00Z'>07:08</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Luke-Jr: hasn&#x27;t been my experience haha, I don&#x27;t run swap on my most of my work machines and if I OOM, it just grinds to a complete halt usually
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930100' id='432710'>
<a class='timestamp' href='#432710'><time timestamp='2015-10-27T07:15:00Z'>07:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I used to have no swap enabled when 8GB still seemed like a lot of memory, but I can confirm what Luke-Jr says, even compile with -j3 would invoke the killer penguin
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930280' id='432711'>
<a class='timestamp' href='#432711'><time timestamp='2015-10-27T07:18:00Z'>07:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the problem was that any amount of swapping somehow instantly brought the entire system to a halt (even mouse cursor would no longer move) until it was done.  Managed to improve this somewhat by setting high swappiness.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930280' id='432712'>
<a class='timestamp' href='#432712'><time timestamp='2015-10-27T07:18:00Z'>07:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(which makes it swap little used pages in advance instead of as last desperate measure)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930340' id='432713'>
<a class='timestamp' href='#432713'><time timestamp='2015-10-27T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
nice thing about a desktop PC is I have like 4-6 hard drives I can RAID0 the swap across..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930580' id='432714'>
<a class='timestamp' href='#432714'><time timestamp='2015-10-27T07:23:00Z'>07:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
good idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1445930940' id='432715'>
<a class='timestamp' href='#432715'><time timestamp='2015-10-27T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
(fwiw, that&#x27;s builtin to Linux by using swapon -o pri=N where N is identical for everything)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445931420' id='432716'>
<a class='timestamp' href='#432716'><time timestamp='2015-10-27T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
oh!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445932080' id='432717'>
<a class='timestamp' href='#432717'><time timestamp='2015-10-27T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-7'> GitHub175</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2b625510d374...38369dda325d" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2b625510d374...38369dda325d</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445932080' id='432718'>
<a class='timestamp' href='#432718'><time timestamp='2015-10-27T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-7'> GitHub175</span>&gt;
bitcoin/master 0d699fc Jonas Schnelli: fix locking issue with new mempool limiting...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445932080' id='432719'>
<a class='timestamp' href='#432719'><time timestamp='2015-10-27T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-7'> GitHub175</span>&gt;
bitcoin/master 38369dd Wladimir J. van der Laan: Merge pull request #6889...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445932080' id='432720'>
<a class='timestamp' href='#432720'><time timestamp='2015-10-27T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-11'> GitHub109</span>&gt;
[bitcoin] laanwj closed pull request #6889: fix locking issue with new mempool limiting (master...2015/10/fix_mempool_lock) <a href="https://github.com/bitcoin/bitcoin/pull/6889" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6889</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445933040' id='432721'>
<a class='timestamp' href='#432721'><time timestamp='2015-10-27T08:04:00Z'>08:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: what is the idea with #6865? I think we should either remove or change the meaningless test
<br>
</div>

<div class='talk op-msg' data-timestamp='1445940540' id='432722'>
<a class='timestamp' href='#432722'><time timestamp='2015-10-27T10:09:00Z'>10:09</time></a>
&lt;<span class='nick nick-11'> GitHub182</span>&gt;
[bitcoin] paveljanik closed pull request #5525: Add removeaddress RPC call (remove watch-only address) (master...rpc_removeaddress) <a href="https://github.com/bitcoin/bitcoin/pull/5525" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/5525</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445943540' id='432723'>
<a class='timestamp' href='#432723'><time timestamp='2015-10-27T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-11'> GitHub78</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/38369dda325d...8f3b3cdee497" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/38369dda325d...8f3b3cdee497</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445943540' id='432724'>
<a class='timestamp' href='#432724'><time timestamp='2015-10-27T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-11'> GitHub78</span>&gt;
bitcoin/master 2d8c49d Casey Rodarmor: Clean up tx prioritization when conflict mined
<br>
</div>

<div class='talk op-msg' data-timestamp='1445943540' id='432725'>
<a class='timestamp' href='#432725'><time timestamp='2015-10-27T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-11'> GitHub78</span>&gt;
bitcoin/master 8f3b3cd Wladimir J. van der Laan: Merge pull request #6464...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445943540' id='432726'>
<a class='timestamp' href='#432726'><time timestamp='2015-10-27T10:59:00Z'>10:59</time></a>
&lt;<span class='nick nick-4'> GitHub144</span>&gt;
[bitcoin] laanwj closed pull request #6464: Always clean up manual transaction prioritization (master...manual-tx-prioritization-cleanup) <a href="https://github.com/bitcoin/bitcoin/pull/6464" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6464</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445954820' id='432727'>
<a class='timestamp' href='#432727'><time timestamp='2015-10-27T14:07:00Z'>14:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I have some questions about changes I&#x27;d like to make to manual transaction prioritization and CreateNewBlock and block priority space.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445954940' id='432728'>
<a class='timestamp' href='#432728'><time timestamp='2015-10-27T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I added a fee rate sort to the mempool.  Using this and examining 600 calls to CreateNewBlock over the last 12 hours, the time to create a new block has been reduced from 2.337 seconds + 222 ms to validate to 11 ms + 345 ms to validate
<br>
</div>

<div class='talk op-msg' data-timestamp='1445954940' id='432729'>
<a class='timestamp' href='#432729'><time timestamp='2015-10-27T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I think the increased validation time is because the originaly version made the cache warm first
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955000' id='432730'>
<a class='timestamp' href='#432730'><time timestamp='2015-10-27T14:10:00Z'>14:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
However, this does not create a priority space and does not apply manual transaction prioritization
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955060' id='432731'>
<a class='timestamp' href='#432731'><time timestamp='2015-10-27T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Fixing the manual transaction prioritzation shouldn&#x27;t be a problem as long as we&#x27;re willing to store that data in the CTxMemPoolEntry.  I know it was previously discussed not to do that because it might only apply to a few txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955060' id='432732'>
<a class='timestamp' href='#432732'><time timestamp='2015-10-27T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
However I don&#x27;t think a sort based on the modified fee will work very well otherwise.  So question 1, can I store the fee delta in the CTxMemPoolEntry.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955120' id='432733'>
<a class='timestamp' href='#432733'><time timestamp='2015-10-27T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Question 2:  I assume I&#x27;m not allowed to get rid of block priority space?   
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955180' id='432734'>
<a class='timestamp' href='#432734'><time timestamp='2015-10-27T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I was thinking I could just basically repeat the priority sort of the old alogrithm first, but I believe we might lose some advantages of the speedup.  However I think we could just skip that if blockprioritysize=0.  The code will be a bit uglier that way, but sort of optimized for the case where blockprioritysize=0?  
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955180' id='432735'>
<a class='timestamp' href='#432735'><time timestamp='2015-10-27T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Any thoughts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955540' id='432736'>
<a class='timestamp' href='#432736'><time timestamp='2015-10-27T14:19:00Z'>14:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Question 3: BlueMatt: In your issue about tie-breaking you seem to suggest its random.  But isn&#x27;t the current tiebreaker (for the fee sort) priority?  What would you like the tiebreaker to be?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955600' id='432737'>
<a class='timestamp' href='#432737'><time timestamp='2015-10-27T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
BTW, since the current tie-breaker is priority, and its expensive to calculate priority, I&#x27;m not going to try to make my code generate the exact same blocks as the old code.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445955660' id='432738'>
<a class='timestamp' href='#432738'><time timestamp='2015-10-27T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: gmaxwell: wumpus: see above questions please
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956080' id='432739'>
<a class='timestamp' href='#432739'><time timestamp='2015-10-27T14:28:00Z'>14:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: BlueMatt&#x27;s problem occurs when there is an abundance of transactions with the exact same priority, i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956140' id='432740'>
<a class='timestamp' href='#432740'><time timestamp='2015-10-27T14:29:00Z'>14:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i too believe we should get rid of priority, and replace it with a custom function that alters size or fee of a transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956800' id='432741'>
<a class='timestamp' href='#432741'><time timestamp='2015-10-27T14:40:00Z'>14:40</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
sipa: I agree, but a simple function with a miner-tweakable multiplier (maybe zero by default to mean &quot;no priority adjustment&quot;) would be fine, I think.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956920' id='432742'>
<a class='timestamp' href='#432742'><time timestamp='2015-10-27T14:42:00Z'>14:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gavinandresen: right, i was taking code-wise... the policy code can implement an overridable function, and we know that everything keeps.workimg whatever that function is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956920' id='432743'>
<a class='timestamp' href='#432743'><time timestamp='2015-10-27T14:42:00Z'>14:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the default implementation can be a simple multiplier
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956980' id='432744'>
<a class='timestamp' href='#432744'><time timestamp='2015-10-27T14:43:00Z'>14:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or a constant that get added to both fee and size
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956980' id='432745'>
<a class='timestamp' href='#432745'><time timestamp='2015-10-27T14:43:00Z'>14:43</time></a>
&lt;<span class='nick nick-10'> gavinandresen</span>&gt;
spiffy, I was worried somebody would go and implement a javascript interpreter so miners could tweak the function at runtime... :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445956980' id='432746'>
<a class='timestamp' href='#432746'><time timestamp='2015-10-27T14:43:00Z'>14:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ha
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957040' id='432747'>
<a class='timestamp' href='#432747'><time timestamp='2015-10-27T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
should definitely use lua for that <b>*ducks*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957040' id='432748'>
<a class='timestamp' href='#432748'><time timestamp='2015-10-27T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we should use bitcoin script with the op_x86 extension
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957100' id='432749'>
<a class='timestamp' href='#432749'><time timestamp='2015-10-27T14:45:00Z'>14:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: what is the main drawback of storing the fee delta in CTxMemPoolEntry? increasing the size of the structure?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957220' id='432750'>
<a class='timestamp' href='#432750'><time timestamp='2015-10-27T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bitcoin script, hah, even better
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957400' id='432751'>
<a class='timestamp' href='#432751'><time timestamp='2015-10-27T14:50:00Z'>14:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
morcos: optimizing for blockprioritysize=0 sounds good to me, removing it is somewhat controversial - but as it seems to be where things are going anyway, and simplifies the algorithm a lot it makes sense to optimize for the case
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957520' id='432752'>
<a class='timestamp' href='#432752'><time timestamp='2015-10-27T14:52:00Z'>14:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok thanks everyone.  yes only downside is more bloat to the mempool, but its relatively small.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957580' id='432753'>
<a class='timestamp' href='#432753'><time timestamp='2015-10-27T14:53:00Z'>14:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: so perhaps i&#x27;ll make a CTxMemPoolEntry function GetMiningPriority (ugh I hate overuse of the word priority) which for now = GetFee() + feeDelta
<br>
</div>

<div class='talk op-msg' data-timestamp='1445957760' id='432754'>
<a class='timestamp' href='#432754'><time timestamp='2015-10-27T14:56:00Z'>14:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or should I store a miningPriority variable, and use an outside of CTxMempool function to calculate it and set it? I guess it could set it at creation and further calls to prioritizeTransaction would adjust it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960160' id='432755'>
<a class='timestamp' href='#432755'><time timestamp='2015-10-27T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields: any idea why i get &quot;clang: error: unknown argument: &#x27;-framework QtCore&#x27;&quot; on my osx machine with qt5.5 [homebrew]?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960340' id='432756'>
<a class='timestamp' href='#432756'><time timestamp='2015-10-27T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jonasschnelli: mm, that&#x27;s an odd error. is anything quoted funny?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960340' id='432757'>
<a class='timestamp' href='#432757'><time timestamp='2015-10-27T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields: i just switched back to Qt 5.4.1 .. there i don&#x27;t have a such problem..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960400' id='432758'>
<a class='timestamp' href='#432758'><time timestamp='2015-10-27T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields: no additional details... just the clang error output during linking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960400' id='432759'>
<a class='timestamp' href='#432759'><time timestamp='2015-10-27T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jonasschnelli: can you paste the exact link-line? (make V=1)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960400' id='432760'>
<a class='timestamp' href='#432760'><time timestamp='2015-10-27T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
if there&#x27;s a problem with the framework, i&#x27;d expect &quot;framework not found&quot; or so
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960460' id='432761'>
<a class='timestamp' href='#432761'><time timestamp='2015-10-27T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields: will do soon... currently switched back to qt5.4.1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960520' id='432762'>
<a class='timestamp' href='#432762'><time timestamp='2015-10-27T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
Can discuss c++11 here if you prefer.  But then what&#x27;s #bitcoin-dev for?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960640' id='432763'>
<a class='timestamp' href='#432763'><time timestamp='2015-10-27T15:44:00Z'>15:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for more abstract things, nitty gritty implementation details for bitcoin core belong here
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960760' id='432764'>
<a class='timestamp' href='#432764'><time timestamp='2015-10-27T15:46:00Z'>15:46</time></a>
&lt;<span class='nick nick-6'> bsm1175321</span>&gt;
wumpus: indeed an explicit shared_ptr gets rid of the compiler error.  Let&#x27;s see if it runs...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960820' id='432765'>
<a class='timestamp' href='#432765'><time timestamp='2015-10-27T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
welcome zooko
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960820' id='432766'>
<a class='timestamp' href='#432766'><time timestamp='2015-10-27T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
bsm1175321: great!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445960940' id='432767'>
<a class='timestamp' href='#432767'><time timestamp='2015-10-27T15:49:00Z'>15:49</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jonasschnelli: <a href="https://github.com/Homebrew/homebrew/commit/fdbb338f2274e093b96209e7ca3ff9bf5460714e" class="link" target="_blank">https://github.com/Homebrew/homebrew/commit/fdbb338f2274e093b96209e7ca3ff9bf5460714e</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961000' id='432768'>
<a class='timestamp' href='#432768'><time timestamp='2015-10-27T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
patch is here: <a href="https://gist.githubusercontent.com/UniqMartin/a54542d666be1983dc83/raw/f235dfb418c3d0d086c3baae520d538bae0b1c70/qtbug-47162.patch" class="link" target="_blank">https://gist.githubusercontent.com/UniqMartin/a54542d666be1983dc83/raw/f235dfb418c3d0d086c3baae520d538bae0b1c70/qtbug-47162.patch</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961000' id='432769'>
<a class='timestamp' href='#432769'><time timestamp='2015-10-27T15:50:00Z'>15:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
it seems to leave out the closing quote
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961060' id='432770'>
<a class='timestamp' href='#432770'><time timestamp='2015-10-27T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
er, nm, misread
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961060' id='432771'>
<a class='timestamp' href='#432771'><time timestamp='2015-10-27T15:51:00Z'>15:51</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields : you mean a syntax error for the two ends?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961240' id='432772'>
<a class='timestamp' href='#432772'><time timestamp='2015-10-27T15:54:00Z'>15:54</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
jonasschnelli: oh, according to the bug report, that patchshould actually fix your problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961300' id='432773'>
<a class='timestamp' href='#432773'><time timestamp='2015-10-27T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
possible you hadn&#x27;t updated brew lately before building 5.5?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445961420' id='432774'>
<a class='timestamp' href='#432774'><time timestamp='2015-10-27T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
(remember that we use static libs for depends builds, so we wouldn&#x27;t hit this there for our 5.5.0 build)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445964000' id='432775'>
<a class='timestamp' href='#432775'><time timestamp='2015-10-27T16:40:00Z'>16:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
cfields: thanks for looking at it! I think i can solve it now... but need to finish stuff with qt 5.4.1 now until i go back to 5.5.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445964060' id='432776'>
<a class='timestamp' href='#432776'><time timestamp='2015-10-27T16:41:00Z'>16:41</time></a>
&lt;<span class='nick nick-6'> GitHub34</span>&gt;
[bitcoin] Diapolo opened pull request #6891: constify missing catch cases (master...const-ex) <a href="https://github.com/bitcoin/bitcoin/pull/6891" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6891</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445964360' id='432777'>
<a class='timestamp' href='#432777'><time timestamp='2015-10-27T16:46:00Z'>16:46</time></a>
&lt;<span class='nick nick-2'> GitHub81</span>&gt;
[bitcoin] Diapolo opened pull request #6892: [Trivial] ensure minimal header conventions (master...headers-new) <a href="https://github.com/bitcoin/bitcoin/pull/6892" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6892</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445964840' id='432778'>
<a class='timestamp' href='#432778'><time timestamp='2015-10-27T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-13'> GitHub176</span>&gt;
[bitcoin] Diapolo opened pull request #6893: forward-declare univalue in rpcclient + remove include in rpcserver.cpp (master...univalue) <a href="https://github.com/bitcoin/bitcoin/pull/6893" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6893</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445965440' id='432779'>
<a class='timestamp' href='#432779'><time timestamp='2015-10-27T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sigh...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445965740' id='432780'>
<a class='timestamp' href='#432780'><time timestamp='2015-10-27T17:09:00Z'>17:09</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
;-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445966880' id='432781'>
<a class='timestamp' href='#432781'><time timestamp='2015-10-27T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
Trolling for review: <a href="https://github.com/bitcoin/bitcoin/pull/6312" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6312</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445968800' id='432782'>
<a class='timestamp' href='#432782'><time timestamp='2015-10-27T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: is no one backporting mediantimepast to 0.11?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445968800' id='432783'>
<a class='timestamp' href='#432783'><time timestamp='2015-10-27T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: I backported it...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445968800' id='432784'>
<a class='timestamp' href='#432784'><time timestamp='2015-10-27T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: <a href="https://github.com/bitcoin/bitcoin/issues/6884" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/6884</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445968860' id='432785'>
<a class='timestamp' href='#432785'><time timestamp='2015-10-27T18:01:00Z'>18:01</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: Not sure if we need to backport to 0.10, didnt have time yet anyway.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445968860' id='432786'>
<a class='timestamp' href='#432786'><time timestamp='2015-10-27T18:01:00Z'>18:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ah okay I missed it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969040' id='432787'>
<a class='timestamp' href='#432787'><time timestamp='2015-10-27T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: I also made a branch with BIP68+OP_CSV in one as some people asked for it. I&#x27;m debating if I should make a PR or just leave the two separate PRs as is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969400' id='432788'>
<a class='timestamp' href='#432788'><time timestamp='2015-10-27T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: this patch does not appear to enforce (as standardness) the new behavior.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969580' id='432789'>
<a class='timestamp' href='#432789'><time timestamp='2015-10-27T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
there are some unit tests in miner_tests.cpp which verify that CreateNewBlock won&#x27;t mine non-final txs that are in the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969580' id='432790'>
<a class='timestamp' href='#432790'><time timestamp='2015-10-27T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
they were added by petertodd 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969640' id='432791'>
<a class='timestamp' href='#432791'><time timestamp='2015-10-27T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i was under the impression that we don&#x27;t want to allow non-final txs into the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969700' id='432792'>
<a class='timestamp' href='#432792'><time timestamp='2015-10-27T18:15:00Z'>18:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i suppose i should have checked that my code passed the unit tests earlier on, but the whole idea is to not recheck everything while building the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969760' id='432793'>
<a class='timestamp' href='#432793'><time timestamp='2015-10-27T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: the finality test is against the mined block itself, while the mempool is running one block behind.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969760' id='432794'>
<a class='timestamp' href='#432794'><time timestamp='2015-10-27T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think that was fixed so the mempool checks against +1, but that would have been a problem in the opposite direction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969760' id='432795'>
<a class='timestamp' href='#432795'><time timestamp='2015-10-27T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So the mepool need a one block lookahead or there will be an extra delay in mining transactions. (which would presumably mean a competative advantage for miners that change that code)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969820' id='432796'>
<a class='timestamp' href='#432796'><time timestamp='2015-10-27T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the unit test specifically calls addUnchecked with a non-final tx, and then sees if CreateNewBlock would mine it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969820' id='432797'>
<a class='timestamp' href='#432797'><time timestamp='2015-10-27T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
non-final for 1 block ahead (and a time based version as well)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969880' id='432798'>
<a class='timestamp' href='#432798'><time timestamp='2015-10-27T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what i&#x27;m saying is I&#x27;d like to be able ot rely on there being no non-final txs in the mempool, i think this was the idea sipa had in mind too?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969940' id='432799'>
<a class='timestamp' href='#432799'><time timestamp='2015-10-27T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the one thing I can think of is that its possible we need a function analogous to removeCoinbaseSpends for locktime based txs in the event of a reorg if thats not happening already
<br>
</div>

<div class='talk op-msg' data-timestamp='1445969940' id='432800'>
<a class='timestamp' href='#432800'><time timestamp='2015-10-27T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
The hight based can be precise, e.g. so it&#x27;s not possible to add something that won&#x27;t be final; and I think that would be good enough for what you&#x27;re doing. But time based can&#x27;t be precise; but MPL is fixing that.  I&#x27;m fine with there beinging nothing that won&#x27;t be final. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970000' id='432801'>
<a class='timestamp' href='#432801'><time timestamp='2015-10-27T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;m not sure if we&#x27;re on the same page, so I&#x27;m saying that I think there should be currently non-final tx in the mempool which will be final from the perspective of createnewblock,  but none that won&#x27;t be final from the perspective of createnewblock. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970060' id='432802'>
<a class='timestamp' href='#432802'><time timestamp='2015-10-27T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Before MTP this was hard to achieve without adding additional delays, but MTP will effectively make that additional delay universal.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970060' id='432803'>
<a class='timestamp' href='#432803'><time timestamp='2015-10-27T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I guess thats the same page.  Mempool adds 1 to chainActive.height before checking finality, so i would consider it to be final from the perspective of both the mempool and CNB
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970120' id='432804'>
<a class='timestamp' href='#432804'><time timestamp='2015-10-27T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and yes i agree that the current state is no non-final txs will end up in the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970120' id='432805'>
<a class='timestamp' href='#432805'><time timestamp='2015-10-27T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what i&#x27;m saying is the unit tests require that even if they do, CNB will not put them in the template.  (that breaks for me, and i think is unnecessary computation)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970120' id='432806'>
<a class='timestamp' href='#432806'><time timestamp='2015-10-27T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
okay, fair enough, I was defining current as chainActive.Tip().
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970120' id='432807'>
<a class='timestamp' href='#432807'><time timestamp='2015-10-27T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also what i&#x27;m saying is that a reorg could probably break that assumption
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970180' id='432808'>
<a class='timestamp' href='#432808'><time timestamp='2015-10-27T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think we can drop that test, but we need to make sure that reorgs are removing things correctly at the same time. (I don&#x27;t know if we have a test for that).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970180' id='432809'>
<a class='timestamp' href='#432809'><time timestamp='2015-10-27T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
morcos: bluematt had a pr recently to fix that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970240' id='432810'>
<a class='timestamp' href='#432810'><time timestamp='2015-10-27T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
#6595
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970240' id='432811'>
<a class='timestamp' href='#432811'><time timestamp='2015-10-27T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
we need to pick that up again...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970240' id='432812'>
<a class='timestamp' href='#432812'><time timestamp='2015-10-27T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
oh ha. i remember now, we were going to revamp the way reorgs are handled
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970240' id='432813'>
<a class='timestamp' href='#432813'><time timestamp='2015-10-27T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ah, ok good.  yes we need that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970300' id='432814'>
<a class='timestamp' href='#432814'><time timestamp='2015-10-27T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and yeah thats what i was thinking, that you only want to run this after the reorg
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970300' id='432815'>
<a class='timestamp' href='#432815'><time timestamp='2015-10-27T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but why is that difficult
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970300' id='432816'>
<a class='timestamp' href='#432816'><time timestamp='2015-10-27T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i&#x27;ll dust off that code.  after packages went in, bluematt&#x27;s open pulls needed some rebasing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970300' id='432817'>
<a class='timestamp' href='#432817'><time timestamp='2015-10-27T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
see also #6656
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970300' id='432818'>
<a class='timestamp' href='#432818'><time timestamp='2015-10-27T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you odn&#x27;t have to redo the whole way reorgs are handled, you just have to call the removeForReorg after ActivateBestChainStep returns
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970360' id='432819'>
<a class='timestamp' href='#432819'><time timestamp='2015-10-27T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
yeah i think that&#x27;s what 6656 does
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970360' id='432820'>
<a class='timestamp' href='#432820'><time timestamp='2015-10-27T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
er, did
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970360' id='432821'>
<a class='timestamp' href='#432821'><time timestamp='2015-10-27T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
perhaps you need to flag that the height or mediantimepast might have changed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970360' id='432822'>
<a class='timestamp' href='#432822'><time timestamp='2015-10-27T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
down
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970360' id='432823'>
<a class='timestamp' href='#432823'><time timestamp='2015-10-27T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Perhaps that unit test could be changed to addunchecked but then trigger the logic that handles a reorg.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970420' id='432824'>
<a class='timestamp' href='#432824'><time timestamp='2015-10-27T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
heh, i think thats in a different unit test
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970480' id='432825'>
<a class='timestamp' href='#432825'><time timestamp='2015-10-27T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sdaftuar: so 6656 really supercedes 6595 then.  jsut for some reason 6595 was left open
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970540' id='432826'>
<a class='timestamp' href='#432826'><time timestamp='2015-10-27T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: this actually does lead me to a concern.  i was leaving in the final TestBlockValidity test, but what should the code do in the event it fails?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970540' id='432827'>
<a class='timestamp' href='#432827'><time timestamp='2015-10-27T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I&#x27;m thinking it should switch into mining empty block mode, because otherwise there is no way to figure out what part of your block assembly broke
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970600' id='432828'>
<a class='timestamp' href='#432828'><time timestamp='2015-10-27T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the down side of this, is if there is some error in mempool code that lets non valid txs in, all miners will just start switching to mining empty blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970600' id='432829'>
<a class='timestamp' href='#432829'><time timestamp='2015-10-27T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ugh that sounds terrible
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970600' id='432830'>
<a class='timestamp' href='#432830'><time timestamp='2015-10-27T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We assert now, no? .. yea, but I was just about to suggest it could start doing that. OTOH, that doesn&#x27;t exactly encourage people to fix things, and empty blocks may mean that you don&#x27;t failover to another daemon.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432831'>
<a class='timestamp' href='#432831'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its much less likely to happen now, because we CheckInputs on every tx as we add it anyway, and if that fails we skip that txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432832'>
<a class='timestamp' href='#432832'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: well empty blocks are safe(er). Assuming that <u>_prior_</u> chain is not invalid, they&#x27;re no worse than not mining and likely better.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432833'>
<a class='timestamp' href='#432833'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
perhaps i should put that code back in
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432834'>
<a class='timestamp' href='#432834'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and just leave it off, unless you hit an invalid block, and then switch it on
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432835'>
<a class='timestamp' href='#432835'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
because that way you&#x27;ll just skip over the invalid txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970660' id='432836'>
<a class='timestamp' href='#432836'><time timestamp='2015-10-27T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
at least for that failure mode
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970720' id='432837'>
<a class='timestamp' href='#432837'><time timestamp='2015-10-27T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Running checkinputs again sounds expensive.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970720' id='432838'>
<a class='timestamp' href='#432838'><time timestamp='2015-10-27T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but then it won&#x27;t be a very tested code path, unless we have a mode to test it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970720' id='432839'>
<a class='timestamp' href='#432839'><time timestamp='2015-10-27T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah well thats why the existing code is slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970780' id='432840'>
<a class='timestamp' href='#432840'><time timestamp='2015-10-27T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its a nice property of the existing code, that if somebody injects an invalid tx into mempools, the mining code will just keep skipping it and assembling valid blocks from the rest of the txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970840' id='432841'>
<a class='timestamp' href='#432841'><time timestamp='2015-10-27T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
In any case, thinking in terms of what the user of this code wants;  they either want empty blocks (if they have no fail over) or they want the node to stop responding (if they have fail-over).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445970840' id='432842'>
<a class='timestamp' href='#432842'><time timestamp='2015-10-27T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: right, it keeps the mempool behavior seperate from consensus.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445971440' id='432843'>
<a class='timestamp' href='#432843'><time timestamp='2015-10-27T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i think the mempool should avoid but not outlaw non-final transactions; CNB should skip the nonfinal ones though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445971680' id='432844'>
<a class='timestamp' href='#432844'><time timestamp='2015-10-27T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
what about checkinputs redundancy?  at least doing another IsFinal check is cheap.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445971920' id='432845'>
<a class='timestamp' href='#432845'><time timestamp='2015-10-27T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think all mempool entries should be valid regarding 1) not spending nonexisting inputs 2) script validity
<br>
</div>

<div class='talk op-msg' data-timestamp='1445971980' id='432846'>
<a class='timestamp' href='#432846'><time timestamp='2015-10-27T18:53:00Z'>18:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if we have that, i think CNB could just not validate tye result
<br>
</div>

<div class='talk op-msg' data-timestamp='1445971980' id='432847'>
<a class='timestamp' href='#432847'><time timestamp='2015-10-27T18:53:00Z'>18:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that seems controversial
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972160' id='432848'>
<a class='timestamp' href='#432848'><time timestamp='2015-10-27T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: so you&#x27;d like me to put IsFinal check back in?, you might be right, it might be cheap...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972220' id='432849'>
<a class='timestamp' href='#432849'><time timestamp='2015-10-27T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i suppose it would be nice to not have to worry about removing txs in the event of a reorg, you know they&#x27;ll be valid again very soon 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972220' id='432850'>
<a class='timestamp' href='#432850'><time timestamp='2015-10-27T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what do you think about BIP68 and sequence numbers though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972280' id='432851'>
<a class='timestamp' href='#432851'><time timestamp='2015-10-27T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
thats not cheap to check b/c you have to look up the inputs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972280' id='432852'>
<a class='timestamp' href='#432852'><time timestamp='2015-10-27T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: really if we make CNB no longer latency critical (via mechenisms discussed before) then I think validate after remains a cheap protection.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972340' id='432853'>
<a class='timestamp' href='#432853'><time timestamp='2015-10-27T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but I&#x27;d rather remove some of the internal double checking where it is expensive and really shouldn&#x27;t be needed but continue to validate after.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972400' id='432854'>
<a class='timestamp' href='#432854'><time timestamp='2015-10-27T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i think enforcing nonfinalness in the mempool.is expensive, and the worst a reorg can cheaply do is put a bunch of things in that will be check anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972460' id='432855'>
<a class='timestamp' href='#432855'><time timestamp='2015-10-27T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: fair enough, bip68 does make this significantly more expensive
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972580' id='432856'>
<a class='timestamp' href='#432856'><time timestamp='2015-10-27T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i feel like i&#x27;m really overloading CTxMempoolEntry, but seems like it could store a block height and time at which the tx is final
<br>
</div>

<div class='talk op-msg' data-timestamp='1445972640' id='432857'>
<a class='timestamp' href='#432857'><time timestamp='2015-10-27T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that way the locktime and bip68 checks that you do at ATMP don&#x27;t have to be repeated (ugh... i guess unless there is a reorg that affects inputs)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445973240' id='432858'>
<a class='timestamp' href='#432858'><time timestamp='2015-10-27T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: sgtm, if that can guarantee not needing to verify after creation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445974020' id='432859'>
<a class='timestamp' href='#432859'><time timestamp='2015-10-27T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: well then we&#x27;re back to the reorg problem right?  but maybe that&#x27;s solvable more quickly by only having to do work on smaller subset of the txs.  for instance if you know the lowest height and mediantPast time you disconnected down to, you only need to look at txs with CTxMemPoolEntry valid time and heights &gt; that
<br>
</div>

<div class='talk op-msg' data-timestamp='1445974320' id='432860'>
<a class='timestamp' href='#432860'><time timestamp='2015-10-27T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
[bitcoin] giacecco closed pull request #6885: Instructions on how to make the Homebrew OpenSSL headers visible... (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/6885" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6885</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445975880' id='432861'>
<a class='timestamp' href='#432861'><time timestamp='2015-10-27T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-13'> GitHub51</span>&gt;
[bitcoin] sdaftuar opened pull request #6894: [Tests] Fix BIP65 p2p test (master...fix-bip65-p2p-test) <a href="https://github.com/bitcoin/bitcoin/pull/6894" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6894</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445975940' id='432862'>
<a class='timestamp' href='#432862'><time timestamp='2015-10-27T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: BlueMatt: sdaftuar and i were just talking.  the ccoinsviewcache growing out of control.  the biggest problem is a reorg!  a reorg will cause removeCoinbaseSpends to run, which will pull every single txin into the cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1445975940' id='432863'>
<a class='timestamp' href='#432863'><time timestamp='2015-10-27T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i assume it&#x27;ll flush right after that, but at that point it&#x27;ll be too late if you OOM&#x27;ed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445975940' id='432864'>
<a class='timestamp' href='#432864'><time timestamp='2015-10-27T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976000' id='432865'>
<a class='timestamp' href='#432865'><time timestamp='2015-10-27T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think storing this valid height/time will be very useful for coinbase spends, and moderately useful for checklocktime and csv
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976060' id='432866'>
<a class='timestamp' href='#432866'><time timestamp='2015-10-27T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
arguably we should actually store 3 numbers, the height/time its valid at, and the height which if you reorg below you need to recalculate validity
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976060' id='432867'>
<a class='timestamp' href='#432867'><time timestamp='2015-10-27T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then on a reorg we just scan the whole mempool checking that last number, and recalculate validity
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976060' id='432868'>
<a class='timestamp' href='#432868'><time timestamp='2015-10-27T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
unfortunatley anti-fee sniping will cause any txs which have arrived in the last couple blocks to be triggered for recalc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976120' id='432869'>
<a class='timestamp' href='#432869'><time timestamp='2015-10-27T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and wihtout storing more info, you&#x27;d have to recalc for coinbase, checklocktime and bip68 sequence, bc you don&#x27;t know which was invalidated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445976120' id='432870'>
<a class='timestamp' href='#432870'><time timestamp='2015-10-27T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so its a bit of an expensive recalc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978100' id='432871'>
<a class='timestamp' href='#432871'><time timestamp='2015-10-27T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: no, there is no current tie breaker in CreateNewBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978100' id='432872'>
<a class='timestamp' href='#432872'><time timestamp='2015-10-27T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
BlueMatt: sure why not, it uses TxPriorityCompare right?  which sorts by fee then priority
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978160' id='432873'>
<a class='timestamp' href='#432873'><time timestamp='2015-10-27T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: the way I read it, it first creates a heap according to priority, then resorts to create a heap using fee
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978160' id='432874'>
<a class='timestamp' href='#432874'><time timestamp='2015-10-27T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it never uses fee then priority
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978220' id='432875'>
<a class='timestamp' href='#432875'><time timestamp='2015-10-27T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes correct, but if you look at that compartor, in either case it uses the other one as the tie break
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978220' id='432876'>
<a class='timestamp' href='#432876'><time timestamp='2015-10-27T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
comparatator
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978280' id='432877'>
<a class='timestamp' href='#432877'><time timestamp='2015-10-27T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hmmmm, indeed, I hadnt seen that before....how is it that ordering seems randomish, then?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978340' id='432878'>
<a class='timestamp' href='#432878'><time timestamp='2015-10-27T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
lemme go look at mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978400' id='432879'>
<a class='timestamp' href='#432879'><time timestamp='2015-10-27T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i was wondering that, you would think that would be fairly consistent across nodes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978460' id='432880'>
<a class='timestamp' href='#432880'><time timestamp='2015-10-27T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i wonder if in this recent attack there are many things with also the same priority...  seems a bit unlikely..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978460' id='432881'>
<a class='timestamp' href='#432881'><time timestamp='2015-10-27T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that was my assumption
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978520' id='432882'>
<a class='timestamp' href='#432882'><time timestamp='2015-10-27T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if all outputs are created in the same block, and the spends are the same size
<br>
</div>

<div class='talk op-msg' data-timestamp='1445978520' id='432883'>
<a class='timestamp' href='#432883'><time timestamp='2015-10-27T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s what you would get
<br>
</div>

<div class='talk op-msg' data-timestamp='1445982900' id='432884'>
<a class='timestamp' href='#432884'><time timestamp='2015-10-27T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: hmmmm, now I&#x27;m very confused
<br>
</div>

<div class='talk op-msg' data-timestamp='1445982900' id='432885'>
<a class='timestamp' href='#432885'><time timestamp='2015-10-27T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: there are almost no txn in my mempool which have the same fee and prio
<br>
</div>

<div class='talk op-msg' data-timestamp='1445982960' id='432886'>
<a class='timestamp' href='#432886'><time timestamp='2015-10-27T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
BlueMatt: I didn&#x27;t look into the root issue, its just that you are not seeing the blocks you expect to see?  It&#x27;s not a result of malleated txs?  Where some nodes have one version and others have another
<br>
</div>

<div class='talk op-msg' data-timestamp='1445983140' id='432887'>
<a class='timestamp' href='#432887'><time timestamp='2015-10-27T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it could be related to malleated txn, but ive definitely seen it every time mempools get large, not necessarily when malleation is happening
<br>
</div>

<div class='talk op-msg' data-timestamp='1445983260' id='432888'>
<a class='timestamp' href='#432888'><time timestamp='2015-10-27T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
might it just be different miners using different policies?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445983500' id='432889'>
<a class='timestamp' href='#432889'><time timestamp='2015-10-27T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
afaiu there are effectively no different policies in use by miners today
<br>
</div>

<div class='talk op-msg' data-timestamp='1445983500' id='432890'>
<a class='timestamp' href='#432890'><time timestamp='2015-10-27T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(aside from eligius)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445987460' id='432891'>
<a class='timestamp' href='#432891'><time timestamp='2015-10-27T23:11:00Z'>23:11</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
when are the IRC meetings planned?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445987460' id='432892'>
<a class='timestamp' href='#432892'><time timestamp='2015-10-27T23:11:00Z'>23:11</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
ooi
<br>
</div>

<div class='talk op-msg' data-timestamp='1445987700' id='432893'>
<a class='timestamp' href='#432893'><time timestamp='2015-10-27T23:15:00Z'>23:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
thursday 7pm UTC
<br>
</div>

<div class='talk op-msg' data-timestamp='1445987700' id='432894'>
<a class='timestamp' href='#432894'><time timestamp='2015-10-27T23:15:00Z'>23:15</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
ta
<br>
</div>

</div>
</section>

</body>
</html>
