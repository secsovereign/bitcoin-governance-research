<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-09-09
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-09-09' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:26 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-08-09">&lt;</a><span class='header'>  September 2016  </span><a href="/bitcoin-core-dev/2016-10-09">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2016-09-01">1</a>  <a class="" href="/bitcoin-core-dev/2016-09-02">2</a>  <a class="" href="/bitcoin-core-dev/2016-09-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-09-04">4</a>  <a class="" href="/bitcoin-core-dev/2016-09-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-09-06">6</a>  <a class="" href="/bitcoin-core-dev/2016-09-07">7</a>  <a class="" href="/bitcoin-core-dev/2016-09-08">8</a>  <a class="current" href="/bitcoin-core-dev/2016-09-09">9</a> <a class="" href="/bitcoin-core-dev/2016-09-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-11">11</a> <a class="" href="/bitcoin-core-dev/2016-09-12">12</a> <a class="" href="/bitcoin-core-dev/2016-09-13">13</a> <a class="" href="/bitcoin-core-dev/2016-09-14">14</a> <a class="" href="/bitcoin-core-dev/2016-09-15">15</a> <a class="" href="/bitcoin-core-dev/2016-09-16">16</a> <a class="" href="/bitcoin-core-dev/2016-09-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-18">18</a> <a class="" href="/bitcoin-core-dev/2016-09-19">19</a> <a class="" href="/bitcoin-core-dev/2016-09-20">20</a> <a class="" href="/bitcoin-core-dev/2016-09-21">21</a> <a class="" href="/bitcoin-core-dev/2016-09-22">22</a> <a class="" href="/bitcoin-core-dev/2016-09-23">23</a> <a class="" href="/bitcoin-core-dev/2016-09-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-09-25">25</a> <a class="" href="/bitcoin-core-dev/2016-09-26">26</a> <a class="" href="/bitcoin-core-dev/2016-09-27">27</a> <a class="" href="/bitcoin-core-dev/2016-09-28">28</a> <a class="" href="/bitcoin-core-dev/2016-09-29">29</a> <a class="" href="/bitcoin-core-dev/2016-09-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1473382500' id='492552'>
<a class='timestamp' href='#492552'><time timestamp='2016-09-09T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
polling for things like balance make perfect sense - I was referring to things like getting notified of new blocks or transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382500' id='492553'>
<a class='timestamp' href='#492553'><time timestamp='2016-09-09T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
polling makes sense for that in most contexts.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382560' id='492554'>
<a class='timestamp' href='#492554'><time timestamp='2016-09-09T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Blocks show up once per ten minutes on average, polling once a second adds a neglgible amount of overhead and delay, and you avoid any issues with corner cases where the notifcation gets lost.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382620' id='492555'>
<a class='timestamp' href='#492555'><time timestamp='2016-09-09T00:57:00Z'>00:57</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you can solve those issues with another protocol layer but yeah, it does add some complexity
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382680' id='492556'>
<a class='timestamp' href='#492556'><time timestamp='2016-09-09T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
what I&#x27;ve usually done is open the connection and subscribe, then ping periodically
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382740' id='492557'>
<a class='timestamp' href='#492557'><time timestamp='2016-09-09T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
the pings don&#x27;t have to be every second
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382740' id='492558'>
<a class='timestamp' href='#492558'><time timestamp='2016-09-09T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you still get extremely low latency when it works correctly - and you detect malfunction fairly quickly
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382800' id='492559'>
<a class='timestamp' href='#492559'><time timestamp='2016-09-09T01:00:00Z'>01:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
this is all middleware, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382800' id='492560'>
<a class='timestamp' href='#492560'><time timestamp='2016-09-09T01:00:00Z'>01:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
app developers shouldn&#x27;t have to deal with all the inner plumbing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382800' id='492561'>
<a class='timestamp' href='#492561'><time timestamp='2016-09-09T01:00:00Z'>01:00</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
and the model of writing event handlers is a pretty nice one
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382860' id='492562'>
<a class='timestamp' href='#492562'><time timestamp='2016-09-09T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you can even have an event handler for when there&#x27;s a connection error
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382860' id='492563'>
<a class='timestamp' href='#492563'><time timestamp='2016-09-09T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
makes all the clientside logic easier to follow
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382860' id='492564'>
<a class='timestamp' href='#492564'><time timestamp='2016-09-09T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the logic needed to handle a lost event is so hard that even experts usually don&#x27;t get it right though.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382860' id='492565'>
<a class='timestamp' href='#492565'><time timestamp='2016-09-09T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(generally speaking)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382920' id='492566'>
<a class='timestamp' href='#492566'><time timestamp='2016-09-09T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
there are plenty of places where you have no choice but to be event triggered-- when load and latency are critical.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382920' id='492567'>
<a class='timestamp' href='#492567'><time timestamp='2016-09-09T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but they result in a lot more exceptional conditions which are hard to reason about and hard to test.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382920' id='492568'>
<a class='timestamp' href='#492568'><time timestamp='2016-09-09T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
which is why it&#x27;s the kind of stuff you want in a very well-tested library
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382980' id='492569'>
<a class='timestamp' href='#492569'><time timestamp='2016-09-09T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
and not the kind of thing you want every app developer to be writing ad hoc
<br>
</div>

<div class='talk op-msg' data-timestamp='1473382980' id='492570'>
<a class='timestamp' href='#492570'><time timestamp='2016-09-09T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
but I agree that the general cases can be quite hard
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383040' id='492571'>
<a class='timestamp' href='#492571'><time timestamp='2016-09-09T01:04:00Z'>01:04</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
it should then be in an external library. putting reliable message delivery into bitcoin core would also make the binary liable in the event something (inevitably) goes wrong.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383040' id='492572'>
<a class='timestamp' href='#492572'><time timestamp='2016-09-09T01:04:00Z'>01:04</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
midnightmagic: agreed - that&#x27;s what I do
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383040' id='492573'>
<a class='timestamp' href='#492573'><time timestamp='2016-09-09T01:04:00Z'>01:04</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I have a process connect to bitcoin core via p2p which receives inv messages and sends getdata
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383100' id='492574'>
<a class='timestamp' href='#492574'><time timestamp='2016-09-09T01:05:00Z'>01:05</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
all the messaging stuff beyond that is entirely in the other process
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383400' id='492575'>
<a class='timestamp' href='#492575'><time timestamp='2016-09-09T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
then the other process can be queried for its connection status - if it&#x27;s connected, if it&#x27;s synched, etc...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383520' id='492576'>
<a class='timestamp' href='#492576'><time timestamp='2016-09-09T01:12:00Z'>01:12</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
<a href="https://github.com/ciphrex/mSIGNA/blob/master/deps/CoinQ/src/CoinQ_peer_io.h#L313" class="link" target="_blank">https://github.com/ciphrex/mSIGNA/blob/master/deps/CoinQ/src/CoinQ_peer_io.h#L313</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383640' id='492577'>
<a class='timestamp' href='#492577'><time timestamp='2016-09-09T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i don&#x27;t think it would be obvious to others to do application integration at the p2p layer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383640' id='492578'>
<a class='timestamp' href='#492578'><time timestamp='2016-09-09T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
they wouldn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383640' id='492579'>
<a class='timestamp' href='#492579'><time timestamp='2016-09-09T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
they only need to interact with this other process
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383640' id='492580'>
<a class='timestamp' href='#492580'><time timestamp='2016-09-09T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i know. but i mean they wouldn&#x27;t know to look for something that does this :).
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383700' id='492581'>
<a class='timestamp' href='#492581'><time timestamp='2016-09-09T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
the typical thing is to &quot;use rpc&quot; not &quot;look for a p2p client that bridges events on the network to your own messaging system, without using bitcoind rpc&quot;.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383700' id='492582'>
<a class='timestamp' href='#492582'><time timestamp='2016-09-09T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
indeed - I&#x27;d like to see this kind of thing become more readily available
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383760' id='492583'>
<a class='timestamp' href='#492583'><time timestamp='2016-09-09T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
in my ideal world, Bitcoin Core would just do peer discovery, validation, and relay
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383760' id='492584'>
<a class='timestamp' href='#492584'><time timestamp='2016-09-09T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
and other processes would handle all app layer event processing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473383940' id='492585'>
<a class='timestamp' href='#492585'><time timestamp='2016-09-09T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
perhaps a shared block storage process could be incorporated into the design
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384000' id='492586'>
<a class='timestamp' href='#492586'><time timestamp='2016-09-09T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
and shared utxo storage
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384000' id='492587'>
<a class='timestamp' href='#492587'><time timestamp='2016-09-09T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I&#x27;m tempted to work on multiwallet stuff. is anyone else? (poke CodeShark)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384060' id='492588'>
<a class='timestamp' href='#492588'><time timestamp='2016-09-09T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384060' id='492589'>
<a class='timestamp' href='#492589'><time timestamp='2016-09-09T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I don&#x27;t think what I had done will rebase too easily :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384120' id='492590'>
<a class='timestamp' href='#492590'><time timestamp='2016-09-09T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
probably not, or I&#x27;d have been including it in Knots already :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384180' id='492591'>
<a class='timestamp' href='#492591'><time timestamp='2016-09-09T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
assuming you didn&#x27;t keep maintaining it privately
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384180' id='492592'>
<a class='timestamp' href='#492592'><time timestamp='2016-09-09T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
nah, I decided to write my own wallet from scratch instead :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384240' id='492593'>
<a class='timestamp' href='#492593'><time timestamp='2016-09-09T01:24:00Z'>01:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yeah, I figured :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384360' id='492594'>
<a class='timestamp' href='#492594'><time timestamp='2016-09-09T01:26:00Z'>01:26</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
if I were to attempt the multiwallet in Core again I would take a very different approach ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384360' id='492595'>
<a class='timestamp' href='#492595'><time timestamp='2016-09-09T01:26:00Z'>01:26</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
especially in regards to the merge process
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384420' id='492596'>
<a class='timestamp' href='#492596'><time timestamp='2016-09-09T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
I tried to do too much at once
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384480' id='492597'>
<a class='timestamp' href='#492597'><time timestamp='2016-09-09T01:28:00Z'>01:28</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
some of the hooks did get in, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384600' id='492598'>
<a class='timestamp' href='#492598'><time timestamp='2016-09-09T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/commit/67155d9299ef75cc73272a259dbfbf72632c3020" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/67155d9299ef75cc73272a259dbfbf72632c3020</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384600' id='492599'>
<a class='timestamp' href='#492599'><time timestamp='2016-09-09T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I&#x27;m doing tiny commits so far, mostly cleanups
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384600' id='492600'>
<a class='timestamp' href='#492600'><time timestamp='2016-09-09T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
the difficult part I see (and may just skip) is closing/removing a wallet at runtime
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384660' id='492601'>
<a class='timestamp' href='#492601'><time timestamp='2016-09-09T01:31:00Z'>01:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I&#x27;m not really sure our shutdown close is even safe
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384780' id='492602'>
<a class='timestamp' href='#492602'><time timestamp='2016-09-09T01:33:00Z'>01:33</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you mean in terms of RPC?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384840' id='492603'>
<a class='timestamp' href='#492603'><time timestamp='2016-09-09T01:34:00Z'>01:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I mean shutdown deletes the wallet pointer, but who knows if another thread might still be using it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384840' id='492604'>
<a class='timestamp' href='#492604'><time timestamp='2016-09-09T01:34:00Z'>01:34</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
reference counting? :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384840' id='492605'>
<a class='timestamp' href='#492605'><time timestamp='2016-09-09T01:34:00Z'>01:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
maybe it&#x27;s safe, but it&#x27;s far from clear that it is
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384900' id='492606'>
<a class='timestamp' href='#492606'><time timestamp='2016-09-09T01:35:00Z'>01:35</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
there is no refcounting right now
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384900' id='492607'>
<a class='timestamp' href='#492607'><time timestamp='2016-09-09T01:35:00Z'>01:35</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I&#x27;ll probably add something like that <b>*if*</b> I implement close
<br>
</div>

<div class='talk op-msg' data-timestamp='1473384900' id='492608'>
<a class='timestamp' href='#492608'><time timestamp='2016-09-09T01:35:00Z'>01:35</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(my main practical goal is to use JoinMarket without touching my real Core hot wallet, and without two node instances)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385020' id='492609'>
<a class='timestamp' href='#492609'><time timestamp='2016-09-09T01:37:00Z'>01:37</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
simplest is to just provide a list of wallet files in the config and just have them all load for the duration of runtime
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385020' id='492610'>
<a class='timestamp' href='#492610'><time timestamp='2016-09-09T01:37:00Z'>01:37</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
oh, I guess that&#x27;s a possibility
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385020' id='492611'>
<a class='timestamp' href='#492611'><time timestamp='2016-09-09T01:37:00Z'>01:37</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
-wallet exists, could just accept multiples
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385140' id='492612'>
<a class='timestamp' href='#492612'><time timestamp='2016-09-09T01:39:00Z'>01:39</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
from a GUI perspective it&#x27;s nice to be able to open and close wallet files during runtime - but if you&#x27;ll be using a specific setup and connecting via RPC it doesn&#x27;t really matter
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385200' id='492613'>
<a class='timestamp' href='#492613'><time timestamp='2016-09-09T01:40:00Z'>01:40</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
in fact, being able to open and close wallet files via RPC is potentially exploitable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385260' id='492614'>
<a class='timestamp' href='#492614'><time timestamp='2016-09-09T01:41:00Z'>01:41</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
only slightly more-so than backupwallet, I think? :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385260' id='492615'>
<a class='timestamp' href='#492615'><time timestamp='2016-09-09T01:41:00Z'>01:41</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385500' id='492616'>
<a class='timestamp' href='#492616'><time timestamp='2016-09-09T01:45:00Z'>01:45</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
point is if your payment processing app is designed to deliberately open and close wallet files at runtime there&#x27;s probably something wrong in your design ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385560' id='492617'>
<a class='timestamp' href='#492617'><time timestamp='2016-09-09T01:46:00Z'>01:46</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
well, that&#x27;s probably true as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385560' id='492618'>
<a class='timestamp' href='#492618'><time timestamp='2016-09-09T01:46:00Z'>01:46</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
maybe.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385620' id='492619'>
<a class='timestamp' href='#492619'><time timestamp='2016-09-09T01:47:00Z'>01:47</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
it might make sense to do wallet rotation in some capacity
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385620' id='492620'>
<a class='timestamp' href='#492620'><time timestamp='2016-09-09T01:47:00Z'>01:47</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
yeah, you could have tools for such things
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385620' id='492621'>
<a class='timestamp' href='#492621'><time timestamp='2016-09-09T01:47:00Z'>01:47</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
but I think they should be conceptually separate from the business logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385620' id='492622'>
<a class='timestamp' href='#492622'><time timestamp='2016-09-09T01:47:00Z'>01:47</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
probably
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385620' id='492623'>
<a class='timestamp' href='#492623'><time timestamp='2016-09-09T01:47:00Z'>01:47</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you have your business logic, then below that you have a policy layer
<br>
</div>

<div class='talk op-msg' data-timestamp='1473385680' id='492624'>
<a class='timestamp' href='#492624'><time timestamp='2016-09-09T01:48:00Z'>01:48</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
specifying which wallet, which keys, which signing policies, etc... should be used is part of the policy layer
<br>
</div>

<div class='talk op-msg' data-timestamp='1473398280' id='492625'>
<a class='timestamp' href='#492625'><time timestamp='2016-09-09T05:18:00Z'>05:18</time></a>
&lt;<span class='nick nick-7'> GitHub90</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/ddc308068d69...17347d6a5915" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/ddc308068d69...17347d6a5915</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473398280' id='492626'>
<a class='timestamp' href='#492626'><time timestamp='2016-09-09T05:18:00Z'>05:18</time></a>
&lt;<span class='nick nick-7'> GitHub90</span>&gt;
bitcoin/master df2d2e7 Gaurav Rana: update name of file bitcoin.qrc
<br>
</div>

<div class='talk op-msg' data-timestamp='1473398280' id='492627'>
<a class='timestamp' href='#492627'><time timestamp='2016-09-09T05:18:00Z'>05:18</time></a>
&lt;<span class='nick nick-7'> GitHub90</span>&gt;
bitcoin/master 17347d6 Wladimir J. van der Laan: Merge #8683: fix incorrect file name bitcoin.qrc...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473398280' id='492628'>
<a class='timestamp' href='#492628'><time timestamp='2016-09-09T05:18:00Z'>05:18</time></a>
&lt;<span class='nick nick-8'> GitHub14</span>&gt;
[bitcoin] laanwj closed pull request #8683: fix incorrect file name bitcoin.qrc  (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/8683" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8683</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473400080' id='492629'>
<a class='timestamp' href='#492629'><time timestamp='2016-09-09T05:48:00Z'>05:48</time></a>
&lt;<span class='nick nick-10'> GitHub170</span>&gt;
[bitcoin] laanwj pushed 3 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/17347d6a5915...80a4f21d377a" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/17347d6a5915...80a4f21d377a</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473400080' id='492630'>
<a class='timestamp' href='#492630'><time timestamp='2016-09-09T05:48:00Z'>05:48</time></a>
&lt;<span class='nick nick-10'> GitHub170</span>&gt;
bitcoin/master 34521e4 Pieter Wuille: Do not store witness txn in rejection cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1473400080' id='492631'>
<a class='timestamp' href='#492631'><time timestamp='2016-09-09T05:48:00Z'>05:48</time></a>
&lt;<span class='nick nick-10'> GitHub170</span>&gt;
bitcoin/master ca10a03 instagibbs: Add basic test for IsStandard witness transaction blinding
<br>
</div>

<div class='talk op-msg' data-timestamp='1473400080' id='492632'>
<a class='timestamp' href='#492632'><time timestamp='2016-09-09T05:48:00Z'>05:48</time></a>
&lt;<span class='nick nick-10'> GitHub170</span>&gt;
bitcoin/master 80a4f21 Wladimir J. van der Laan: Merge #8525: Do not store witness txn in rejection cache...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473400080' id='492633'>
<a class='timestamp' href='#492633'><time timestamp='2016-09-09T05:48:00Z'>05:48</time></a>
&lt;<span class='nick nick-12'> GitHub131</span>&gt;
[bitcoin] laanwj closed pull request #8525: Do not store witness txn in rejection cache (master...nowitnessreject) <a href="https://github.com/bitcoin/bitcoin/pull/8525" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8525</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402360' id='492634'>
<a class='timestamp' href='#492634'><time timestamp='2016-09-09T06:26:00Z'>06:26</time></a>
&lt;<span class='nick nick-8'> GitHub190</span>&gt;
[bitcoin] bitcoinsSG opened pull request #8686: translate to np (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/8686" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8686</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402540' id='492635'>
<a class='timestamp' href='#492635'><time timestamp='2016-09-09T06:29:00Z'>06:29</time></a>
&lt;<span class='nick nick-11'> GitHub50</span>&gt;
[bitcoin] laanwj closed pull request #8686: translate to np (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/8686" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8686</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402840' id='492636'>
<a class='timestamp' href='#492636'><time timestamp='2016-09-09T06:34:00Z'>06:34</time></a>
&lt;<span class='nick nick-14'> GitHub118</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/80a4f21d377a...666eaf03cf25" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/80a4f21d377a...666eaf03cf25</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402840' id='492637'>
<a class='timestamp' href='#492637'><time timestamp='2016-09-09T06:34:00Z'>06:34</time></a>
&lt;<span class='nick nick-14'> GitHub118</span>&gt;
bitcoin/master d6a5dc4 Cory Fields: add waitfornewblock/waitforblock/waitforblockheight rpcs and use them for tests...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402840' id='492638'>
<a class='timestamp' href='#492638'><time timestamp='2016-09-09T06:34:00Z'>06:34</time></a>
&lt;<span class='nick nick-14'> GitHub118</span>&gt;
bitcoin/master 666eaf0 Wladimir J. van der Laan: Merge #8680: Address Travis spurious failures...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473402840' id='492639'>
<a class='timestamp' href='#492639'><time timestamp='2016-09-09T06:34:00Z'>06:34</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
[bitcoin] laanwj closed pull request #8680: Address Travis spurious failures (master...rpc-waitforblock) <a href="https://github.com/bitcoin/bitcoin/pull/8680" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8680</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473403380' id='492640'>
<a class='timestamp' href='#492640'><time timestamp='2016-09-09T06:43:00Z'>06:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: <a href="https://github.com/bitcoin/bitcoin/pull/8371#issuecomment-242719674" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8371#issuecomment-242719674</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473403380' id='492641'>
<a class='timestamp' href='#492641'><time timestamp='2016-09-09T06:43:00Z'>06:43</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
any idea how to detect if a header-tip is to far in the past? Just comparing against &lt;now&gt;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404160' id='492642'>
<a class='timestamp' href='#492642'><time timestamp='2016-09-09T06:56:00Z'>06:56</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
what is the meaning of &quot;false&quot; in return state.DoS(0, false, REJECT_NONSTANDARD, reason) ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404340' id='492643'>
<a class='timestamp' href='#492643'><time timestamp='2016-09-09T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-1'> GitHub91</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/666eaf03cf25...7f8b677aeb79" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/666eaf03cf25...7f8b677aeb79</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404340' id='492644'>
<a class='timestamp' href='#492644'><time timestamp='2016-09-09T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-1'> GitHub91</span>&gt;
bitcoin/master 878faac Anthony Towns: Add configure check for -latomic
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404340' id='492645'>
<a class='timestamp' href='#492645'><time timestamp='2016-09-09T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-1'> GitHub91</span>&gt;
bitcoin/master 7f8b677 Wladimir J. van der Laan: Merge #8563: Add configure check for -latomic...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404340' id='492646'>
<a class='timestamp' href='#492646'><time timestamp='2016-09-09T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-9'> GitHub157</span>&gt;
[bitcoin] laanwj closed pull request #8563: Add configure check for -latomic (master...autoconf-latomic) <a href="https://github.com/bitcoin/bitcoin/pull/8563" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8563</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404520' id='492647'>
<a class='timestamp' href='#492647'><time timestamp='2016-09-09T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
jl2012: I guess this is kind a strange. It let you define your return value.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404520' id='492648'>
<a class='timestamp' href='#492648'><time timestamp='2016-09-09T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
looking at validation.h L45-L48 is looks wrongish
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404580' id='492649'>
<a class='timestamp' href='#492649'><time timestamp='2016-09-09T07:03:00Z'>07:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Meh.. maybe it makes sense like that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404640' id='492650'>
<a class='timestamp' href='#492650'><time timestamp='2016-09-09T07:04:00Z'>07:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Calling the DoS function basically allows you to set the return value of that function.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404640' id='492651'>
<a class='timestamp' href='#492651'><time timestamp='2016-09-09T07:04:00Z'>07:04</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
it&#x27;s to avoid 2 lines
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404700' id='492652'>
<a class='timestamp' href='#492652'><time timestamp='2016-09-09T07:05:00Z'>07:05</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
jonasschnelli: it seems it is always set as false. I can&#x27;t find any example of true
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404820' id='492653'>
<a class='timestamp' href='#492653'><time timestamp='2016-09-09T07:07:00Z'>07:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
jl2012: Indeed. I guess the error() function also resolves to false.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404820' id='492654'>
<a class='timestamp' href='#492654'><time timestamp='2016-09-09T07:07:00Z'>07:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Maybe remove it to increase code readability?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404820' id='492655'>
<a class='timestamp' href='#492655'><time timestamp='2016-09-09T07:07:00Z'>07:07</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
so it&#x27;s just some kind of dead code?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473404880' id='492656'>
<a class='timestamp' href='#492656'><time timestamp='2016-09-09T07:08:00Z'>07:08</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Looks like... though, haven&#x27;t analyzed it in detail
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405060' id='492657'>
<a class='timestamp' href='#492657'><time timestamp='2016-09-09T07:11:00Z'>07:11</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
used to have state.DoS(0, error( some places IIRC
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405120' id='492658'>
<a class='timestamp' href='#492658'><time timestamp='2016-09-09T07:12:00Z'>07:12</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
still do I think
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405360' id='492659'>
<a class='timestamp' href='#492659'><time timestamp='2016-09-09T07:16:00Z'>07:16</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wee, reduced pwalletMain references to 42 lines, half in tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405420' id='492660'>
<a class='timestamp' href='#492660'><time timestamp='2016-09-09T07:17:00Z'>07:17</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
why is nWalletUnlockTime not on CWallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405480' id='492661'>
<a class='timestamp' href='#492661'><time timestamp='2016-09-09T07:18:00Z'>07:18</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
I was thinking that the RPC wallet-calls should include an monochromic increasing nounce:  the only one that I can reliably think of is the &#x27;total blockchain work&#x27; statistic.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405480' id='492662'>
<a class='timestamp' href='#492662'><time timestamp='2016-09-09T07:18:00Z'>07:18</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
block hash and block hight are both not reliable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473405660' id='492663'>
<a class='timestamp' href='#492663'><time timestamp='2016-09-09T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
then the RPC call should guarantee the return values are correct for at least the total work specified; or respond with the error &#x27;not enough total work&#x27;.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406260' id='492664'>
<a class='timestamp' href='#492664'><time timestamp='2016-09-09T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
da2ce7: eh, block hash is always a specific known amount of work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406260' id='492665'>
<a class='timestamp' href='#492665'><time timestamp='2016-09-09T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
using total work would fail to solve issues for reorgs
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406320' id='492666'>
<a class='timestamp' href='#492666'><time timestamp='2016-09-09T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
luke-jr I thought you reorg to the chain that has the &#x27;most total work&#x27;.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406320' id='492667'>
<a class='timestamp' href='#492667'><time timestamp='2016-09-09T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
da2ce7: competing chains often have the same work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406320' id='492668'>
<a class='timestamp' href='#492668'><time timestamp='2016-09-09T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
this is important to at times of difficulty adjustment. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406380' id='492669'>
<a class='timestamp' href='#492669'><time timestamp='2016-09-09T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
two blocks at height X are almost always going to have the same total work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406620' id='492670'>
<a class='timestamp' href='#492670'><time timestamp='2016-09-09T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
except at the case of the edge of a difficulty adjustment?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406680' id='492671'>
<a class='timestamp' href='#492671'><time timestamp='2016-09-09T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406680' id='492672'>
<a class='timestamp' href='#492672'><time timestamp='2016-09-09T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
or an attack
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406680' id='492673'>
<a class='timestamp' href='#492673'><time timestamp='2016-09-09T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(but not all attacks)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406800' id='492674'>
<a class='timestamp' href='#492674'><time timestamp='2016-09-09T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
well it seems like a thing that we should take account of; then the wallet can give out a stronger consistency guarantee
<br>
</div>

<div class='talk op-msg' data-timestamp='1473406980' id='492675'>
<a class='timestamp' href='#492675'><time timestamp='2016-09-09T07:43:00Z'>07:43</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
da2ce7: the problem then is that in some cases, you want the RPC call to execute regardless of what block you&#x27;re at - including the &quot;in between blocks&quot; state
<br>
</div>

<div class='talk op-msg' data-timestamp='1473407100' id='492676'>
<a class='timestamp' href='#492676'><time timestamp='2016-09-09T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-14'> da2ce7</span>&gt;
luke-jr: then if without specifying the nounce the RPC call should return a statement: &quot;this response is accurate for at least X total work&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473407400' id='492677'>
<a class='timestamp' href='#492677'><time timestamp='2016-09-09T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I having a hard time to analyze our main.cpp code how Core is detecting if a peer is not responding to a getheader message... there must be a timeout or something I guess.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408060' id='492678'>
<a class='timestamp' href='#492678'><time timestamp='2016-09-09T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408060' id='492679'>
<a class='timestamp' href='#492679'><time timestamp='2016-09-09T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
search for &#x27;stall&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408120' id='492680'>
<a class='timestamp' href='#492680'><time timestamp='2016-09-09T08:02:00Z'>08:02</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
instagibbs: why does removeprunedfunds call ThreadFlushWalletDB? :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408120' id='492681'>
<a class='timestamp' href='#492681'><time timestamp='2016-09-09T08:02:00Z'>08:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: i searched, but can only link it to block downloads (not to headers)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408120' id='492682'>
<a class='timestamp' href='#492682'><time timestamp='2016-09-09T08:02:00Z'>08:02</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I can&#x27;t imagine that&#x27;s right. It will rename the RPC thread!
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408540' id='492683'>
<a class='timestamp' href='#492683'><time timestamp='2016-09-09T08:09:00Z'>08:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: i don&#x27;t think we have timeouts for headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408600' id='492684'>
<a class='timestamp' href='#492684'><time timestamp='2016-09-09T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but we do ask for headers from multiple peers
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408600' id='492685'>
<a class='timestamp' href='#492685'><time timestamp='2016-09-09T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so it&#x27;s less risky
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408600' id='492686'>
<a class='timestamp' href='#492686'><time timestamp='2016-09-09T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it will continue with a new source once someone else offers it a block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408600' id='492687'>
<a class='timestamp' href='#492687'><time timestamp='2016-09-09T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I was explaining this in #bitcoin two days ago in fact.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408660' id='492688'>
<a class='timestamp' href='#492688'><time timestamp='2016-09-09T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Okay...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408660' id='492689'>
<a class='timestamp' href='#492689'><time timestamp='2016-09-09T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
as it interacts poorly with the large number of fake nodes out there that just monitor transaction advertisements and don&#x27;t do anything else.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408720' id='492690'>
<a class='timestamp' href='#492690'><time timestamp='2016-09-09T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
we not increase the missbehave score if a node does not response to a getheaders request in an adequate amount of time?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408780' id='492691'>
<a class='timestamp' href='#492691'><time timestamp='2016-09-09T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
seems to be the cheapest method to detect fake nodes... though, keeping a headers-chain is probably simple, but I guess most fake nodes are not willing to implement that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408780' id='492692'>
<a class='timestamp' href='#492692'><time timestamp='2016-09-09T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
that can cause network partioning. just dos attack nodes and peers will ban them.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408840' id='492693'>
<a class='timestamp' href='#492693'><time timestamp='2016-09-09T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
misbehavior score can&#x27;t be just handed out like that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408840' id='492694'>
<a class='timestamp' href='#492694'><time timestamp='2016-09-09T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think we should get rid of misbehaviour score
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408840' id='492695'>
<a class='timestamp' href='#492695'><time timestamp='2016-09-09T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Agreed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408840' id='492696'>
<a class='timestamp' href='#492696'><time timestamp='2016-09-09T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and just have a boolean: bannable offence or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408840' id='492697'>
<a class='timestamp' href='#492697'><time timestamp='2016-09-09T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Right.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408900' id='492698'>
<a class='timestamp' href='#492698'><time timestamp='2016-09-09T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess there are cases where you disconnect but not ban
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408900' id='492699'>
<a class='timestamp' href='#492699'><time timestamp='2016-09-09T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that&#x27;s more for not wanting to deal with a request, and a courtesy to the peer, so he can find someone else
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408960' id='492700'>
<a class='timestamp' href='#492700'><time timestamp='2016-09-09T08:16:00Z'>08:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not for misbehaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1473408960' id='492701'>
<a class='timestamp' href='#492701'><time timestamp='2016-09-09T08:16:00Z'>08:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: headers should come from all network peers, the only real complication with that is the initial headers sync, which you don&#x27;t want to do redundantly as its some 40MB of data or so.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409380' id='492702'>
<a class='timestamp' href='#492702'><time timestamp='2016-09-09T08:23:00Z'>08:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, there is some logic that does not overeagerly send out headers requests during ibd
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409440' id='492703'>
<a class='timestamp' href='#492703'><time timestamp='2016-09-09T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats the only element of headers handling that I&#x27;ve ever seen cause stalls.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409440' id='492704'>
<a class='timestamp' href='#492704'><time timestamp='2016-09-09T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and they recover on new blocks, but it does sometimes causes new users to footgun themselves.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409440' id='492705'>
<a class='timestamp' href='#492705'><time timestamp='2016-09-09T08:24:00Z'>08:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
e.g. they are syncing and they decide it&#x27;s slow, so they restart... and the first peer they get is a black hole... and so they sit there not syncing for a bit.. then decide to reindex.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492706'>
<a class='timestamp' href='#492706'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/7f8b677aeb79...4daf02a03f9e" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/7f8b677aeb79...4daf02a03f9e</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492707'>
<a class='timestamp' href='#492707'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
bitcoin/master 125b946 Pavel JanÃ­k: Do not shadow upper local variable &#x27;send&#x27;, prevent -Wshadow compiler warning.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492708'>
<a class='timestamp' href='#492708'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
bitcoin/master 4daf02a Wladimir J. van der Laan: Merge #8677: Do not shadow upper local variable &#x27;send&#x27;, prevent -Wshadow compiler warning....
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492709'>
<a class='timestamp' href='#492709'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-10'> GitHub48</span>&gt;
[bitcoin] laanwj closed pull request #8677: Do not shadow upper local variable &#x27;send&#x27;, prevent -Wshadow compiler warning. (master...20160907_Wshadow_8606) <a href="https://github.com/bitcoin/bitcoin/pull/8677" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8677</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492710'>
<a class='timestamp' href='#492710'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
<a href="https://bitcoincore.org/en/lifecycle/" class="link" target="_blank">https://bitcoincore.org/en/lifecycle/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492711'>
<a class='timestamp' href='#492711'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
Needs updating
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492712'>
<a class='timestamp' href='#492712'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
[20 minutes later] and as they strap their head to a table and start pushing the drill bit into their temple, some don&#x27;t think that perhaps lobotomizing themselves is too far to go to complete a software install... :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409560' id='492713'>
<a class='timestamp' href='#492713'><time timestamp='2016-09-09T08:26:00Z'>08:26</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
Still has &quot;TBA*&quot; on 0.13.0
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409620' id='492714'>
<a class='timestamp' href='#492714'><time timestamp='2016-09-09T08:27:00Z'>08:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Lauda: thanks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409740' id='492715'>
<a class='timestamp' href='#492715'><time timestamp='2016-09-09T08:29:00Z'>08:29</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
Np.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409800' id='492716'>
<a class='timestamp' href='#492716'><time timestamp='2016-09-09T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: also, i believe we still have the bug that after a reindex finishes, we do not actively start asking pers for headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409800' id='492717'>
<a class='timestamp' href='#492717'><time timestamp='2016-09-09T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wait a minute
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409860' id='492718'>
<a class='timestamp' href='#492718'><time timestamp='2016-09-09T08:31:00Z'>08:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
since the reindex change in 0.13 we already know all headers beforehand
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409860' id='492719'>
<a class='timestamp' href='#492719'><time timestamp='2016-09-09T08:31:00Z'>08:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so we could in fact start asking peers for headers after the first stage
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409860' id='492720'>
<a class='timestamp' href='#492720'><time timestamp='2016-09-09T08:31:00Z'>08:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and learn about new headers while still reindexing blocms from disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1473409920' id='492721'>
<a class='timestamp' href='#492721'><time timestamp='2016-09-09T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t recall what governs the decision between asking only a single peer vs everyone.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410040' id='492722'>
<a class='timestamp' href='#492722'><time timestamp='2016-09-09T08:34:00Z'>08:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
IBD or not, i guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410100' id='492723'>
<a class='timestamp' href='#492723'><time timestamp='2016-09-09T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but this is something else
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410100' id='492724'>
<a class='timestamp' href='#492724'><time timestamp='2016-09-09T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at startup we pick one peer to actively start asking for headwrs, to bootstrap the sync process
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410100' id='492725'>
<a class='timestamp' href='#492725'><time timestamp='2016-09-09T08:35:00Z'>08:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we don&#x27;t do that during reindex, and not after reindex finishes either
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410580' id='492726'>
<a class='timestamp' href='#492726'><time timestamp='2016-09-09T08:43:00Z'>08:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jonasschnelli: re &#x27;detect fake&#x27;-- not reasonable to do, they&#x27;ll just continue to do the bare minimum to not get detected whatever that is. We should focus on being robust (and increasingly so) in the face of abusive peers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410700' id='492727'>
<a class='timestamp' href='#492727'><time timestamp='2016-09-09T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
gmaxwell: Yes. Agree. I haven&#x27;t tested it,... but somehow I had the assumption a peer that signals NODE_NETWORK not does not respond to getheaders messages will result in stalling IBD (if we have chosen that peer for headers sync during IBD).
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410700' id='492728'>
<a class='timestamp' href='#492728'><time timestamp='2016-09-09T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
But I guess I&#x27;m wrong with that assumption.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410700' id='492729'>
<a class='timestamp' href='#492729'><time timestamp='2016-09-09T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Just couldn&#x27;t find the corresponding code part that breaks my assumption
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410760' id='492730'>
<a class='timestamp' href='#492730'><time timestamp='2016-09-09T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it will, until the next block on the network, and then it will select another peer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410940' id='492731'>
<a class='timestamp' href='#492731'><time timestamp='2016-09-09T08:49:00Z'>08:49</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Wouldn&#x27;t a timeout of lets say 30 secs make sense in this case? If timeout fired, select next node for header-sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410940' id='492732'>
<a class='timestamp' href='#492732'><time timestamp='2016-09-09T08:49:00Z'>08:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
30s is extremely short
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410940' id='492733'>
<a class='timestamp' href='#492733'><time timestamp='2016-09-09T08:49:00Z'>08:49</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
for a headers message after a getheaders? Why short?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473410940' id='492734'>
<a class='timestamp' href='#492734'><time timestamp='2016-09-09T08:49:00Z'>08:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s trivial to dos a peer to make them unresponsive for 30s
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411000' id='492735'>
<a class='timestamp' href='#492735'><time timestamp='2016-09-09T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Would you care switching to the next header sync peer in case your DOSed?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411000' id='492736'>
<a class='timestamp' href='#492736'><time timestamp='2016-09-09T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and it also means you couldn&#x27;t use bitcoin anymore on a connection of less than about 50kbit/sec which, otherwise, could keep up with the chain.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411000' id='492737'>
<a class='timestamp' href='#492737'><time timestamp='2016-09-09T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
during IBD that&#x27;s fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411060' id='492738'>
<a class='timestamp' href='#492738'><time timestamp='2016-09-09T08:51:00Z'>08:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(as the first header response will be 160kb of data, 30 second timeout means the minimum usable bandwidth around 50kbit/sec.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411060' id='492739'>
<a class='timestamp' href='#492739'><time timestamp='2016-09-09T08:51:00Z'>08:51</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. The bandwith / timeout problems still appears...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492740'>
<a class='timestamp' href='#492740'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
even just switching that fast would mean that a host with borderline bandwith you would livelock requesting the same data over again and changing peers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492741'>
<a class='timestamp' href='#492741'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I have a peer right now ping wait over 300s
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492742'>
<a class='timestamp' href='#492742'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: that one is probably not actually working.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492743'>
<a class='timestamp' href='#492743'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
though I do frequently have working peers with rather high pingtimes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492744'>
<a class='timestamp' href='#492744'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: it&#x27;s responded to pings before?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492745'>
<a class='timestamp' href='#492745'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
connected 3 hours, last ping time 227s
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492746'>
<a class='timestamp' href='#492746'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: I mean it&#x27;s probably fallen off the network.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411120' id='492747'>
<a class='timestamp' href='#492747'><time timestamp='2016-09-09T08:52:00Z'>08:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hm
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411180' id='492748'>
<a class='timestamp' href='#492748'><time timestamp='2016-09-09T08:53:00Z'>08:53</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
debug window claims it&#x27;s got the best block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411300' id='492749'>
<a class='timestamp' href='#492749'><time timestamp='2016-09-09T08:55:00Z'>08:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
    &quot;minping&quot;: 21.978129,
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411300' id='492750'>
<a class='timestamp' href='#492750'><time timestamp='2016-09-09T08:55:00Z'>08:55</time></a>
&lt;<span class='nick nick-1'> GitHub91</span>&gt;
[bitcoin] luke-jr opened pull request #8687: Bugfix: RPC/Wallet: removeprunedfunds should flush the wallet db (master...bugfix_removeprunedfunds) <a href="https://github.com/bitcoin/bitcoin/pull/8687" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8687</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411600' id='492751'>
<a class='timestamp' href='#492751'><time timestamp='2016-09-09T09:00:00Z'>09:00</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/blob/a6a860796a44a2805a58391a009ba22752f64e32/src/secp256k1/src/eckey_impl.h#L17" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/a6a860796a44a2805a58391a009ba22752f64e32/src/secp256k1/src/eckey_impl.h#L17</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411600' id='492752'>
<a class='timestamp' href='#492752'><time timestamp='2016-09-09T09:00:00Z'>09:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I wish we could control the number of headers retured by getheaders in that initial case... as the obvious thing to do is request a tiny amount from every peer. Then pick among the responses, and keep doubling the request size, requesting from a single peer, so long as the replies are sufficiently fast. Then a short timeout would be fine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411660' id='492753'>
<a class='timestamp' href='#492753'><time timestamp='2016-09-09T09:01:00Z'>09:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jl2012: yes, thats an internal function in libsecp256k1. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411660' id='492754'>
<a class='timestamp' href='#492754'><time timestamp='2016-09-09T09:01:00Z'>09:01</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
^ sipa: if the pubkey does not pass this test, the verify must return 0?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473411780' id='492755'>
<a class='timestamp' href='#492755'><time timestamp='2016-09-09T09:03:00Z'>09:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jl2012: a pubkey that fails that test will never result in a passing signature validation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473412020' id='492756'>
<a class='timestamp' href='#492756'><time timestamp='2016-09-09T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jl2012: if that functioms returns 1 there always exists some valid signature/message pairs
<br>
</div>

<div class='talk op-msg' data-timestamp='1473412080' id='492757'>
<a class='timestamp' href='#492757'><time timestamp='2016-09-09T09:08:00Z'>09:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jl2iif it returns 0, no signature can verify
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413400' id='492758'>
<a class='timestamp' href='#492758'><time timestamp='2016-09-09T09:30:00Z'>09:30</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
so P2WPKH has an implicit requirement for key size 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413460' id='492759'>
<a class='timestamp' href='#492759'><time timestamp='2016-09-09T09:31:00Z'>09:31</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
pub[0] == 0x06 || pub[0] == 0x07 are so called &quot;hybrid key&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413520' id='492760'>
<a class='timestamp' href='#492760'><time timestamp='2016-09-09T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413520' id='492761'>
<a class='timestamp' href='#492761'><time timestamp='2016-09-09T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
afaik, never used on mainnet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413580' id='492762'>
<a class='timestamp' href='#492762'><time timestamp='2016-09-09T09:33:00Z'>09:33</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
should we make keys not 33 bytes non standard in segwit?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413640' id='492763'>
<a class='timestamp' href='#492763'><time timestamp='2016-09-09T09:34:00Z'>09:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think there is any reason not to
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413640' id='492764'>
<a class='timestamp' href='#492764'><time timestamp='2016-09-09T09:34:00Z'>09:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that should be communicated
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413700' id='492765'>
<a class='timestamp' href='#492765'><time timestamp='2016-09-09T09:35:00Z'>09:35</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
i&#x27;ll post it the ML with all other segwit standard limits
<br>
</div>

<div class='talk op-msg' data-timestamp='1473413700' id='492766'>
<a class='timestamp' href='#492766'><time timestamp='2016-09-09T09:35:00Z'>09:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
great
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414720' id='492767'>
<a class='timestamp' href='#492767'><time timestamp='2016-09-09T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
[bitcoin] laanwj pushed 34 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/4daf02a03f9e...6423116741de" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/4daf02a03f9e...6423116741de</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414720' id='492768'>
<a class='timestamp' href='#492768'><time timestamp='2016-09-09T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
bitcoin/master 531214f Cory Fields: gui: add NodeID to the peer table
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414720' id='492769'>
<a class='timestamp' href='#492769'><time timestamp='2016-09-09T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
bitcoin/master d93b14d Cory Fields: net: move CBanDB and CAddrDB out of net.h/cpp...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414720' id='492770'>
<a class='timestamp' href='#492770'><time timestamp='2016-09-09T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
bitcoin/master cd16f48 Cory Fields: net: Create CConnman to encapsulate p2p connections
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414720' id='492771'>
<a class='timestamp' href='#492771'><time timestamp='2016-09-09T09:52:00Z'>09:52</time></a>
&lt;<span class='nick nick-15'> GitHub100</span>&gt;
[bitcoin] laanwj closed pull request #8085: p2p: Begin encapsulation (master...net-refactor13) <a href="https://github.com/bitcoin/bitcoin/pull/8085" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8085</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473414780' id='492772'>
<a class='timestamp' href='#492772'><time timestamp='2016-09-09T09:53:00Z'>09:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
\o/
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415260' id='492773'>
<a class='timestamp' href='#492773'><time timestamp='2016-09-09T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-6'> GitHub198</span>&gt;
[bitcoin] laanwj closed pull request #8679: [0.13] Various backports (0.13...backports_0.13) <a href="https://github.com/bitcoin/bitcoin/pull/8679" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8679</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415260' id='492774'>
<a class='timestamp' href='#492774'><time timestamp='2016-09-09T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-10'> GitHub48</span>&gt;
[bitcoin] laanwj pushed 13 new commits to 0.13: <a href="https://github.com/bitcoin/bitcoin/compare/122fdfdae915...32269449185d" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/122fdfdae915...32269449185d</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415260' id='492775'>
<a class='timestamp' href='#492775'><time timestamp='2016-09-09T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-10'> GitHub48</span>&gt;
bitcoin/0.13 75f2065 Wladimir J. van der Laan: build: Remove check for `openssl/ec.h`...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415260' id='492776'>
<a class='timestamp' href='#492776'><time timestamp='2016-09-09T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-10'> GitHub48</span>&gt;
bitcoin/0.13 1db3352 Wladimir J. van der Laan: qt: Fix random segfault when closing &quot;Choose data directory&quot; dialog...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415260' id='492777'>
<a class='timestamp' href='#492777'><time timestamp='2016-09-09T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-10'> GitHub48</span>&gt;
bitcoin/0.13 2611ad7 Ethan Heilman: Added feeler connections increasing good addrs in the tried table....
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415500' id='492778'>
<a class='timestamp' href='#492778'><time timestamp='2016-09-09T10:05:00Z'>10:05</time></a>
&lt;<span class='nick nick-7'> GitHub90</span>&gt;
[bitcoin] laanwj pushed 1 new commit to 0.13: <a href="https://github.com/bitcoin/bitcoin/commit/a9429ca26dd8f4555def2dc8bd8ea7fc4e32fce6" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/a9429ca26dd8f4555def2dc8bd8ea7fc4e32fce6</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415500' id='492779'>
<a class='timestamp' href='#492779'><time timestamp='2016-09-09T10:05:00Z'>10:05</time></a>
&lt;<span class='nick nick-7'> GitHub90</span>&gt;
bitcoin/0.13 a9429ca Pieter Wuille: Reduce default number of blocks to check at startup...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415500' id='492780'>
<a class='timestamp' href='#492780'><time timestamp='2016-09-09T10:05:00Z'>10:05</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
wumpus: I always wondered if you need the &quot;Rebased-From:&quot; comment in backports
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415500' id='492781'>
<a class='timestamp' href='#492781'><time timestamp='2016-09-09T10:05:00Z'>10:05</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
MarcoFalke: it helps a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415560' id='492782'>
<a class='timestamp' href='#492782'><time timestamp='2016-09-09T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it would be nice to have some script to do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415560' id='492783'>
<a class='timestamp' href='#492783'><time timestamp='2016-09-09T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if not I have to expand the pulls manually
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415560' id='492784'>
<a class='timestamp' href='#492784'><time timestamp='2016-09-09T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-15'> GitHub149</span>&gt;
[bitcoin] laanwj closed pull request #8646: [0.13 backport] Reduce default number of blocks to check at startup (0.13...reduceblocks_backport) <a href="https://github.com/bitcoin/bitcoin/pull/8646" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8646</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415560' id='492785'>
<a class='timestamp' href='#492785'><time timestamp='2016-09-09T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(or not, and leave it as &#x27;backport&#x27; in the release notes)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415560' id='492786'>
<a class='timestamp' href='#492786'><time timestamp='2016-09-09T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but that doesn&#x27;t make reading it any easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415620' id='492787'>
<a class='timestamp' href='#492787'><time timestamp='2016-09-09T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, it would be useful to have a script for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415680' id='492788'>
<a class='timestamp' href='#492788'><time timestamp='2016-09-09T10:08:00Z'>10:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I never bothered, top-level commits have to be signed anyhow, so I can just as well add in the metadata
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415740' id='492789'>
<a class='timestamp' href='#492789'><time timestamp='2016-09-09T10:09:00Z'>10:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but if the idea is to have more &#x27;nested&#x27; PRs which backport other PRs, then a script would sure be handy
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415800' id='492790'>
<a class='timestamp' href='#492790'><time timestamp='2016-09-09T10:10:00Z'>10:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(which makes sense if the code is substantially different)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415800' id='492791'>
<a class='timestamp' href='#492791'><time timestamp='2016-09-09T10:10:00Z'>10:10</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I have a script that does it. Sortof.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415800' id='492792'>
<a class='timestamp' href='#492792'><time timestamp='2016-09-09T10:10:00Z'>10:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if it applies cleanly, please just cherry-pick to the tip of the branch w/ added Github-Pull: #8611 header
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415800' id='492793'>
<a class='timestamp' href='#492793'><time timestamp='2016-09-09T10:10:00Z'>10:10</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
<a href="http://codepad.org/DRsESBYb" class="link" target="_blank">http://codepad.org/DRsESBYb</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415860' id='492794'>
<a class='timestamp' href='#492794'><time timestamp='2016-09-09T10:11:00Z'>10:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and Rebased-From if appropriate
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415860' id='492795'>
<a class='timestamp' href='#492795'><time timestamp='2016-09-09T10:11:00Z'>10:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
cool luke-jr
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415860' id='492796'>
<a class='timestamp' href='#492796'><time timestamp='2016-09-09T10:11:00Z'>10:11</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
the github pull # isn&#x27;t actually optional
<br>
</div>

<div class='talk op-msg' data-timestamp='1473415980' id='492797'>
<a class='timestamp' href='#492797'><time timestamp='2016-09-09T10:13:00Z'>10:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes the pull # is the most important part, the Rebased-From commit ids are optional / nice to know for cross-referencing, I don&#x27;t use it for the release notes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473416640' id='492798'>
<a class='timestamp' href='#492798'><time timestamp='2016-09-09T10:24:00Z'>10:24</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/6423116741de...2abfe5956eef" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/6423116741de...2abfe5956eef</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473416640' id='492799'>
<a class='timestamp' href='#492799'><time timestamp='2016-09-09T10:24:00Z'>10:24</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
bitcoin/master c40b034 Suhas Daftuar: Clear witness with vin/vout in CWallet::CreateTransaction()
<br>
</div>

<div class='talk op-msg' data-timestamp='1473416640' id='492800'>
<a class='timestamp' href='#492800'><time timestamp='2016-09-09T10:24:00Z'>10:24</time></a>
&lt;<span class='nick nick-7'> GitHub33</span>&gt;
bitcoin/master 2abfe59 Wladimir J. van der Laan: Merge #8664: Fix segwit-related wallet bug...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473416700' id='492801'>
<a class='timestamp' href='#492801'><time timestamp='2016-09-09T10:25:00Z'>10:25</time></a>
&lt;<span class='nick nick-2'> GitHub43</span>&gt;
[bitcoin] laanwj closed pull request #8664: Fix segwit-related wallet bug (master...segwit-wallet-bug) <a href="https://github.com/bitcoin/bitcoin/pull/8664" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8664</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473418080' id='492802'>
<a class='timestamp' href='#492802'><time timestamp='2016-09-09T10:48:00Z'>10:48</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
would be nice to have a test case for this ^
<br>
</div>

<div class='talk op-msg' data-timestamp='1473418260' id='492803'>
<a class='timestamp' href='#492803'><time timestamp='2016-09-09T10:51:00Z'>10:51</time></a>
&lt;<span class='nick nick-10'> GitHub126</span>&gt;
[bitcoin] sipa opened pull request #8688: Move static global randomizer seeds into CConnman (master...detrandconnman) <a href="https://github.com/bitcoin/bitcoin/pull/8688" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8688</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473421260' id='492804'>
<a class='timestamp' href='#492804'><time timestamp='2016-09-09T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
[bitcoin] sipa pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2abfe5956eef...689821340981" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2abfe5956eef...689821340981</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473421260' id='492805'>
<a class='timestamp' href='#492805'><time timestamp='2016-09-09T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
bitcoin/master ec81881 Jeremy Rubin: Performance Regression Fix: Pre-Allocate txChanged vector
<br>
</div>

<div class='talk op-msg' data-timestamp='1473421260' id='492806'>
<a class='timestamp' href='#492806'><time timestamp='2016-09-09T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-3'> GitHub163</span>&gt;
bitcoin/master 6898213 Pieter Wuille: Merge #8681: Performance Regression Fix: Pre-Allocate txChanged vector...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473421260' id='492807'>
<a class='timestamp' href='#492807'><time timestamp='2016-09-09T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-6'> GitHub34</span>&gt;
[bitcoin] sipa closed pull request #8681: Performance Regression Fix: Pre-Allocate txChanged vector (master...fix-perf-regressed-txChanged) <a href="https://github.com/bitcoin/bitcoin/pull/8681" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8681</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473423360' id='492808'>
<a class='timestamp' href='#492808'><time timestamp='2016-09-09T12:16:00Z'>12:16</time></a>
&lt;<span class='nick nick-5'> GitHub103</span>&gt;
[bitcoin] sipa opened pull request #8690: Use a heap to not fully sort all nodes for addr relay (master...heapaddrsort) <a href="https://github.com/bitcoin/bitcoin/pull/8690" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8690</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473424440' id='492809'>
<a class='timestamp' href='#492809'><time timestamp='2016-09-09T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-5'> GitHub155</span>&gt;
[bitcoin] jonasschnelli pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/689821340981...702e6e059b3d" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/689821340981...702e6e059b3d</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473424440' id='492810'>
<a class='timestamp' href='#492810'><time timestamp='2016-09-09T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-5'> GitHub155</span>&gt;
bitcoin/master 0480293 Jonas Schnelli: [Qt][CoinControl] fix UI bug that could result in paying unexpected fee
<br>
</div>

<div class='talk op-msg' data-timestamp='1473424440' id='492811'>
<a class='timestamp' href='#492811'><time timestamp='2016-09-09T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-5'> GitHub155</span>&gt;
bitcoin/master 702e6e0 Jonas Schnelli: Merge #8678: [Qt][CoinControl] fix UI bug that could result in paying unexpected fee...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473424440' id='492812'>
<a class='timestamp' href='#492812'><time timestamp='2016-09-09T12:34:00Z'>12:34</time></a>
&lt;<span class='nick nick-14'> GitHub17</span>&gt;
[bitcoin] jonasschnelli closed pull request #8678: [Qt][CoinControl] fix UI bug that could result in paying unexpected fee (master...2016/09/qt_cc_ui_radrio_fix) <a href="https://github.com/bitcoin/bitcoin/pull/8678" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8678</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473427560' id='492813'>
<a class='timestamp' href='#492813'><time timestamp='2016-09-09T13:26:00Z'>13:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i may be thoroughly confusing myself, but once you made the change to track explicit conflicts.  was it any longer necessary to have the SyncWithWallets loop run on txConflicted?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473427620' id='492814'>
<a class='timestamp' href='#492814'><time timestamp='2016-09-09T13:27:00Z'>13:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems like that code actively does the wrong thing now, but its ok since its corrected by the loop immediately following which calls SyncWithWallets on the in block txs which will then call your MarkConflicted code
<br>
</div>

<div class='talk op-msg' data-timestamp='1473427680' id='492815'>
<a class='timestamp' href='#492815'><time timestamp='2016-09-09T13:28:00Z'>13:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
of course if we could see mid block state, then that would be bad.  But if it is true that we can just remove the txConflicted updates, then maybe that problem goes away?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473427980' id='492816'>
<a class='timestamp' href='#492816'><time timestamp='2016-09-09T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: txConflicted... that&#x27;s the thing used for malleability detection?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473427980' id='492817'>
<a class='timestamp' href='#492817'><time timestamp='2016-09-09T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or you mean the txConflicted in the block connection logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428040' id='492818'>
<a class='timestamp' href='#492818'><time timestamp='2016-09-09T13:34:00Z'>13:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
block connection logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428280' id='492819'>
<a class='timestamp' href='#492819'><time timestamp='2016-09-09T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it appears to me that both removeForBlock and AddToWalletIfInvolvingMe try to do the same thing, which is find conflicting txs.  In removeForBlock (at least in the block connection logic) this is used to build a vector txConflicted, which we then call SyncWithWallets with (essentially with a null hashBlock).
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428280' id='492820'>
<a class='timestamp' href='#492820'><time timestamp='2016-09-09T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Thats actually the wrong way to mark something conflicted now
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428280' id='492821'>
<a class='timestamp' href='#492821'><time timestamp='2016-09-09T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but maybe i&#x27;m getting confused
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428400' id='492822'>
<a class='timestamp' href='#492822'><time timestamp='2016-09-09T13:40:00Z'>13:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
txConflicted (iirc, not looking at the code) is just transactions that used to be confirmed which go back to being unconfirmed after the reorg
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428460' id='492823'>
<a class='timestamp' href='#492823'><time timestamp='2016-09-09T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, no, which were in the mempool and are removed due to being in conflict with the new change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428460' id='492824'>
<a class='timestamp' href='#492824'><time timestamp='2016-09-09T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe you are right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428580' id='492825'>
<a class='timestamp' href='#492825'><time timestamp='2016-09-09T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
trying to think whether one of the approaches can subsume the other
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428640' id='492826'>
<a class='timestamp' href='#492826'><time timestamp='2016-09-09T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m having trouble figuring out why we ever needed the SyncWithWallets(txConflicted)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428700' id='492827'>
<a class='timestamp' href='#492827'><time timestamp='2016-09-09T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, there may be conflicts that are only obvious once you take dependencies through the mempool into account
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428700' id='492828'>
<a class='timestamp' href='#492828'><time timestamp='2016-09-09T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the wallet&#x27;s internal conflict detection code can only work when the disconnected chain is entirely inside the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428700' id='492829'>
<a class='timestamp' href='#492829'><time timestamp='2016-09-09T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428760' id='492830'>
<a class='timestamp' href='#492830'><time timestamp='2016-09-09T13:46:00Z'>13:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it may make sense to keep the wallet&#x27;s internal code as well, as i think it&#x27;s more robust (it can also track things that are temporarily removed from the mempool), and it would keep working in a hypothetical spv mode
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428820' id='492831'>
<a class='timestamp' href='#492831'><time timestamp='2016-09-09T13:47:00Z'>13:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i guess we do need to mark the things from txConflicted as actually conflicted
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428820' id='492832'>
<a class='timestamp' href='#492832'><time timestamp='2016-09-09T13:47:00Z'>13:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not just as unconfirmed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428880' id='492833'>
<a class='timestamp' href='#492833'><time timestamp='2016-09-09T13:48:00Z'>13:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i&#x27;m not sure that&#x27;s very doable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428940' id='492834'>
<a class='timestamp' href='#492834'><time timestamp='2016-09-09T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
how so?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428940' id='492835'>
<a class='timestamp' href='#492835'><time timestamp='2016-09-09T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well, i don&#x27;t think we&#x27;ve really ever tracked that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428940' id='492836'>
<a class='timestamp' href='#492836'><time timestamp='2016-09-09T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
prior to your conflict change
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428940' id='492837'>
<a class='timestamp' href='#492837'><time timestamp='2016-09-09T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think we can?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473428940' id='492838'>
<a class='timestamp' href='#492838'><time timestamp='2016-09-09T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we know what block caused the conflict
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429000' id='492839'>
<a class='timestamp' href='#492839'><time timestamp='2016-09-09T13:50:00Z'>13:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it was txs that were no longer in the mempool that were viewed as conflicted, it didn&#x27;t really matter that you&#x27;d called SyncWithWallets(txConflicted)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429000' id='492840'>
<a class='timestamp' href='#492840'><time timestamp='2016-09-09T13:50:00Z'>13:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, but i think we can make it work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429060' id='492841'>
<a class='timestamp' href='#492841'><time timestamp='2016-09-09T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but how would you ever know if it became unconflicted
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429060' id='492842'>
<a class='timestamp' href='#492842'><time timestamp='2016-09-09T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
when the block it conflicts with is no longer in the active chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429120' id='492843'>
<a class='timestamp' href='#492843'><time timestamp='2016-09-09T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe that&#x27;s what the negative confirmation logic already does
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429120' id='492844'>
<a class='timestamp' href='#492844'><time timestamp='2016-09-09T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
perhaps you are right...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429300' id='492845'>
<a class='timestamp' href='#492845'><time timestamp='2016-09-09T13:55:00Z'>13:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we remember either the block which contains the transaction, or the first block that directly or indirectly conflicts with it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429360' id='492846'>
<a class='timestamp' href='#492846'><time timestamp='2016-09-09T13:56:00Z'>13:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then we count the number of confirmations on that block, and negate the number if it&#x27;s a conflict
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429480' id='492847'>
<a class='timestamp' href='#492847'><time timestamp='2016-09-09T13:58:00Z'>13:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
when we disconnect a block, where do we go back and reevaluate things that might have conflicted with the now disconnected txs?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429540' id='492848'>
<a class='timestamp' href='#492848'><time timestamp='2016-09-09T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we don&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429540' id='492849'>
<a class='timestamp' href='#492849'><time timestamp='2016-09-09T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is no need, i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429540' id='492850'>
<a class='timestamp' href='#492850'><time timestamp='2016-09-09T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the confirmations are always calculated based on the current best chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429600' id='492851'>
<a class='timestamp' href='#492851'><time timestamp='2016-09-09T14:00:00Z'>14:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ah, i guess what there is a need for is to mark the cached credits/debits as dirty though right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429600' id='492852'>
<a class='timestamp' href='#492852'><time timestamp='2016-09-09T14:00:00Z'>14:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so if that disconnected block was the one that conflicted with a transaction, the confirmations for that tx will go from -n to 0 afterwarfs
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429600' id='492853'>
<a class='timestamp' href='#492853'><time timestamp='2016-09-09T14:00:00Z'>14:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, we may need dirtymarking
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429660' id='492854'>
<a class='timestamp' href='#492854'><time timestamp='2016-09-09T14:01:00Z'>14:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, all very confusing...  we probably need to comment this way better
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429720' id='492855'>
<a class='timestamp' href='#492855'><time timestamp='2016-09-09T14:02:00Z'>14:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429720' id='492856'>
<a class='timestamp' href='#492856'><time timestamp='2016-09-09T14:02:00Z'>14:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it was a relatively short notice change after the mempool eviction had been implemented
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429720' id='492857'>
<a class='timestamp' href='#492857'><time timestamp='2016-09-09T14:02:00Z'>14:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we haven&#x27;t really revisited it since
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429780' id='492858'>
<a class='timestamp' href='#492858'><time timestamp='2016-09-09T14:03:00Z'>14:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
hmm, so to summarize, even in 0.13, there is a problem right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429780' id='492859'>
<a class='timestamp' href='#492859'><time timestamp='2016-09-09T14:03:00Z'>14:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if you have a mempool tx which is conflicted only via a chain of mempool txs...  then the wallet code won&#x27;t catch it to mark it properly conflicted, so it&#x27;ll just get marked with a null hash block which in the 0.13 code does not make the balance available again
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429840' id='492860'>
<a class='timestamp' href='#492860'><time timestamp='2016-09-09T14:04:00Z'>14:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if that is true, it is probably 1) infrequent and 2) also wrong in 0.12
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429840' id='492861'>
<a class='timestamp' href='#492861'><time timestamp='2016-09-09T14:04:00Z'>14:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
agreed and agreed, but damn annoying when it happens.  :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429900' id='492862'>
<a class='timestamp' href='#492862'><time timestamp='2016-09-09T14:05:00Z'>14:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it also seems easy to fix, but probably hard to test
<br>
</div>

<div class='talk op-msg' data-timestamp='1473429900' id='492863'>
<a class='timestamp' href='#492863'><time timestamp='2016-09-09T14:05:00Z'>14:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i will probably not have much time next week to look at things
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430020' id='492864'>
<a class='timestamp' href='#492864'><time timestamp='2016-09-09T14:07:00Z'>14:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, i&#x27;m not sure i will either, but i&#x27;ll make an issue for it at least...   
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430080' id='492865'>
<a class='timestamp' href='#492865'><time timestamp='2016-09-09T14:08:00Z'>14:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sdaftuar thinks we may have already known about this, i remember we knew that it was hard to correctly identify chains of txs that should be marked conflicted, but didn&#x27;t remember it cause a (re)spendability problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430080' id='492866'>
<a class='timestamp' href='#492866'><time timestamp='2016-09-09T14:08:00Z'>14:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it was known to me there were potential issues with chains outside of the wallet... but i think i considered it a best effort thing
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430140' id='492867'>
<a class='timestamp' href='#492867'><time timestamp='2016-09-09T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and it is... if the chain gets broken due to eviction, it stops working too
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430260' id='492868'>
<a class='timestamp' href='#492868'><time timestamp='2016-09-09T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess the novel thing is that the current code is mostly a no-op (ignoring those edge cases)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430260' id='492869'>
<a class='timestamp' href='#492869'><time timestamp='2016-09-09T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so either we do not care about through-mempool conflicts, and we should just remove the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430260' id='492870'>
<a class='timestamp' href='#492870'><time timestamp='2016-09-09T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or we do, and then we should make it mark dependent txn as actually conflicted
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430440' id='492871'>
<a class='timestamp' href='#492871'><time timestamp='2016-09-09T14:14:00Z'>14:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, i think i agree with all that.  i also think that the mid-block state is a bigger concern here, b/c then the existing code might be worse than a no-op.  also aside from the mid-block state, the existing code might be worse than a no-op in the event that you&#x27;ve abandoned a tx, and then it&#x27;s marked unabandoned if it gets conflicted via a mempool only chain.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473430500' id='492872'>
<a class='timestamp' href='#492872'><time timestamp='2016-09-09T14:15:00Z'>14:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1473431040' id='492873'>
<a class='timestamp' href='#492873'><time timestamp='2016-09-09T14:24:00Z'>14:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: ok last comment i think and then i&#x27;ll shut up.  the value of that SyncWithWallets(txConflicted) was essentially that it was marking things as dirty, that wouldn&#x27;t have been caught by the wallets own conflict detection code.  B/c it doesn&#x27;t seem like it was ever changing any of the state of the wtx anyway.  Is that right?  that makes it easier to reason about. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473431280' id='492874'>
<a class='timestamp' href='#492874'><time timestamp='2016-09-09T14:28:00Z'>14:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
my head hurts :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473431280' id='492875'>
<a class='timestamp' href='#492875'><time timestamp='2016-09-09T14:28:00Z'>14:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;ll check the code later
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432000' id='492876'>
<a class='timestamp' href='#492876'><time timestamp='2016-09-09T14:40:00Z'>14:40</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
sipa: I think we could not make uncompressed key non-std in segwit, because addwitnessaddress may create adddresses with existing or imported uncompressed keys
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432060' id='492877'>
<a class='timestamp' href='#492877'><time timestamp='2016-09-09T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jl2012: good point, but addwitnessaddress could test for that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432180' id='492878'>
<a class='timestamp' href='#492878'><time timestamp='2016-09-09T14:43:00Z'>14:43</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
it also needs to test pubkeys inside multisig addresses. Would it be too much?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432240' id='492879'>
<a class='timestamp' href='#492879'><time timestamp='2016-09-09T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: ok, take a look at <a href="https://github.com/TheBlueMatt/bitcoin/tree/segwitcb" class="link" target="_blank">https://github.com/TheBlueMatt/bitcoin/tree/segwitcb</a> - removed the boolean and I think simplified some of the logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432240' id='492880'>
<a class='timestamp' href='#492880'><time timestamp='2016-09-09T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the total diff against master is simpler to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432480' id='492881'>
<a class='timestamp' href='#492881'><time timestamp='2016-09-09T14:48:00Z'>14:48</time></a>
&lt;<span class='nick nick-16'> bsm117532</span>&gt;
BlueMatt: you&#x27;re going to be in NYC from Monday, no?  What do you have planned for your &quot;hacker residency&quot; and time here?  I&#x27;d definitely like to swing by since I&#x27;m here and all...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432600' id='492882'>
<a class='timestamp' href='#492882'><time timestamp='2016-09-09T14:50:00Z'>14:50</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
bsm117532: I&#x27;m already here, but, yea, we start on monday...if you want to swing by for a day or two the week after next that&#x27;d be cool
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432660' id='492883'>
<a class='timestamp' href='#492883'><time timestamp='2016-09-09T14:51:00Z'>14:51</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
next week might be tricky since we&#x27;ll be doing a bunch of spin-up and such
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432720' id='492884'>
<a class='timestamp' href='#492884'><time timestamp='2016-09-09T14:52:00Z'>14:52</time></a>
&lt;<span class='nick nick-16'> bsm117532</span>&gt;
We also have a BitDevs meetup next week, I hope you can attend: <a href="https://www.meetup.com/BitDevsNYC/events/233599964/" class="link" target="_blank">https://www.meetup.com/BitDevsNYC/events/233599964/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432720' id='492885'>
<a class='timestamp' href='#492885'><time timestamp='2016-09-09T14:52:00Z'>14:52</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yea, I had it on my mental list to figure out when bitdevs things are and show up for some of them
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432780' id='492886'>
<a class='timestamp' href='#492886'><time timestamp='2016-09-09T14:53:00Z'>14:53</time></a>
&lt;<span class='nick nick-16'> bsm117532</span>&gt;
The following week (Sep 21) a fellow has asked to present the Rootstock whitepaper.  Hopefully I&#x27;ll announce that event today.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473432840' id='492887'>
<a class='timestamp' href='#492887'><time timestamp='2016-09-09T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jl2012: i dislike that a local wallet implementation detail would stand in the way of clearly useful network rule
<br>
</div>

<div class='talk op-msg' data-timestamp='1473433740' id='492888'>
<a class='timestamp' href='#492888'><time timestamp='2016-09-09T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jl2012: I would have no problem if addwitnessaddress failed for uncompressed pubkeys
<br>
</div>

<div class='talk op-msg' data-timestamp='1473433740' id='492889'>
<a class='timestamp' href='#492889'><time timestamp='2016-09-09T15:09:00Z'>15:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
altneratively, we could just compress the pubkey for them, at that point, but thats probably not ideal
<br>
</div>

<div class='talk op-msg' data-timestamp='1473434100' id='492890'>
<a class='timestamp' href='#492890'><time timestamp='2016-09-09T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
is mutlisig the only allowed P2SH address type in wallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473436020' id='492891'>
<a class='timestamp' href='#492891'><time timestamp='2016-09-09T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
is addwitnessaddress the only possible way to create and add a witness address to the wallet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473436500' id='492892'>
<a class='timestamp' href='#492892'><time timestamp='2016-09-09T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe so
<br>
</div>

<div class='talk op-msg' data-timestamp='1473436500' id='492893'>
<a class='timestamp' href='#492893'><time timestamp='2016-09-09T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is createwitnessaddress as well, however
<br>
</div>

<div class='talk op-msg' data-timestamp='1473436560' id='492894'>
<a class='timestamp' href='#492894'><time timestamp='2016-09-09T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which allows computing the address, but does not actually allow soending
<br>
</div>

<div class='talk op-msg' data-timestamp='1473436980' id='492895'>
<a class='timestamp' href='#492895'><time timestamp='2016-09-09T16:03:00Z'>16:03</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
so createwitnessaddress will return an address, even if the script is clearly invalid? (e.g. OP_RETURN)?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437040' id='492896'>
<a class='timestamp' href='#492896'><time timestamp='2016-09-09T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437040' id='492897'>
<a class='timestamp' href='#492897'><time timestamp='2016-09-09T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
so that&#x27;s another problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437100' id='492898'>
<a class='timestamp' href='#492898'><time timestamp='2016-09-09T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think so - createwitnessaddress takes a raw script
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437100' id='492899'>
<a class='timestamp' href='#492899'><time timestamp='2016-09-09T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s a raw tool; we could warn that it does not guarantee it results in a spendable script
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437100' id='492900'>
<a class='timestamp' href='#492900'><time timestamp='2016-09-09T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or just delete it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437100' id='492901'>
<a class='timestamp' href='#492901'><time timestamp='2016-09-09T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-11'> jl2012</span>&gt;
yes, either way
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437280' id='492902'>
<a class='timestamp' href='#492902'><time timestamp='2016-09-09T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
sipa: is there a reason addwitnessaddress doesn&#x27;t add the address to the address book? Any funds sent to those addresses gets counted as change, which is a bit off
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437280' id='492903'>
<a class='timestamp' href='#492903'><time timestamp='2016-09-09T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
odd*
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437340' id='492904'>
<a class='timestamp' href='#492904'><time timestamp='2016-09-09T16:09:00Z'>16:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
instagibbs_: we should fix that too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437400' id='492905'>
<a class='timestamp' href='#492905'><time timestamp='2016-09-09T16:10:00Z'>16:10</time></a>
&lt;<span class='nick nick-11'> instagibbs_</span>&gt;
ok ill PR.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473437820' id='492906'>
<a class='timestamp' href='#492906'><time timestamp='2016-09-09T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-12'> GitHub77</span>&gt;
[bitcoin] instagibbs opened pull request #8693: add witness address to address book (master...addwitbook) <a href="https://github.com/bitcoin/bitcoin/pull/8693" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8693</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473446880' id='492907'>
<a class='timestamp' href='#492907'><time timestamp='2016-09-09T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: sdaftuar: MarcoFalke: re: #8680, i actually think we need to improve the design a bit.  the problem is latestblock can be accessed when it hasn&#x27;t been updated by even the reference node yet?  in practice this doesn&#x27;t happen very often because the python control flow blocks on the reference node completing chain operations, but might happen in a p2p test.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473446940' id='492908'>
<a class='timestamp' href='#492908'><time timestamp='2016-09-09T18:49:00Z'>18:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
In addition invalidateblock (and reconsiderblock?) don&#x27;t even notify latestblock after chain operations are complete, but this i think is fixable separately
<br>
</div>

<div class='talk op-msg' data-timestamp='1473447120' id='492909'>
<a class='timestamp' href='#492909'><time timestamp='2016-09-09T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
It seems like a better overall testing design might be to say sync_blocks(reference_node) where then you call reference_node.getbestblockhash() and then wait for all latest blocks to be at that hash (including at this point waiting for the reference_node to have finished wallet ops)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473447180' id='492910'>
<a class='timestamp' href='#492910'><time timestamp='2016-09-09T18:53:00Z'>18:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but this requires changing all the rpc tests.   it&#x27;s probably the case that reference_node is node0 a very high percentage of the time, but thats a bit of an unintuitive thing to have as a default
<br>
</div>

<div class='talk op-msg' data-timestamp='1473448260' id='492911'>
<a class='timestamp' href='#492911'><time timestamp='2016-09-09T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: on an unrelated note, maxuploadtarget.py is failing now.  i&#x27;m guessing its due to your network refactor?  did you try that test?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473448680' id='492912'>
<a class='timestamp' href='#492912'><time timestamp='2016-09-09T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: yeah, i just checked, the merge of #8085 broke that test. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449160' id='492913'>
<a class='timestamp' href='#492913'><time timestamp='2016-09-09T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: hmm, I was getting that spuriously, but I thought i was seeing it in master as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449220' id='492914'>
<a class='timestamp' href='#492914'><time timestamp='2016-09-09T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
probably crossed wires, though. checking now, thanks for letting me know
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449280' id='492915'>
<a class='timestamp' href='#492915'><time timestamp='2016-09-09T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: re rpc stuff, yea, there&#x27;s lots to fix, i&#x27;m not sure where is the best place to start.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449400' id='492916'>
<a class='timestamp' href='#492916'><time timestamp='2016-09-09T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i think we need to nail down an approach to attack these async issues in general though, rather than reacting to changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449400' id='492917'>
<a class='timestamp' href='#492917'><time timestamp='2016-09-09T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: ha, that was sufficient for me to erase what i just typed. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449460' id='492918'>
<a class='timestamp' href='#492918'><time timestamp='2016-09-09T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449520' id='492919'>
<a class='timestamp' href='#492919'><time timestamp='2016-09-09T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: i started working on more async calls/features, but it all feels so ad-hoc that i&#x27;m having a hard time moving forward
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449520' id='492920'>
<a class='timestamp' href='#492920'><time timestamp='2016-09-09T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i think a design doc is necessary :\
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449700' id='492921'>
<a class='timestamp' href='#492921'><time timestamp='2016-09-09T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think one question we should answer in that design doc is how important it is to fully support invalidateblock and reconsiderblock
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449700' id='492922'>
<a class='timestamp' href='#492922'><time timestamp='2016-09-09T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i consider them unsupported raw emergency tools
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449700' id='492923'>
<a class='timestamp' href='#492923'><time timestamp='2016-09-09T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
originally i thought these were just kind of developer tools, and it wasn&#x27;t maybe necessary that production code worked 100% seamlessly with them
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449760' id='492924'>
<a class='timestamp' href='#492924'><time timestamp='2016-09-09T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
they were introduced because of experience with the march 2013 attack
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449760' id='492925'>
<a class='timestamp' href='#492925'><time timestamp='2016-09-09T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but seems like over time i&#x27;ve heard them being talked of as yeah, tools that we would use in an emergency
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449760' id='492926'>
<a class='timestamp' href='#492926'><time timestamp='2016-09-09T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i seem to find myself using them in tests a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449760' id='492927'>
<a class='timestamp' href='#492927'><time timestamp='2016-09-09T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which to me means they also need to make sure behavior is correct after you use them...  such as if you&#x27;re asking for a balance and you expect it to be after wallet is updated, then that ought to also work for invalidate block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473449880' id='492928'>
<a class='timestamp' href='#492928'><time timestamp='2016-09-09T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: they&#x27;re interesting to me because they break all notions of fencing. And I assume there are other cases, or will be in the future. But it really makes me crave atomicity as a feature.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450000' id='492929'>
<a class='timestamp' href='#492929'><time timestamp='2016-09-09T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
which things feel adhoc about the async stuff?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450060' id='492930'>
<a class='timestamp' href='#492930'><time timestamp='2016-09-09T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I also think of invalidate/revalidate as emergency tools / developer tools, I expected that they&#x27;d cause some misbehavior. OTOH,  I don&#x27;t think there is any fundimental reason why they need to: we already <u>_must_</u> handle reorgs in the system. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450060' id='492931'>
<a class='timestamp' href='#492931'><time timestamp='2016-09-09T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
kanzure: thinking in terms of individual calls rather than a general approach
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450060' id='492932'>
<a class='timestamp' href='#492932'><time timestamp='2016-09-09T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: but a reorg that lowers height is basically impossible
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450120' id='492933'>
<a class='timestamp' href='#492933'><time timestamp='2016-09-09T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i mean if those rpcs break wallet, does anyone give a fuck?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450120' id='492934'>
<a class='timestamp' href='#492934'><time timestamp='2016-09-09T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
3 blocks replaced by 2 blocks at the tip?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450120' id='492935'>
<a class='timestamp' href='#492935'><time timestamp='2016-09-09T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: and reorgs don&#x27;t return control while height is less than prev height
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450120' id='492936'>
<a class='timestamp' href='#492936'><time timestamp='2016-09-09T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
they&#x27;re primarily considered there for mining, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450360' id='492937'>
<a class='timestamp' href='#492937'><time timestamp='2016-09-09T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
anyone who&#x27;s running a wallet and is aware of issues like this enough to want to run invalidateblock shouldnt run invalidateblock - they should stop using their damn wallet until the problem is fixed
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450360' id='492938'>
<a class='timestamp' href='#492938'><time timestamp='2016-09-09T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: reorgs can reduce height, in fact.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450360' id='492939'>
<a class='timestamp' href='#492939'><time timestamp='2016-09-09T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
They commonly do on testnet, but they can on mainnet too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450360' id='492940'>
<a class='timestamp' href='#492940'><time timestamp='2016-09-09T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yeah i know, thats why i said basically
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450420' id='492941'>
<a class='timestamp' href='#492941'><time timestamp='2016-09-09T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh sorry.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450420' id='492942'>
<a class='timestamp' href='#492942'><time timestamp='2016-09-09T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if we forget about where we are and just think about where we want to be
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450420' id='492943'>
<a class='timestamp' href='#492943'><time timestamp='2016-09-09T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what we really might want is a blocking version of a wallet call that takes some hash
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450480' id='492944'>
<a class='timestamp' href='#492944'><time timestamp='2016-09-09T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and then blocks until the work on the wallet chain is &gt;= work on that hash?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450480' id='492945'>
<a class='timestamp' href='#492945'><time timestamp='2016-09-09T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which should then work for all reorgs, but not invalidateblock?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450480' id='492946'>
<a class='timestamp' href='#492946'><time timestamp='2016-09-09T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but maybe matt is right, maybe thats good enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450540' id='492947'>
<a class='timestamp' href='#492947'><time timestamp='2016-09-09T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: yes, that&#x27;s basically what i&#x27;ve arrived at as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450540' id='492948'>
<a class='timestamp' href='#492948'><time timestamp='2016-09-09T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then we could modify the tests to use a simple get bestblockhash on our reference node, and then call the blocking balance calls with that hash
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450540' id='492949'>
<a class='timestamp' href='#492949'><time timestamp='2016-09-09T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
then we&#x27;d have to do something somewhat smart to make tests that use invalidateblock work properly
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450600' id='492950'>
<a class='timestamp' href='#492950'><time timestamp='2016-09-09T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
&lt;cfields&gt; I think the reason today&#x27;s discussion devolved so quickly is because &quot;getblockcount&quot; is impossible to define, because there&#x27;s no global height. So the only fix is to ensure that we&#x27;re asking a specific interface a specific question. Then there&#x27;s no way of being out of sync because you&#x27;ve specified your constraints
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450600' id='492951'>
<a class='timestamp' href='#492951'><time timestamp='2016-09-09T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
at least thats what we want to do if we want to compare balances, if we&#x27;re syncing chains for other reasons, thats fine, we just since the getbestblockhashes
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450660' id='492952'>
<a class='timestamp' href='#492952'><time timestamp='2016-09-09T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yep, i think we agree&#x27;ish
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450660' id='492953'>
<a class='timestamp' href='#492953'><time timestamp='2016-09-09T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: close, but i think that&#x27;s falling into the same trap. What you really want in that case is &quot;tell the wallet to wait for balance x at height y and hash z&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450660' id='492954'>
<a class='timestamp' href='#492954'><time timestamp='2016-09-09T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which part
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450660' id='492955'>
<a class='timestamp' href='#492955'><time timestamp='2016-09-09T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
morcos: would we need to do something smarter for tests? I mean if we get to control what it blocks until isnt that fine?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450720' id='492956'>
<a class='timestamp' href='#492956'><time timestamp='2016-09-09T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
(the missing constraint in yours was the balance itself)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450720' id='492957'>
<a class='timestamp' href='#492957'><time timestamp='2016-09-09T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well i was trying to imagine what might be a useful rpc call in general (and then how would we use that to accomplish the tests goals)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450720' id='492958'>
<a class='timestamp' href='#492958'><time timestamp='2016-09-09T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
in general you might say, oh i know this many blocks have happened
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450720' id='492959'>
<a class='timestamp' href='#492959'><time timestamp='2016-09-09T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i want the wallet to give me the balance as soon as its caught up that far
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450780' id='492960'>
<a class='timestamp' href='#492960'><time timestamp='2016-09-09T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but you have no control if it accidentally proceeds beyond that before you get a chance to ask it
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450780' id='492961'>
<a class='timestamp' href='#492961'><time timestamp='2016-09-09T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which is already the case
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450840' id='492962'>
<a class='timestamp' href='#492962'><time timestamp='2016-09-09T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: invalidate and reconsider do need to do pretty invasive things to the internal data structures (they pretty much iterate over all block index objects and modify values here and there to keep things consistent)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450840' id='492963'>
<a class='timestamp' href='#492963'><time timestamp='2016-09-09T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-16'> * BlueMatt</span>&gt;
missed a bunch of discussion, but what happened to &quot;wallet rpc calls, by default, block until the wallet is up-to-date with the state of the chain at the start of the call, or, if the state of the chain changes and we never reach that point, until the wallet is caught up to the state of the chain&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450900' id='492964'>
<a class='timestamp' href='#492964'><time timestamp='2016-09-09T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: i am not convinced that is necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450960' id='492965'>
<a class='timestamp' href='#492965'><time timestamp='2016-09-09T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
not neccessary in what regard?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473450960' id='492966'>
<a class='timestamp' href='#492966'><time timestamp='2016-09-09T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
not neccessary for tests or not a good idea to target for?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451020' id='492967'>
<a class='timestamp' href='#492967'><time timestamp='2016-09-09T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: it&#x27;s a promise that&#x27;s hard to keep if the wallet becomes more independent
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451020' id='492968'>
<a class='timestamp' href='#492968'><time timestamp='2016-09-09T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe it is necessary, but i am not convinced yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451080' id='492969'>
<a class='timestamp' href='#492969'><time timestamp='2016-09-09T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I dont think its hard to keep?
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451080' id='492970'>
<a class='timestamp' href='#492970'><time timestamp='2016-09-09T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I mean you start wallet calls with &quot;get current chain state&quot; and then wait until the wallet thinks its up to date with that or better before returning
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451140' id='492971'>
<a class='timestamp' href='#492971'><time timestamp='2016-09-09T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well, yes, a huge cost
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451140' id='492972'>
<a class='timestamp' href='#492972'><time timestamp='2016-09-09T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
of course it is easy to implement
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451140' id='492973'>
<a class='timestamp' href='#492973'><time timestamp='2016-09-09T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but it may reduce performance a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451200' id='492974'>
<a class='timestamp' href='#492974'><time timestamp='2016-09-09T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i&#x27;d rather not
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451260' id='492975'>
<a class='timestamp' href='#492975'><time timestamp='2016-09-09T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
anyway, off to have beer
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451320' id='492976'>
<a class='timestamp' href='#492976'><time timestamp='2016-09-09T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i mean, yes, there should be an option to say &quot;actually, only wait until point X&quot;, but it should default to X being the current chainstate when entering the wallet call
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451380' id='492977'>
<a class='timestamp' href='#492977'><time timestamp='2016-09-09T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t know about that
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451380' id='492978'>
<a class='timestamp' href='#492978'><time timestamp='2016-09-09T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that seems like an over-conservative approach that we may regret
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451380' id='492979'>
<a class='timestamp' href='#492979'><time timestamp='2016-09-09T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think that what BlueMatt and I are saying is the same thing.  Although I&#x27;d expose the argument as to what hash you want the wallet to require it is synced up to at least (workwise) and possibly add a default that does what matt suggests
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451440' id='492980'>
<a class='timestamp' href='#492980'><time timestamp='2016-09-09T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but certainly i suppose there should be a just give me what you got version as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451440' id='492981'>
<a class='timestamp' href='#492981'><time timestamp='2016-09-09T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: I mean I think the api change has a lot of cost to users, so would prefer we default to what it does now, though I suppose I donnt care as long as there is a way to easily switch to the original behavior
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451500' id='492982'>
<a class='timestamp' href='#492982'><time timestamp='2016-09-09T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
fair enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451560' id='492983'>
<a class='timestamp' href='#492983'><time timestamp='2016-09-09T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the reason i think it may not be needed os that right now, between any two calls the height can already cjange
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451620' id='492984'>
<a class='timestamp' href='#492984'><time timestamp='2016-09-09T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i don&#x27;t think that the wallet should report a state that is necessarily at the beginning of the call
<br>
</div>

<div class='talk op-msg' data-timestamp='1473451620' id='492985'>
<a class='timestamp' href='#492985'><time timestamp='2016-09-09T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it just needs to be internally consistent and well-ordered with the results of other calls
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454500' id='492986'>
<a class='timestamp' href='#492986'><time timestamp='2016-09-09T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: pretty sure i found the maxupload problem, working on a patch now. thanks again for the ping.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454620' id='492987'>
<a class='timestamp' href='#492987'><time timestamp='2016-09-09T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
heh, fun, if memory allocation fails in script (which it def could), bitcoind will reject the block as an invalid block
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454620' id='492988'>
<a class='timestamp' href='#492988'><time timestamp='2016-09-09T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yay overcommit
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454740' id='492989'>
<a class='timestamp' href='#492989'><time timestamp='2016-09-09T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
actual overcommit will not cause an allocation failure.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454800' id='492990'>
<a class='timestamp' href='#492990'><time timestamp='2016-09-09T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it will cause a crash, which would actually be preferable here. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454800' id='492991'>
<a class='timestamp' href='#492991'><time timestamp='2016-09-09T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
indeed, overcommit is required to run bitcoin core in consensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454860' id='492992'>
<a class='timestamp' href='#492992'><time timestamp='2016-09-09T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
required is a bit too strong, in practice that divergence may be untriggerable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454860' id='492993'>
<a class='timestamp' href='#492993'><time timestamp='2016-09-09T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
true
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454920' id='492994'>
<a class='timestamp' href='#492994'><time timestamp='2016-09-09T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
This can probably be handled with a limited wrapper that catches any unexpected exception inside block validation and asserts.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473454920' id='492995'>
<a class='timestamp' href='#492995'><time timestamp='2016-09-09T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Which I think would be a really good idea, especailly in the short term.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473455040' id='492996'>
<a class='timestamp' href='#492996'><time timestamp='2016-09-09T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
i think in block validation its fine, it will throw out to caller and either give you an exception in rpc or in ProcessMessage
<br>
</div>

<div class='talk op-msg' data-timestamp='1473455100' id='492997'>
<a class='timestamp' href='#492997'><time timestamp='2016-09-09T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but in script we have a general catch
<br>
</div>

<div class='talk op-msg' data-timestamp='1473455100' id='492998'>
<a class='timestamp' href='#492998'><time timestamp='2016-09-09T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
indeed, should probably have a catch for bad_alloc there that does an assert(false)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473455100' id='492999'>
<a class='timestamp' href='#492999'><time timestamp='2016-09-09T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-10'> GitHub57</span>&gt;
[bitcoin] luke-jr opened pull request #8694: Basic multiwallet support (master...multiwallet) <a href="https://github.com/bitcoin/bitcoin/pull/8694" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8694</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473455700' id='493000'>
<a class='timestamp' href='#493000'><time timestamp='2016-09-09T21:15:00Z'>21:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I looked before to see if it was possible to catch bad_alloc process wide, but found nothing. (Also, I don&#x27;t think that would work, because while stepping through with GDB I&#x27;ve seen boost code try to alloc TBs of memory then fail and continue on with life)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456060' id='493001'>
<a class='timestamp' href='#493001'><time timestamp='2016-09-09T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-1'> GitHub64</span>&gt;
[bitcoin] MarcoFalke pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/702e6e059b3d...2a0836f6d5e7" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/702e6e059b3d...2a0836f6d5e7</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456060' id='493002'>
<a class='timestamp' href='#493002'><time timestamp='2016-09-09T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-1'> GitHub64</span>&gt;
bitcoin/master 2f2548d Johnson Lau: Fix SIGHASH_SINGLE bug in test_framework SignatureHash...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456060' id='493003'>
<a class='timestamp' href='#493003'><time timestamp='2016-09-09T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-1'> GitHub64</span>&gt;
bitcoin/master 2a0836f MarcoFalke: Merge #8667: Fix SIGHASH_SINGLE bug in test_framework SignatureHash...
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456060' id='493004'>
<a class='timestamp' href='#493004'><time timestamp='2016-09-09T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-3'> GitHub25</span>&gt;
[bitcoin] MarcoFalke closed pull request #8667: Fix SIGHASH_SINGLE bug in test_framework SignatureHash (master...patch-16) <a href="https://github.com/bitcoin/bitcoin/pull/8667" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8667</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456540' id='493005'>
<a class='timestamp' href='#493005'><time timestamp='2016-09-09T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gmaxwell: lulwut
<br>
</div>

<div class='talk op-msg' data-timestamp='1473456540' id='493006'>
<a class='timestamp' href='#493006'><time timestamp='2016-09-09T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
in any case should probably put a second catch in script interpreter above the catch-all and assert(false) on bad_alloc
<br>
</div>

<div class='talk op-msg' data-timestamp='1473463140' id='493007'>
<a class='timestamp' href='#493007'><time timestamp='2016-09-09T23:19:00Z'>23:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hm. I don&#x27;t understand why my node is attempting feeler connections on IPv when the only v6 ifs I have are ::1 and a link local.
<br>
</div>

<div class='talk op-msg' data-timestamp='1473464520' id='493008'>
<a class='timestamp' href='#493008'><time timestamp='2016-09-09T23:42:00Z'>23:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell: the reachable stuff was largely disabled because it didn&#x27;t work
<br>
</div>

<div class='talk op-msg' data-timestamp='1473464520' id='493009'>
<a class='timestamp' href='#493009'><time timestamp='2016-09-09T23:42:00Z'>23:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
so right now unless something is marked explicitly as unreachable everything is reachable
<br>
</div>

<div class='talk op-msg' data-timestamp='1473464520' id='493010'>
<a class='timestamp' href='#493010'><time timestamp='2016-09-09T23:42:00Z'>23:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(ie you&#x27;re using tor)
<br>
</div>

<div class='talk op-msg' data-timestamp='1473464640' id='493011'>
<a class='timestamp' href='#493011'><time timestamp='2016-09-09T23:44:00Z'>23:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
this is suboptimal. :) at least it probably shouldn&#x27;t think it can connect to IPv6 if I litterally have no IPv6 addresses but local and linklocal.
<br>
</div>

</div>
</section>

</body>
</html>
