<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-08-05
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-08-05' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:26 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-07-05">&lt;</a><span class='header'>   August 2016    </span><a href="/bitcoin-core-dev/2016-09-05">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;    <a class="" href="/bitcoin-core-dev/2016-08-01">1</a>  <a class="" href="/bitcoin-core-dev/2016-08-02">2</a>  <a class="" href="/bitcoin-core-dev/2016-08-03">3</a>  <a class="" href="/bitcoin-core-dev/2016-08-04">4</a>  <a class="current" href="/bitcoin-core-dev/2016-08-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-08-06">6</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-08-07">7</a>  <a class="" href="/bitcoin-core-dev/2016-08-08">8</a>  <a class="" href="/bitcoin-core-dev/2016-08-09">9</a> <a class="" href="/bitcoin-core-dev/2016-08-10">10</a> <a class="" href="/bitcoin-core-dev/2016-08-11">11</a> <a class="" href="/bitcoin-core-dev/2016-08-12">12</a> <a class="" href="/bitcoin-core-dev/2016-08-13">13</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-08-14">14</a> <a class="" href="/bitcoin-core-dev/2016-08-15">15</a> <a class="" href="/bitcoin-core-dev/2016-08-16">16</a> <a class="" href="/bitcoin-core-dev/2016-08-17">17</a> <a class="" href="/bitcoin-core-dev/2016-08-18">18</a> <a class="" href="/bitcoin-core-dev/2016-08-19">19</a> <a class="" href="/bitcoin-core-dev/2016-08-20">20</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-08-21">21</a> <a class="" href="/bitcoin-core-dev/2016-08-22">22</a> <a class="" href="/bitcoin-core-dev/2016-08-23">23</a> <a class="" href="/bitcoin-core-dev/2016-08-24">24</a> <a class="" href="/bitcoin-core-dev/2016-08-25">25</a> <a class="" href="/bitcoin-core-dev/2016-08-26">26</a> <a class="" href="/bitcoin-core-dev/2016-08-27">27</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-08-28">28</a> <a class="" href="/bitcoin-core-dev/2016-08-29">29</a> <a class="" href="/bitcoin-core-dev/2016-08-30">30</a> <a class="" href="/bitcoin-core-dev/2016-08-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1470355200' id='484960'>
<a class='timestamp' href='#484960'><time timestamp='2016-08-05T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar, luke-jr, gmaxwell, wumpus: i believe that downgrading from 0.13.1 to 0.13.0 will just work
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355200' id='484961'>
<a class='timestamp' href='#484961'><time timestamp='2016-08-05T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sdaftuar: even in case of a reorg that takes you back into witness-enabled code
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355200' id='484962'>
<a class='timestamp' href='#484962'><time timestamp='2016-08-05T00:00:00Z'>00:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
s/code/blocks/
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355260' id='484963'>
<a class='timestamp' href='#484963'><time timestamp='2016-08-05T00:01:00Z'>00:01</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
well, that&#x27;s good, I think
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355260' id='484964'>
<a class='timestamp' href='#484964'><time timestamp='2016-08-05T00:01:00Z'>00:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the test that no witness data is present in non-witness blocks is only done in AcceptBlock, not in ConnectBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355320' id='484965'>
<a class='timestamp' href='#484965'><time timestamp='2016-08-05T00:02:00Z'>00:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so we enforce it when receiving the block from somewhere, but not afterwards
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355320' id='484966'>
<a class='timestamp' href='#484966'><time timestamp='2016-08-05T00:02:00Z'>00:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which i think is exactly right
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355320' id='484967'>
<a class='timestamp' href='#484967'><time timestamp='2016-08-05T00:02:00Z'>00:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: what happens if you downgrad then upgrade again?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470355380' id='484968'>
<a class='timestamp' href='#484968'><time timestamp='2016-08-05T00:03:00Z'>00:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: newly added blocks will be rewinded
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358140' id='484969'>
<a class='timestamp' href='#484969'><time timestamp='2016-08-05T00:49:00Z'>00:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: luke-jr: sorry, but i&#x27;m not sure i understand sipa&#x27;s suggested compromise in 8459.  sorry i don&#x27;t remember exactly what the first version was, but i think it makes sense to explain that you don&#x27;t NEED to specify both size and weight, otherwise its just confusing as to how you are supposed to set things up
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358200' id='484970'>
<a class='timestamp' href='#484970'><time timestamp='2016-08-05T00:50:00Z'>00:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
as to making a recommendation whether or not to set size...  i&#x27;m not sure why you say its not worse than 0.12, we don&#x27;t know that.  my guess is that it isn&#x27;t significantly worse now, but it certainly could be post segwit, when you are trying to fit the last tx in a block and you keep trying EVERYTHING b/c the limit thats stopping you isn&#x27;t the consensus limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358260' id='484971'>
<a class='timestamp' href='#484971'><time timestamp='2016-08-05T00:51:00Z'>00:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i do apologize for not testing at least the serialization effect (the other would be tricky to test), but i&#x27;ve been too caught up in trying to figure out why waking up threads is so abysmally slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358320' id='484972'>
<a class='timestamp' href='#484972'><time timestamp='2016-08-05T00:52:00Z'>00:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
it doesn&#x27;t serialise any more than without maxsize AFAIK.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358320' id='484973'>
<a class='timestamp' href='#484973'><time timestamp='2016-08-05T00:52:00Z'>00:52</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
GetSerializeSize doesn&#x27;t serialize
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358440' id='484974'>
<a class='timestamp' href='#484974'><time timestamp='2016-08-05T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ah so its expected that GetSerializeSize is fast?  well that explains why anecdotally its not slower
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358440' id='484975'>
<a class='timestamp' href='#484975'><time timestamp='2016-08-05T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: I thought it was obvious the options were optional.. but if you disagree, I can add perhaps: &quot;Both of these are optional, but at least blockmaxsize ought to be assigned by miners, to determine the largest block they are willing to create.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358440' id='484976'>
<a class='timestamp' href='#484976'><time timestamp='2016-08-05T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
luke-jr: i assume you make suggestions like that on purpose
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358440' id='484977'>
<a class='timestamp' href='#484977'><time timestamp='2016-08-05T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: GetSerializeSize is literally just adding the sizes of each field
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358440' id='484978'>
<a class='timestamp' href='#484978'><time timestamp='2016-08-05T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358500' id='484979'>
<a class='timestamp' href='#484979'><time timestamp='2016-08-05T00:55:00Z'>00:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i expect getserializesize time to be dominated by just memory access of iterating all vectors
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358560' id='484980'>
<a class='timestamp' href='#484980'><time timestamp='2016-08-05T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
luke-jr: you are against what you see as advice in the notes to use weight, but surely you understand that all of us are against advice to limit based on bytes?  if any of us believed that was an issue, we&#x27;d be opposed to segwit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358560' id='484981'>
<a class='timestamp' href='#484981'><time timestamp='2016-08-05T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: it is clearly an issue today. I am shocked that anyone would disagree.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358560' id='484982'>
<a class='timestamp' href='#484982'><time timestamp='2016-08-05T00:56:00Z'>00:56</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
0.13 will hopefully change that with CB, but it isn&#x27;t deployed yet.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358680' id='484983'>
<a class='timestamp' href='#484983'><time timestamp='2016-08-05T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: my view is that at worst it may make block propagation slightly worse, but at the same time it improves utxo storage incentives, which i&#x27;m much more concerned about long term
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358680' id='484984'>
<a class='timestamp' href='#484984'><time timestamp='2016-08-05T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
how about language along the lines of &quot;If a miner wishes to limit the actual size of a block in bytes (as opposed to the consensus weight limit) then it is necessary to specify a blockmaxsize explicitly.  If a miner does not wish to do that, it would be better to only specify a blockmaxweight&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358680' id='484985'>
<a class='timestamp' href='#484985'><time timestamp='2016-08-05T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a small constant factor was never something i opposed for block size. an expectation of it being increased under whatever perceived pressure is
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484986'>
<a class='timestamp' href='#484986'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: that suggests miners ought not to limit size
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484987'>
<a class='timestamp' href='#484987'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think miners ought not to limit size
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484988'>
<a class='timestamp' href='#484988'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
something like that, not exactly &quot;as opposed to&quot; b/c that sounds like you&#x27;re not enforcing the consensus limit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484989'>
<a class='timestamp' href='#484989'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because it&#x27;s unreasonable that all of them will
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484990'>
<a class='timestamp' href='#484990'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
luke-jr: why does that language suggest they ought not limit size.   its just saying that if you dont&#x27; care about a limit on actual size, then its better to not set blockmaxsize.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358740' id='484991'>
<a class='timestamp' href='#484991'><time timestamp='2016-08-05T00:59:00Z'>00:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
which is TRUE
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358800' id='484992'>
<a class='timestamp' href='#484992'><time timestamp='2016-08-05T01:00:00Z'>01:00</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
if they don&#x27;t care, they should set it based on someone&#x27;s recommendation, but not necessarily the big blocker recommendation
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358860' id='484993'>
<a class='timestamp' href='#484993'><time timestamp='2016-08-05T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
if they care about Bitcoin (but not per se enough to research their own opinion on block size limits), they should follow recommendations to set it lower.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358860' id='484994'>
<a class='timestamp' href='#484994'><time timestamp='2016-08-05T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: as a collective, perhaps
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358860' id='484995'>
<a class='timestamp' href='#484995'><time timestamp='2016-08-05T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
brb
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358860' id='484996'>
<a class='timestamp' href='#484996'><time timestamp='2016-08-05T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: there could be a gentlemen&#x27;s agreement not to set it to the maximum immediately
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358860' id='484997'>
<a class='timestamp' href='#484997'><time timestamp='2016-08-05T01:01:00Z'>01:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i believe that&#x27;s unrealistic at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358920' id='484998'>
<a class='timestamp' href='#484998'><time timestamp='2016-08-05T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
&quot;If a miner wishes to limit the actual size of a block in bytes then it is necessary to specify a  blockmaxsize explicitly.  If a miner wishes only to limit block creation by weight (BIP141) regardless of how large in bytes the block is they should only specify a blockmaxweight&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358920' id='484999'>
<a class='timestamp' href='#484999'><time timestamp='2016-08-05T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: every time I brought this up before, I was asked to &quot;wait for the segwit release notes&quot;; now I&#x27;m told it&#x27;s too late?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358920' id='485000'>
<a class='timestamp' href='#485000'><time timestamp='2016-08-05T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m trying to make it as neutral as possible, while explaining the difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358920' id='485001'>
<a class='timestamp' href='#485001'><time timestamp='2016-08-05T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(still brb mode)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358980' id='485002'>
<a class='timestamp' href='#485002'><time timestamp='2016-08-05T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what i don&#x27;t want is a bunch of miners trying to mine max blocks and having a blockmaxsize set (especially after segwit).  and we have to explain in detail enough for that to happen.  i have no objection if they actually want to limit bytes
<br>
</div>

<div class='talk op-msg' data-timestamp='1470358980' id='485003'>
<a class='timestamp' href='#485003'><time timestamp='2016-08-05T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: i can&#x27;t remember ever recommending to wait for release notes. i have told you many times that if you disagree that weight is the limiting factor on the network, you should oppose segwit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359100' id='485004'>
<a class='timestamp' href='#485004'><time timestamp='2016-08-05T01:05:00Z'>01:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: want to think about something different an arcane for a second?   in those checkqueue graphs i presented you, the scriptthreads were busyspinning waiting for work
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359100' id='485005'>
<a class='timestamp' href='#485005'><time timestamp='2016-08-05T01:05:00Z'>01:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i heard
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359160' id='485006'>
<a class='timestamp' href='#485006'><time timestamp='2016-08-05T01:06:00Z'>01:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it slows down the whole thing quite a bit (about 5ms per block) but still a big improvement, if you wake up the scripthreads only when there is work
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359160' id='485007'>
<a class='timestamp' href='#485007'><time timestamp='2016-08-05T01:06:00Z'>01:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
even though it takes only about 100us for them all to wake up, and you can make that happen as early as the start of ConnectTip so they are all awake and busy spinning well before work comes in
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359220' id='485008'>
<a class='timestamp' href='#485008'><time timestamp='2016-08-05T01:07:00Z'>01:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m assuming its the fact that their caches have been blown away, but doesn&#x27;t 5ms seem like a lot?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359280' id='485009'>
<a class='timestamp' href='#485009'><time timestamp='2016-08-05T01:08:00Z'>01:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
just wondering if you had any thoughts..  we&#x27;re still working on it (mostly jeremy, i&#x27;m mostly just testing)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359340' id='485010'>
<a class='timestamp' href='#485010'><time timestamp='2016-08-05T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: is the slowdown as significant when you have fewer threads?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359340' id='485011'>
<a class='timestamp' href='#485011'><time timestamp='2016-08-05T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sadly i didn&#x27;t test that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359400' id='485012'>
<a class='timestamp' href='#485012'><time timestamp='2016-08-05T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359460' id='485013'>
<a class='timestamp' href='#485013'><time timestamp='2016-08-05T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and this is 5ms clock time, not cpu time?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359580' id='485014'>
<a class='timestamp' href='#485014'><time timestamp='2016-08-05T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, 5ms clock time.  it appears from debugging that the scriptthreads are just slower to run.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359760' id='485015'>
<a class='timestamp' href='#485015'><time timestamp='2016-08-05T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i guess if there are many memory locations to access one by one for script validation to run, the effect of not running could be many ram latencies
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359760' id='485016'>
<a class='timestamp' href='#485016'><time timestamp='2016-08-05T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i&#x27;m not sure whether than makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1470359880' id='485017'>
<a class='timestamp' href='#485017'><time timestamp='2016-08-05T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, don&#x27;t worry about it.. its mostly just bugging me.  i realize that it doesn&#x27;t make sense to micro optimize for one architecture anyway, but just trying to understand the effect
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366600' id='485018'>
<a class='timestamp' href='#485018'><time timestamp='2016-08-05T03:10:00Z'>03:10</time></a>
&lt;<span class='nick nick-14'> PatBoy</span>&gt;
thx dev for all ur hard work !
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366660' id='485019'>
<a class='timestamp' href='#485019'><time timestamp='2016-08-05T03:11:00Z'>03:11</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: I do not believe that opposing segwit is a serious suggestion.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366720' id='485020'>
<a class='timestamp' href='#485020'><time timestamp='2016-08-05T03:12:00Z'>03:12</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
morcos: then in the segwit announcement, we can re-evaluate and make recommendations that make sense given the new network conditions
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366780' id='485021'>
<a class='timestamp' href='#485021'><time timestamp='2016-08-05T03:13:00Z'>03:13</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(which might or might not include removing blockmaxsize depending on CB effectiveness and real-world testing)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366900' id='485022'>
<a class='timestamp' href='#485022'><time timestamp='2016-08-05T03:15:00Z'>03:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: miners will set block and weight likely to the maximum... that may be suboptimal, but it&#x27;s inevitable that this is what will happen if segwit goes through
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366900' id='485023'>
<a class='timestamp' href='#485023'><time timestamp='2016-08-05T03:15:00Z'>03:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
people can suggest to not do that... but for centralization risk (which is a long term effect), the important question is now what people do, but what they could do
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366960' id='485024'>
<a class='timestamp' href='#485024'><time timestamp='2016-08-05T03:16:00Z'>03:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*not
<br>
</div>

<div class='talk op-msg' data-timestamp='1470366960' id='485025'>
<a class='timestamp' href='#485025'><time timestamp='2016-08-05T03:16:00Z'>03:16</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: we don&#x27;t know that yet, and our recommendations should always be what is sane even if they get ignored.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367080' id='485026'>
<a class='timestamp' href='#485026'><time timestamp='2016-08-05T03:18:00Z'>03:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: that&#x27;s a reasonable position... but the code is written from a viewpoint that we will get weight-limited block construction
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367080' id='485027'>
<a class='timestamp' href='#485027'><time timestamp='2016-08-05T03:18:00Z'>03:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: and the release notes should describe the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367140' id='485028'>
<a class='timestamp' href='#485028'><time timestamp='2016-08-05T03:19:00Z'>03:19</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
then the code is broken (sabotaged, it sounds like) and fixing it should be considered a blocker for any release.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367140' id='485029'>
<a class='timestamp' href='#485029'><time timestamp='2016-08-05T03:19:00Z'>03:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if that is your viewpoint, then it is segwit that is sabotaged
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367200' id='485030'>
<a class='timestamp' href='#485030'><time timestamp='2016-08-05T03:20:00Z'>03:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i disagree strongly with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367200' id='485031'>
<a class='timestamp' href='#485031'><time timestamp='2016-08-05T03:20:00Z'>03:20</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: do you disagree strongly with 29000050e575a26b7f7c853cbccdb6bc60ddfdd9 for 0.13?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367260' id='485032'>
<a class='timestamp' href='#485032'><time timestamp='2016-08-05T03:21:00Z'>03:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think it&#x27;s pointless
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367260' id='485033'>
<a class='timestamp' href='#485033'><time timestamp='2016-08-05T03:21:00Z'>03:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;re doing busy work to avoid stating reality in release notes
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367260' id='485034'>
<a class='timestamp' href='#485034'><time timestamp='2016-08-05T03:21:00Z'>03:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the reality is that segwit will mean that blocks go over 1 MB
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485035'>
<a class='timestamp' href='#485035'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
reality is that blockmaxsize should be used for today and the near future
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485036'>
<a class='timestamp' href='#485036'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i disagree with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485037'>
<a class='timestamp' href='#485037'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: I think you are not paying attention to reality. Virtually all miners make blocks as large as they can. If at any point they make a block smaller than maximum, angry mobs show up and demand them to make maximum size blocks. Not wanting to deal with such nonsense, they simply do it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485038'>
<a class='timestamp' href='#485038'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or rather, i would agree with that if there was a reasonable chance that the entire ecosystem will self limit in that way
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485039'>
<a class='timestamp' href='#485039'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it won&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367320' id='485040'>
<a class='timestamp' href='#485040'><time timestamp='2016-08-05T03:22:00Z'>03:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
this is the existing behavior in the network, and has been for a long time-- more or less since we made it configurable at all.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367380' id='485041'>
<a class='timestamp' href='#485041'><time timestamp='2016-08-05T03:23:00Z'>03:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: the entire ecosystem doesn&#x27;t need to; why is it all or nothing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367380' id='485042'>
<a class='timestamp' href='#485042'><time timestamp='2016-08-05T03:23:00Z'>03:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: that&#x27;s with 1 MB blocks. who knows if it will work out the same with 3 MB
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367440' id='485043'>
<a class='timestamp' href='#485043'><time timestamp='2016-08-05T03:24:00Z'>03:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it especially will work out that way, with CB and relay mitigating orphaning effects.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367440' id='485044'>
<a class='timestamp' href='#485044'><time timestamp='2016-08-05T03:24:00Z'>03:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I know that if miners start doing &gt;1 MB blocks before the network is ready, I will intentionally NOT use a segwit wallet, to do my small part in preventing them from bloating the blocks. I think a lot of the community could be convinced to do the same.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367440' id='485045'>
<a class='timestamp' href='#485045'><time timestamp='2016-08-05T03:24:00Z'>03:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: and if you want to posit a change in how things work you should suggest how.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367500' id='485046'>
<a class='timestamp' href='#485046'><time timestamp='2016-08-05T03:25:00Z'>03:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: nothing held back blocksizes from growing from 250k to 1mb... not even the defaults in bitcoin core-- or large increases in orphaning rates.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367500' id='485047'>
<a class='timestamp' href='#485047'><time timestamp='2016-08-05T03:25:00Z'>03:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: smaller blocks will always be better for propagation relay effects, and larger blocks will always be worse
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367500' id='485048'>
<a class='timestamp' href='#485048'><time timestamp='2016-08-05T03:25:00Z'>03:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: there is no &#x27;ready&#x27; here; just a compromise that is acceptable
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367500' id='485049'>
<a class='timestamp' href='#485049'><time timestamp='2016-08-05T03:25:00Z'>03:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
segwit shifts the relay effects one way, but shifts other incentives the other way
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367620' id='485050'>
<a class='timestamp' href='#485050'><time timestamp='2016-08-05T03:27:00Z'>03:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
ugh, even IF miners will end up doing terrible things, it doesn&#x27;t mean we need to sabotage miners who WANT to do what is best for the network.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367680' id='485051'>
<a class='timestamp' href='#485051'><time timestamp='2016-08-05T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
its not a question of &quot;want to do what is best&quot;; most people don&#x27;t want to decide and do not have the time to do so in any case.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367680' id='485052'>
<a class='timestamp' href='#485052'><time timestamp='2016-08-05T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
You&#x27;re thinking in terms of pixie unicorn miners.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367680' id='485053'>
<a class='timestamp' href='#485053'><time timestamp='2016-08-05T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the only way miners can do something that is good for the network is by making themselves replacable
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367680' id='485054'>
<a class='timestamp' href='#485054'><time timestamp='2016-08-05T03:28:00Z'>03:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Go look at the actual blocks. The miners you&#x27;re expecting just don&#x27;t exist at a meaningful level.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367800' id='485055'>
<a class='timestamp' href='#485055'><time timestamp='2016-08-05T03:30:00Z'>03:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: moreover, we&#x27;re not removing the ability to limit the block size
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367860' id='485056'>
<a class='timestamp' href='#485056'><time timestamp='2016-08-05T03:31:00Z'>03:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
reality is that the code is optimized for limiting by weight, and segwit is designed with the assumption that that is what will happen... your suggestions seem to be that we should hide that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367860' id='485057'>
<a class='timestamp' href='#485057'><time timestamp='2016-08-05T03:31:00Z'>03:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
block size limiting is supported, and we should explain how to use it for those who want to
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367920' id='485058'>
<a class='timestamp' href='#485058'><time timestamp='2016-08-05T03:32:00Z'>03:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: yes, pixie unicorn miners who actually exist, despite being ignored by Core
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367920' id='485059'>
<a class='timestamp' href='#485059'><time timestamp='2016-08-05T03:32:00Z'>03:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: either blockmaxsize has a notable cost or it doesn&#x27;t. if it doesn&#x27;t, there is no reason to claim it does.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367920' id='485060'>
<a class='timestamp' href='#485060'><time timestamp='2016-08-05T03:32:00Z'>03:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: so, benchmark
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367920' id='485061'>
<a class='timestamp' href='#485061'><time timestamp='2016-08-05T03:32:00Z'>03:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
if it does, then it&#x27;s sabotaging miners who use it
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367980' id='485062'>
<a class='timestamp' href='#485062'><time timestamp='2016-08-05T03:33:00Z'>03:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: they don&#x27;t exist in a meaningful sense. a miner that gets a block a day is not making a meaningful dent in the systems&#x27; survivability.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367980' id='485063'>
<a class='timestamp' href='#485063'><time timestamp='2016-08-05T03:33:00Z'>03:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: limiting by block size is already taking a cut. fee income will be suboptimal if you limit by size
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367980' id='485064'>
<a class='timestamp' href='#485064'><time timestamp='2016-08-05T03:33:00Z'>03:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
luke-jr: that&#x27;s as much sabotaging
<br>
</div>

<div class='talk op-msg' data-timestamp='1470367980' id='485065'>
<a class='timestamp' href='#485065'><time timestamp='2016-08-05T03:33:00Z'>03:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: so that justifies ignoring the requests of such miners, and sabotaging them with (allegedly) bad performance?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368040' id='485066'>
<a class='timestamp' href='#485066'><time timestamp='2016-08-05T03:34:00Z'>03:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
limiting by weight is a design decision which has costs
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368040' id='485067'>
<a class='timestamp' href='#485067'><time timestamp='2016-08-05T03:34:00Z'>03:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
&#x27;sabotaging&#x27; after I had to jump up and down and yell for over a month to get eligius to upgrade to 0.12 even though it made a <u>_tens of fold_</u> increase in createnewblocktime?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368040' id='485068'>
<a class='timestamp' href='#485068'><time timestamp='2016-08-05T03:34:00Z'>03:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
This is such bullshit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368100' id='485069'>
<a class='timestamp' href='#485069'><time timestamp='2016-08-05T03:35:00Z'>03:35</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
ignoring that 0.12 broke numerous things Eligius provided that were left unmerged in Core since 0.6..
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368160' id='485070'>
<a class='timestamp' href='#485070'><time timestamp='2016-08-05T03:36:00Z'>03:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
such as?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368160' id='485071'>
<a class='timestamp' href='#485071'><time timestamp='2016-08-05T03:36:00Z'>03:36</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
CPFP
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368220' id='485072'>
<a class='timestamp' href='#485072'><time timestamp='2016-08-05T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i never trusted that code enough to merge
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368220' id='485073'>
<a class='timestamp' href='#485073'><time timestamp='2016-08-05T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and i think i was not alone
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368220' id='485074'>
<a class='timestamp' href='#485074'><time timestamp='2016-08-05T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I am fed up with this.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368280' id='485075'>
<a class='timestamp' href='#485075'><time timestamp='2016-08-05T03:38:00Z'>03:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
same here.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368280' id='485076'>
<a class='timestamp' href='#485076'><time timestamp='2016-08-05T03:38:00Z'>03:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: you are abusive towards me and the other contributors.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368280' id='485077'>
<a class='timestamp' href='#485077'><time timestamp='2016-08-05T03:38:00Z'>03:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
you are obsessing over minutia on top of minutia.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368280' id='485078'>
<a class='timestamp' href='#485078'><time timestamp='2016-08-05T03:38:00Z'>03:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
You are wasting countless hours exhausting all patience.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368340' id='485079'>
<a class='timestamp' href='#485079'><time timestamp='2016-08-05T03:39:00Z'>03:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Over matters which <u>_do_</u> _not_ <u>_matter_.  The few obscure miners which will set non-defaults even though they get abusive and threatening contact from users (which drives away their hashpower); can _still_</u> do so. If it&#x27;s slightly slower? so what--- the latest software is dozens of times faster to creates blocks than older software and they hardly cared to upgrade.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368400' id='485080'>
<a class='timestamp' href='#485080'><time timestamp='2016-08-05T03:40:00Z'>03:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it litterally makes no difference in the world, and yet you force people to spend hours and hours debating these things.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368460' id='485081'>
<a class='timestamp' href='#485081'><time timestamp='2016-08-05T03:41:00Z'>03:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and I get to spend my time asking others to not leave the project because they are exhausted by you; but it even exhausts me too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368700' id='485082'>
<a class='timestamp' href='#485082'><time timestamp='2016-08-05T03:45:00Z'>03:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
The last block from eligius was 64 hours ago.  It contained <u>_NO_</u> transactions.  I would say that createnew block being merely 29.5 times faster than the old code it was running until recently instead of 30x faster won&#x27;t matter. ... except it won&#x27;t even see that difference when it mines empty blocks with no transactions at all.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470368820' id='485083'>
<a class='timestamp' href='#485083'><time timestamp='2016-08-05T03:47:00Z'>03:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
When it does actually include transactions-- it appears to produce maximum size blocks just like everyone else: <a href="https://blockchain.info/block/0000000000000000050631b932ed81eb9de6267f1cb8b8a353dd59365fd07fd5" class="link" target="_blank">https://blockchain.info/block/0000000000000000050631b932ed81eb9de6267f1cb8b8a353dd59365fd07fd5</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470393600' id='485084'>
<a class='timestamp' href='#485084'><time timestamp='2016-08-05T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I think &quot;memusage.h&quot; should include &quot;prevector.h&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1470394560' id='485085'>
<a class='timestamp' href='#485085'><time timestamp='2016-08-05T10:56:00Z'>10:56</time></a>
&lt;<span class='nick nick-14'> GitHub83</span>&gt;
[bitcoin] jonasschnelli closed pull request #7865: [RPC] Add bumpfee command. (master...2016/04/rbf_combined) <a href="https://github.com/bitcoin/bitcoin/pull/7865" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7865</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399720' id='485086'>
<a class='timestamp' href='#485086'><time timestamp='2016-08-05T12:22:00Z'>12:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jonasschnelli: you&#x27;d say so, as the type is used; but does any compiler complain about this in practice? it&#x27;s in a template, so it could be that you only need it at instantiation time
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399720' id='485087'>
<a class='timestamp' href='#485087'><time timestamp='2016-08-05T12:22:00Z'>12:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m a little rusty on the exact rules there though
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399780' id='485088'>
<a class='timestamp' href='#485088'><time timestamp='2016-08-05T12:23:00Z'>12:23</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
wumpus: I just added some stats stuff and included memusage.h, compiler was then complaining about the missing type prevector...
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399840' id='485089'>
<a class='timestamp' href='#485089'><time timestamp='2016-08-05T12:24:00Z'>12:24</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
memusage.h is directly using (in a template but directly) prevector
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399840' id='485090'>
<a class='timestamp' href='#485090'><time timestamp='2016-08-05T12:24:00Z'>12:24</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
But anyways... far away from important. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399840' id='485091'>
<a class='timestamp' href='#485091'><time timestamp='2016-08-05T12:24:00Z'>12:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
does the data structure that you&#x27;re trying to measure include a prevector
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399840' id='485092'>
<a class='timestamp' href='#485092'><time timestamp='2016-08-05T12:24:00Z'>12:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399900' id='485093'>
<a class='timestamp' href='#485093'><time timestamp='2016-08-05T12:25:00Z'>12:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
no. I just want to measure a vector of structs... but mempool.h refers to prevector
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399900' id='485094'>
<a class='timestamp' href='#485094'><time timestamp='2016-08-05T12:25:00Z'>12:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I guess all other places where mempool.h is included, prevector was previously already included
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399960' id='485095'>
<a class='timestamp' href='#485095'><time timestamp='2016-08-05T12:26:00Z'>12:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
there is no mempool.h? I guess you mean memusage.h?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399960' id='485096'>
<a class='timestamp' href='#485096'><time timestamp='2016-08-05T12:26:00Z'>12:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
argm. memusage.h
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399960' id='485097'>
<a class='timestamp' href='#485097'><time timestamp='2016-08-05T12:26:00Z'>12:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
indeed, if including memusage.h forces you to include prevector.h then it should be included there
<br>
</div>

<div class='talk op-msg' data-timestamp='1470399960' id='485098'>
<a class='timestamp' href='#485098'><time timestamp='2016-08-05T12:26:00Z'>12:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
static inline size_t DynamicUsage(const prevector&lt;N, X, S, D&gt;&amp; v
<br>
</div>

<div class='talk op-msg' data-timestamp='1470400020' id='485099'>
<a class='timestamp' href='#485099'><time timestamp='2016-08-05T12:27:00Z'>12:27</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
It&#x27;s a nitpick and I&#x27;ll try to cover that fix in one of my stats releated commits.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470400080' id='485100'>
<a class='timestamp' href='#485100'><time timestamp='2016-08-05T12:28:00Z'>12:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sometimes the c/c++ dependency management is a bit unfortunate, very easy to accidentally have something creep into your scope so you forget that direct dependencies exist but have no include, then it turns up later when the header happens to be used independently
<br>
</div>

<div class='talk op-msg' data-timestamp='1470400080' id='485101'>
<a class='timestamp' href='#485101'><time timestamp='2016-08-05T12:28:00Z'>12:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1470400140' id='485102'>
<a class='timestamp' href='#485102'><time timestamp='2016-08-05T12:29:00Z'>12:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
unlike missing prototypes in C, at least this cannot lead to ugly type-unsafety bugs, you either have to include it somewhere or it just won&#x27;t compile :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470413040' id='485103'>
<a class='timestamp' href='#485103'><time timestamp='2016-08-05T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-4'> GitHub89</span>&gt;
[bitcoin] Mirobit closed pull request #8283: Move AdvertiseLocal debug output to net category (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/8283" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8283</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470415080' id='485104'>
<a class='timestamp' href='#485104'><time timestamp='2016-08-05T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-5'> GitHub188</span>&gt;
[bitcoin] Mirobit opened pull request #8462: Move AdvertiseLocal debug output to net category (master...advertiselocal) <a href="https://github.com/bitcoin/bitcoin/pull/8462" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8462</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470415860' id='485105'>
<a class='timestamp' href='#485105'><time timestamp='2016-08-05T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-16'> kvnn</span>&gt;
Can anyone tell me how much disk space testnet currenty takes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470416640' id='485106'>
<a class='timestamp' href='#485106'><time timestamp='2016-08-05T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-15'> GitHub149</span>&gt;
[bitcoin] MarcoFalke opened pull request #8463: [qt] Remove Priority from coincontrol dialog (master...Mf1608-qtPrio) <a href="https://github.com/bitcoin/bitcoin/pull/8463" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8463</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470417360' id='485107'>
<a class='timestamp' href='#485107'><time timestamp='2016-08-05T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-9'> GitHub47</span>&gt;
[bitcoin] JeremyRubin opened pull request #8464: &quot;Lockfree&quot; Checkqueue Implementation (master...lockfree-checkqueue-squashed) <a href="https://github.com/bitcoin/bitcoin/pull/8464" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8464</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470417540' id='485108'>
<a class='timestamp' href='#485108'><time timestamp='2016-08-05T17:19:00Z'>17:19</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
(forgot to mark as WIP fyi)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470417660' id='485109'>
<a class='timestamp' href='#485109'><time timestamp='2016-08-05T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
you can edit the title
<br>
</div>

<div class='talk op-msg' data-timestamp='1470417660' id='485110'>
<a class='timestamp' href='#485110'><time timestamp='2016-08-05T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jeremyrubin
<br>
</div>

<div class='talk op-msg' data-timestamp='1470417720' id='485111'>
<a class='timestamp' href='#485111'><time timestamp='2016-08-05T17:22:00Z'>17:22</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
jeremyrubin: it&#x27;s quite useful to use markdown task lists in the PR body, as those show up in lists and references on other tickets/PRs <a href="https://github.com/blog/1825-task-lists-in-all-markdown-documents" class="link" target="_blank">https://github.com/blog/1825-task-lists-in-all-markdown-documents</a> and it also has the side benefit of making the WIP status clear
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418020' id='485112'>
<a class='timestamp' href='#485112'><time timestamp='2016-08-05T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
btcdrak: what are the tasks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418020' id='485113'>
<a class='timestamp' href='#485113'><time timestamp='2016-08-05T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
your todo list.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418080' id='485114'>
<a class='timestamp' href='#485114'><time timestamp='2016-08-05T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
btcdrak: the only stuff really remaining is more testing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418080' id='485115'>
<a class='timestamp' href='#485115'><time timestamp='2016-08-05T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
btcdrak: actually I can think of two things
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418080' id='485116'>
<a class='timestamp' href='#485116'><time timestamp='2016-08-05T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: if all that remains is testing, i wouldn&#x27;t call it WIP :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418200' id='485117'>
<a class='timestamp' href='#485117'><time timestamp='2016-08-05T17:30:00Z'>17:30</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: exactly! if it&#x27;s marked WIP no-one will test it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418260' id='485118'>
<a class='timestamp' href='#485118'><time timestamp='2016-08-05T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: oh ok... I&#x27;ll un WIP it then, it&#x27;s ready for testing
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418380' id='485119'>
<a class='timestamp' href='#485119'><time timestamp='2016-08-05T17:33:00Z'>17:33</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sorry was unclear at what point I should WIP/vs non WIP, thanks for the guidance
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418500' id='485120'>
<a class='timestamp' href='#485120'><time timestamp='2016-08-05T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
I&#x27;m going to be awk for a little bit, but will respond to more things later.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418500' id='485121'>
<a class='timestamp' href='#485121'><time timestamp='2016-08-05T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: you may just want to view the whole diff rather than commit by commit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470418920' id='485122'>
<a class='timestamp' href='#485122'><time timestamp='2016-08-05T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: i tend to review per commit, as i think every commit should logically make sense... the combination into a pull request is there to see the bigger picture
<br>
</div>

<div class='talk op-msg' data-timestamp='1470419520' id='485123'>
<a class='timestamp' href='#485123'><time timestamp='2016-08-05T17:52:00Z'>17:52</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
yep I agree, each commit should compile and run on this PR but is maybe not fully documented ;) 
<br>
</div>

<div class='talk op-msg' data-timestamp='1470422280' id='485124'>
<a class='timestamp' href='#485124'><time timestamp='2016-08-05T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-16'> bsm117532</span>&gt;
wizkid057, the exploding bitcoin spammer, somehow got op permissions on #bitcoin-wizards and is banning people.  Can someone here take care of him?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470422460' id='485125'>
<a class='timestamp' href='#485125'><time timestamp='2016-08-05T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
jeremyrubin: impressive PR... my review will take a while. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470422640' id='485126'>
<a class='timestamp' href='#485126'><time timestamp='2016-08-05T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-9'> pigeons</span>&gt;
he&#x27;s not banning people, just kicked you only and its not the spammer it really is wizkid. probably just a mistake
<br>
</div>

<div class='talk op-msg' data-timestamp='1470422700' id='485127'>
<a class='timestamp' href='#485127'><time timestamp='2016-08-05T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-16'> bsm117532</span>&gt;
sorry, don&#x27;t know who wizkid is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470423780' id='485128'>
<a class='timestamp' href='#485128'><time timestamp='2016-08-05T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-12'> GitHub178</span>&gt;
[bitcoin] sipa opened pull request #8465: [0.13] Document reindexing changes (0.13...docreindex) <a href="https://github.com/bitcoin/bitcoin/pull/8465" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8465</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424020' id='485129'>
<a class='timestamp' href='#485129'><time timestamp='2016-08-05T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-10'> GitHub185</span>&gt;
[bitcoin] paveljanik opened pull request #8466: [Trivial] Do not shadow variables in networking code (master...20160805_Wshadow_net) <a href="https://github.com/bitcoin/bitcoin/pull/8466" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8466</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424620' id='485130'>
<a class='timestamp' href='#485130'><time timestamp='2016-08-05T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i feel that &#x27;New mempool information RPC calls&#x27; could move to &#x27;Low-level RPC changes&#x27; in the release notes
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424620' id='485131'>
<a class='timestamp' href='#485131'><time timestamp='2016-08-05T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
thoughts on <a href="https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1</a> NicolasDorier btcdrak sipa should I open a PR?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424680' id='485132'>
<a class='timestamp' href='#485132'><time timestamp='2016-08-05T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
this doesn&#x27;t touch the script flags and doesn&#x27;t move anything out of contextualCheckBlock like the previous one
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424680' id='485133'>
<a class='timestamp' href='#485133'><time timestamp='2016-08-05T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
it could be 1 or a few commits, but I kept it extremely separated just in case
<br>
</div>

<div class='talk op-msg' data-timestamp='1470424920' id='485134'>
<a class='timestamp' href='#485134'><time timestamp='2016-08-05T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-2'> GitHub153</span>&gt;
[bitcoin] paveljanik opened pull request #8467: [Trivial] Do not shadow members in dbwrapper (master...20160805_Wshadow_dbwrapper) <a href="https://github.com/bitcoin/bitcoin/pull/8467" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8467</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470425520' id='485135'>
<a class='timestamp' href='#485135'><time timestamp='2016-08-05T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: ack
<br>
</div>

<div class='talk op-msg' data-timestamp='1470425580' id='485136'>
<a class='timestamp' href='#485136'><time timestamp='2016-08-05T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sipa: more generally i think if you&#x27;re going to clean up further, perhaps reordering the Notable Changes section might be called for.  eg hd wallet support, segwit, cpfp mining, and compact blocks strike me as more important to highlight than c++11 code modernizations
<br>
</div>

<div class='talk op-msg' data-timestamp='1470425760' id='485137'>
<a class='timestamp' href='#485137'><time timestamp='2016-08-05T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe a section that aggregates all non-user-visible code changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1470425760' id='485138'>
<a class='timestamp' href='#485138'><time timestamp='2016-08-05T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that would even include segwit, i guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1470426120' id='485139'>
<a class='timestamp' href='#485139'><time timestamp='2016-08-05T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
sure.  fyi the mining stuff references segwit, so if you move those around relative to each other, the text might need some edits
<br>
</div>

<div class='talk op-msg' data-timestamp='1470426900' id='485140'>
<a class='timestamp' href='#485140'><time timestamp='2016-08-05T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-8'> GitHub14</span>&gt;
[bitcoin] paveljanik opened pull request #8468: Do not shadow member variables in serialization (master...20160805_Wshadow_serialization) <a href="https://github.com/bitcoin/bitcoin/pull/8468" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8468</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470427980' id='485141'>
<a class='timestamp' href='#485141'><time timestamp='2016-08-05T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
Is this entire block of code inside of bloom.cpp basically so that we can match redeemScript/pubkey hashes in scriptPubKeys?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470427980' id='485142'>
<a class='timestamp' href='#485142'><time timestamp='2016-08-05T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/blob/master/src/bloom.cpp#L163-LL177" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/bloom.cpp#L163-LL177</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428160' id='485143'>
<a class='timestamp' href='#485143'><time timestamp='2016-08-05T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: how do I get the DynamicUsage from a struct?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428160' id='485144'>
<a class='timestamp' href='#485144'><time timestamp='2016-08-05T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
MallocUsage(size_t alloc) is inline...
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428220' id='485145'>
<a class='timestamp' href='#485145'><time timestamp='2016-08-05T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: sum the dynamic usages of its member fields
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428280' id='485146'>
<a class='timestamp' href='#485146'><time timestamp='2016-08-05T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: what about MallocUsage(sizeof(mystruct))?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428280' id='485147'>
<a class='timestamp' href='#485147'><time timestamp='2016-08-05T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
+allow external calls to MallocUsage
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428340' id='485148'>
<a class='timestamp' href='#485148'><time timestamp='2016-08-05T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: are you mallocing your stuct?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428340' id='485149'>
<a class='timestamp' href='#485149'><time timestamp='2016-08-05T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: ... ah... no.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428340' id='485150'>
<a class='timestamp' href='#485150'><time timestamp='2016-08-05T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
then you shouldn&#x27;t be using either of them
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428400' id='485151'>
<a class='timestamp' href='#485151'><time timestamp='2016-08-05T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I guess std::vector&lt;mystruct&gt; is on the stack
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428400' id='485152'>
<a class='timestamp' href='#485152'><time timestamp='2016-08-05T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
DynamicUsage is not how much memory a struct uses. It&#x27;s how much <u>_dynamic_</u> memory it uses. The static memory you find just using sizeof.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428400' id='485153'>
<a class='timestamp' href='#485153'><time timestamp='2016-08-05T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: use DynamicUsage on the vector.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428400' id='485154'>
<a class='timestamp' href='#485154'><time timestamp='2016-08-05T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
The vector is allocated on the stack. Its entries are allocated on the heap.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485155'>
<a class='timestamp' href='#485155'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
DynamicUsage(vector) will tell you how much memory that vector malloced.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485156'>
<a class='timestamp' href='#485156'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: yes. I&#x27;ll do that. But i&#x27;d like to know how many elements i have to remove from the vector to match a usage target... therefore I need to calculate the size of a single element.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485157'>
<a class='timestamp' href='#485157'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: use sizeof.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485158'>
<a class='timestamp' href='#485158'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, removing elements from a vector does not reduce its memory usage.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485159'>
<a class='timestamp' href='#485159'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you need to call shrink_to_fit
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428460' id='485160'>
<a class='timestamp' href='#485160'><time timestamp='2016-08-05T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
okay... but aren&#x27;t the element malloced?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428520' id='485161'>
<a class='timestamp' href='#485161'><time timestamp='2016-08-05T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428520' id='485162'>
<a class='timestamp' href='#485162'><time timestamp='2016-08-05T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but not individually
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428520' id='485163'>
<a class='timestamp' href='#485163'><time timestamp='2016-08-05T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a vector has a single allocated block with all its elements in it
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428520' id='485164'>
<a class='timestamp' href='#485164'><time timestamp='2016-08-05T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Okay. I&#x27;ll use sizeof(struct) and good point about shrink_to_fit!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428520' id='485165'>
<a class='timestamp' href='#485165'><time timestamp='2016-08-05T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
thanks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428820' id='485166'>
<a class='timestamp' href='#485166'><time timestamp='2016-08-05T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: sizeof(struct) = 32, memusage::DynamicUsage(vector)/size = 52?!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428880' id='485167'>
<a class='timestamp' href='#485167'><time timestamp='2016-08-05T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
calculating the amount of items to remove based on sizeof(struct) is not precise to get the memory usage target
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428880' id='485168'>
<a class='timestamp' href='#485168'><time timestamp='2016-08-05T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: look at vector.capacity)(
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428880' id='485169'>
<a class='timestamp' href='#485169'><time timestamp='2016-08-05T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
instead of size
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428940' id='485170'>
<a class='timestamp' href='#485170'><time timestamp='2016-08-05T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
vectors allocate more than what is requested, so that they don&#x27;t need to reallocate whenever a new element is added
<br>
</div>

<div class='talk op-msg' data-timestamp='1470428940' id='485171'>
<a class='timestamp' href='#485171'><time timestamp='2016-08-05T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: i think it&#x27;s very ugly to have a single set of flags that contains both block level validation rules and script level validation rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429000' id='485172'>
<a class='timestamp' href='#485172'><time timestamp='2016-08-05T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: /vector.capacity() == sizeof(struct) ... thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429060' id='485173'>
<a class='timestamp' href='#485173'><time timestamp='2016-08-05T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: the script flags are hidden behind ScriptFlagsFromConsensus() I thought that was what you wanted
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429060' id='485174'>
<a class='timestamp' href='#485174'><time timestamp='2016-08-05T20:31:00Z'>20:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: <a href="https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1#diff-cefdf710ea5108806289afadb6cf8717R13" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1#diff-cefdf710ea5108806289afadb6cf8717R13</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485175'>
<a class='timestamp' href='#485175'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: so how many sets of flags do we want to expose in libconsensus?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485176'>
<a class='timestamp' href='#485176'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: one for every layer
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485177'>
<a class='timestamp' href='#485177'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
is locktime a layer?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485178'>
<a class='timestamp' href='#485178'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there will be a script validation API and a block validation API, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485179'>
<a class='timestamp' href='#485179'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe a transaction validation API as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429120' id='485180'>
<a class='timestamp' href='#485180'><time timestamp='2016-08-05T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think it&#x27;s wrong to make them share flags
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429180' id='485181'>
<a class='timestamp' href='#485181'><time timestamp='2016-08-05T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what if there was a script change that only applied to transactions with nVersion&gt;=5... you&#x27;d have a block level flag to enable the soft fork, but it wouldn&#x27;t map one-to-one to the script flag
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429180' id='485182'>
<a class='timestamp' href='#485182'><time timestamp='2016-08-05T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
maybe a header validation API too, I think that would be the easiest thing to expose and discuss abstractions from storage
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429240' id='485183'>
<a class='timestamp' href='#485183'><time timestamp='2016-08-05T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa:yeah, now they don&#x27;t need to map, the non-script consensus flags don&#x27;t need to be in the internal script flags
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429240' id='485184'>
<a class='timestamp' href='#485184'><time timestamp='2016-08-05T20:34:00Z'>20:34</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
and some internal script flags are not exposed
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429360' id='485185'>
<a class='timestamp' href='#485185'><time timestamp='2016-08-05T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I don&#x27;t undesrtand your txversion&gt;5 example
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429360' id='485186'>
<a class='timestamp' href='#485186'><time timestamp='2016-08-05T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the flag would be used at the tx validation level either way, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429420' id='485187'>
<a class='timestamp' href='#485187'><time timestamp='2016-08-05T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
oh, I see what you mean
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429420' id='485188'>
<a class='timestamp' href='#485188'><time timestamp='2016-08-05T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
say we had a new OP_CHECKSIGAWESOME, but only enabled in UTXOs created by transactions with nVersion &gt;= 5
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429480' id='485189'>
<a class='timestamp' href='#485189'><time timestamp='2016-08-05T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there would be SCRIPT_VERIFY_CHECKSIGAWESOME, and a BIP9 deployment AWESOME
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429480' id='485190'>
<a class='timestamp' href='#485190'><time timestamp='2016-08-05T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you&#x27;d pass AWESOME to the block validation functions
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429480' id='485191'>
<a class='timestamp' href='#485191'><time timestamp='2016-08-05T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
yes, you&#x27;re saying that you would do the consensus-to-internal-script conversion outside of the conversion function and inside, say verifyTx
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429480' id='485192'>
<a class='timestamp' href='#485192'><time timestamp='2016-08-05T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right... there is not necessarily a clean mapping between the two
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485193'>
<a class='timestamp' href='#485193'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what flags the script code is called with is block level logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485194'>
<a class='timestamp' href='#485194'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, what we&#x27;re exposing in libconsensus are the BIP9/older_sf flags, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485195'>
<a class='timestamp' href='#485195'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
for the script layer, sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485196'>
<a class='timestamp' href='#485196'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wait, no
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485197'>
<a class='timestamp' href='#485197'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
for all layers, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485198'>
<a class='timestamp' href='#485198'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m confused :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429540' id='485199'>
<a class='timestamp' href='#485199'><time timestamp='2016-08-05T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m assuming there will be a enum for block level validation flags
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429600' id='485200'>
<a class='timestamp' href='#485200'><time timestamp='2016-08-05T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the flags we expose in libconsensus right now are a subset of the script internal ones
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429600' id='485201'>
<a class='timestamp' href='#485201'><time timestamp='2016-08-05T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and an enum (which already exists) for script level validation flags
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429600' id='485202'>
<a class='timestamp' href='#485202'><time timestamp='2016-08-05T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
for some softforks there will be a flag in both
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429600' id='485203'>
<a class='timestamp' href='#485203'><time timestamp='2016-08-05T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
there&#x27;s no flag for say bip68 and bip113, because thouse would be needed for verifyTx, but not for verifyScript
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429660' id='485204'>
<a class='timestamp' href='#485204'><time timestamp='2016-08-05T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429660' id='485205'>
<a class='timestamp' href='#485205'><time timestamp='2016-08-05T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, the &quot;block level&quot; flags include all the &quot;script level&quot; flags, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429720' id='485206'>
<a class='timestamp' href='#485206'><time timestamp='2016-08-05T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not necessarily
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429720' id='485207'>
<a class='timestamp' href='#485207'><time timestamp='2016-08-05T20:42:00Z'>20:42</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
how do you tell verifyblock to verify p2sh otherwise?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429780' id='485208'>
<a class='timestamp' href='#485208'><time timestamp='2016-08-05T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I mean, verifytx
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429780' id='485209'>
<a class='timestamp' href='#485209'><time timestamp='2016-08-05T20:43:00Z'>20:43</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
verifyblock could call getflags internally I guess, but that&#x27;s not the point
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429840' id='485210'>
<a class='timestamp' href='#485210'><time timestamp='2016-08-05T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;d expect verifyblock to have something like BLOCK_VERIFY_CSV, and verifyscript to have something like SCRIPT_VERIFY_CHECKSEQUENCEVERIFY
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429900' id='485211'>
<a class='timestamp' href='#485211'><time timestamp='2016-08-05T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
say I want to call verifytx specifying that I want p2sh and bip113 validated
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429900' id='485212'>
<a class='timestamp' href='#485212'><time timestamp='2016-08-05T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sure, CSV implies that CHECKSEQUENCEVERIFY is passed to script
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429900' id='485213'>
<a class='timestamp' href='#485213'><time timestamp='2016-08-05T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but CSV does much more than that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429900' id='485214'>
<a class='timestamp' href='#485214'><time timestamp='2016-08-05T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it also enabled nsequence behaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429900' id='485215'>
<a class='timestamp' href='#485215'><time timestamp='2016-08-05T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
which has nothing to do with script
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429960' id='485216'>
<a class='timestamp' href='#485216'><time timestamp='2016-08-05T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
so BLOCK_VERIFY_CSV is mapped into bitcoinconsensus_SCRIPT_FLAGS_VERIFY_P2SH and then bitcoinconsensus_SCRIPT_FLAGS_VERIFY_P2SH into SCRIPT_VERIFY_P2SH
<br>
</div>

<div class='talk op-msg' data-timestamp='1470429960' id='485217'>
<a class='timestamp' href='#485217'><time timestamp='2016-08-05T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
do we need also a TX_VERIFY_P2SH for exposing verifyTx ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430020' id='485218'>
<a class='timestamp' href='#485218'><time timestamp='2016-08-05T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;d keep the tx-level flags and block-level flags the same
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430020' id='485219'>
<a class='timestamp' href='#485219'><time timestamp='2016-08-05T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but script flags seem separate
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430020' id='485220'>
<a class='timestamp' href='#485220'><time timestamp='2016-08-05T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, the flags for BIP68 and for BIP112 are separated in that branch
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430080' id='485221'>
<a class='timestamp' href='#485221'><time timestamp='2016-08-05T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s just my opinion, btw... maybe other people feel that script and block flags should be combined
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430080' id='485222'>
<a class='timestamp' href='#485222'><time timestamp='2016-08-05T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
they are separated: there&#x27;s &quot;all consensus flags&quot; and &quot;all consensus flags related to script plus some more script specific flags&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430140' id='485223'>
<a class='timestamp' href='#485223'><time timestamp='2016-08-05T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, from previous talks I thought this was exactly what you wanted, still not sure what would you prefer
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430140' id='485224'>
<a class='timestamp' href='#485224'><time timestamp='2016-08-05T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, i feel they should be completely separate
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430140' id='485225'>
<a class='timestamp' href='#485225'><time timestamp='2016-08-05T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not one being an extension of the other
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430200' id='485226'>
<a class='timestamp' href='#485226'><time timestamp='2016-08-05T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
like not repeating p2sh in both of them? I don&#x27;t undesrtand
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430200' id='485227'>
<a class='timestamp' href='#485227'><time timestamp='2016-08-05T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but maybe others disagree... that&#x27;s fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430200' id='485228'>
<a class='timestamp' href='#485228'><time timestamp='2016-08-05T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, P2SH would be in both
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430200' id='485229'>
<a class='timestamp' href='#485229'><time timestamp='2016-08-05T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
in this case one is not an extension of the other, what do you mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430200' id='485230'>
<a class='timestamp' href='#485230'><time timestamp='2016-08-05T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
they share some (they currently share)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430260' id='485231'>
<a class='timestamp' href='#485231'><time timestamp='2016-08-05T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1#diff-cefdf710ea5108806289afadb6cf8717R13" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/master...jtimon:0.13-consensus-flags?expand=1#diff-cefdf710ea5108806289afadb6cf8717R13</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430260' id='485232'>
<a class='timestamp' href='#485232'><time timestamp='2016-08-05T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you&#x27;re just copying the script flags there
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430260' id='485233'>
<a class='timestamp' href='#485233'><time timestamp='2016-08-05T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and then adding other things
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430260' id='485234'>
<a class='timestamp' href='#485234'><time timestamp='2016-08-05T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just make it a completely independent enum
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430320' id='485235'>
<a class='timestamp' href='#485235'><time timestamp='2016-08-05T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
not from the script, see <a href="https://github.com/bitcoin/bitcoin/commit/82bf11faf9a1d915eb0fc40ea6db10da9908df2a" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/82bf11faf9a1d915eb0fc40ea6db10da9908df2a</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430320' id='485236'>
<a class='timestamp' href='#485236'><time timestamp='2016-08-05T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
cfields, thanks for review!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430320' id='485237'>
<a class='timestamp' href='#485237'><time timestamp='2016-08-05T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I&#x27;m just adding new non-script flags there
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430320' id='485238'>
<a class='timestamp' href='#485238'><time timestamp='2016-08-05T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
bitcoinconsensus_BIP16, bitcoinconsensus_BIP66, bitcoinconsensus_BIP65, bitcoinconsensus_BIP68, ... for example
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430320' id='485239'>
<a class='timestamp' href='#485239'><time timestamp='2016-08-05T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the script ones were already exposed in libconsensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430380' id='485240'>
<a class='timestamp' href='#485240'><time timestamp='2016-08-05T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and BIP16 would map to script verify P2SH
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430380' id='485241'>
<a class='timestamp' href='#485241'><time timestamp='2016-08-05T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
they already do by hardcoding the same bit positions in both, I&#x27;m trying to solve that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430440' id='485242'>
<a class='timestamp' href='#485242'><time timestamp='2016-08-05T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
that&#x27;s what ScriptFlagsFromConsensus() is supposed to solve
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430440' id='485243'>
<a class='timestamp' href='#485243'><time timestamp='2016-08-05T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well why do you have both LOCKTIME_VERIFY_SEQUENCE and bitcoinconsensus_SCRIPT_FLAGS_VERIFY_CHECKSEQUENCEVERIFY in the same enum?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430440' id='485244'>
<a class='timestamp' href='#485244'><time timestamp='2016-08-05T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the block level they&#x27;re the same thing
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430560' id='485245'>
<a class='timestamp' href='#485245'><time timestamp='2016-08-05T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
because I&#x27;m not creating a new enum for libconsensus, there&#x27;s currently one for libconsensus and another for scripts, I&#x27;m keeping it that way, just decoupling each other from the bit positions having to match
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430560' id='485246'>
<a class='timestamp' href='#485246'><time timestamp='2016-08-05T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to verifyblock you would just pass &quot;CSV is enabled&quot;, and it would trigger all necessary things... including locktime nsequence checking and script checksequenceverify
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430560' id='485247'>
<a class='timestamp' href='#485247'><time timestamp='2016-08-05T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
let&#x27;s say in libconsensus the &quot;block level&quot; flags would be reused for verifyTx and verfiyScript, does that make sense?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430620' id='485248'>
<a class='timestamp' href='#485248'><time timestamp='2016-08-05T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t know what you mean by that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430620' id='485249'>
<a class='timestamp' href='#485249'><time timestamp='2016-08-05T20:57:00Z'>20:57</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I see, you want the block level ones to correspond with deployments, ie bip68 and bip112 go together
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430680' id='485250'>
<a class='timestamp' href='#485250'><time timestamp='2016-08-05T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well if there is a reason why they would be implemented separately, they can be separate
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430680' id='485251'>
<a class='timestamp' href='#485251'><time timestamp='2016-08-05T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s about abstraction... the caller of blockverify shouldn&#x27;t need to know what every softfork corresponds to internally
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430740' id='485252'>
<a class='timestamp' href='#485252'><time timestamp='2016-08-05T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but you don&#x27;t want verifyScript to receive a CSV_bip68_bip112 flag that it internally maps to SCRIPT_VERIFY_CHECKSEQUENCEVERIFY (ignoring bip68 because at the script level it doesn&#x27;t care)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430740' id='485253'>
<a class='timestamp' href='#485253'><time timestamp='2016-08-05T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that enum you have there feels to me like you want to expose all internal choices to the caller... that isn&#x27;t necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430740' id='485254'>
<a class='timestamp' href='#485254'><time timestamp='2016-08-05T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right... have block validation flags that correspond to deployments/softforks, and script validation flags that correspond to script rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430740' id='485255'>
<a class='timestamp' href='#485255'><time timestamp='2016-08-05T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
yeah they can be separated, we could also have a bool param for every option
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430800' id='485256'>
<a class='timestamp' href='#485256'><time timestamp='2016-08-05T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
some block validation flags will correspond to one or more script flags... some may not
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430800' id='485257'>
<a class='timestamp' href='#485257'><time timestamp='2016-08-05T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but the caller shouldn&#x27;t need to know that
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430800' id='485258'>
<a class='timestamp' href='#485258'><time timestamp='2016-08-05T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
again... all of that is just my opinion
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430800' id='485259'>
<a class='timestamp' href='#485259'><time timestamp='2016-08-05T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;d like to hear some others too
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430860' id='485260'>
<a class='timestamp' href='#485260'><time timestamp='2016-08-05T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
agree on what you said about the caller, disagree that I want to expose more details than necessary to the caller, I&#x27;m happy to merge bip68 and bip112 flags, that seems orthogonal
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430860' id='485261'>
<a class='timestamp' href='#485261'><time timestamp='2016-08-05T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just the naming of your flags is exposing things :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430860' id='485262'>
<a class='timestamp' href='#485262'><time timestamp='2016-08-05T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the main question is how many enums do we want and what should it be in them
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430860' id='485263'>
<a class='timestamp' href='#485263'><time timestamp='2016-08-05T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
oh, come on, I expect people to bike-shedd
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485264'>
<a class='timestamp' href='#485264'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
don&#x27;t tell me that&#x27;s the main complain
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485265'>
<a class='timestamp' href='#485265'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the block/tx level, you&#x27;d have bip16, bip34, bip66, bip65, bip68_112_113, bip141
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485266'>
<a class='timestamp' href='#485266'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: np. the serialization one will require more effort.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485267'>
<a class='timestamp' href='#485267'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the script level, you&#x27;d have what already exists
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485268'>
<a class='timestamp' href='#485268'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
asume you fully decide the names in the enum
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485269'>
<a class='timestamp' href='#485269'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: imo changing the name for those would be helpful, the version serialization is quite confusing as-is
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485270'>
<a class='timestamp' href='#485270'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: i don&#x27;t care about the name... i care about the fact that it&#x27;s mixing several layers!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430920' id='485271'>
<a class='timestamp' href='#485271'><time timestamp='2016-08-05T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
why are bip68_112_113 together?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430980' id='485272'>
<a class='timestamp' href='#485272'><time timestamp='2016-08-05T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
bip113 was deployed separately
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430980' id='485273'>
<a class='timestamp' href='#485273'><time timestamp='2016-08-05T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because someone calling verifyblock shouldn&#x27;t need to know that part of it is a script rule and part of it is not
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430980' id='485274'>
<a class='timestamp' href='#485274'><time timestamp='2016-08-05T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
for the libconsensus caller, all he cares about is deployments, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470430980' id='485275'>
<a class='timestamp' href='#485275'><time timestamp='2016-08-05T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
IMHO, there should not be any flags at all, and you just give it the block headers :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485276'>
<a class='timestamp' href='#485276'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i understand we&#x27;re not there yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485277'>
<a class='timestamp' href='#485277'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
with my approach all they need to know is that each flag is a deployment
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485278'>
<a class='timestamp' href='#485278'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, i don&#x27;t like it, sorry
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485279'>
<a class='timestamp' href='#485279'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s not a NACK
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485280'>
<a class='timestamp' href='#485280'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i&#x27;m tired of discussing it
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431040' id='485281'>
<a class='timestamp' href='#485281'><time timestamp='2016-08-05T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, we can expose consensus::getflags
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431100' id='485282'>
<a class='timestamp' href='#485282'><time timestamp='2016-08-05T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but are you saying that verifyTx should call getflags internally?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431100' id='485283'>
<a class='timestamp' href='#485283'><time timestamp='2016-08-05T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
cfields, yes. I took me a lot of time to get it done. This was my third attempt to do so.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431160' id='485284'>
<a class='timestamp' href='#485284'><time timestamp='2016-08-05T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: understood. it&#x27;s much appreciated.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431160' id='485285'>
<a class='timestamp' href='#485285'><time timestamp='2016-08-05T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
cfields, I have more huge task... LOCK inside LOCK
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431160' id='485286'>
<a class='timestamp' href='#485286'><time timestamp='2016-08-05T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: one high-level request: if the param isn&#x27;t used, please just leave the var unspecified
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431220' id='485287'>
<a class='timestamp' href='#485287'><time timestamp='2016-08-05T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
cfields, I thought about it too (esp. nVersion...) but this would make review more difficult.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431220' id='485288'>
<a class='timestamp' href='#485288'><time timestamp='2016-08-05T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: otherwise we&#x27;re not getting any closer to being able to enable -Wunused-parameter :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431220' id='485289'>
<a class='timestamp' href='#485289'><time timestamp='2016-08-05T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
paveljanik: how so?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431280' id='485290'>
<a class='timestamp' href='#485290'><time timestamp='2016-08-05T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
every reviewer must read the whole function code...
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431280' id='485291'>
<a class='timestamp' href='#485291'><time timestamp='2016-08-05T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
without this change, it is almost enough to read the context
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431400' id='485292'>
<a class='timestamp' href='#485292'><time timestamp='2016-08-05T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
ok, fair enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431520' id='485293'>
<a class='timestamp' href='#485293'><time timestamp='2016-08-05T21:12:00Z'>21:12</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
of course the compilation can find problems there...
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431760' id='485294'>
<a class='timestamp' href='#485294'><time timestamp='2016-08-05T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
BTW - LOCK inside LOCK problem: LOCK macro defines a local variable CCriticalBlock criticalblock. And thus LOCK inside LOCK shadows it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431760' id='485295'>
<a class='timestamp' href='#485295'><time timestamp='2016-08-05T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
I do not want to make the change in the syntax of LOCK, so I have to change the macro.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431760' id='485296'>
<a class='timestamp' href='#485296'><time timestamp='2016-08-05T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats presumably why there are LOCKN macros?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431820' id='485297'>
<a class='timestamp' href='#485297'><time timestamp='2016-08-05T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
yes, but... LOCK2 at the beginning of the function grabs both at the beginning.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431820' id='485298'>
<a class='timestamp' href='#485298'><time timestamp='2016-08-05T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
I do not think this is wanted.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431880' id='485299'>
<a class='timestamp' href='#485299'><time timestamp='2016-08-05T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
I had an idea to change the name of the variable somehow - e.g. criticalblockLINENR or so.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431880' id='485300'>
<a class='timestamp' href='#485300'><time timestamp='2016-08-05T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
but implementing this in the preprocessor&#x27;s ## ## ## is currently above my knowledge ;-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431940' id='485301'>
<a class='timestamp' href='#485301'><time timestamp='2016-08-05T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
see e.g. ProcessGetData in main.cpp.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431940' id='485302'>
<a class='timestamp' href='#485302'><time timestamp='2016-08-05T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
paveljanik: use the file number in the name of the variable :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431940' id='485303'>
<a class='timestamp' href='#485303'><time timestamp='2016-08-05T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, line number
<br>
</div>

<div class='talk op-msg' data-timestamp='1470431940' id='485304'>
<a class='timestamp' href='#485304'><time timestamp='2016-08-05T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
that was my plan :-) But not so easy to write it 8)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432000' id='485305'>
<a class='timestamp' href='#485305'><time timestamp='2016-08-05T21:20:00Z'>21:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;ll try
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432180' id='485306'>
<a class='timestamp' href='#485306'><time timestamp='2016-08-05T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
can&#x27;t you just use the incoming param&#x27;s name?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432300' id='485307'>
<a class='timestamp' href='#485307'><time timestamp='2016-08-05T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: what do you if it&#x27;s called pnode-&gt;buf[(int)(sin(x)*35)].cs?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432300' id='485308'>
<a class='timestamp' href='#485308'><time timestamp='2016-08-05T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
jtimon: I think we shoudl talk about that in ##libconsensus on my side I&#x27;m still not decided whther I prefer the one flag approach of my approach (<a href="https://github.com/bitcoin/bitcoin/pull/8339/commits/a59f79dfb7a996e9b309aa43d699499339b1a7c4)" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8339/commits/a59f79dfb7a996e9b309aa43d699499339b1a7c4)</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432300' id='485309'>
<a class='timestamp' href='#485309'><time timestamp='2016-08-05T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
NicolasDorier: sure we can move there
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432480' id='485310'>
<a class='timestamp' href='#485310'><time timestamp='2016-08-05T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: heh, ok. that&#x27;s a stretch, though :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432480' id='485311'>
<a class='timestamp' href='#485311'><time timestamp='2016-08-05T21:28:00Z'>21:28</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
cfields, self-assing: good catch. Look like I do not even understand the original code 8) <a href="https://github.com/bitcoin/bitcoin/blob/master/src/net.h#L289" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/net.h#L289</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432600' id='485312'>
<a class='timestamp' href='#485312'><time timestamp='2016-08-05T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
paveljanik: 
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432660' id='485313'>
<a class='timestamp' href='#485313'><time timestamp='2016-08-05T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
#define LOCK(cs) CCriticalBlock criticalblock ## __LINE__(cs, #cs, __FILE__, __LINE__)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432660' id='485314'>
<a class='timestamp' href='#485314'><time timestamp='2016-08-05T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
does that not work?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432660' id='485315'>
<a class='timestamp' href='#485315'><time timestamp='2016-08-05T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
IIRC I have already tried this. Will try again
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432780' id='485316'>
<a class='timestamp' href='#485316'><time timestamp='2016-08-05T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: (on one line) std::mutex m1; std::mutex m2; LOCK(m1); LOCK(m2);
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432780' id='485317'>
<a class='timestamp' href='#485317'><time timestamp='2016-08-05T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485318'>
<a class='timestamp' href='#485318'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
both variables will be named the same.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485319'>
<a class='timestamp' href='#485319'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485320'>
<a class='timestamp' href='#485320'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
main.cpp:6543:28: note: previous declaration is here
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485321'>
<a class='timestamp' href='#485321'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
            CCriticalBlock criticalblock__LINE__(pto-&gt;cs_inventory, &quot;pto-&gt;cs_inventory&quot;, &quot;main.cpp&quot;, 6543);
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485322'>
<a class='timestamp' href='#485322'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, that looks wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432840' id='485323'>
<a class='timestamp' href='#485323'><time timestamp='2016-08-05T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: only because you poked a hole in mine first :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432900' id='485324'>
<a class='timestamp' href='#485324'><time timestamp='2016-08-05T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: well use LOCK2 in that case
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432900' id='485325'>
<a class='timestamp' href='#485325'><time timestamp='2016-08-05T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
:-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470432960' id='485326'>
<a class='timestamp' href='#485326'><time timestamp='2016-08-05T21:36:00Z'>21:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
paveljanik: bip112
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433020' id='485327'>
<a class='timestamp' href='#485327'><time timestamp='2016-08-05T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433020' id='485328'>
<a class='timestamp' href='#485328'><time timestamp='2016-08-05T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
paveljanik: <a href="http://stackoverflow.com/a/1597129" class="link" target="_blank">http://stackoverflow.com/a/1597129</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433020' id='485329'>
<a class='timestamp' href='#485329'><time timestamp='2016-08-05T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
<u>__COUNTER__</u> looks even nicer
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433140' id='485330'>
<a class='timestamp' href='#485330'><time timestamp='2016-08-05T21:39:00Z'>21:39</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
I&#x27;ll see.
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485331'>
<a class='timestamp' href='#485331'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
#define paste1(a,b) a ## b
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485332'>
<a class='timestamp' href='#485332'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
#define paste(a,b) paste1(a,b)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485333'>
<a class='timestamp' href='#485333'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
#define LOCK(cs) CCriticalBlock paste(criticalblock,__COUNTER__)(cs, #cs, __FILE__, __LINE__)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485334'>
<a class='timestamp' href='#485334'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
#define TOKENPASTE(x, y) x ## y
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485335'>
<a class='timestamp' href='#485335'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
#define TOKENPASTE2(x, y) TOKENPASTE(x, y)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485336'>
<a class='timestamp' href='#485336'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
#define LOCK(cs) CCriticalBlock TOKENPASTE2(criticalblock, __LINE__)(cs, #cs, __FILE__, __LINE__)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433200' id='485337'>
<a class='timestamp' href='#485337'><time timestamp='2016-08-05T21:40:00Z'>21:40</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
seems to work
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433260' id='485338'>
<a class='timestamp' href='#485338'><time timestamp='2016-08-05T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
\o/
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433260' id='485339'>
<a class='timestamp' href='#485339'><time timestamp='2016-08-05T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
will try COUNTER here
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433320' id='485340'>
<a class='timestamp' href='#485340'><time timestamp='2016-08-05T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
works as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433500' id='485341'>
<a class='timestamp' href='#485341'><time timestamp='2016-08-05T21:45:00Z'>21:45</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
thank you sipa!
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433500' id='485342'>
<a class='timestamp' href='#485342'><time timestamp='2016-08-05T21:45:00Z'>21:45</time></a>
&lt;<span class='nick nick-15'> paveljanik</span>&gt;
Looks like I need some sleep 8)
<br>
</div>

<div class='talk op-msg' data-timestamp='1470433560' id='485343'>
<a class='timestamp' href='#485343'><time timestamp='2016-08-05T21:46:00Z'>21:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
night
<br>
</div>

</div>
</section>

</body>
</html>
