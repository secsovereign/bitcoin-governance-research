<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-11-21
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-11-21' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-10-21">&lt;</a><span class='header'>  November 2015   </span><a href="/bitcoin-core-dev/2015-12-21">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A; <a class="" href="/bitcoin-core-dev/2015-11-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-11-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-11-03">3</a>  <a class="" href="/bitcoin-core-dev/2015-11-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-11-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-11-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-11-07">7</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-11-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-11-09">9</a> <a class="" href="/bitcoin-core-dev/2015-11-10">10</a> <a class="" href="/bitcoin-core-dev/2015-11-11">11</a> <a class="" href="/bitcoin-core-dev/2015-11-12">12</a> <a class="" href="/bitcoin-core-dev/2015-11-13">13</a> <a class="" href="/bitcoin-core-dev/2015-11-14">14</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-15">15</a> <a class="" href="/bitcoin-core-dev/2015-11-16">16</a> <a class="" href="/bitcoin-core-dev/2015-11-17">17</a> <a class="" href="/bitcoin-core-dev/2015-11-18">18</a> <a class="" href="/bitcoin-core-dev/2015-11-19">19</a> <a class="" href="/bitcoin-core-dev/2015-11-20">20</a> <a class="current" href="/bitcoin-core-dev/2015-11-21">21</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-22">22</a> <a class="" href="/bitcoin-core-dev/2015-11-23">23</a> <a class="" href="/bitcoin-core-dev/2015-11-24">24</a> <a class="" href="/bitcoin-core-dev/2015-11-25">25</a> <a class="" href="/bitcoin-core-dev/2015-11-26">26</a> <a class="" href="/bitcoin-core-dev/2015-11-27">27</a> <a class="" href="/bitcoin-core-dev/2015-11-28">28</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-29">29</a> <a class="" href="/bitcoin-core-dev/2015-11-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1448064360' id='439267'>
<a class='timestamp' href='#439267'><time timestamp='2015-11-21T00:06:00Z'>00:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
lol, luke&#x27;s #6851 reduces the time to add 53k tx to the wallet from 843 seconds to 35 seconds.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448066220' id='439268'>
<a class='timestamp' href='#439268'><time timestamp='2015-11-21T00:37:00Z'>00:37</time></a>
&lt;<span class='nick nick-14'> GitHub179</span>&gt;
[bitcoin] pstratem closed pull request #6966: [WIP] Wallet: Cache CWalletDB pointer in CWallet to improve performance (master...wallet_speedup) <a href="https://github.com/bitcoin/bitcoin/pull/6966" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6966</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448067060' id='439269'>
<a class='timestamp' href='#439269'><time timestamp='2015-11-21T00:51:00Z'>00:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: around?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448067060' id='439270'>
<a class='timestamp' href='#439270'><time timestamp='2015-11-21T00:51:00Z'>00:51</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448067240' id='439271'>
<a class='timestamp' href='#439271'><time timestamp='2015-11-21T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, comment changed and merged petertodd&#x27;s fRelayTxs rpc addition
<br>
</div>

<div class='talk op-msg' data-timestamp='1448073480' id='439272'>
<a class='timestamp' href='#439272'><time timestamp='2015-11-21T02:38:00Z'>02:38</time></a>
&lt;<span class='nick nick-2'> GitHub132</span>&gt;
[bitcoin] Har01d opened pull request #7072: [RPC] Add transaction size to JSON output (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/7072" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7072</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074380' id='439273'>
<a class='timestamp' href='#439273'><time timestamp='2015-11-21T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
gmaxwell: <a href="http://0bin.net/paste/vKUjDmnyTyWAkxP2#gkQ4nb" class="link" target="_blank">http://0bin.net/paste/vKUjDmnyTyWAkxP2#gkQ4nb</a>+AGhl0QZKpjE1W0oaQqM0ElXzZMseXDp+fwmY  corruption..
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074380' id='439274'>
<a class='timestamp' href='#439274'><time timestamp='2015-11-21T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
[bitcoin] gmaxwell pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/776848acefa8...616d61b20d56" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/776848acefa8...616d61b20d56</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074380' id='439275'>
<a class='timestamp' href='#439275'><time timestamp='2015-11-21T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
bitcoin/master 3e7c891 Luke Dashjr: Optimisation: Store transaction list order in memory rather than compute it every need...
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074380' id='439276'>
<a class='timestamp' href='#439276'><time timestamp='2015-11-21T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-7'> GitHub123</span>&gt;
bitcoin/master 616d61b Gregory Maxwell: Merge pull request #6851...
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074380' id='439277'>
<a class='timestamp' href='#439277'><time timestamp='2015-11-21T02:53:00Z'>02:53</time></a>
&lt;<span class='nick nick-8'> GitHub42</span>&gt;
[bitcoin] gmaxwell closed pull request #6851: Optimisation: Store transaction list order in memory rather than compute it every need (master...opti_txorder) <a href="https://github.com/bitcoin/bitcoin/pull/6851" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6851</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074440' id='439278'>
<a class='timestamp' href='#439278'><time timestamp='2015-11-21T02:54:00Z'>02:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
midnightmagic: interesting, so that had been running without interruption and just crashed while syncing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074500' id='439279'>
<a class='timestamp' href='#439279'><time timestamp='2015-11-21T02:55:00Z'>02:55</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
gmaxwell: I did a -reindex and -connect to an internal node.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074500' id='439280'>
<a class='timestamp' href='#439280'><time timestamp='2015-11-21T02:55:00Z'>02:55</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
bitcoind -connect=x.y.z.a -listen -daemon -nodnsseed -nodns -reindex
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074560' id='439281'>
<a class='timestamp' href='#439281'><time timestamp='2015-11-21T02:56:00Z'>02:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I guess I need to fix the ppc host to see if I can repro.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074560' id='439282'>
<a class='timestamp' href='#439282'><time timestamp='2015-11-21T02:56:00Z'>02:56</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
Come to think of it.. I&#x27;m not sure this machine has ever reliably sync&#x27;d to head.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074560' id='439283'>
<a class='timestamp' href='#439283'><time timestamp='2015-11-21T02:56:00Z'>02:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
midnightmagic: I think before you might have been failing when it was fine for me.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074620' id='439284'>
<a class='timestamp' href='#439284'><time timestamp='2015-11-21T02:57:00Z'>02:57</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
gmaxwell: Yes. At one point it seemed to be coincident with a hard-disconnect of the network in the middle of a block transfer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448074680' id='439285'>
<a class='timestamp' href='#439285'><time timestamp='2015-11-21T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
Perhaps this machine is just flakey.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448075340' id='439286'>
<a class='timestamp' href='#439286'><time timestamp='2015-11-21T03:09:00Z'>03:09</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
no other evidence of a machine problem. everything else has been running for 300+ days
<br>
</div>

<div class='talk op-msg' data-timestamp='1448075400' id='439287'>
<a class='timestamp' href='#439287'><time timestamp='2015-11-21T03:10:00Z'>03:10</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
drat. another one.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448075400' id='439288'>
<a class='timestamp' href='#439288'><time timestamp='2015-11-21T03:10:00Z'>03:10</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
<a href="http://0bin.net/paste/Jf7jsnULbX4jHJIU#TlLnA8uBw6uxDrYJicVgeOgtgfN37ouH51otjBRT2jC" class="link" target="_blank">http://0bin.net/paste/Jf7jsnULbX4jHJIU#TlLnA8uBw6uxDrYJicVgeOgtgfN37ouH51otjBRT2jC</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448075820' id='439289'>
<a class='timestamp' href='#439289'><time timestamp='2015-11-21T03:17:00Z'>03:17</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
ooo tor stream isolation
<br>
</div>

<div class='talk op-msg' data-timestamp='1448076180' id='439290'>
<a class='timestamp' href='#439290'><time timestamp='2015-11-21T03:23:00Z'>03:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
woot, dual G5 is back up.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448078040' id='439291'>
<a class='timestamp' href='#439291'><time timestamp='2015-11-21T03:54:00Z'>03:54</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
ooo fascinating.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448078100' id='439292'>
<a class='timestamp' href='#439292'><time timestamp='2015-11-21T03:55:00Z'>03:55</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
<a href="http://0bin.net/paste/mK4mOOxCYGHmdN7a#6N5" class="link" target="_blank">http://0bin.net/paste/mK4mOOxCYGHmdN7a#6N5</a>+i3ta5ZuVpyVBPX3Uk5NVna+MZUvDvCz5EGc7cTx
<br>
</div>

<div class='talk op-msg' data-timestamp='1448079180' id='439293'>
<a class='timestamp' href='#439293'><time timestamp='2015-11-21T04:13:00Z'>04:13</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
that&#x27;s weird
<br>
</div>

<div class='talk op-msg' data-timestamp='1448079420' id='439294'>
<a class='timestamp' href='#439294'><time timestamp='2015-11-21T04:17:00Z'>04:17</time></a>
&lt;<span class='nick nick-4'> * midnightmagic</span>&gt;
shrugs and reindexes the main node.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448079840' id='439295'>
<a class='timestamp' href='#439295'><time timestamp='2015-11-21T04:24:00Z'>04:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
in any case, my 2xG5 host seems to be catching up fine with git master.. taking like 10 seconds for some blocks. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1448091540' id='439296'>
<a class='timestamp' href='#439296'><time timestamp='2015-11-21T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
what magic incantation do you do to make it go fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1448113440' id='439297'>
<a class='timestamp' href='#439297'><time timestamp='2015-11-21T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
morcos the linked commit doesn&#x27;t touch TrimToSize, that&#x27;s the next one
<br>
</div>

<div class='talk op-msg' data-timestamp='1448113560' id='439298'>
<a class='timestamp' href='#439298'><time timestamp='2015-11-21T13:46:00Z'>13:46</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
ACK on policy estimator called directly instead of through the mempool (but I&#x27;ve been asked not to worked not to work on policy refactors for now) and that one is certainly disruptive
<br>
</div>

<div class='talk op-msg' data-timestamp='1448113620' id='439299'>
<a class='timestamp' href='#439299'><time timestamp='2015-11-21T13:47:00Z'>13:47</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
setting the attribute by calling TrimToSize seems weird, what&#x27;s wrong with doing it in the constructor (or in a setter if necessary)?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448113680' id='439300'>
<a class='timestamp' href='#439300'><time timestamp='2015-11-21T13:48:00Z'>13:48</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
morcos_: the estimator is currently not asking questions to the mempool and it doesn&#x27;t need to, please don&#x27;t couple that again
<br>
</div>

<div class='talk op-msg' data-timestamp='1448114100' id='439301'>
<a class='timestamp' href='#439301'><time timestamp='2015-11-21T13:55:00Z'>13:55</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
you want the mempool decoupled from policy/fees and I agree, and have done it already in a &quot;private&quot; outdated branch
<br>
</div>

<div class='talk op-msg' data-timestamp='1448114100' id='439302'>
<a class='timestamp' href='#439302'><time timestamp='2015-11-21T13:55:00Z'>13:55</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but to do so, it is not necessary to couple policy/fees to the mempool instead, they can be completely independent
<br>
</div>

<div class='talk op-msg' data-timestamp='1448114160' id='439303'>
<a class='timestamp' href='#439303'><time timestamp='2015-11-21T13:56:00Z'>13:56</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
whenever we think is the moment, I can completely decouple them
<br>
</div>

<div class='talk op-msg' data-timestamp='1448118240' id='439304'>
<a class='timestamp' href='#439304'><time timestamp='2015-11-21T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
jtimon: the question is where shoould the logic live in smartly estimate fees.  in the policyestimator.  that logic requires asking question of the mempool. otherwise you&#x27;re going to have to put that logic repeated in several different places in wallet and gui.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448118240' id='439305'>
<a class='timestamp' href='#439305'><time timestamp='2015-11-21T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
s/live in/live to/
<br>
</div>

<div class='talk op-msg' data-timestamp='1448118360' id='439306'>
<a class='timestamp' href='#439306'><time timestamp='2015-11-21T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
jtimon: the reason I like setting the mempool size in TrimToSize is you can easily imagine logic where the size is non-constant.  So after you have trimmed it the mempool knows what size it currently is  (the logic as to what size to trim it lives outside mempool)
<br>
</div>

<div class='talk op-msg' data-timestamp='1448118360' id='439307'>
<a class='timestamp' href='#439307'><time timestamp='2015-11-21T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
for instance we discussed using less size for the mempool during IBD so you could use more of your allocated memory for the dbcache
<br>
</div>

<div class='talk op-msg' data-timestamp='1448118360' id='439308'>
<a class='timestamp' href='#439308'><time timestamp='2015-11-21T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or you can imagine other scenarios
<br>
</div>

<div class='talk op-msg' data-timestamp='1448124540' id='439309'>
<a class='timestamp' href='#439309'><time timestamp='2015-11-21T16:49:00Z'>16:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
1h 11m to rescan a wallet with 11.7m transactions now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448124660' id='439310'>
<a class='timestamp' href='#439310'><time timestamp='2015-11-21T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
how long for a wallet with 0?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448124780' id='439311'>
<a class='timestamp' href='#439311'><time timestamp='2015-11-21T16:53:00Z'>16:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: less than 10 minutes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448124780' id='439312'>
<a class='timestamp' href='#439312'><time timestamp='2015-11-21T16:53:00Z'>16:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
listunspent on that wallet is taking 2m10s right now (to return 15870 coins)
<br>
</div>

<div class='talk op-msg' data-timestamp='1448124900' id='439313'>
<a class='timestamp' href='#439313'><time timestamp='2015-11-21T16:55:00Z'>16:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Wallet.dat is 11G which isn&#x27;t bad.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448125080' id='439314'>
<a class='timestamp' href='#439314'><time timestamp='2015-11-21T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
bleh, and getinfo takes 1m8s.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448125140' id='439315'>
<a class='timestamp' href='#439315'><time timestamp='2015-11-21T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: It might be useful to add an index of which transactions have unspent coins to make listunspent fast.  But I think with the way balance calculations work getinfo is going to remain slow. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1448125260' id='439316'>
<a class='timestamp' href='#439316'><time timestamp='2015-11-21T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
I have never once had a reason to use listunspent..
<br>
</div>

<div class='talk op-msg' data-timestamp='1448125260' id='439317'>
<a class='timestamp' href='#439317'><time timestamp='2015-11-21T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: it also means selectcoins will be superslow.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448125620' id='439318'>
<a class='timestamp' href='#439318'><time timestamp='2015-11-21T17:07:00Z'>17:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
4m 15s for a getbalance &quot;*&quot; 0 true, I dunno why getinfo is faster.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448129640' id='439319'>
<a class='timestamp' href='#439319'><time timestamp='2015-11-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
::sigh:: we really need a remove feature for the wallet, but the remove needs to keep track of what was removed so rescan doesn&#x27;t read... and we can&#x27;t remove things with spendable txouts because they&#x27;re not seperate.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448129880' id='439320'>
<a class='timestamp' href='#439320'><time timestamp='2015-11-21T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
jonas is still rewriting it, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130120' id='439321'>
<a class='timestamp' href='#439321'><time timestamp='2015-11-21T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We&#x27;ve fucked over the project for years with that kind of thinking; we can&#x27;t stop improving the wallet because of a grand rewrite.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130240' id='439322'>
<a class='timestamp' href='#439322'><time timestamp='2015-11-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sure, it&#x27;s just one of those things that if I were to personally try to do it, I would end up probably rewriting the wallet myself :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130240' id='439323'>
<a class='timestamp' href='#439323'><time timestamp='2015-11-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: what do you mean by remove?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130300' id='439324'>
<a class='timestamp' href='#439324'><time timestamp='2015-11-21T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
remove keys?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130300' id='439325'>
<a class='timestamp' href='#439325'><time timestamp='2015-11-21T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: no, no reason to remove keys. Remove transactions.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130360' id='439326'>
<a class='timestamp' href='#439326'><time timestamp='2015-11-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: right now large parties using bitcoin core have to periodically rotate out wallets to keep things managable. Things are much better now because of varrious fat trimming. (Including the addtowallet fix we just merged from luke)
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130420' id='439327'>
<a class='timestamp' href='#439327'><time timestamp='2015-11-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so more like mark transactions as archived
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130420' id='439328'>
<a class='timestamp' href='#439328'><time timestamp='2015-11-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
?
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130420' id='439329'>
<a class='timestamp' href='#439329'><time timestamp='2015-11-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so they are no longer considered for balance computations etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130420' id='439330'>
<a class='timestamp' href='#439330'><time timestamp='2015-11-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yea, in particular, get them out of the linear scans used to getbalance/listunspent/etc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130480' id='439331'>
<a class='timestamp' href='#439331'><time timestamp='2015-11-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But not do so in a way that causes coins to fall out of balance and listunspent, because that will cause funds loss when you think a wallet is empty and it&#x27;s not.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130540' id='439332'>
<a class='timestamp' href='#439332'><time timestamp='2015-11-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so that could be refusing to archive when there are unspent outputs, but thats kind of obnoxious, since it would make visible wallet internal behavior that the caller shouldn&#x27;t really care about.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130540' id='439333'>
<a class='timestamp' href='#439333'><time timestamp='2015-11-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(Though, otoh, it might encourage sweeping the utxo set. :) )
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130600' id='439334'>
<a class='timestamp' href='#439334'><time timestamp='2015-11-21T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Also, &#x27;the must be spent completely&#x27; rule wouldn&#x27;t be reorg robust.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130600' id='439335'>
<a class='timestamp' href='#439335'><time timestamp='2015-11-21T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
And, of course, an archived transaction shouldn&#x27;t be added back by rescanning.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130660' id='439336'>
<a class='timestamp' href='#439336'><time timestamp='2015-11-21T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Some parties (e.g. bitstamp about a year ago) also complained about the size of the wallet files when they had long histories because it complicated backups; but I think the key exports patch that somewhat.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130720' id='439337'>
<a class='timestamp' href='#439337'><time timestamp='2015-11-21T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
seems easy enough to build a second map inside that does not contain transactions whose outputs have been spent for ages
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130720' id='439338'>
<a class='timestamp' href='#439338'><time timestamp='2015-11-21T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
andnuse that for balance calculations etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1448130840' id='439339'>
<a class='timestamp' href='#439339'><time timestamp='2015-11-21T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think accounts mess this up somewhat; or at least make it not a transparent implementation detail.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448131080' id='439340'>
<a class='timestamp' href='#439340'><time timestamp='2015-11-21T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
uh, right
<br>
</div>

<div class='talk op-msg' data-timestamp='1448131080' id='439341'>
<a class='timestamp' href='#439341'><time timestamp='2015-11-21T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats why I was talking about remove/archive. :-/
<br>
</div>

<div class='talk op-msg' data-timestamp='1448143260' id='439342'>
<a class='timestamp' href='#439342'><time timestamp='2015-11-21T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
[bitcoin] gmaxwell pushed 5 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/616d61b20d56...31de2414c65d" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/616d61b20d56...31de2414c65d</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448143260' id='439343'>
<a class='timestamp' href='#439343'><time timestamp='2015-11-21T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master 748321e Peter Todd: Add mediantime field to getblockchaininfo RPC call...
<br>
</div>

<div class='talk op-msg' data-timestamp='1448143260' id='439344'>
<a class='timestamp' href='#439344'><time timestamp='2015-11-21T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master c277a63 Peter Todd: Clarify nLockTime-by-time comment in CheckFinalTx()
<br>
</div>

<div class='talk op-msg' data-timestamp='1448143260' id='439345'>
<a class='timestamp' href='#439345'><time timestamp='2015-11-21T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master 7259769 Peter Todd: Document new mediantime field in getblockchaininfo
<br>
</div>

<div class='talk op-msg' data-timestamp='1448143260' id='439346'>
<a class='timestamp' href='#439346'><time timestamp='2015-11-21T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-13'> GitHub66</span>&gt;
[bitcoin] gmaxwell closed pull request #7011: Add mediantime to getblockchaininfo (master...2015-11-add-mediantime-to-getblockchaininfo) <a href="https://github.com/bitcoin/bitcoin/pull/7011" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7011</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1448148840' id='439347'>
<a class='timestamp' href='#439347'><time timestamp='2015-11-21T23:34:00Z'>23:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: were you going to fix the trickle logic? it really is broken.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448148900' id='439348'>
<a class='timestamp' href='#439348'><time timestamp='2015-11-21T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes, please!
<br>
</div>

<div class='talk op-msg' data-timestamp='1448148960' id='439349'>
<a class='timestamp' href='#439349'><time timestamp='2015-11-21T23:36:00Z'>23:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;m testing the blocks only mode with relaynetwork client as a whitelisted peer (and I cut out the forced broadcasting for whitelisted peers)... and I&#x27;m watching it instantly inv any tx that comes in to all it&#x27;s neighbors.
<br>
</div>

<div class='talk op-msg' data-timestamp='1448150100' id='439350'>
<a class='timestamp' href='#439350'><time timestamp='2015-11-21T23:55:00Z'>23:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
of course, there is some node connected to me which is sending me every transaction without an INV.
<br>
</div>

</div>
</section>

</body>
</html>
