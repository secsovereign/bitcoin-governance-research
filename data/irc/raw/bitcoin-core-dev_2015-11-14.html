<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-11-14
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-11-14' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-10-14">&lt;</a><span class='header'>  November 2015   </span><a href="/bitcoin-core-dev/2015-12-14">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A; <a class="" href="/bitcoin-core-dev/2015-11-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-11-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-11-03">3</a>  <a class="" href="/bitcoin-core-dev/2015-11-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-11-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-11-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-11-07">7</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-11-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-11-09">9</a> <a class="" href="/bitcoin-core-dev/2015-11-10">10</a> <a class="" href="/bitcoin-core-dev/2015-11-11">11</a> <a class="" href="/bitcoin-core-dev/2015-11-12">12</a> <a class="" href="/bitcoin-core-dev/2015-11-13">13</a> <a class="current" href="/bitcoin-core-dev/2015-11-14">14</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-15">15</a> <a class="" href="/bitcoin-core-dev/2015-11-16">16</a> <a class="" href="/bitcoin-core-dev/2015-11-17">17</a> <a class="" href="/bitcoin-core-dev/2015-11-18">18</a> <a class="" href="/bitcoin-core-dev/2015-11-19">19</a> <a class="" href="/bitcoin-core-dev/2015-11-20">20</a> <a class="" href="/bitcoin-core-dev/2015-11-21">21</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-22">22</a> <a class="" href="/bitcoin-core-dev/2015-11-23">23</a> <a class="" href="/bitcoin-core-dev/2015-11-24">24</a> <a class="" href="/bitcoin-core-dev/2015-11-25">25</a> <a class="" href="/bitcoin-core-dev/2015-11-26">26</a> <a class="" href="/bitcoin-core-dev/2015-11-27">27</a> <a class="" href="/bitcoin-core-dev/2015-11-28">28</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-29">29</a> <a class="" href="/bitcoin-core-dev/2015-11-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1447460640' id='437001'>
<a class='timestamp' href='#437001'><time timestamp='2015-11-14T00:24:00Z'>00:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: jonasschnelli:  Care to give me a quick design sniff test?  I&#x27;m thinking of having someone implement functionality for external signers in Bitcoin core along these lines, <a href="http://0bin.net/paste/7HCkLWNJBDqJB7Up#hPgdwfs06m7FJw-WQZUCBNTNfCZnrix2K0Mo" class="link" target="_blank">http://0bin.net/paste/7HCkLWNJBDqJB7Up#hPgdwfs06m7FJw-WQZUCBNTNfCZnrix2K0Mo</a>++6jpbH
<br>
</div>

<div class='talk op-msg' data-timestamp='1447460700' id='437002'>
<a class='timestamp' href='#437002'><time timestamp='2015-11-14T00:25:00Z'>00:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I realize that some might want a more extensive wallet redesign, but I think this would be good incremental progress and would enable a <u>_lot_</u> of flexibility for minimal code impact.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447478220' id='437003'>
<a class='timestamp' href='#437003'><time timestamp='2015-11-14T05:17:00Z'>05:17</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
[bitcoin] gmaxwell pushed 3 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/dbd2c135ddb9...e0a5ef84272b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/dbd2c135ddb9...e0a5ef84272b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447478220' id='437004'>
<a class='timestamp' href='#437004'><time timestamp='2015-11-14T05:17:00Z'>05:17</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
bitcoin/master 61e1eb2 Peter Todd: Actually use includeWatching value in fundrawtransaction...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447478220' id='437005'>
<a class='timestamp' href='#437005'><time timestamp='2015-11-14T05:17:00Z'>05:17</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
bitcoin/master 10953a7 Peter Todd: Better error message for fundrawtransaction w/ empty vout...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447478220' id='437006'>
<a class='timestamp' href='#437006'><time timestamp='2015-11-14T05:17:00Z'>05:17</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
bitcoin/master e0a5ef8 Gregory Maxwell: Merge pull request #7010...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447478280' id='437007'>
<a class='timestamp' href='#437007'><time timestamp='2015-11-14T05:18:00Z'>05:18</time></a>
&lt;<span class='nick nick-11'> GitHub67</span>&gt;
[bitcoin] gmaxwell closed pull request #7010: Fix fundrawtransaction handling of includeWatching (master...2015-11-fix-fundrawtransaction-bugs) <a href="https://github.com/bitcoin/bitcoin/pull/7010" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7010</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447480740' id='437008'>
<a class='timestamp' href='#437008'><time timestamp='2015-11-14T05:59:00Z'>05:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, thoughts on a &quot;-miner&quot; mode that does things like reduce (or even remove) the sleep calls in some of the networking threads?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447480740' id='437009'>
<a class='timestamp' href='#437009'><time timestamp='2015-11-14T05:59:00Z'>05:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(ie please do everything possible to reduce latency even if you spin my cpu at 100% constantly)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481220' id='437010'>
<a class='timestamp' href='#437010'><time timestamp='2015-11-14T06:07:00Z'>06:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: what sleep calls are there at all in networking? (other than in e.g. connect loops, which are needed to avoid dos attacking peers)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481340' id='437011'>
<a class='timestamp' href='#437011'><time timestamp='2015-11-14T06:09:00Z'>06:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
we probably should have a miner mode regardless. relay nodes have no real need for the mempool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481340' id='437012'>
<a class='timestamp' href='#437012'><time timestamp='2015-11-14T06:09:00Z'>06:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
(they just need to relay and forget, plus some txid record so they can&#x27;t be DoS&#x27;d)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481400' id='437013'>
<a class='timestamp' href='#437013'><time timestamp='2015-11-14T06:10:00Z'>06:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
Luke-Jr, please define relay node more specifically
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481520' id='437014'>
<a class='timestamp' href='#437014'><time timestamp='2015-11-14T06:12:00Z'>06:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
phantomcircuit: a node that wishes to participate (non-leech) in the p2p network, but has no miners
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481520' id='437015'>
<a class='timestamp' href='#437015'><time timestamp='2015-11-14T06:12:00Z'>06:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
Luke-Jr, they require a mempool if they are going to forward transactions otherwise they become a DoS amplifier
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481520' id='437016'>
<a class='timestamp' href='#437016'><time timestamp='2015-11-14T06:12:00Z'>06:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, there&#x27;s a sleep on select() error (im not even sure why that&#x27;s there actually)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481520' id='437017'>
<a class='timestamp' href='#437017'><time timestamp='2015-11-14T06:12:00Z'>06:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
phantomcircuit: why can&#x27;t they just remember txids?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481580' id='437018'>
<a class='timestamp' href='#437018'><time timestamp='2015-11-14T06:13:00Z'>06:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
and there&#x27;s messageHandlerCondition which can be replaced by a spin lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481640' id='437019'>
<a class='timestamp' href='#437019'><time timestamp='2015-11-14T06:14:00Z'>06:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
there&#x27;s also a bunch of other things like changing the defaults for various things to be much much larger
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481640' id='437020'>
<a class='timestamp' href='#437020'><time timestamp='2015-11-14T06:14:00Z'>06:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: forgetting things is not so useful for avoiding the 2x++ redundant transmission when the same data shows up again in a block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481700' id='437021'>
<a class='timestamp' href='#437021'><time timestamp='2015-11-14T06:15:00Z'>06:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, i&#x27;d also add a background thread that just calls CreateNewBlock in a loop trying to improve on the current cached block template
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481760' id='437022'>
<a class='timestamp' href='#437022'><time timestamp='2015-11-14T06:16:00Z'>06:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: hm, that&#x27;s a point
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481760' id='437023'>
<a class='timestamp' href='#437023'><time timestamp='2015-11-14T06:16:00Z'>06:16</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
phantomcircuit: merely calling CNB won&#x27;t use/update the cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481760' id='437024'>
<a class='timestamp' href='#437024'><time timestamp='2015-11-14T06:16:00Z'>06:16</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
Luke-Jr, yes i know
<br>
</div>

<div class='talk op-msg' data-timestamp='1447481820' id='437025'>
<a class='timestamp' href='#437025'><time timestamp='2015-11-14T06:17:00Z'>06:17</time></a>
&lt;<span class='nick nick-3'> * phantomcircuit</span>&gt;
hand waves details
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482240' id='437026'>
<a class='timestamp' href='#437026'><time timestamp='2015-11-14T06:24:00Z'>06:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
Luke-Jr, it&#x27;ll update every 5 seconds if the memory pool was modified, correct?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482240' id='437027'>
<a class='timestamp' href='#437027'><time timestamp='2015-11-14T06:24:00Z'>06:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(or the tip changes obviously)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482300' id='437028'>
<a class='timestamp' href='#437028'><time timestamp='2015-11-14T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
phantomcircuit: the cache is in the RPC code
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482300' id='437029'>
<a class='timestamp' href='#437029'><time timestamp='2015-11-14T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yes i know
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482300' id='437030'>
<a class='timestamp' href='#437030'><time timestamp='2015-11-14T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that&#x27;s the logic though right? (just verifying i read it correctly)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482420' id='437031'>
<a class='timestamp' href='#437031'><time timestamp='2015-11-14T06:27:00Z'>06:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: I was recommending before that we change the gbt behavior to <u>_never_</u> run createnewblock at the time the rpc is called.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482420' id='437032'>
<a class='timestamp' href='#437032'><time timestamp='2015-11-14T06:27:00Z'>06:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, yes that&#x27;s what i would be implementing, a background thread only
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482540' id='437033'>
<a class='timestamp' href='#437033'><time timestamp='2015-11-14T06:29:00Z'>06:29</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
there&#x27;s some interesting optimizations that can be done if we&#x27;re willing to spend a bunch of cpu time on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482600' id='437034'>
<a class='timestamp' href='#437034'><time timestamp='2015-11-14T06:30:00Z'>06:30</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the obvious one is optimizing for the block that pays the highest fee
<br>
</div>

<div class='talk op-msg' data-timestamp='1447482600' id='437035'>
<a class='timestamp' href='#437035'><time timestamp='2015-11-14T06:30:00Z'>06:30</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(or whatever)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447483440' id='437036'>
<a class='timestamp' href='#437036'><time timestamp='2015-11-14T06:44:00Z'>06:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: concept ACK
<br>
</div>

<div class='talk op-msg' data-timestamp='1447483440' id='437037'>
<a class='timestamp' href='#437037'><time timestamp='2015-11-14T06:44:00Z'>06:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell:  I&#x27;d personally prefer not adding more &#x27;invoke external programs&#x27;, I know we already have walletnotify etc but it makes sandboxing the thing harder because we can&#x27;t disable fork/exec 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447483500' id='437038'>
<a class='timestamp' href='#437038'><time timestamp='2015-11-14T06:45:00Z'>06:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: I know there is walletnotify, blocknotify etc but at least we have an alternative notification mechanism for that now, so they may be deprecated in some future version
<br>
</div>

<div class='talk op-msg' data-timestamp='1447483860' id='437039'>
<a class='timestamp' href='#437039'><time timestamp='2015-11-14T06:51:00Z'>06:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: anyhow so I&#x27;m not strongly against that, just wary of it, also with regard to argument shell injection. Although at least that an be easily avoided by executing a program directly instead of using ::system
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484280' id='437040'>
<a class='timestamp' href='#437040'><time timestamp='2015-11-14T06:58:00Z'>06:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
an alternative would be to use a little protocol intead for communicating with the signer
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484400' id='437041'>
<a class='timestamp' href='#437041'><time timestamp='2015-11-14T07:00:00Z'>07:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: hm. we can limit to what we can exec (via seccomp) .. interesting I was thinking the seperate process there was a sandboxing benefit, e.g. because it can have totally distinct selinux / seccomp settings.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484400' id='437042'>
<a class='timestamp' href='#437042'><time timestamp='2015-11-14T07:00:00Z'>07:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sure, just be really careful
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484400' id='437043'>
<a class='timestamp' href='#437043'><time timestamp='2015-11-14T07:00:00Z'>07:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But the biggest reason for the seperate process is to tear down development barriers. E.g. so someone can build a module without the scarryness in bitcoin core. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484400' id='437044'>
<a class='timestamp' href='#437044'><time timestamp='2015-11-14T07:00:00Z'>07:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
walletnotify/blocknotify use ::system that has always bugged me
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484460' id='437045'>
<a class='timestamp' href='#437045'><time timestamp='2015-11-14T07:01:00Z'>07:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sure that&#x27;s why I dont give &quot;integrate it into bitcoin core&quot; as an alternative, but say communicate through a pipe or socket
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484460' id='437046'>
<a class='timestamp' href='#437046'><time timestamp='2015-11-14T07:01:00Z'>07:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: still need a way to start the thing that speaks the protocol.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484520' id='437047'>
<a class='timestamp' href='#437047'><time timestamp='2015-11-14T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
could be similar to e.g. torcontrol.cpp which speaks a simple protocol with Tor
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484520' id='437048'>
<a class='timestamp' href='#437048'><time timestamp='2015-11-14T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But okay, reasonable. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484520' id='437049'>
<a class='timestamp' href='#437049'><time timestamp='2015-11-14T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
true
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484520' id='437050'>
<a class='timestamp' href='#437050'><time timestamp='2015-11-14T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok, let&#x27;s leave that isue for later
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484520' id='437051'>
<a class='timestamp' href='#437051'><time timestamp='2015-11-14T07:02:00Z'>07:02</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for initial version invoking a process is fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1447484580' id='437052'>
<a class='timestamp' href='#437052'><time timestamp='2015-11-14T07:03:00Z'>07:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
just don&#x27;t use ::system :D
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485840' id='437053'>
<a class='timestamp' href='#437053'><time timestamp='2015-11-14T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-3'> GitHub73</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/e0a5ef84272b...36baa9f47587" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/e0a5ef84272b...36baa9f47587</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485840' id='437054'>
<a class='timestamp' href='#437054'><time timestamp='2015-11-14T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-3'> GitHub73</span>&gt;
bitcoin/master b3ae384 Peter Todd: Remove LOCK(cs_main) from decodescript...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485840' id='437055'>
<a class='timestamp' href='#437055'><time timestamp='2015-11-14T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-3'> GitHub73</span>&gt;
bitcoin/master 36baa9f Wladimir J. van der Laan: Merge pull request #7013...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485840' id='437056'>
<a class='timestamp' href='#437056'><time timestamp='2015-11-14T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-2'> GitHub81</span>&gt;
[bitcoin] laanwj closed pull request #7013: Remove LOCK(cs_main) from decodescript (master...2015-11-remove-cs-main-from-decodescript) <a href="https://github.com/bitcoin/bitcoin/pull/7013" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7013</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485960' id='437057'>
<a class='timestamp' href='#437057'><time timestamp='2015-11-14T07:26:00Z'>07:26</time></a>
&lt;<span class='nick nick-14'> GitHub151</span>&gt;
[bitcoin] laanwj pushed 1 new commit to master: <a href="https://github.com/bitcoin/bitcoin/commit/44ac42e50d567b08d3cb3f3c5766588468ce5bbf" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/44ac42e50d567b08d3cb3f3c5766588468ce5bbf</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485960' id='437058'>
<a class='timestamp' href='#437058'><time timestamp='2015-11-14T07:26:00Z'>07:26</time></a>
&lt;<span class='nick nick-14'> GitHub151</span>&gt;
bitcoin/master 44ac42e Wladimir J. van der Laan: Merge pull request #7004...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447485960' id='437059'>
<a class='timestamp' href='#437059'><time timestamp='2015-11-14T07:26:00Z'>07:26</time></a>
&lt;<span class='nick nick-13'> GitHub79</span>&gt;
[bitcoin] laanwj closed pull request #7004: update jonasschnellis gpg key (master...2015/11/signing_key_jonasschnelli) <a href="https://github.com/bitcoin/bitcoin/pull/7004" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7004</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447487700' id='437060'>
<a class='timestamp' href='#437060'><time timestamp='2015-11-14T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> GitHub18</span>&gt;
[bitcoin] gmaxwell pushed 4 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/44ac42e50d56...9ffc687288dd" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/44ac42e50d56...9ffc687288dd</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447487700' id='437061'>
<a class='timestamp' href='#437061'><time timestamp='2015-11-14T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> GitHub18</span>&gt;
bitcoin/master d61fcff Jonas Schnelli: don&#x27;t enforce maxuploadtargets disconnect for whitelisted peers
<br>
</div>

<div class='talk op-msg' data-timestamp='1447487700' id='437062'>
<a class='timestamp' href='#437062'><time timestamp='2015-11-14T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> GitHub18</span>&gt;
bitcoin/master 5760749 Jonas Schnelli: [docs] rename reducetraffic.md to reduce-traffic.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1447487700' id='437063'>
<a class='timestamp' href='#437063'><time timestamp='2015-11-14T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> GitHub18</span>&gt;
bitcoin/master e495ed5 Jonas Schnelli: add documentation for exluding whitelistes peer from maxuploadtarget
<br>
</div>

<div class='talk op-msg' data-timestamp='1447487700' id='437064'>
<a class='timestamp' href='#437064'><time timestamp='2015-11-14T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-3'> GitHub44</span>&gt;
[bitcoin] gmaxwell closed pull request #6984: don&#x27;t enforce maxuploadtarget&#x27;s disconnect for whitelisted peers (master...2015/11/maxupload_whitebind) <a href="https://github.com/bitcoin/bitcoin/pull/6984" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6984</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488420' id='437065'>
<a class='timestamp' href='#437065'><time timestamp='2015-11-14T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: do you have any advice for phantomcircuit on my DEFAULT_BLOCKSONLY complaint?  My response to him was not terribly constructive... in part because I don&#x27;t have any good advice. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488480' id='437066'>
<a class='timestamp' href='#437066'><time timestamp='2015-11-14T08:08:00Z'>08:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;d have merged it already but for that issue.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488600' id='437067'>
<a class='timestamp' href='#437067'><time timestamp='2015-11-14T08:10:00Z'>08:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what is the issue exactly? can&#x27;t find it in the comments
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488660' id='437068'>
<a class='timestamp' href='#437068'><time timestamp='2015-11-14T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I do see DEFAULT_BLOCKSONLY is not actually used (besides documentation)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488660' id='437069'>
<a class='timestamp' href='#437069'><time timestamp='2015-11-14T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but what prevents him from doing that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488660' id='437070'>
<a class='timestamp' href='#437070'><time timestamp='2015-11-14T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh he adds a DEFAULT_BLOCKSONLY, but then doesn&#x27;t use it in the getargs because some of them are in net.cpp.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488660' id='437071'>
<a class='timestamp' href='#437071'><time timestamp='2015-11-14T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
move the constant to net.h?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488660' id='437072'>
<a class='timestamp' href='#437072'><time timestamp='2015-11-14T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
And he would pass it as an argument but apparently pushversion is called in a blinking constructor.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488720' id='437073'>
<a class='timestamp' href='#437073'><time timestamp='2015-11-14T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-2'> * gmaxwell</span>&gt;
checks if he can do that easily
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488720' id='437074'>
<a class='timestamp' href='#437074'><time timestamp='2015-11-14T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in general the constants should be defined in the header of the cpp they are used in
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488720' id='437075'>
<a class='timestamp' href='#437075'><time timestamp='2015-11-14T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if they are used in multiple places that could be annoying, but at least init.cpp already inclused net.h so that&#x27;s not a problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488720' id='437076'>
<a class='timestamp' href='#437076'><time timestamp='2015-11-14T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
:) I&#x27;d assumed there was a reason he couldn&#x27;t do that, but looking now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488780' id='437077'>
<a class='timestamp' href='#437077'><time timestamp='2015-11-14T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yup he can. one is in main.cpp but it also pulls in net.h.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488780' id='437078'>
<a class='timestamp' href='#437078'><time timestamp='2015-11-14T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
otherwise define a global bool and assign that in init.cpp, instead of calling GetBoolArg every time, we do that for more settings (especially those used in inner loops where the overhead of argument-parsing-every-time hurts)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488780' id='437079'>
<a class='timestamp' href='#437079'><time timestamp='2015-11-14T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok!
<br>
</div>

<div class='talk op-msg' data-timestamp='1447488840' id='437080'>
<a class='timestamp' href='#437080'><time timestamp='2015-11-14T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
okay thanks for the cluestick. I&#x27;d assumed that he used them someplace that didn&#x27;t have net.h but I didn&#x27;t look.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447489500' id='437081'>
<a class='timestamp' href='#437081'><time timestamp='2015-11-14T08:25:00Z'>08:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: someone was seeking feedback from you here: <a href="https://github.com/bitcoin/bitcoin/pull/6844" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6844</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494540' id='437082'>
<a class='timestamp' href='#437082'><time timestamp='2015-11-14T09:49:00Z'>09:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
interesting, so this seccomp filter is a little program (in a restricted instruction set) that is uploaded to the kernel that checks system calls and arguments and returns whether allowed or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494600' id='437083'>
<a class='timestamp' href='#437083'><time timestamp='2015-11-14T09:50:00Z'>09:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
never expected it to be so dynamic
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494660' id='437084'>
<a class='timestamp' href='#437084'><time timestamp='2015-11-14T09:51:00Z'>09:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and it should be possible to set it as non-privileged user, given that PR_SET_NO_NEW_PRIVS is set first to avoid tricking set-uid executables with it
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494840' id='437085'>
<a class='timestamp' href='#437085'><time timestamp='2015-11-14T09:54:00Z'>09:54</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sounds ActuallyUseful, should do some experiments with it some time...
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494900' id='437086'>
<a class='timestamp' href='#437086'><time timestamp='2015-11-14T09:55:00Z'>09:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yes. It is. I tried to do it for bitcoin core eons ago, but the utility library was GPLed... they since changed the licensing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494900' id='437087'>
<a class='timestamp' href='#437087'><time timestamp='2015-11-14T09:55:00Z'>09:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(somehow always avoided use of seccomp because I assumed you&#x27;d need root to set them, like chroot etc)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494960' id='437088'>
<a class='timestamp' href='#437088'><time timestamp='2015-11-14T09:56:00Z'>09:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
cjdns uses it without utility library
<br>
</div>

<div class='talk op-msg' data-timestamp='1447494960' id='437089'>
<a class='timestamp' href='#437089'><time timestamp='2015-11-14T09:56:00Z'>09:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
nope. The thing that makes me most sad right now is walletbackup and the import thing, since they require arbritary file access. But I&#x27;d like to replace them with little utility programs, which we&#x27;d let ourselves exec and talk to over pipes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495020' id='437090'>
<a class='timestamp' href='#437090'><time timestamp='2015-11-14T09:57:00Z'>09:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(but cjdns does recommend starting it as root, which was one of the things that put the idea in my head, but they need it for tun setup)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495020' id='437091'>
<a class='timestamp' href='#437091'><time timestamp='2015-11-14T09:57:00Z'>09:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(as well as other jail functionality, which, unfortunately, does need root)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495080' id='437092'>
<a class='timestamp' href='#437092'><time timestamp='2015-11-14T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well my idea at least at first would be to have a restricted, secure mode, that disabled calls like that (and also walletnotify/blocknotify and everything that calls external processes)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495080' id='437093'>
<a class='timestamp' href='#437093'><time timestamp='2015-11-14T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ACK
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495200' id='437094'>
<a class='timestamp' href='#437094'><time timestamp='2015-11-14T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but you&#x27;re right about walletbackup/import, I would prefer if they just dumped/retrieved their data over HTTP instead of making files
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495260' id='437095'>
<a class='timestamp' href='#437095'><time timestamp='2015-11-14T10:01:00Z'>10:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
within the JSON RPC framework this is difficult to solve, but outside that w/ using the http server directly it&#x27;d be pretty easy to stream instead
<br>
</div>

<div class='talk op-msg' data-timestamp='1447495560' id='437096'>
<a class='timestamp' href='#437096'><time timestamp='2015-11-14T10:06:00Z'>10:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think there is some utility for triggering local backups, at least. But instead of arbritary file access it could simply be making it write out dated files; without giving the rpc caller huge freedom.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497000' id='437097'>
<a class='timestamp' href='#437097'><time timestamp='2015-11-14T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
one thing that would make sense is to write to the datadir only
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497000' id='437098'>
<a class='timestamp' href='#437098'><time timestamp='2015-11-14T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it also proves that the user using the calls has access to it
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497060' id='437099'>
<a class='timestamp' href='#437099'><time timestamp='2015-11-14T10:31:00Z'>10:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
on the other hand, of course people want to backup to mounted filesystems etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497120' id='437100'>
<a class='timestamp' href='#437100'><time timestamp='2015-11-14T10:32:00Z'>10:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
hence I&#x27;d really prefer it to stream from/to http so that the client can decide where to put it or take it from, anywhere <b>*they*</b> have access to
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497180' id='437101'>
<a class='timestamp' href='#437101'><time timestamp='2015-11-14T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this avoids using bitcoind in a confused deputy attack (e.g have it write /etc/passwd :-) )
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497240' id='437102'>
<a class='timestamp' href='#437102'><time timestamp='2015-11-14T10:34:00Z'>10:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(or read, for that matter, although you&#x27;d be hard pressed to find a file that it likes to read and interpret)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447497240' id='437103'>
<a class='timestamp' href='#437103'><time timestamp='2015-11-14T10:34:00Z'>10:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(except maybe <b>*other*</b> backups it happens to have access to)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447498680' id='437104'>
<a class='timestamp' href='#437104'><time timestamp='2015-11-14T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
IMO if you want to backup to a mounted FS you can either symlink it into the datadir, or have something external copy there. but ::shrugs::
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500720' id='437105'>
<a class='timestamp' href='#437105'><time timestamp='2015-11-14T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: I wrote a prototype separate thread for running CreateNewBlock, but the naive approach turned out much worse than the existing implementation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500780' id='437106'>
<a class='timestamp' href='#437106'><time timestamp='2015-11-14T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
The issue was that the template creation code kept needing to hold cs_main, so you ended up holding that lock all the time and holding up things like block relay.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500840' id='437107'>
<a class='timestamp' href='#437107'><time timestamp='2015-11-14T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Actually it makes a lot of sense to be sure you are not holding that lock at all when a new block comes in so you can validate it as quickly as possilbe and decide whether you should now be building off that
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500840' id='437108'>
<a class='timestamp' href='#437108'><time timestamp='2015-11-14T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Of course redesigning the template generation code to not need all the locking is probably what we need to do, but it turned out to be a much easier win just to speed up how long it takes
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500900' id='437109'>
<a class='timestamp' href='#437109'><time timestamp='2015-11-14T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
It&#x27;s really a mempool lock it needs but thats unfortunately cs_main partly.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500960' id='437110'>
<a class='timestamp' href='#437110'><time timestamp='2015-11-14T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa and I discussed some ideas on having a transaction storage object, which the mempool and the mining code could separately refer to.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447500960' id='437111'>
<a class='timestamp' href='#437111'><time timestamp='2015-11-14T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
a while back matt was also just suggesting that CNB could terminate early if there was contention for the lock from a new block coming in.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437112'>
<a class='timestamp' href='#437112'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
which sounds a little hackish, but probably the kind of prudent hack that would work pretty well.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437113'>
<a class='timestamp' href='#437113'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
&quot;Look, we&#x27;ve invented cooperative multitasking!&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437114'>
<a class='timestamp' href='#437114'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
unfortunately everything uses cs_main though
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437115'>
<a class='timestamp' href='#437115'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the hold createnewblock would have constantly been holding up ATMP by 3 secs or more
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437116'>
<a class='timestamp' href='#437116'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
old
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501020' id='437117'>
<a class='timestamp' href='#437117'><time timestamp='2015-11-14T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea, not at all a replacement for making it not embarassingly slow.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501080' id='437118'>
<a class='timestamp' href='#437118'><time timestamp='2015-11-14T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m not saying its not fixable, but its a bit of work
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501080' id='437119'>
<a class='timestamp' href='#437119'><time timestamp='2015-11-14T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
::nods::
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501080' id='437120'>
<a class='timestamp' href='#437120'><time timestamp='2015-11-14T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also the other issue is all the package stucture that sdaftuar put into the mempool is potentially really important for mining
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501080' id='437121'>
<a class='timestamp' href='#437121'><time timestamp='2015-11-14T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and so we have to decide whether it makes sense to duplicate all that code
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501080' id='437122'>
<a class='timestamp' href='#437122'><time timestamp='2015-11-14T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
should their be two mempools?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501140' id='437123'>
<a class='timestamp' href='#437123'><time timestamp='2015-11-14T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that are each dynamically updated
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501140' id='437124'>
<a class='timestamp' href='#437124'><time timestamp='2015-11-14T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
should the mining code just copy all it cares about from the real mempool and then do its work
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501140' id='437125'>
<a class='timestamp' href='#437125'><time timestamp='2015-11-14T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or perhaps my favorite approach is to fine grain the locks a little better, and then have a mode where txs can queue up to enter the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501200' id='437126'>
<a class='timestamp' href='#437126'><time timestamp='2015-11-14T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so you can manipulate the actual mempool in the mining code (i think it&#x27;ll be relatively fast)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501200' id='437127'>
<a class='timestamp' href='#437127'><time timestamp='2015-11-14T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but anyway, properly sorting out the locks is a precursor to any of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501200' id='437128'>
<a class='timestamp' href='#437128'><time timestamp='2015-11-14T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
btw, i&#x27;m a bit confused by your 30 secs of the same work for mining hardware
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501260' id='437129'>
<a class='timestamp' href='#437129'><time timestamp='2015-11-14T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i didn&#x27;t analyze too closely, but the antminer seemed to be sending new work much more often than that, or at least considering doing so
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501380' id='437130'>
<a class='timestamp' href='#437130'><time timestamp='2015-11-14T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
All modern devices have internal queing and pipelines so they don&#x27;t stall, some are unfortunately pretty deep.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501500' id='437131'>
<a class='timestamp' href='#437131'><time timestamp='2015-11-14T11:45:00Z'>11:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
will the pool software that phantomcircuit suggested use the longpool feature of gbt, or is that not what most people do
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501560' id='437132'>
<a class='timestamp' href='#437132'><time timestamp='2015-11-14T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
constantly polling getblockcount and getblockhash seems pretty silly (what cgminer does)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501560' id='437133'>
<a class='timestamp' href='#437133'><time timestamp='2015-11-14T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the 30 second rule of thumb is an amalgmation of total delays, in pratice;-- including most pool server software being fairly slow. as far as hardware goes I&#x27;m not sure what the antminer s7 is like; S1 was very good (I beat on them pre-release); S2 was pretty terrible (and completely unusable with p2pool which has 30 second blocks); I think I heard S5 was better than S2, I haven&#x27;t heard about S7
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501560' id='437134'>
<a class='timestamp' href='#437134'><time timestamp='2015-11-14T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
.  KNC devices have quite high latency (seconds to respond to new work in my expirence),  SP10/SP20 have quite low latency. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501620' id='437135'>
<a class='timestamp' href='#437135'><time timestamp='2015-11-14T11:47:00Z'>11:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ckpool uses blocknotify, many things (including p2pool) talk to bitcoind on the p2p port.  Eloipool will use GBT longpool I think, as well as p2p port.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501620' id='437136'>
<a class='timestamp' href='#437136'><time timestamp='2015-11-14T11:47:00Z'>11:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
shocking that there are so many different mining software implementations, when its essentially consensus critical too
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501620' id='437137'>
<a class='timestamp' href='#437137'><time timestamp='2015-11-14T11:47:00Z'>11:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Even when things long poll they can take a really long time to get it out to the devices due to &#x27;reasons&#x27;. (such as almost no one ever actually measuring)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501680' id='437138'>
<a class='timestamp' href='#437138'><time timestamp='2015-11-14T11:48:00Z'>11:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and do the big miners use the existing implementations, or have custom code.   and who maintains all those things
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501680' id='437139'>
<a class='timestamp' href='#437139'><time timestamp='2015-11-14T11:48:00Z'>11:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sorry for the barrage of ?&#x27;s
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501680' id='437140'>
<a class='timestamp' href='#437140'><time timestamp='2015-11-14T11:48:00Z'>11:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: well it&#x27;s armored by bitcoin nodes in and out; not that there haven&#x27;t been problems.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501740' id='437141'>
<a class='timestamp' href='#437141'><time timestamp='2015-11-14T11:49:00Z'>11:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: so historically mining pools have mostly been custom code; sometimes hacked on top of parts openly available.  Historically, public pools spend a lot of their development brainpower on dealing with DOS attacks; then data management for payout computation..
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501800' id='437142'>
<a class='timestamp' href='#437142'><time timestamp='2015-11-14T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
are &quot;pools&quot; still what dominate mining or is it mostly single entities using the pool infrastructure b/c thats what exists
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501860' id='437143'>
<a class='timestamp' href='#437143'><time timestamp='2015-11-14T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So there are still big public pools but many of them have their own hashpower (either directly or in commonly owned partner companies). The exact breakdown of things is unclear.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447501980' id='437144'>
<a class='timestamp' href='#437144'><time timestamp='2015-11-14T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
There are, of course, big entities now and they have simpler mining challenges (e.g. not so much having to worry about DOS).  They sometimes use existing public pools. (I mean some large entities are always on public pools; some only use them sometimes for various reasons)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502040' id='437145'>
<a class='timestamp' href='#437145'><time timestamp='2015-11-14T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Mining ecosystem is weird; as you observe there are a bazillion seperate implementations of this or that... and then no one goes and makes createnewblock fast.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502040' id='437146'>
<a class='timestamp' href='#437146'><time timestamp='2015-11-14T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, thats what i was wondering about
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502100' id='437147'>
<a class='timestamp' href='#437147'><time timestamp='2015-11-14T11:55:00Z'>11:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i suppose for our purposes (not that it would lead to a different design goal) what we should envision is i guess a p2pool implementation
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502100' id='437148'>
<a class='timestamp' href='#437148'><time timestamp='2015-11-14T11:55:00Z'>11:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Only &#x27;mining pool&#x27; people who&#x27;ve really been active in core are luke-jr and phantomcircuit (who used to run the gear for a big-mining entitiy before working at BS).  And mostly, even for these guys the ideal strategy is to work around limitations; because doing so eas easier/safer.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502100' id='437149'>
<a class='timestamp' href='#437149'><time timestamp='2015-11-14T11:55:00Z'>11:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i mean the whole point is to make the small miner able to compete?
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502160' id='437150'>
<a class='timestamp' href='#437150'><time timestamp='2015-11-14T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
E.g. eloipool (the mining pool software luke-jr wrote that runs eligius) compensates for CNB latency by constructing empty blocks on its own, until CNB responds. And most mining operations just run multiple bitcoinds: one for GBT and several others that they submit through.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502160' id='437151'>
<a class='timestamp' href='#437151'><time timestamp='2015-11-14T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-3'> tulip</span>&gt;
morcos: many of the larger pools appear to run completely custom software, for the most part their quirks are completely unique. many of the smaller ones now use ckpool, which seems to be for the most part significantly faster than everybody else. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502220' id='437152'>
<a class='timestamp' href='#437152'><time timestamp='2015-11-14T11:57:00Z'>11:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
tulip: thanks.  i&#x27;m trying to narrow the universe of pool/mining software to explore
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502340' id='437153'>
<a class='timestamp' href='#437153'><time timestamp='2015-11-14T11:59:00Z'>11:59</time></a>
&lt;<span class='nick nick-3'> tulip</span>&gt;
morcos: ckpool, eloipool, p2pool, NOMP 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502340' id='437154'>
<a class='timestamp' href='#437154'><time timestamp='2015-11-14T11:59:00Z'>11:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
P2pool is nice idea with cute features, but has always struggled with the high startup cost of having to run a bitcoin node with it; and then high latency asics showed up (in particular, some of the early BFL products had 10%+ hashrate loss from 10 second retasking)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502400' id='437155'>
<a class='timestamp' href='#437155'><time timestamp='2015-11-14T12:00:00Z'>12:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and that pretty much killed it there, and when it wasn&#x27;t yet dead enough; somewhat later antpool announced that they&#x27;d be converting to p2pool based (but with a friendly front end where they run it for you) and lots of p2pool users moved over, then they didn&#x27;t actually do it. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502400' id='437156'>
<a class='timestamp' href='#437156'><time timestamp='2015-11-14T12:00:00Z'>12:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so now p2pool is too low of a hashrate for anyone who is variance twitchy to use. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502460' id='437157'>
<a class='timestamp' href='#437157'><time timestamp='2015-11-14T12:01:00Z'>12:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh no, thats sad
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502460' id='437158'>
<a class='timestamp' href='#437158'><time timestamp='2015-11-14T12:01:00Z'>12:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Also through this time the developer burned out on Bitcoin, and only does life support maintaince on p2pool now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502520' id='437159'>
<a class='timestamp' href='#437159'><time timestamp='2015-11-14T12:02:00Z'>12:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
at the moment P2Pool&#x27;s hashrate is 918 TH, says my local p2pool node.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502520' id='437160'>
<a class='timestamp' href='#437160'><time timestamp='2015-11-14T12:02:00Z'>12:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(it&#x27;s pretty neat, has a built in webserver and graphs and such)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502580' id='437161'>
<a class='timestamp' href='#437161'><time timestamp='2015-11-14T12:03:00Z'>12:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(Forrestv seems to have flamed out due to a mixture of bitcoin drama, and then donations to support p2pool being relatively low (compared to life changing amounts of income centeralized pool operators were getting), and then he got ripped off ... twice, I think, by mining hardware makers.)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447502820' id='437162'>
<a class='timestamp' href='#437162'><time timestamp='2015-11-14T12:07:00Z'>12:07</time></a>
&lt;<span class='nick nick-3'> tulip</span>&gt;
morcos: there&#x27;s also stratum proxies like bfgminer and stratum-mining-proxy which present work to downstream miners, based on either an upstream work server or a Bitcoin node. the latter was meant for use with early hardware miners which supported getwork but not stratum. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447503000' id='437163'>
<a class='timestamp' href='#437163'><time timestamp='2015-11-14T12:10:00Z'>12:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
then of course there is all these mining devices with embedded mips and arm linux systems that run usually very old versions of cgminer (or sometimes bfgminer)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447503840' id='437164'>
<a class='timestamp' href='#437164'><time timestamp='2015-11-14T12:24:00Z'>12:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: while mentioning p2pool I was looking at my stats, and the 1 year view on GBT latency is amusing: <a href="https://people.xiph.org/~greg/p2pool-gbt.png" class="link" target="_blank">https://people.xiph.org/~greg/p2pool-gbt.png</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447506360' id='437165'>
<a class='timestamp' href='#437165'><time timestamp='2015-11-14T13:06:00Z'>13:06</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
sigh
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507380' id='437166'>
<a class='timestamp' href='#437166'><time timestamp='2015-11-14T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-3'> GitHub86</span>&gt;
[bitcoin] gmaxwell pushed 9 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/9ffc687288dd...b632145edeb3" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/9ffc687288dd...b632145edeb3</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507380' id='437167'>
<a class='timestamp' href='#437167'><time timestamp='2015-11-14T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-3'> GitHub86</span>&gt;
bitcoin/master 4044f07 Patick Strateman: Add blocksonly mode
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507380' id='437168'>
<a class='timestamp' href='#437168'><time timestamp='2015-11-14T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-3'> GitHub86</span>&gt;
bitcoin/master 420fa81 Patick Strateman: Do not process tx inv&#x27;s in blocksonly mode
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507380' id='437169'>
<a class='timestamp' href='#437169'><time timestamp='2015-11-14T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-3'> GitHub86</span>&gt;
bitcoin/master 3a96497 Patick Strateman: Add whitelistalwaysrelay option
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507380' id='437170'>
<a class='timestamp' href='#437170'><time timestamp='2015-11-14T13:23:00Z'>13:23</time></a>
&lt;<span class='nick nick-11'> GitHub168</span>&gt;
[bitcoin] gmaxwell closed pull request #6993: Add -blocksonly option (master...blocksonly) <a href="https://github.com/bitcoin/bitcoin/pull/6993" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6993</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507680' id='437171'>
<a class='timestamp' href='#437171'><time timestamp='2015-11-14T13:28:00Z'>13:28</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, generally speaking.. yes i dont care that cnb is slow because it&#x27;s mostly irrelevant
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507680' id='437172'>
<a class='timestamp' href='#437172'><time timestamp='2015-11-14T13:28:00Z'>13:28</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
and i really dont care that it holds a lock for ages since blocks are submitted to nodes dedicated for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507740' id='437173'>
<a class='timestamp' href='#437173'><time timestamp='2015-11-14T13:29:00Z'>13:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s much less irrelevant if you&#x27;re not assuming a big miner farm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507740' id='437174'>
<a class='timestamp' href='#437174'><time timestamp='2015-11-14T13:29:00Z'>13:29</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, true
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507800' id='437175'>
<a class='timestamp' href='#437175'><time timestamp='2015-11-14T13:30:00Z'>13:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: i thinking having getblocktemplate and createnewblock quickly return a valid block after a new tip is important to everyone
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507800' id='437176'>
<a class='timestamp' href='#437176'><time timestamp='2015-11-14T13:30:00Z'>13:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
even better if it is with txs, but not critical
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507860' id='437177'>
<a class='timestamp' href='#437177'><time timestamp='2015-11-14T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, well making it return <b>*something*</b> immediately afterwards would certainly be nice
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507860' id='437178'>
<a class='timestamp' href='#437178'><time timestamp='2015-11-14T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that would reduce the need for some of the comical hacks
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507860' id='437179'>
<a class='timestamp' href='#437179'><time timestamp='2015-11-14T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
but as gmaxwell said most of the hardware has queues that are very long and dont flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507860' id='437180'>
<a class='timestamp' href='#437180'><time timestamp='2015-11-14T13:31:00Z'>13:31</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(there&#x27;s good reason for this but i wont get into that)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507920' id='437181'>
<a class='timestamp' href='#437181'><time timestamp='2015-11-14T13:32:00Z'>13:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
right so the way i look at it is assuming we don&#x27;t want to code up validationless mining (which i am not yet convinced of)  then we need 100ish ms to validate the new tip and about 100ish ms to generate a new block with txs (with the new code)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507920' id='437182'>
<a class='timestamp' href='#437182'><time timestamp='2015-11-14T13:32:00Z'>13:32</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so at most we could carve out the second 100ms, but at this point we&#x27;ve gotten 95% of the improvement, so maybe not worth doing that unless we are going all the way
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507920' id='437183'>
<a class='timestamp' href='#437183'><time timestamp='2015-11-14T13:32:00Z'>13:32</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, 100ms to return an empty but validated block template would be better :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1447507980' id='437184'>
<a class='timestamp' href='#437184'><time timestamp='2015-11-14T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and before gmaxwell reaches through the tubes to strangle me, my primary argument for considering doing validationless mining is that if people are going to implement it anyway, we might as well make it as safe as possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508040' id='437185'>
<a class='timestamp' href='#437185'><time timestamp='2015-11-14T13:34:00Z'>13:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i agree that if there are other bottlenecks to switching work, then its not something we can do...   (validationless block header then 100-200ms later the validated version, if you can&#x27;t switch after 200ms, then its not safe to start on the unvalidated version)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508100' id='437186'>
<a class='timestamp' href='#437186'><time timestamp='2015-11-14T13:35:00Z'>13:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but that same argument applies much less importantly to empty blocks.  if you&#x27;re not going to switch after 100ms to the block with txs...  then you probably dont&#x27; want to start with the empty block...   depends on the amount of fees and the minimum switching delay i guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508100' id='437187'>
<a class='timestamp' href='#437187'><time timestamp='2015-11-14T13:35:00Z'>13:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
If we want to implement validationless mining, then we need to do it right; which would mean doing something like signaling in the block header what we haven&#x27;t verified prev, and so SPV clients should ignore the block for conf count purposes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508160' id='437188'>
<a class='timestamp' href='#437188'><time timestamp='2015-11-14T13:36:00Z'>13:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But I&#x27;d rather get validation lower first. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508160' id='437189'>
<a class='timestamp' href='#437189'><time timestamp='2015-11-14T13:36:00Z'>13:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, there&#x27;s basically no bottleneck in the validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508220' id='437190'>
<a class='timestamp' href='#437190'><time timestamp='2015-11-14T13:37:00Z'>13:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: sure agreed.   phantomcircuit: no bottleneck? i&#x27;m talking about latency in sending new work to hardware outside of bitcoind
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508220' id='437191'>
<a class='timestamp' href='#437191'><time timestamp='2015-11-14T13:37:00Z'>13:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;d guess that a significant chunk of the remaining 100ms is allocation (in the non degenerate block case)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508280' id='437192'>
<a class='timestamp' href='#437192'><time timestamp='2015-11-14T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, yes... the issue is almost entirely not in validation but in selecting transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508280' id='437193'>
<a class='timestamp' href='#437193'><time timestamp='2015-11-14T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s an interesting point that the extra 100ms doesn&#x27;t matter. But rather, I think getting the 100ms upfront matters, and then it doesn&#x27;t really matter if CNB is slow (except for lock holding reasons)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508280' id='437194'>
<a class='timestamp' href='#437194'><time timestamp='2015-11-14T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the mempool indexing + limiting mostly fixes that
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508280' id='437195'>
<a class='timestamp' href='#437195'><time timestamp='2015-11-14T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
phantomcircuit: huh? no thats backwards.  selecting txs is blazingly fast.  (well until cpfp)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508340' id='437196'>
<a class='timestamp' href='#437196'><time timestamp='2015-11-14T13:39:00Z'>13:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh you&#x27;re talking about in master
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508340' id='437197'>
<a class='timestamp' href='#437197'><time timestamp='2015-11-14T13:39:00Z'>13:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah sure.. i&#x27;m talking about the remaining 100ms...  which is 10ms tx selection and 90 ms validation.   tx selection is still only 20ms if you scan an entire 300mb mempool to also sort by priority (with a fast priority calc)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508400' id='437198'>
<a class='timestamp' href='#437198'><time timestamp='2015-11-14T13:40:00Z'>13:40</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
morcos, im not (and i dont think anybody paying attention) is worried about validation times of 100ms
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508460' id='437199'>
<a class='timestamp' href='#437199'><time timestamp='2015-11-14T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i see 100 ms, and i think the units still need to change.  :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508460' id='437200'>
<a class='timestamp' href='#437200'><time timestamp='2015-11-14T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that&#x27;s like 0.01% orphan rate
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508460' id='437201'>
<a class='timestamp' href='#437201'><time timestamp='2015-11-14T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yes well faster is always better
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508520' id='437202'>
<a class='timestamp' href='#437202'><time timestamp='2015-11-14T13:42:00Z'>13:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hah. I think 100ms is really slow, but people clearly don&#x27;t mind that much. But they don&#x27;t mind in part because they perform hacks; some of which are harmful and we&#x27;d like them to stop. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508520' id='437203'>
<a class='timestamp' href='#437203'><time timestamp='2015-11-14T13:42:00Z'>13:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
actually we are forgetting to measure some things there
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508520' id='437204'>
<a class='timestamp' href='#437204'><time timestamp='2015-11-14T13:42:00Z'>13:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m measuring from receive block to new tip = 100ms  and new tip to new template = 100ms
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508520' id='437205'>
<a class='timestamp' href='#437205'><time timestamp='2015-11-14T13:42:00Z'>13:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
when I say they don&#x27;t mind that much; a year ago there were two places in the network handling code that just interted 100ms _sleeps_. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508520' id='437206'>
<a class='timestamp' href='#437206'><time timestamp='2015-11-14T13:42:00Z'>13:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but we also need to worry about receive most work header to receive block
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508580' id='437207'>
<a class='timestamp' href='#437207'><time timestamp='2015-11-14T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that&#x27;s probably what we need to optimize now
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508580' id='437208'>
<a class='timestamp' href='#437208'><time timestamp='2015-11-14T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yes the push head instead of inv patch is a huge win for that
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508580' id='437209'>
<a class='timestamp' href='#437209'><time timestamp='2015-11-14T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
or even someone else genarates new tip to receiving most work header.  direct headers will help with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508640' id='437210'>
<a class='timestamp' href='#437210'><time timestamp='2015-11-14T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yes, well we can remove a one way delay by nominating your favorite peer to relay uninvited; beyond that needs something like matt&#x27;s relay protocol. (or better)
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508640' id='437211'>
<a class='timestamp' href='#437211'><time timestamp='2015-11-14T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i need to look into how the relay client works...  if you generate a new tip... how do you communicate that to the relay network, same as p2p
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508640' id='437212'>
<a class='timestamp' href='#437212'><time timestamp='2015-11-14T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-3'> * phantomcircuit</span>&gt;
looks at brain clock <b>*wow so late*</b> goes to sleep
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508700' id='437213'>
<a class='timestamp' href='#437213'><time timestamp='2015-11-14T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: the relay network has its own protocol, and a local proxy you run that speaks bitcoin p2p.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508700' id='437214'>
<a class='timestamp' href='#437214'><time timestamp='2015-11-14T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh i suppose if you submitted to a node thats not mining, then it doesn&#x27;t have the problem of that immediate cs_main lock from gbt after you generate a new tim
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508700' id='437215'>
<a class='timestamp' href='#437215'><time timestamp='2015-11-14T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508700' id='437216'>
<a class='timestamp' href='#437216'><time timestamp='2015-11-14T13:45:00Z'>13:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea, thats why the earlier mentioned architecture of multiple nodes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508760' id='437217'>
<a class='timestamp' href='#437217'><time timestamp='2015-11-14T13:46:00Z'>13:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
The relay protocol is super simple. It can send lose transactions, and keeps a history of the X sent. When you want to send a block it sends the header and a list of two byte indexes into that transaction history, as well as any history-miss transactions.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508820' id='437218'>
<a class='timestamp' href='#437218'><time timestamp='2015-11-14T13:47:00Z'>13:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
other end reconstructs the reblock and passes it on to bitcond unsolicited.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447508880' id='437219'>
<a class='timestamp' href='#437219'><time timestamp='2015-11-14T13:48:00Z'>13:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
his server side, passes all transactions through a local bitcoind, and only relays what it spits out.. but for blocks it checks work and relays them on without more then minimal verification.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447509000' id='437220'>
<a class='timestamp' href='#437220'><time timestamp='2015-11-14T13:50:00Z'>13:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
This really simple approach frequently managed to turn 1MB blocks into 3.6KB. <a href="http://bitcoinrelaynetwork.org/stats.html" class="link" target="_blank">http://bitcoinrelaynetwork.org/stats.html</a>  and leaves matt either fighting sha256 speed ... or mempool spam that breaks his hitrates.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447509420' id='437221'>
<a class='timestamp' href='#437221'><time timestamp='2015-11-14T13:57:00Z'>13:57</time></a>
&lt;<span class='nick nick-9'> GitHub101</span>&gt;
[bitcoin] gmaxwell opened pull request #7016: Avoid a compile error on hosts with libevent too old for EVENT_LOG_WARN. (master...without_EVENT_LOG_WARN) <a href="https://github.com/bitcoin/bitcoin/pull/7016" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7016</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447518840' id='437222'>
<a class='timestamp' href='#437222'><time timestamp='2015-11-14T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-8'> vev__</span>&gt;
we need people to support us #libreidea
<br>
</div>

<div class='talk op-msg' data-timestamp='1447527780' id='437223'>
<a class='timestamp' href='#437223'><time timestamp='2015-11-14T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-11'> GitHub50</span>&gt;
[bitcoin] morcos closed pull request #6292: Rename and comment priority calculation in TxMemPoolEntry (master...PriorityComment) <a href="https://github.com/bitcoin/bitcoin/pull/6292" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6292</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1447527960' id='437224'>
<a class='timestamp' href='#437224'><time timestamp='2015-11-14T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Can someone tag #6134 with 0.12 milestone.
<br>
</div>

<div class='talk op-msg' data-timestamp='1447528380' id='437225'>
<a class='timestamp' href='#437225'><time timestamp='2015-11-14T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I also think #6915 should go in for 0.12.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1447537380' id='437226'>
<a class='timestamp' href='#437226'><time timestamp='2015-11-14T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-9'> GitHub136</span>&gt;
[bitcoin] MarcoFalke opened pull request #7019: [trivial] travis: cover <b>*receivedby*</b> rpcs (master...MarcoFalke-2015-receivedby) <a href="https://github.com/bitcoin/bitcoin/pull/7019" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/7019</a>
<br>
</div>

</div>
</section>

</body>
</html>
