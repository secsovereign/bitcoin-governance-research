<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-11-06
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-11-06' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:27 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-10-06">&lt;</a><span class='header'>  November 2015   </span><a href="/bitcoin-core-dev/2015-12-06">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A; <a class="" href="/bitcoin-core-dev/2015-11-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-11-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-11-03">3</a>  <a class="" href="/bitcoin-core-dev/2015-11-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-11-05">5</a>  <a class="current" href="/bitcoin-core-dev/2015-11-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-11-07">7</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-11-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-11-09">9</a> <a class="" href="/bitcoin-core-dev/2015-11-10">10</a> <a class="" href="/bitcoin-core-dev/2015-11-11">11</a> <a class="" href="/bitcoin-core-dev/2015-11-12">12</a> <a class="" href="/bitcoin-core-dev/2015-11-13">13</a> <a class="" href="/bitcoin-core-dev/2015-11-14">14</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-15">15</a> <a class="" href="/bitcoin-core-dev/2015-11-16">16</a> <a class="" href="/bitcoin-core-dev/2015-11-17">17</a> <a class="" href="/bitcoin-core-dev/2015-11-18">18</a> <a class="" href="/bitcoin-core-dev/2015-11-19">19</a> <a class="" href="/bitcoin-core-dev/2015-11-20">20</a> <a class="" href="/bitcoin-core-dev/2015-11-21">21</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-22">22</a> <a class="" href="/bitcoin-core-dev/2015-11-23">23</a> <a class="" href="/bitcoin-core-dev/2015-11-24">24</a> <a class="" href="/bitcoin-core-dev/2015-11-25">25</a> <a class="" href="/bitcoin-core-dev/2015-11-26">26</a> <a class="" href="/bitcoin-core-dev/2015-11-27">27</a> <a class="" href="/bitcoin-core-dev/2015-11-28">28</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-11-29">29</a> <a class="" href="/bitcoin-core-dev/2015-11-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1446781320' id='434577'>
<a class='timestamp' href='#434577'><time timestamp='2015-11-06T03:42:00Z'>03:42</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
a claim/report that running std::bad_alloc can cause a corrupt chainstate.. <a href="https://www.reddit.com/r/Bitcoin/comments/3rp0jb/another_dos_attack_how_to_safely_restart_node/" class="link" target="_blank">https://www.reddit.com/r/Bitcoin/comments/3rp0jb/another_dos_attack_how_to_safely_restart_node/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446782940' id='434578'>
<a class='timestamp' href='#434578'><time timestamp='2015-11-06T04:09:00Z'>04:09</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
jonasschnelli How easy is it for your nightly builder to spin up builds that contain multiple PRs?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784320' id='434579'>
<a class='timestamp' href='#434579'><time timestamp='2015-11-06T04:32:00Z'>04:32</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Thinking #6931/2 + #6918 + #6954 + #6851
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784380' id='434580'>
<a class='timestamp' href='#434580'><time timestamp='2015-11-06T04:33:00Z'>04:33</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
what is &quot;Work Queue depth exceeded&quot; coming from the bitcoin rpc
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784380' id='434581'>
<a class='timestamp' href='#434581'><time timestamp='2015-11-06T04:33:00Z'>04:33</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Its not JSON encoded either
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784380' id='434582'>
<a class='timestamp' href='#434582'><time timestamp='2015-11-06T04:33:00Z'>04:33</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Guessing something we didn&#x27;t catch in libevent?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784440' id='434583'>
<a class='timestamp' href='#434583'><time timestamp='2015-11-06T04:34:00Z'>04:34</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Seems to happen if I smash the RPC with a few hundred requests
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784440' id='434584'>
<a class='timestamp' href='#434584'><time timestamp='2015-11-06T04:34:00Z'>04:34</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
an internal libevent queue of requests waiting to be serviced by the rpc thread(s)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784500' id='434585'>
<a class='timestamp' href='#434585'><time timestamp='2015-11-06T04:35:00Z'>04:35</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Look at the http request callback function in httpserver
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784560' id='434586'>
<a class='timestamp' href='#434586'><time timestamp='2015-11-06T04:36:00Z'>04:36</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
Where is that limit set?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784560' id='434587'>
<a class='timestamp' href='#434587'><time timestamp='2015-11-06T04:36:00Z'>04:36</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
basically a bunch of HTTPWorkItem&#x27;s
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784560' id='434588'>
<a class='timestamp' href='#434588'><time timestamp='2015-11-06T04:36:00Z'>04:36</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
also, wouldn&#x27;t it be better to reply using application logic (aka, the RPC) rather than just &quot;Work queue depth exceeded&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784560' id='434589'>
<a class='timestamp' href='#434589'><time timestamp='2015-11-06T04:36:00Z'>04:36</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
   int workQueueDepth = std::max((long)GetArg(&quot;-rpcworkqueue&quot;, DEFAULT_HTTP_WORK
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784620' id='434590'>
<a class='timestamp' href='#434590'><time timestamp='2015-11-06T04:37:00Z'>04:37</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
ta, why isn&#x27;t my search finding this
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784620' id='434591'>
<a class='timestamp' href='#434591'><time timestamp='2015-11-06T04:37:00Z'>04:37</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1446784620' id='434592'>
<a class='timestamp' href='#434592'><time timestamp='2015-11-06T04:37:00Z'>04:37</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Need to reindex :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786240' id='434593'>
<a class='timestamp' href='#434593'><time timestamp='2015-11-06T05:04:00Z'>05:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: FWIW, in memory UTXO during a IBD currently peaks out at 5486.7MB according to updatetip messages. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786300' id='434594'>
<a class='timestamp' href='#434594'><time timestamp='2015-11-06T05:05:00Z'>05:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: would be interested in what that number is with #6914
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786360' id='434595'>
<a class='timestamp' href='#434595'><time timestamp='2015-11-06T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;ll benchmark a reindex next, and then a reindex with 6914
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786360' id='434596'>
<a class='timestamp' href='#434596'><time timestamp='2015-11-06T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
great
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786360' id='434597'>
<a class='timestamp' href='#434597'><time timestamp='2015-11-06T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
currently waiting on stopnode.... turns out flushing a 5468 MB cache takes an awful long time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786420' id='434598'>
<a class='timestamp' href='#434598'><time timestamp='2015-11-06T05:07:00Z'>05:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
about a minute and a half.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446786540' id='434599'>
<a class='timestamp' href='#434599'><time timestamp='2015-11-06T05:09:00Z'>05:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
FWIW that sync from the network with no checkpoints took 3hrs 39 minutes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446787200' id='434600'>
<a class='timestamp' href='#434600'><time timestamp='2015-11-06T05:20:00Z'>05:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
<a href="https://people.xiph.org/~greg/utxo-memory-2015-11-06.png" class="link" target="_blank">https://people.xiph.org/~greg/utxo-memory-2015-11-06.png</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446787200' id='434601'>
<a class='timestamp' href='#434601'><time timestamp='2015-11-06T05:20:00Z'>05:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
:(
<br>
</div>

<div class='talk op-msg' data-timestamp='1446790680' id='434602'>
<a class='timestamp' href='#434602'><time timestamp='2015-11-06T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: IBD?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446790920' id='434603'>
<a class='timestamp' href='#434603'><time timestamp='2015-11-06T06:22:00Z'>06:22</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, libsecp?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446790980' id='434604'>
<a class='timestamp' href='#434604'><time timestamp='2015-11-06T06:23:00Z'>06:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
dcousens: initial block download
<br>
</div>

<div class='talk op-msg' data-timestamp='1446790980' id='434605'>
<a class='timestamp' href='#434605'><time timestamp='2015-11-06T06:23:00Z'>06:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791040' id='434606'>
<a class='timestamp' href='#434606'><time timestamp='2015-11-06T06:24:00Z'>06:24</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
gmaxwell: and before libsecp?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791100' id='434607'>
<a class='timestamp' href='#434607'><time timestamp='2015-11-06T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
&quot;more&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791100' id='434608'>
<a class='timestamp' href='#434608'><time timestamp='2015-11-06T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
probably also about 3 hours. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791100' id='434609'>
<a class='timestamp' href='#434609'><time timestamp='2015-11-06T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
also with no signature validation.. also about three hours. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791100' id='434610'>
<a class='timestamp' href='#434610'><time timestamp='2015-11-06T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
can&#x27;t really make use of all the cpus on this host.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791100' id='434611'>
<a class='timestamp' href='#434611'><time timestamp='2015-11-06T06:25:00Z'>06:25</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
IO bound?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791160' id='434612'>
<a class='timestamp' href='#434612'><time timestamp='2015-11-06T06:26:00Z'>06:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
no, it&#x27;s cpu bound in all the things that aren&#x27;t signature validation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791160' id='434613'>
<a class='timestamp' href='#434613'><time timestamp='2015-11-06T06:26:00Z'>06:26</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791160' id='434614'>
<a class='timestamp' href='#434614'><time timestamp='2015-11-06T06:26:00Z'>06:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but thats what you get with over 8 cores or so.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791280' id='434615'>
<a class='timestamp' href='#434615'><time timestamp='2015-11-06T06:28:00Z'>06:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(in particular it gets bound on the leveldb, block handing, hashing, etc. and that inserts bubbles in the downloading pipeline)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791340' id='434616'>
<a class='timestamp' href='#434616'><time timestamp='2015-11-06T06:29:00Z'>06:29</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
oh no signature validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791340' id='434617'>
<a class='timestamp' href='#434617'><time timestamp='2015-11-06T06:29:00Z'>06:29</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791460' id='434618'>
<a class='timestamp' href='#434618'><time timestamp='2015-11-06T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: no, this is with signature validation, specifically I&#x27;m testing the libsecp256k1 pull.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791460' id='434619'>
<a class='timestamp' href='#434619'><time timestamp='2015-11-06T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
But if I bench with none it won&#x27;t be much faster.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791460' id='434620'>
<a class='timestamp' href='#434620'><time timestamp='2015-11-06T06:31:00Z'>06:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or openssl much slower. (because it&#x27;ll just manage to use more of the cpus)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791580' id='434621'>
<a class='timestamp' href='#434621'><time timestamp='2015-11-06T06:33:00Z'>06:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ohh
<br>
</div>

<div class='talk op-msg' data-timestamp='1446791700' id='434622'>
<a class='timestamp' href='#434622'><time timestamp='2015-11-06T06:35:00Z'>06:35</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, it&#x27;ll be a bit faster but yeah
<br>
</div>

<div class='talk op-msg' data-timestamp='1446793020' id='434623'>
<a class='timestamp' href='#434623'><time timestamp='2015-11-06T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
dcousens: the work queue is part of the HTTP server, happens before requests are handed off to the appliction logic (REST or RPC)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446793140' id='434624'>
<a class='timestamp' href='#434624'><time timestamp='2015-11-06T06:59:00Z'>06:59</time></a>
&lt;<span class='nick nick-3'> dcousens</span>&gt;
wumpus: all good :), just hadn&#x27;t received it before, caught me off guard
<br>
</div>

<div class='talk op-msg' data-timestamp='1446793260' id='434625'>
<a class='timestamp' href='#434625'><time timestamp='2015-11-06T07:01:00Z'>07:01</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
don&#x27;t know if the default number is high enough, do you hit it under quasi-normal circumstances? at some point under heavy &#x27;abuse&#x27; it&#x27;s better to reject clients instead of adding them to an overlong queue (also to prevents the requests from filling up memory), but the default of 16 may well be too conservative
<br>
</div>

<div class='talk op-msg' data-timestamp='1446793860' id='434626'>
<a class='timestamp' href='#434626'><time timestamp='2015-11-06T07:11:00Z'>07:11</time></a>
&lt;<span class='nick nick-6'> GitHub62</span>&gt;
[bitcoin] MarcoFalke opened pull request #6958: [trivial] Cleanup maxuploadtarget (doc &amp; log) (master...MarcoFalke-2015-maxupload) <a href="https://github.com/bitcoin/bitcoin/pull/6958" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6958</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446794640' id='434627'>
<a class='timestamp' href='#434627'><time timestamp='2015-11-06T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, bleh it&#x27;s really annoying nto having a MAC for the plaintext key
<br>
</div>

<div class='talk op-msg' data-timestamp='1446794640' id='434628'>
<a class='timestamp' href='#434628'><time timestamp='2015-11-06T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
any opposition to storing one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795060' id='434629'>
<a class='timestamp' href='#434629'><time timestamp='2015-11-06T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what plaintext key and MAC are you talking about?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795060' id='434630'>
<a class='timestamp' href='#434630'><time timestamp='2015-11-06T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-12'> * jonasschnelli</span>&gt;
is also wondering...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795180' id='434631'>
<a class='timestamp' href='#434631'><time timestamp='2015-11-06T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
oh the encrypted wallet entires
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795180' id='434632'>
<a class='timestamp' href='#434632'><time timestamp='2015-11-06T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
entires*
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795180' id='434633'>
<a class='timestamp' href='#434633'><time timestamp='2015-11-06T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
entries*
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795180' id='434634'>
<a class='timestamp' href='#434634'><time timestamp='2015-11-06T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the only way to tell which keys go to which master key (technically we support more than one... kind of) is to derive the public key
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795180' id='434635'>
<a class='timestamp' href='#434635'><time timestamp='2015-11-06T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
why do you want to change wallet encryption? it works fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795240' id='434636'>
<a class='timestamp' href='#434636'><time timestamp='2015-11-06T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it&#x27;s very slow and corruption can only be detected when you unlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795240' id='434637'>
<a class='timestamp' href='#434637'><time timestamp='2015-11-06T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
i think phantomcircuits optimizations makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795240' id='434638'>
<a class='timestamp' href='#434638'><time timestamp='2015-11-06T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
we&#x27;re basically using the private key -&gt; public key derivation as a hash function right now
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795240' id='434639'>
<a class='timestamp' href='#434639'><time timestamp='2015-11-06T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
which doesn&#x27;t make a lot of sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795240' id='434640'>
<a class='timestamp' href='#434640'><time timestamp='2015-11-06T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
requiring an explicit pubkey derivation was on purpose, although due to AES padding trick you don&#x27;t actually need tot do it
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795300' id='434641'>
<a class='timestamp' href='#434641'><time timestamp='2015-11-06T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what do you want to optimize? what is not fast enough?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795300' id='434642'>
<a class='timestamp' href='#434642'><time timestamp='2015-11-06T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&#x27;trying more passphrases per second&#x27;? :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795360' id='434643'>
<a class='timestamp' href='#434643'><time timestamp='2015-11-06T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: why do you need one for the plaintext key? you&#x27;re checking the ciphertext.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795360' id='434644'>
<a class='timestamp' href='#434644'><time timestamp='2015-11-06T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, the current check will detect whether you have multiple master keys mixed together into a single wallet file
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795360' id='434645'>
<a class='timestamp' href='#434645'><time timestamp='2015-11-06T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what are we even trying to accomplish here? what is too slow that needs to be optimized?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795420' id='434646'>
<a class='timestamp' href='#434646'><time timestamp='2015-11-06T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I really don&#x27;t like aimless optimization in the context of crypto code :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795420' id='434647'>
<a class='timestamp' href='#434647'><time timestamp='2015-11-06T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: please see his existing PR, thie performance is not the main focus (though its quite slow with large wallets)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795420' id='434648'>
<a class='timestamp' href='#434648'><time timestamp='2015-11-06T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the existing behavior has no integrity checking at all for keys in an encrypted wallet, which is not very safe.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795420' id='434649'>
<a class='timestamp' href='#434649'><time timestamp='2015-11-06T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, the main focus is detecting corruption on load instead of at the first unlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795480' id='434650'>
<a class='timestamp' href='#434650'><time timestamp='2015-11-06T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what I want to avoid is to make it really fast but insecure
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795480' id='434651'>
<a class='timestamp' href='#434651'><time timestamp='2015-11-06T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Nothing he&#x27;s talking about would reduce security.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795480' id='434652'>
<a class='timestamp' href='#434652'><time timestamp='2015-11-06T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
then hashing database records (eg, add a checksum to the data) will work well enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795480' id='434653'>
<a class='timestamp' href='#434653'><time timestamp='2015-11-06T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no need to mess with the crypto
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795480' id='434654'>
<a class='timestamp' href='#434654'><time timestamp='2015-11-06T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: Yes thats what his PR does.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795540' id='434655'>
<a class='timestamp' href='#434655'><time timestamp='2015-11-06T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok, then what&#x27;s the problem?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795540' id='434656'>
<a class='timestamp' href='#434656'><time timestamp='2015-11-06T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
he&#x27;s trying to also eliminate the need for the really slow check on unlock, it sounds like. (which is problamatically slow for wallets with very large numbers of keys)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795600' id='434657'>
<a class='timestamp' href='#434657'><time timestamp='2015-11-06T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the same is avoided already for non-encrypted wallets.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795600' id='434658'>
<a class='timestamp' href='#434658'><time timestamp='2015-11-06T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that never used to be the case, we only have to check one key/value pair
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795600' id='434659'>
<a class='timestamp' href='#434659'><time timestamp='2015-11-06T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you can assure the database is correct some other way
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795600' id='434660'>
<a class='timestamp' href='#434660'><time timestamp='2015-11-06T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
at some point someone wanted to check <b>*all*</b> keys on first unlock, as an integrity check
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795600' id='434661'>
<a class='timestamp' href='#434661'><time timestamp='2015-11-06T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but that&#x27;s not necessary if you add one at the db level
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795660' id='434662'>
<a class='timestamp' href='#434662'><time timestamp='2015-11-06T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that&#x27;s what it does now :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795660' id='434663'>
<a class='timestamp' href='#434663'><time timestamp='2015-11-06T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yeah, I heavily disagreed with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795660' id='434664'>
<a class='timestamp' href='#434664'><time timestamp='2015-11-06T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: We <u>_do_</u> check all of them on first unlock, as there is no other integrity check.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795660' id='434665'>
<a class='timestamp' href='#434665'><time timestamp='2015-11-06T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that indeed makes the first unlock slow on big wallets, that was clear, I even commented that back then
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795660' id='434666'>
<a class='timestamp' href='#434666'><time timestamp='2015-11-06T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, if we&#x27;re OK with saying all the encrypted keys in the wallet have to be from the same master key
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795720' id='434667'>
<a class='timestamp' href='#434667'><time timestamp='2015-11-06T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Sure, and thats still better than having no integrity check.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795720' id='434668'>
<a class='timestamp' href='#434668'><time timestamp='2015-11-06T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
then we dont need the hash on the plaintext key
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795720' id='434669'>
<a class='timestamp' href='#434669'><time timestamp='2015-11-06T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyhow, adding an integrity mechanism at the db level sounds good to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795720' id='434670'>
<a class='timestamp' href='#434670'><time timestamp='2015-11-06T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
but then we should assert if there&#x27;s more than 1 master key entry
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795720' id='434671'>
<a class='timestamp' href='#434671'><time timestamp='2015-11-06T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but please don&#x27;t change this code unnecessarily
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795840' id='434672'>
<a class='timestamp' href='#434672'><time timestamp='2015-11-06T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: does it actually work correctly now if there is more than one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795840' id='434673'>
<a class='timestamp' href='#434673'><time timestamp='2015-11-06T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, it correctly fails
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795840' id='434674'>
<a class='timestamp' href='#434674'><time timestamp='2015-11-06T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
with the hashes it will silently not fail
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795900' id='434675'>
<a class='timestamp' href='#434675'><time timestamp='2015-11-06T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
which would be double plus not good
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795900' id='434676'>
<a class='timestamp' href='#434676'><time timestamp='2015-11-06T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ah so without the exhaustive test it won&#x27;t know that some are encryted but with another key.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795900' id='434677'>
<a class='timestamp' href='#434677'><time timestamp='2015-11-06T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if you just add a checksum to the data, how can it add paths where it will silently work? you just add more checks, so more failures
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795960' id='434678'>
<a class='timestamp' href='#434678'><time timestamp='2015-11-06T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: if he adds the checksum and turns off the exhaustive test (now not so important with the checksum)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795960' id='434679'>
<a class='timestamp' href='#434679'><time timestamp='2015-11-06T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: so make it fail the load if there is more than one master key and call it done.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795960' id='434680'>
<a class='timestamp' href='#434680'><time timestamp='2015-11-06T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1446795960' id='434681'>
<a class='timestamp' href='#434681'><time timestamp='2015-11-06T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so that was the same in most actual releases (before the exhaustive check was added)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796020' id='434682'>
<a class='timestamp' href='#434682'><time timestamp='2015-11-06T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
agreed
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796020' id='434683'>
<a class='timestamp' href='#434683'><time timestamp='2015-11-06T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sounds reasonable to me :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796020' id='434684'>
<a class='timestamp' href='#434684'><time timestamp='2015-11-06T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
at this point having more master keys <b>*means*</b> corruption 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796020' id='434685'>
<a class='timestamp' href='#434685'><time timestamp='2015-11-06T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
are you protecting all records or just the keys?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796080' id='434686'>
<a class='timestamp' href='#434686'><time timestamp='2015-11-06T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in any case, an assert to only have one master key is a good sanity check
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796080' id='434687'>
<a class='timestamp' href='#434687'><time timestamp='2015-11-06T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
who knows what happens with more, did anyone ever test that part...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796140' id='434688'>
<a class='timestamp' href='#434688'><time timestamp='2015-11-06T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, it&#x27;s unfortunately a huge nuisance to protect all the records
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796140' id='434689'>
<a class='timestamp' href='#434689'><time timestamp='2015-11-06T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i should look at doing that more carefully though...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796200' id='434690'>
<a class='timestamp' href='#434690'><time timestamp='2015-11-06T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit: ok, then doing just the keys is a good compromise
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796200' id='434691'>
<a class='timestamp' href='#434691'><time timestamp='2015-11-06T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it is the most important data in the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796200' id='434692'>
<a class='timestamp' href='#434692'><time timestamp='2015-11-06T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
key records are already protected, ckey are not. but yea, most concerning is keys, and I think its a reasonable compromise. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796260' id='434693'>
<a class='timestamp' href='#434693'><time timestamp='2015-11-06T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if this was starting from scratch I&#x27;d want to do it for all data, but I can believe you if you say that becomes too ugly now
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796440' id='434694'>
<a class='timestamp' href='#434694'><time timestamp='2015-11-06T07:54:00Z'>07:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
hmm maybe it&#x27;s not as hard as i was thinking
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796500' id='434695'>
<a class='timestamp' href='#434695'><time timestamp='2015-11-06T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we should keep in mind that older versions should still be able to open the wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796560' id='434696'>
<a class='timestamp' href='#434696'><time timestamp='2015-11-06T07:56:00Z'>07:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, yeah i need to look at the serialization format to be sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796740' id='434697'>
<a class='timestamp' href='#434697'><time timestamp='2015-11-06T07:59:00Z'>07:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
does -debug=bench affect the performance in a recognizable way?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796800' id='434698'>
<a class='timestamp' href='#434698'><time timestamp='2015-11-06T08:00:00Z'>08:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it shouldn&#x27;t - I think the timings are always done, just not logged normally
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796800' id='434699'>
<a class='timestamp' href='#434699'><time timestamp='2015-11-06T08:00:00Z'>08:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so any performance overhead will be in generating more log data
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796860' id='434700'>
<a class='timestamp' href='#434700'><time timestamp='2015-11-06T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
really chatty log messages do, but the debug bench log data is not that chatty.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446796860' id='434701'>
<a class='timestamp' href='#434701'><time timestamp='2015-11-06T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
okay. thanks... i do no compare the IBD time of the secp256k1 branch with master (with standard parameters)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446797160' id='434702'>
<a class='timestamp' href='#434702'><time timestamp='2015-11-06T08:06:00Z'>08:06</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
*now
<br>
</div>

<div class='talk op-msg' data-timestamp='1446797220' id='434703'>
<a class='timestamp' href='#434703'><time timestamp='2015-11-06T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
are there windows builds for 6954 ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446797340' id='434704'>
<a class='timestamp' href='#434704'><time timestamp='2015-11-06T08:09:00Z'>08:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
As far as protecting all the data goes, --- assuming it could be compatible it would be useful, though otoh, it would be nice to keep the checksums for pubkeys around in memory so we could test against at point of use to reduce the window for corruption further.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446797520' id='434705'>
<a class='timestamp' href='#434705'><time timestamp='2015-11-06T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: sure: <a href="https://bitcoin.jonasschnelli.ch/pulls/6954/" class="link" target="_blank">https://bitcoin.jonasschnelli.ch/pulls/6954/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446798600' id='434706'>
<a class='timestamp' href='#434706'><time timestamp='2015-11-06T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: 3h 16m for the reindex on that host. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446801300' id='434707'>
<a class='timestamp' href='#434707'><time timestamp='2015-11-06T09:15:00Z'>09:15</time></a>
&lt;<span class='nick nick-7'> arowser</span>&gt;
gmaxwell: I got the the error: ‘EVENT_LOG_WARN’ when try to build master on ubuntu12.04, the libevent version is 2.0-5, and I found you got the same error in 10-21 <a href="https://botbot.me/freenode/bitcoin-core-dev/2015-10-21/?msg=52437191&amp;page=2" class="link" target="_blank">https://botbot.me/freenode/bitcoin-core-dev/2015-10-21/?msg=52437191&amp;page=2</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446801360' id='434708'>
<a class='timestamp' href='#434708'><time timestamp='2015-11-06T09:16:00Z'>09:16</time></a>
&lt;<span class='nick nick-7'> arowser</span>&gt;
Is that a known issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1446801480' id='434709'>
<a class='timestamp' href='#434709'><time timestamp='2015-11-06T09:18:00Z'>09:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, that is a known issue, should be easy to solve by adding some ifdefs
<br>
</div>

<div class='talk op-msg' data-timestamp='1446809280' id='434710'>
<a class='timestamp' href='#434710'><time timestamp='2015-11-06T11:28:00Z'>11:28</time></a>
&lt;<span class='nick nick-5'> GitHub98</span>&gt;
[bitcoin] MarcoFalke opened pull request #6961: luke-jr constants (master...luke-jr-const) <a href="https://github.com/bitcoin/bitcoin/pull/6961" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6961</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446812760' id='434711'>
<a class='timestamp' href='#434711'><time timestamp='2015-11-06T12:26:00Z'>12:26</time></a>
&lt;<span class='nick nick-5'> GitHub13</span>&gt;
[bitcoin] MarcoFalke opened pull request #6962: translations: Don&#x27;t translate markup or force English grammar (master...MarcoFalke-2015-translations) <a href="https://github.com/bitcoin/bitcoin/pull/6962" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6962</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446815280' id='434712'>
<a class='timestamp' href='#434712'><time timestamp='2015-11-06T13:08:00Z'>13:08</time></a>
&lt;<span class='nick nick-2'> GitHub153</span>&gt;
[bitcoin] laanwj closed pull request #6825: Backport bugfixes to 0.11 (2015-10-22 / f2c869a) (0.11...backport-bugfixes-to-0.11-20151014) <a href="https://github.com/bitcoin/bitcoin/pull/6825" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6825</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446815280' id='434713'>
<a class='timestamp' href='#434713'><time timestamp='2015-11-06T13:08:00Z'>13:08</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
[bitcoin] laanwj pushed 18 new commits to 0.11: <a href="https://github.com/bitcoin/bitcoin/compare/df616ae43ed4...6c31ac019f1b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/df616ae43ed4...6c31ac019f1b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446815280' id='434714'>
<a class='timestamp' href='#434714'><time timestamp='2015-11-06T13:08:00Z'>13:08</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
bitcoin/0.11 9b9acc2 Diego Viola: Fix spelling of Qt
<br>
</div>

<div class='talk op-msg' data-timestamp='1446815280' id='434715'>
<a class='timestamp' href='#434715'><time timestamp='2015-11-06T13:08:00Z'>13:08</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
bitcoin/0.11 01878c9 Alex Morcos: Fix locking in GetTransaction....
<br>
</div>

<div class='talk op-msg' data-timestamp='1446815280' id='434716'>
<a class='timestamp' href='#434716'><time timestamp='2015-11-06T13:08:00Z'>13:08</time></a>
&lt;<span class='nick nick-13'> GitHub120</span>&gt;
bitcoin/0.11 b3eaa30 MarcoFalke: [Qt] Raise debug window when requested...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446816780' id='434717'>
<a class='timestamp' href='#434717'><time timestamp='2015-11-06T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-13'> GitHub30</span>&gt;
[bitcoin] laanwj pushed 1 new commit to 0.11: <a href="https://github.com/bitcoin/bitcoin/commit/4e895b08da5dc2dfa94ccefb24632062481a8d97" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/4e895b08da5dc2dfa94ccefb24632062481a8d97</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446816780' id='434718'>
<a class='timestamp' href='#434718'><time timestamp='2015-11-06T13:33:00Z'>13:33</time></a>
&lt;<span class='nick nick-13'> GitHub30</span>&gt;
bitcoin/0.11 4e895b0 Pieter Wuille: Always flush block and undo when switching to new file...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446817020' id='434719'>
<a class='timestamp' href='#434719'><time timestamp='2015-11-06T13:37:00Z'>13:37</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
gmaxwell: sipa: off the top of your head, do you have a sense of the relative speed of calculating a sha256 hash versus performing a signature validation using secp?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446817080' id='434720'>
<a class='timestamp' href='#434720'><time timestamp='2015-11-06T13:38:00Z'>13:38</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
256x2 itym?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446817140' id='434721'>
<a class='timestamp' href='#434721'><time timestamp='2015-11-06T13:39:00Z'>13:39</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
yeah probably that is what i mean
<br>
</div>

<div class='talk op-msg' data-timestamp='1446817260' id='434722'>
<a class='timestamp' href='#434722'><time timestamp='2015-11-06T13:41:00Z'>13:41</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
actually it might not be what i mean, i think #6918 (which i&#x27;m analyzing performance on now) does a single sha256 if i&#x27;m reading the code right
<br>
</div>

<div class='talk op-msg' data-timestamp='1446820860' id='434723'>
<a class='timestamp' href='#434723'><time timestamp='2015-11-06T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: re my comment on flushing undo files.  i think i didn&#x27;t realize that a reindex could pick up from where it left off.  so it still reads through all the block files, but if the hash is in mapBlockIndex it skips processing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446820860' id='434724'>
<a class='timestamp' href='#434724'><time timestamp='2015-11-06T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1446820860' id='434725'>
<a class='timestamp' href='#434725'><time timestamp='2015-11-06T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i was assuming the corruption happened after a reindex finished, but before the flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1446820860' id='434726'>
<a class='timestamp' href='#434726'><time timestamp='2015-11-06T14:41:00Z'>14:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, thx
<br>
</div>

<div class='talk op-msg' data-timestamp='1446820920' id='434727'>
<a class='timestamp' href='#434727'><time timestamp='2015-11-06T14:42:00Z'>14:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it used to remember where it was, but this is complicated by block files being possibly out of order, so now it scans from the beginning again after restart (but this goes pretty fast)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446828360' id='434728'>
<a class='timestamp' href='#434728'><time timestamp='2015-11-06T16:46:00Z'>16:46</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
IBD up to 382324 with secp256k1 branch took 9 hours... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446828360' id='434729'>
<a class='timestamp' href='#434729'><time timestamp='2015-11-06T16:46:00Z'>16:46</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
standard parameters
<br>
</div>

<div class='talk op-msg' data-timestamp='1446828420' id='434730'>
<a class='timestamp' href='#434730'><time timestamp='2015-11-06T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Quad Core Intel(R) Xeon(R) CPU E31245 @ 3.30GHz
<br>
</div>

<div class='talk op-msg' data-timestamp='1446828420' id='434731'>
<a class='timestamp' href='#434731'><time timestamp='2015-11-06T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
16GB ram (but i did not change -dbcache)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446828600' id='434732'>
<a class='timestamp' href='#434732'><time timestamp='2015-11-06T16:50:00Z'>16:50</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(now doing the same with current master [openssl], just curios how the performance benefit are with standard args on a standard system)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829500' id='434733'>
<a class='timestamp' href='#434733'><time timestamp='2015-11-06T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: a verify with libsecp256k1 as it&#x27;s used in bitcoin core is 280 times slower than a single run of the sha256 compression function.  That PR ends up calling the sha256 compression function twice.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829680' id='434734'>
<a class='timestamp' href='#434734'><time timestamp='2015-11-06T17:08:00Z'>17:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: I think at some point we should add a faster cryptgraphic hash to the source code base for these internal non-normative uses. (E.g. blake2 is a bit over 5x faster than sha2-256; though if the user has a not-yet-released cpu with a sha256 instruction, sha256 will be faster again).
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829800' id='434735'>
<a class='timestamp' href='#434735'><time timestamp='2015-11-06T17:10:00Z'>17:10</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
gmaxwell: thanks.  i was investigating whether the use of sha256 in the PR might cause an unexpected slowdown...  after some more investigation i think my concern was misplaced, it looks like any &quot;slowdown&quot; is pretty minuscule, and i think i wasn&#x27;t hitting the conditions under which the PR would provide expected speedups.  will keep testing...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829800' id='434736'>
<a class='timestamp' href='#434736'><time timestamp='2015-11-06T17:10:00Z'>17:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: figuring out the if there was any tradeoff there is part of why pieter was measuring the cache performance with many sizes (because a small amount of hitrate increase offsets any constant cost).  Also, the remove operation in the current code ends up being pretty slow compared to the hashing, in fact.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829860' id='434737'>
<a class='timestamp' href='#434737'><time timestamp='2015-11-06T17:11:00Z'>17:11</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
because of map versus unordered_map?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446829980' id='434738'>
<a class='timestamp' href='#434738'><time timestamp='2015-11-06T17:13:00Z'>17:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446830160' id='434739'>
<a class='timestamp' href='#434739'><time timestamp='2015-11-06T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: 6954 results--- so reindex with libsecp256k1,  without 6954 was 3hr 16 minutes, reindex with it was <u>_2 hours_</u> 7 minutes.  Going to benchmark without signature validation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446830220' id='434740'>
<a class='timestamp' href='#434740'><time timestamp='2015-11-06T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
UTXO in memory at the end was 4012 MB. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831300' id='434741'>
<a class='timestamp' href='#434741'><time timestamp='2015-11-06T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: so from 5486 MB to 4012 MB, because of 6914?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831300' id='434742'>
<a class='timestamp' href='#434742'><time timestamp='2015-11-06T17:35:00Z'>17:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: 6954 is libsecp validation, so i guess you mean 6914 instead?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831480' id='434743'>
<a class='timestamp' href='#434743'><time timestamp='2015-11-06T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: is 6914 something you think should be considered for 0.12.  i haven&#x27;t really looked at it much, but i&#x27;d happily test it out if you think its a near term consideration?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831480' id='434744'>
<a class='timestamp' href='#434744'><time timestamp='2015-11-06T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: oops yes. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831540' id='434745'>
<a class='timestamp' href='#434745'><time timestamp='2015-11-06T17:39:00Z'>17:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i&#x27;m not sure what i can do more for it than get review
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831600' id='434746'>
<a class='timestamp' href='#434746'><time timestamp='2015-11-06T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell&#x27;s test seems to indicate there is a HUGE speed improvment, thats from allocation overhead? i think that would be something nice to test in my Connect Block benching
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831600' id='434747'>
<a class='timestamp' href='#434747'><time timestamp='2015-11-06T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: understood, but it wasn&#x27;t clear to me from your previous conversation with gmaxwell whether you even wanted to do 6914 or wanted to wait and do a bigger change
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831600' id='434748'>
<a class='timestamp' href='#434748'><time timestamp='2015-11-06T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: as far as my reading of the specification is concerned, i think it&#x27;s fully compatible with std::vector
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831600' id='434749'>
<a class='timestamp' href='#434749'><time timestamp='2015-11-06T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i don&#x27;t think a bigger change is in scope 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831660' id='434750'>
<a class='timestamp' href='#434750'><time timestamp='2015-11-06T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i mean... i&#x27;d like to change allocation of scripts to some pooled storage per block and tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831660' id='434751'>
<a class='timestamp' href='#434751'><time timestamp='2015-11-06T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
One third less sync time and 25% less memory consumption is pretty nice.  These results don&#x27;t surprise me -- well, so I&#x27;m a little surprised that <u>_just_</u> fixing the scripts did this, I would be less surprised if the whole cache entry were made a single allocation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831720' id='434752'>
<a class='timestamp' href='#434752'><time timestamp='2015-11-06T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: yes thats what i was referring to, but that doesnt mean you don&#x27;t want 6914 for now is what i&#x27;m clarifying, you still do want 6914
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831780' id='434753'>
<a class='timestamp' href='#434753'><time timestamp='2015-11-06T17:43:00Z'>17:43</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell, i was seeing a significant chunk of ConnectBlock time being just destroying the temporary cache at the end.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831840' id='434754'>
<a class='timestamp' href='#434754'><time timestamp='2015-11-06T17:44:00Z'>17:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
while i have you both here.  do you have any thoughts on how we could get rid of the 1 remaining database lookup for the coinbase in 6932
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831840' id='434755'>
<a class='timestamp' href='#434755'><time timestamp='2015-11-06T17:44:00Z'>17:44</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i hate that you have to access the DB for every block just in case you&#x27;re processing the 2 historical violations of BIP 30
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831960' id='434756'>
<a class='timestamp' href='#434756'><time timestamp='2015-11-06T17:46:00Z'>17:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
looking
<br>
</div>

<div class='talk op-msg' data-timestamp='1446831960' id='434757'>
<a class='timestamp' href='#434757'><time timestamp='2015-11-06T17:46:00Z'>17:46</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
morcos, agreed
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832020' id='434758'>
<a class='timestamp' href='#434758'><time timestamp='2015-11-06T17:47:00Z'>17:47</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
that wants fixing (as you&#x27;ve proposed)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832080' id='434759'>
<a class='timestamp' href='#434759'><time timestamp='2015-11-06T17:48:00Z'>17:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
maybe i&#x27;m trying to overoptimize, but i wasn&#x27;t able to eliminate checking the database for preexisting coins when you are creating the new outputs for a new coinbase
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832380' id='434760'>
<a class='timestamp' href='#434760'><time timestamp='2015-11-06T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: how about writing them and just not marking them as fresh?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832380' id='434761'>
<a class='timestamp' href='#434761'><time timestamp='2015-11-06T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
make ModifyNewCoins take a boolean fPossiblePreexisting or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832380' id='434762'>
<a class='timestamp' href='#434762'><time timestamp='2015-11-06T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that was my first plan, but it assert fails
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832440' id='434763'>
<a class='timestamp' href='#434763'><time timestamp='2015-11-06T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the code assumes that if you&#x27;re not fresh you must exist in the parent
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832440' id='434764'>
<a class='timestamp' href='#434764'><time timestamp='2015-11-06T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i see
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832440' id='434765'>
<a class='timestamp' href='#434765'><time timestamp='2015-11-06T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe that can be relaxed
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832440' id='434766'>
<a class='timestamp' href='#434766'><time timestamp='2015-11-06T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think you coudl remove that assert, but i didn&#x27;t like making that change
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832620' id='434767'>
<a class='timestamp' href='#434767'><time timestamp='2015-11-06T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so the idea i&#x27;ve been hesitant to suggest is to actually check if its one of those two hashes
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832620' id='434768'>
<a class='timestamp' href='#434768'><time timestamp='2015-11-06T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yuck
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832620' id='434769'>
<a class='timestamp' href='#434769'><time timestamp='2015-11-06T17:57:00Z'>17:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
hence the hesitancy, but its really more clear as to why you&#x27;re doing what you&#x27;re doing
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832680' id='434770'>
<a class='timestamp' href='#434770'><time timestamp='2015-11-06T17:58:00Z'>17:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
otherwise you have to have a long winded explanation of why you treat a coinbase differently anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832680' id='434771'>
<a class='timestamp' href='#434771'><time timestamp='2015-11-06T17:58:00Z'>17:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also i assume way faster than having to not mark all coinbases as fresh or first check the database for them
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832740' id='434772'>
<a class='timestamp' href='#434772'><time timestamp='2015-11-06T17:59:00Z'>17:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i don&#x27;t know maybe not faster that not FRESH marking i guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832800' id='434773'>
<a class='timestamp' href='#434773'><time timestamp='2015-11-06T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
anyway, lunch..  i&#x27;m happy to do whatever you guys are most comfortable with
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832800' id='434774'>
<a class='timestamp' href='#434774'><time timestamp='2015-11-06T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: the only advantage of fresh is that it&#x27;s removed from memory altogether before hitting disk, if it&#x27;s spent before flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1446832920' id='434775'>
<a class='timestamp' href='#434775'><time timestamp='2015-11-06T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: right. so i guess that doesn&#x27;t happen unless you have a big cache, with coinbases...   but even if it happens a small fraction of the time, a DB write has to be orders of magnitude more expensive than checking 2 hashes on every coinbase
<br>
</div>

<div class='talk op-msg' data-timestamp='1446833340' id='434776'>
<a class='timestamp' href='#434776'><time timestamp='2015-11-06T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i think removing the assertion is fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1446833460' id='434777'>
<a class='timestamp' href='#434777'><time timestamp='2015-11-06T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: my sigcache performance at 320 MB (with validating everything) keeps improving (it&#x27;s an exponentially decaying average with 0.99 factor per block, so ~half a day halflife), down to 6% now
<br>
</div>

<div class='talk op-msg' data-timestamp='1446833640' id='434778'>
<a class='timestamp' href='#434778'><time timestamp='2015-11-06T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: feel like commenting on 6914?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446833760' id='434779'>
<a class='timestamp' href='#434779'><time timestamp='2015-11-06T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i guess in 6914 i can add more comments that refer to the specification and unit tests for the iterators
<br>
</div>

<div class='talk op-msg' data-timestamp='1446834960' id='434780'>
<a class='timestamp' href='#434780'><time timestamp='2015-11-06T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: what size in MB would be equivalent to a 1M sigcache of the old version
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835020' id='434781'>
<a class='timestamp' href='#434781'><time timestamp='2015-11-06T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i tried 80MB which was my guess from the pull, and verification seemed to get a little faster, but overall run time slowed down
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835020' id='434782'>
<a class='timestamp' href='#434782'><time timestamp='2015-11-06T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: it should be around 3 times smaller
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835020' id='434783'>
<a class='timestamp' href='#434783'><time timestamp='2015-11-06T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
between 70 and 85 bytes per entry now
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835020' id='434784'>
<a class='timestamp' href='#434784'><time timestamp='2015-11-06T18:37:00Z'>18:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
around 220 before
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835440' id='434785'>
<a class='timestamp' href='#434785'><time timestamp='2015-11-06T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: will comment when I&#x27;ve through testing things with it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835500' id='434786'>
<a class='timestamp' href='#434786'><time timestamp='2015-11-06T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
reindex with 6914 and no signature checks, 1h 17m. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446835920' id='434787'>
<a class='timestamp' href='#434787'><time timestamp='2015-11-06T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: did you benchmark adding things to the sigcache, or only looking them up?  I&#x27;m wondering if calling GetRand() that often is too expensive.  something slowed down for me for sure...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836100' id='434788'>
<a class='timestamp' href='#434788'><time timestamp='2015-11-06T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: it GetRand&#x27;s on evicition (and the initial initilization) but not otherwise.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836160' id='434789'>
<a class='timestamp' href='#434789'><time timestamp='2015-11-06T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i guess in the steady state it shouldn&#x27;t be more than a couple evictions per new tx..   hmm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836460' id='434790'>
<a class='timestamp' href='#434790'><time timestamp='2015-11-06T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: the eviction takes like a microsecond
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836520' id='434791'>
<a class='timestamp' href='#434791'><time timestamp='2015-11-06T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah i misremembered GetRand speed, but its a tad under a micro, i thought it was a few micros.  still maybe better to use insecure_rand(), but doesn&#x27;t explain my performance issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836520' id='434792'>
<a class='timestamp' href='#434792'><time timestamp='2015-11-06T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: in any case, the getrand is certainly the largest cpu time offender in the sigcache behaviour
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836520' id='434793'>
<a class='timestamp' href='#434793'><time timestamp='2015-11-06T19:02:00Z'>19:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
more than the hash
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836580' id='434794'>
<a class='timestamp' href='#434794'><time timestamp='2015-11-06T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m checking to see if i didn&#x27;t match cache sizes, but i don&#x27;t think thats the problem, since verification did speed up
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836580' id='434795'>
<a class='timestamp' href='#434795'><time timestamp='2015-11-06T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
its the rest of the run time that slowed down... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836580' id='434796'>
<a class='timestamp' href='#434796'><time timestamp='2015-11-06T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do you measure this by running two nodes in parallel?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836580' id='434797'>
<a class='timestamp' href='#434797'><time timestamp='2015-11-06T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or just long period of time averaging?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836700' id='434798'>
<a class='timestamp' href='#434798'><time timestamp='2015-11-06T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: where exactly are you seeing slowdown?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836700' id='434799'>
<a class='timestamp' href='#434799'><time timestamp='2015-11-06T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
total time to run a simulation over 7 days, increased by about 5%
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836760' id='434800'>
<a class='timestamp' href='#434800'><time timestamp='2015-11-06T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
interesting!
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836760' id='434801'>
<a class='timestamp' href='#434801'><time timestamp='2015-11-06T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
time spent in Connect Block had about a 10% decrease (but this number i&#x27;ve found has a lot of noise, i think due to the vagaries of the level db cache and/or whatever else is happening with my hard disk)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836820' id='434802'>
<a class='timestamp' href='#434802'><time timestamp='2015-11-06T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
btw, have you thought about the effect on reorgs
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836820' id='434803'>
<a class='timestamp' href='#434803'><time timestamp='2015-11-06T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
reorgs are already incredibly slow, and now you&#x27;ve just lost the signature cache for every tx in the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836940' id='434804'>
<a class='timestamp' href='#434804'><time timestamp='2015-11-06T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
maybe we can skip signature checking on blocks added back from a reorg?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446836940' id='434805'>
<a class='timestamp' href='#434805'><time timestamp='2015-11-06T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
txs from the disconnected block added to the mempool that is
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837000' id='434806'>
<a class='timestamp' href='#434806'><time timestamp='2015-11-06T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
eh, that won&#x27;t help since a bunch of them will need to be checked if they are included inthe replacement block
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837300' id='434807'>
<a class='timestamp' href='#434807'><time timestamp='2015-11-06T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: looks like it might be GetRand().  just ran with insecure_rand and it was a 5% overall speedup instead.  i&#x27;m going to try again removing a bunch of extraneous debugging i have.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837480' id='434808'>
<a class='timestamp' href='#434808'><time timestamp='2015-11-06T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: oh, that&#x27;s an optimization i&#x27;ve thought about before
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837480' id='434809'>
<a class='timestamp' href='#434809'><time timestamp='2015-11-06T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: we actually store in the block index whether a block was verified already
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837540' id='434810'>
<a class='timestamp' href='#434810'><time timestamp='2015-11-06T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: are you talking about something different?  a re-re-org?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837540' id='434811'>
<a class='timestamp' href='#434811'><time timestamp='2015-11-06T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837540' id='434812'>
<a class='timestamp' href='#434812'><time timestamp='2015-11-06T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: it&#x27;s strange that getrand makes things slower... the earlier version used way more entropy
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837540' id='434813'>
<a class='timestamp' href='#434813'><time timestamp='2015-11-06T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m just talking about regular reorg, where you add back all the txs from the disconnected block.   so now you have to process on the order of a few thousand txs with literally none of their sigs in the cahce
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837600' id='434814'>
<a class='timestamp' href='#434814'><time timestamp='2015-11-06T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
by using GetRandBytes()
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837600' id='434815'>
<a class='timestamp' href='#434815'><time timestamp='2015-11-06T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: one way to mitigate that would be to not remove sigcache entries during validation, but instead keep a list of txids added in each block in the past, and remove entries a few blocks deep
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837660' id='434816'>
<a class='timestamp' href='#434816'><time timestamp='2015-11-06T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, nevermind
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837660' id='434817'>
<a class='timestamp' href='#434817'><time timestamp='2015-11-06T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that would mean keeping a list of all signature checks
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837660' id='434818'>
<a class='timestamp' href='#434818'><time timestamp='2015-11-06T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wait why wouldnt&#x27; that work
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434819'>
<a class='timestamp' href='#434819'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
just keep a list of entries to remove
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434820'>
<a class='timestamp' href='#434820'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it would work, but it&#x27;s ugly, large, and a layer violation :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434821'>
<a class='timestamp' href='#434821'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
every new block add to the back of the list and remove from the front
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434822'>
<a class='timestamp' href='#434822'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we could use greg&#x27;s idea of annotating the sigcache entries with a sequence number
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434823'>
<a class='timestamp' href='#434823'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and then after every block wipe things with a sequence number a few before
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837720' id='434824'>
<a class='timestamp' href='#434824'><time timestamp='2015-11-06T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
as for GetRand().  you&#x27;re right, that doesn&#x27;t make sense that its slower
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837780' id='434825'>
<a class='timestamp' href='#434825'><time timestamp='2015-11-06T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so maybe the speedup from insecure_rand is real, but that still doesn&#x27;t explain why it was slower in the first place
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837780' id='434826'>
<a class='timestamp' href='#434826'><time timestamp='2015-11-06T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
can you try with a 5 MB cache?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837780' id='434827'>
<a class='timestamp' href='#434827'><time timestamp='2015-11-06T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe the slowdown is just from larger working set
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837840' id='434828'>
<a class='timestamp' href='#434828'><time timestamp='2015-11-06T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: something you might try, i discovered this last week when profiling new network code...
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837840' id='434829'>
<a class='timestamp' href='#434829'><time timestamp='2015-11-06T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the base case i was comparing against was a 1M entry cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837840' id='434830'>
<a class='timestamp' href='#434830'><time timestamp='2015-11-06T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
1M entries with old code?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837840' id='434831'>
<a class='timestamp' href='#434831'><time timestamp='2015-11-06T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434832'>
<a class='timestamp' href='#434832'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
does it get filled?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434833'>
<a class='timestamp' href='#434833'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: the secure_delete openssl allocator was taking ~25% of the time to process a transaction. Commenting that out made a massive difference in the profile
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434834'>
<a class='timestamp' href='#434834'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
not sure if that&#x27;s artificial or if it actually surfaces in the real-world
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434835'>
<a class='timestamp' href='#434835'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
s/transaction/message/
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434836'>
<a class='timestamp' href='#434836'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i didn&#x27;t check, but over 7 days it accepts 1.3M txs to the mempool, so i would assume thats several million sigs
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434837'>
<a class='timestamp' href='#434837'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: wut
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837900' id='434838'>
<a class='timestamp' href='#434838'><time timestamp='2015-11-06T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: take that with a grain of salt, it was a very artificial benchmark
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837960' id='434839'>
<a class='timestamp' href='#434839'><time timestamp='2015-11-06T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: so an interesting thing i saw is that with master and a 300 M mempool, and delete-on-use-in-block sigcache, i never got higher than 944k sigcache entries
<br>
</div>

<div class='talk op-msg' data-timestamp='1446837960' id='434840'>
<a class='timestamp' href='#434840'><time timestamp='2015-11-06T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: what kind of profiling?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838020' id='434841'>
<a class='timestamp' href='#434841'><time timestamp='2015-11-06T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: that seems plausible, but the old code doesn&#x27;t have delete on use
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838020' id='434842'>
<a class='timestamp' href='#434842'><time timestamp='2015-11-06T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: gprof of echoing messages back/forth between nodes
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838020' id='434843'>
<a class='timestamp' href='#434843'><time timestamp='2015-11-06T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: in fact, it stayed between 936k and 944k very consistently
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838020' id='434844'>
<a class='timestamp' href='#434844'><time timestamp='2015-11-06T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: CDataStream is backed by the zeroafterfree alloc, so i suspect it&#x27;d be an issue in many other places
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838080' id='434845'>
<a class='timestamp' href='#434845'><time timestamp='2015-11-06T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: yeah, that may be unnecessarily much
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838080' id='434846'>
<a class='timestamp' href='#434846'><time timestamp='2015-11-06T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i&#x27;d prefer if we were more conservative with where that was used. for non-sensitive data, it just seems wasteful
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838140' id='434847'>
<a class='timestamp' href='#434847'><time timestamp='2015-11-06T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838140' id='434848'>
<a class='timestamp' href='#434848'><time timestamp='2015-11-06T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and network data should never be sensitive
<br>
</div>

<div class='talk op-msg' data-timestamp='1446838200' id='434849'>
<a class='timestamp' href='#434849'><time timestamp='2015-11-06T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: right. very likely that that particular case was highly inflated though. It was a worst-case of bouncing thousands of tiny messages around very quickly. Still goes to show the trend, though.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446841800' id='434850'>
<a class='timestamp' href='#434850'><time timestamp='2015-11-06T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: apologies. that slowdown was an artifact.  i&#x27;ve run it a couple times now, and it is faster over all with 6918.  i&#x27;m still seeing 10% speedup in ConnectBlock, but then also an an overall speedup
<br>
</div>

<div class='talk op-msg' data-timestamp='1446841800' id='434851'>
<a class='timestamp' href='#434851'><time timestamp='2015-11-06T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
switching to insecure_rand offered incremental improvement over that, but nothing like what i thought i saw before
<br>
</div>

<div class='talk op-msg' data-timestamp='1446842340' id='434852'>
<a class='timestamp' href='#434852'><time timestamp='2015-11-06T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: ok, good to know!
<br>
</div>

<div class='talk op-msg' data-timestamp='1446851580' id='434853'>
<a class='timestamp' href='#434853'><time timestamp='2015-11-06T23:13:00Z'>23:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
18 of the last 101 blocks have been v4.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446851640' id='434854'>
<a class='timestamp' href='#434854'><time timestamp='2015-11-06T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, oon mainnet?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446851700' id='434855'>
<a class='timestamp' href='#434855'><time timestamp='2015-11-06T23:15:00Z'>23:15</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
that was fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1446851880' id='434856'>
<a class='timestamp' href='#434856'><time timestamp='2015-11-06T23:18:00Z'>23:18</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields: the zeroafterfree allocator has the benefit of killing making some use after free or use-of-uninitilized memory vulnerabilities unexploitable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446851940' id='434857'>
<a class='timestamp' href='#434857'><time timestamp='2015-11-06T23:19:00Z'>23:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
gmaxwell: mmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1446852060' id='434858'>
<a class='timestamp' href='#434858'><time timestamp='2015-11-06T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-8'> GitHub14</span>&gt;
[bitcoin] TheBlueMatt opened pull request #6964: Benchmark sanity checks and fork checks in ConnectBlock (master...verify-commits-fixes) <a href="https://github.com/bitcoin/bitcoin/pull/6964" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6964</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446852180' id='434859'>
<a class='timestamp' href='#434859'><time timestamp='2015-11-06T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I dunno if its worth the cost, of course-- but it&#x27;s not totally pointless.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446852240' id='434860'>
<a class='timestamp' href='#434860'><time timestamp='2015-11-06T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
perhaps makes valgrind happier
<br>
</div>

<div class='talk op-msg' data-timestamp='1446852300' id='434861'>
<a class='timestamp' href='#434861'><time timestamp='2015-11-06T23:25:00Z'>23:25</time></a>
&lt;<span class='nick nick-6'> GitHub124</span>&gt;
[bitcoin] TheBlueMatt opened pull request #6965: Benchmark sanity checks and fork checks in ConnectBlock (master...bench) <a href="https://github.com/bitcoin/bitcoin/pull/6965" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6965</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1446852480' id='434862'>
<a class='timestamp' href='#434862'><time timestamp='2015-11-06T23:28:00Z'>23:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
nah. it&#x27;s on free, won&#x27;t make valgrind happier.
<br>
</div>

<div class='talk op-msg' data-timestamp='1446853020' id='434863'>
<a class='timestamp' href='#434863'><time timestamp='2015-11-06T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, what&#x27;s the cost?
<br>
</div>

<div class='talk op-msg' data-timestamp='1446854100' id='434864'>
<a class='timestamp' href='#434864'><time timestamp='2015-11-06T23:55:00Z'>23:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: memory bandwidth.
<br>
</div>

</div>
</section>

</body>
</html>
