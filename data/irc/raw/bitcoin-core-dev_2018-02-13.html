<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2018-02-13
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2018-02-13' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:22 UTC</pre>
<pre><a href="/bitcoin-core-dev/2018-01-13">&lt;</a><span class='header'>  February 2018   </span><a href="/bitcoin-core-dev/2018-03-13">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2018-02-01">1</a>  <a class="" href="/bitcoin-core-dev/2018-02-02">2</a>  <a class="" href="/bitcoin-core-dev/2018-02-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-02-04">4</a>  <a class="" href="/bitcoin-core-dev/2018-02-05">5</a>  <a class="" href="/bitcoin-core-dev/2018-02-06">6</a>  <a class="" href="/bitcoin-core-dev/2018-02-07">7</a>  <a class="" href="/bitcoin-core-dev/2018-02-08">8</a>  <a class="" href="/bitcoin-core-dev/2018-02-09">9</a> <a class="" href="/bitcoin-core-dev/2018-02-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-02-11">11</a> <a class="" href="/bitcoin-core-dev/2018-02-12">12</a> <a class="current" href="/bitcoin-core-dev/2018-02-13">13</a> <a class="" href="/bitcoin-core-dev/2018-02-14">14</a> <a class="" href="/bitcoin-core-dev/2018-02-15">15</a> <a class="" href="/bitcoin-core-dev/2018-02-16">16</a> <a class="" href="/bitcoin-core-dev/2018-02-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-02-18">18</a> <a class="" href="/bitcoin-core-dev/2018-02-19">19</a> <a class="" href="/bitcoin-core-dev/2018-02-20">20</a> <a class="" href="/bitcoin-core-dev/2018-02-21">21</a> <a class="" href="/bitcoin-core-dev/2018-02-22">22</a> <a class="" href="/bitcoin-core-dev/2018-02-23">23</a> <a class="" href="/bitcoin-core-dev/2018-02-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-02-25">25</a> <a class="" href="/bitcoin-core-dev/2018-02-26">26</a> <a class="" href="/bitcoin-core-dev/2018-02-27">27</a> <a class="" href="/bitcoin-core-dev/2018-02-28">28</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1518484740' id='599724'>
<a class='timestamp' href='#599724'><time timestamp='2018-02-13T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-7'> ProfMac</span>&gt;
was there ever a time when GetBlockWork used the actual hash instead of nBits to calculate work?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484800' id='599725'>
<a class='timestamp' href='#599725'><time timestamp='2018-02-13T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] promag opened pull request #12419: wallet: Force distinct destinations in CWallet::CreateTransaction (master...2018-02-distinct-destinations) <a href="https://github.com/bitcoin/bitcoin/pull/12419" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12419</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484800' id='599726'>
<a class='timestamp' href='#599726'><time timestamp='2018-02-13T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
no, that wouldn&#x27;t be correct.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484800' id='599727'>
<a class='timestamp' href='#599727'><time timestamp='2018-02-13T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-7'> ProfMac</span>&gt;
tell me more.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484920' id='599728'>
<a class='timestamp' href='#599728'><time timestamp='2018-02-13T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the hash reflects more than actual work, by a factor of two on average.  It also has very high variance. meaning that if you got a block with ten times that &#x27;work&#x27; expected (which you&#x27;d get in 1/10) blocks you could just delay announcing it until a couple blocks had passed, then announce it and be very likely to reorg them out.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484920' id='599729'>
<a class='timestamp' href='#599729'><time timestamp='2018-02-13T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
gmaxwell: regarding duplicate outputs #12419 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484920' id='599730'>
<a class='timestamp' href='#599730'><time timestamp='2018-02-13T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/12419" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12419</a> | Force distinct destinations in CWallet::CreateTransaction by promag · Pull Request #12419 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484980' id='599731'>
<a class='timestamp' href='#599731'><time timestamp='2018-02-13T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-7'> ProfMac</span>&gt;
Yes, gmaxwell, I agree with all that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518484980' id='599732'>
<a class='timestamp' href='#599732'><time timestamp='2018-02-13T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-7'> ProfMac</span>&gt;
Thanks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518485040' id='599733'>
<a class='timestamp' href='#599733'><time timestamp='2018-02-13T01:24:00Z'>01:24</time></a>
&lt;<span class='nick nick-7'> ProfMac</span>&gt;
Not unlike &quot;curling&quot; or &quot;corn hole&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518489240' id='599734'>
<a class='timestamp' href='#599734'><time timestamp='2018-02-13T02:34:00Z'>02:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
n1bor: conversation continued in #bitcoin he posted bench logs which indicated to me that he was IO bound very badly. Today he followed up with,
<br>
</div>

<div class='talk op-msg' data-timestamp='1518489240' id='599735'>
<a class='timestamp' href='#599735'><time timestamp='2018-02-13T02:34:00Z'>02:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
n1bor: 18:28:24 &lt; murrayn&gt; gmaxwell, just to follow up from last night: 1) i shutdown gracefully and restarted, and the reindex started from the beginning.  From what you said, it shouldn&#x27;t do that? and 2) it was definitely disk IO bound. doing it on an SSD this time. much better
<br>
</div>

<div class='talk op-msg' data-timestamp='1518489240' id='599736'>
<a class='timestamp' href='#599736'><time timestamp='2018-02-13T02:34:00Z'>02:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(1) was something sipa warned him about in here, that restarting with -reindex-chainstate would restart the reindex.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518489540' id='599737'>
<a class='timestamp' href='#599737'><time timestamp='2018-02-13T02:39:00Z'>02:39</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
doh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518491400' id='599738'>
<a class='timestamp' href='#599738'><time timestamp='2018-02-13T03:10:00Z'>03:10</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
looks like contrib/bitcoin-cli.bash-completion needs an update, hasn&#x27;t been updated for ages
<br>
</div>

<div class='talk op-msg' data-timestamp='1518492240' id='599739'>
<a class='timestamp' href='#599739'><time timestamp='2018-02-13T03:24:00Z'>03:24</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
k, so i&#x27;m looking at the JSON-RPC 2.0 spec stuff now. &#x27;strict compliance&#x27; requires two main changes as far as i can see. one of them I&#x27;ve made gated behind a flag &#x27;strictjsonrpcspec&#x27; (better names accepted)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518492240' id='599740'>
<a class='timestamp' href='#599740'><time timestamp='2018-02-13T03:24:00Z'>03:24</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
that&#x27;s the &#x27;client must send jsonrpc=2.0, server must send jsonrpc=2.0, only one of &#x27;error&#x27; or &#x27;result&#x27; should be returned&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518492300' id='599741'>
<a class='timestamp' href='#599741'><time timestamp='2018-02-13T03:25:00Z'>03:25</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
the other bit is that if the client does not send an id with a request, the server should send a blank response. within a batch it should just be skipped. so if you send [a id=1, b, c id=3] you should get back [aresult, cresult].
<br>
</div>

<div class='talk op-msg' data-timestamp='1518492360' id='599742'>
<a class='timestamp' href='#599742'><time timestamp='2018-02-13T03:26:00Z'>03:26</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
i think that&#x27;s enough to make it fully spec compliant. the former one is enough to get it to work with libjsonrpccpp, could probably write some unit tests based on the jsonrpc spec as well, manual tests i&#x27;ve done look fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1518494040' id='599743'>
<a class='timestamp' href='#599743'><time timestamp='2018-02-13T03:54:00Z'>03:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke reopened pull request #12349: shutdown: fix crash on shutdown with reindex-chainstate (master...fix-qt-shutdown) <a href="https://github.com/bitcoin/bitcoin/pull/12349" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12349</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518497640' id='599744'>
<a class='timestamp' href='#599744'><time timestamp='2018-02-13T04:54:00Z'>04:54</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
What&#x27;s going on here? Either that comment is wrong, or the check is wrong... <a href="https://github.com/bitcoin/bitcoin/blame/master/src/script/interpreter.cpp#L1233" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blame/master/src/script/interpreter.cpp#L1233</a> (it says nOut out of range, but it checks nIn against txTo.vout.size()...)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518497820' id='599745'>
<a class='timestamp' href='#599745'><time timestamp='2018-02-13T04:57:00Z'>04:57</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
I guess it&#x27;s because single requires the in to sign the same index out. Just weird looking.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518498360' id='599746'>
<a class='timestamp' href='#599746'><time timestamp='2018-02-13T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
kallewoof: yeah, &quot;no vout corresponding to nIn&quot; or something would make more sense to me as a comment
<br>
</div>

<div class='talk op-msg' data-timestamp='1518498360' id='599747'>
<a class='timestamp' href='#599747'><time timestamp='2018-02-13T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
kallewoof: code seems right at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1518498540' id='599748'>
<a class='timestamp' href='#599748'><time timestamp='2018-02-13T05:09:00Z'>05:09</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
kallewoof: wow, that comment used to be a log output saying nOut out of range
<br>
</div>

<div class='talk op-msg' data-timestamp='1518498840' id='599749'>
<a class='timestamp' href='#599749'><time timestamp='2018-02-13T05:14:00Z'>05:14</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
aj: yeah agreed!
<br>
</div>

<div class='talk op-msg' data-timestamp='1518514320' id='599750'>
<a class='timestamp' href='#599750'><time timestamp='2018-02-13T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 5 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/c997f8808256...2dbc4a4740cd" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c997f8808256...2dbc4a4740cd</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518514320' id='599751'>
<a class='timestamp' href='#599751'><time timestamp='2018-02-13T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master cc046f6 John Newbery: [tests] Reduce NodeConn connection logging from info to debug
<br>
</div>

<div class='talk op-msg' data-timestamp='1518514320' id='599752'>
<a class='timestamp' href='#599752'><time timestamp='2018-02-13T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master c32cf9f John Newbery: [tests] Add P2PDataStore class...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518514320' id='599753'>
<a class='timestamp' href='#599753'><time timestamp='2018-02-13T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 359d067 John Newbery: [tests] Fix flake8 warnings in invalidtxrequest
<br>
</div>

<div class='talk op-msg' data-timestamp='1518514320' id='599754'>
<a class='timestamp' href='#599754'><time timestamp='2018-02-13T09:32:00Z'>09:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj closed pull request #11771:  [tests] Change invalidtxrequest to use BitcoinTestFramework (master...refactor_invalidtxrequest) <a href="https://github.com/bitcoin/bitcoin/pull/11771" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11771</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518515940' id='599755'>
<a class='timestamp' href='#599755'><time timestamp='2018-02-13T09:59:00Z'>09:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2dbc4a4740cd...f4f4f51f1a94" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2dbc4a4740cd...f4f4f51f1a94</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518515940' id='599756'>
<a class='timestamp' href='#599756'><time timestamp='2018-02-13T09:59:00Z'>09:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master a71c56a Luke Dashjr: clientversion: Use full commit hash for commit-based version descriptions...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518515940' id='599757'>
<a class='timestamp' href='#599757'><time timestamp='2018-02-13T09:59:00Z'>09:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master f4f4f51 Wladimir J. van der Laan: Merge #11966: clientversion: Use full commit hash for commit-based version descriptions...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518516000' id='599758'>
<a class='timestamp' href='#599758'><time timestamp='2018-02-13T10:00:00Z'>10:00</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj closed pull request #11966: clientversion: Use full commit hash for commit-based version descriptions (master...ver_full_commit_hash) <a href="https://github.com/bitcoin/bitcoin/pull/11966" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11966</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518518400' id='599759'>
<a class='timestamp' href='#599759'><time timestamp='2018-02-13T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
hmmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1518518400' id='599760'>
<a class='timestamp' href='#599760'><time timestamp='2018-02-13T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
util.cpp:384:121: note: in instantiation of template class &#x27;std::__1::pair&lt;const std::__1::basic_string&lt;char&gt;, boost::interprocess::file_lock&gt;&#x27; requested here
<br>
</div>

<div class='talk op-msg' data-timestamp='1518518400' id='599761'>
<a class='timestamp' href='#599761'><time timestamp='2018-02-13T10:40:00Z'>10:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
        boost::interprocess::file_lock&amp; lock = locks.emplace(pathLockFile.string(), pathLockFile.string().c_str()).first-&gt;second;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518518460' id='599762'>
<a class='timestamp' href='#599762'><time timestamp='2018-02-13T10:41:00Z'>10:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
full error here: <a href="https://github.com/bitcoin/bitcoin/issues/12413" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12413</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518518460' id='599763'>
<a class='timestamp' href='#599763'><time timestamp='2018-02-13T10:41:00Z'>10:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyone have an idea what can cause this c++ error monstriosity?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518519780' id='599764'>
<a class='timestamp' href='#599764'><time timestamp='2018-02-13T11:03:00Z'>11:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so it looks like &quot;static std::map&lt;std::string, boost::interprocess::file_lock&gt; locks;&quot; is illegal with openbsd&#x27;s clang + boost version combo
<br>
</div>

<div class='talk op-msg' data-timestamp='1518519780' id='599765'>
<a class='timestamp' href='#599765'><time timestamp='2018-02-13T11:03:00Z'>11:03</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] Sjors opened pull request #12421: [qt] navigate to  transaction history page after send (master...2018/02/qt-goto-transactions-after-send) <a href="https://github.com/bitcoin/bitcoin/pull/12421" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12421</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518519840' id='599766'>
<a class='timestamp' href='#599766'><time timestamp='2018-02-13T11:04:00Z'>11:04</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
Will there be rc4?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518520260' id='599767'>
<a class='timestamp' href='#599767'><time timestamp='2018-02-13T11:11:00Z'>11:11</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Lauda: there&#x27;s two open PR&#x27;s which I suspect need to be fixed before rc4: <a href="https://github.com/bitcoin/bitcoin/milestone/30" class="link" target="_blank">https://github.com/bitcoin/bitcoin/milestone/30</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518520320' id='599768'>
<a class='timestamp' href='#599768'><time timestamp='2018-02-13T11:12:00Z'>11:12</time></a>
&lt;<span class='nick nick-14'> Lauda</span>&gt;
Alright, thanks. I&#x27;ll wait for those.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518520620' id='599769'>
<a class='timestamp' href='#599769'><time timestamp='2018-02-13T11:17:00Z'>11:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj opened pull request #12422: util: Use unique_ptr in locks map (master...2018_01_openbsd_util_fix) <a href="https://github.com/bitcoin/bitcoin/pull/12422" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12422</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521040' id='599770'>
<a class='timestamp' href='#599770'><time timestamp='2018-02-13T11:24:00Z'>11:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: can you explain why it works inside a unique ptr? (I am just curious)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521160' id='599771'>
<a class='timestamp' href='#599771'><time timestamp='2018-02-13T11:26:00Z'>11:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: no, I have no idea why it fails in the first place
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521160' id='599772'>
<a class='timestamp' href='#599772'><time timestamp='2018-02-13T11:26:00Z'>11:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
tbh this is really over my limit of understanding C++
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521220' id='599773'>
<a class='timestamp' href='#599773'><time timestamp='2018-02-13T11:27:00Z'>11:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
well, the point of having pointers in a map instead of whole objects makes it &#x27;simpler&#x27; to work with layout in memory I suppose
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521280' id='599774'>
<a class='timestamp' href='#599774'><time timestamp='2018-02-13T11:28:00Z'>11:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
as for some reason the whole lock objects can&#x27;t be moved
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521280' id='599775'>
<a class='timestamp' href='#599775'><time timestamp='2018-02-13T11:28:00Z'>11:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and pointers, obviously, can
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521280' id='599776'>
<a class='timestamp' href='#599776'><time timestamp='2018-02-13T11:28:00Z'>11:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea, I was wondering if values in maps had to be relocatable, but quick googling didn&#x27;t answer the question for me.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521340' id='599777'>
<a class='timestamp' href='#599777'><time timestamp='2018-02-13T11:29:00Z'>11:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it must be some edge case that was solved in either a newer version of clang, or in a different version of boost, as I&#x27;ve not seen the issue on other platforms
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521400' id='599778'>
<a class='timestamp' href='#599778'><time timestamp='2018-02-13T11:30:00Z'>11:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the &#x27;map&#x27; here is used to avoid locking a directory multiple times I guess? this structure is write-only, no lookups are ever done in this map, so there should be no performance difference whatsoever
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521460' id='599779'>
<a class='timestamp' href='#599779'><time timestamp='2018-02-13T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521460' id='599780'>
<a class='timestamp' href='#599780'><time timestamp='2018-02-13T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
from the look of the error log
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521460' id='599781'>
<a class='timestamp' href='#599781'><time timestamp='2018-02-13T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
this has to do with the ctor
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521460' id='599782'>
<a class='timestamp' href='#599782'><time timestamp='2018-02-13T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
not the map itself
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521460' id='599783'>
<a class='timestamp' href='#599783'><time timestamp='2018-02-13T11:31:00Z'>11:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so emplace returns the current record if one already exists, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521520' id='599784'>
<a class='timestamp' href='#599784'><time timestamp='2018-02-13T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I dont&#x27; think this construction even accomplishes what it is meant to accomplish
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521520' id='599785'>
<a class='timestamp' href='#599785'><time timestamp='2018-02-13T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
emplace is like insert afaik, returns a pair of &lt;iter, bool&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521580' id='599786'>
<a class='timestamp' href='#599786'><time timestamp='2018-02-13T11:33:00Z'>11:33</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
the iterator points at the inserted element or the already existing one, the bool tells you if it was added (true) or fetched (false)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599787'>
<a class='timestamp' href='#599787'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok that depends on what does lock-&gt;try_lock does on a lock that is already locked
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599788'>
<a class='timestamp' href='#599788'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
you mean within the same thread?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599789'>
<a class='timestamp' href='#599789'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
or another one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599790'>
<a class='timestamp' href='#599790'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
within the same process
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599791'>
<a class='timestamp' href='#599791'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
i think it throws
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599792'>
<a class='timestamp' href='#599792'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521640' id='599793'>
<a class='timestamp' href='#599793'><time timestamp='2018-02-13T11:34:00Z'>11:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
this is a per-process lock, not per-thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599794'>
<a class='timestamp' href='#599794'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I wonder what the intent is for LockDirectory being called on the same directory multiple times
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599795'>
<a class='timestamp' href='#599795'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
but that wouldnt have anything to do compile, that would just be runtime error
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599796'>
<a class='timestamp' href='#599796'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I know.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599797'>
<a class='timestamp' href='#599797'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m just doubting that this code does what it is meant to do, at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599798'>
<a class='timestamp' href='#599798'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
typically that&#x27;s to make sure you got the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521700' id='599799'>
<a class='timestamp' href='#599799'><time timestamp='2018-02-13T11:35:00Z'>11:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
separate from what it takes to compile it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599800'>
<a class='timestamp' href='#599800'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
now if the same threads is trying to get a lock multiple times
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599801'>
<a class='timestamp' href='#599801'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
it presupposes the methods that are accessed can be used on their own
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599802'>
<a class='timestamp' href='#599802'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it should probably at least check the boolean it gets back from emplace
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599803'>
<a class='timestamp' href='#599803'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
whether the lock already exists
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599804'>
<a class='timestamp' href='#599804'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
otherwise it will lock an old lock another time
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599805'>
<a class='timestamp' href='#599805'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
that part is like
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521760' id='599806'>
<a class='timestamp' href='#599806'><time timestamp='2018-02-13T11:36:00Z'>11:36</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
idk id have to look at the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599807'>
<a class='timestamp' href='#599807'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
but it seems pointless
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599808'>
<a class='timestamp' href='#599808'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
why hold a reference to the lock in the scope? that&#x27;s usless, the map perpetuates it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599809'>
<a class='timestamp' href='#599809'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
either that&#x27;s a no-op, or it throws, but it&#x27;s pointless
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599810'>
<a class='timestamp' href='#599810'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
and that could be your compile issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599811'>
<a class='timestamp' href='#599811'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
that these locks are not copiable
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599812'>
<a class='timestamp' href='#599812'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
ie just get rid of the referencing altgother
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599813'>
<a class='timestamp' href='#599813'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
defining the map itself causes the compile issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599814'>
<a class='timestamp' href='#599814'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
referencing is not the problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521820' id='599815'>
<a class='timestamp' href='#599815'><time timestamp='2018-02-13T11:37:00Z'>11:37</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
boost::interprocess::file_lock&amp; lock = locks.emplace(pathLockFile.string(), pathLockFile.string().c_str()).first-&gt;second;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599816'>
<a class='timestamp' href='#599816'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
get rid of the reference and try
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599817'>
<a class='timestamp' href='#599817'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
in general I wouldn&#x27;t expect a lock to be copyable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599818'>
<a class='timestamp' href='#599818'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
if that doesnt bork other stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599819'>
<a class='timestamp' href='#599819'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
goatpig: I tried, see discussion in <a href="https://github.com/bitcoin/bitcoin/issues/12413" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12413</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599820'>
<a class='timestamp' href='#599820'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
i.e. just do locks.emplace(pathLockFile.string(), pathLockFile.string().c_str());
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599821'>
<a class='timestamp' href='#599821'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
what the heck is this doing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599822'>
<a class='timestamp' href='#599822'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
anyways?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521880' id='599823'>
<a class='timestamp' href='#599823'><time timestamp='2018-02-13T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
goatpig: as I said above, defining the map itself already causes the error, even if you don&#x27;t access it at all!
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599824'>
<a class='timestamp' href='#599824'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: that was also my question, what is the semantics supposed to be
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599825'>
<a class='timestamp' href='#599825'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
you could just ninja that my making it a map of shared_ptr&lt;lock&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599826'>
<a class='timestamp' href='#599826'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
by*     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599827'>
<a class='timestamp' href='#599827'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maybe we can remove it all entirely? thats always the best fix when possible. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599828'>
<a class='timestamp' href='#599828'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
goatpig: that&#x27;s what I did in #12322 (but with unique_lock)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518521940' id='599829'>
<a class='timestamp' href='#599829'><time timestamp='2018-02-13T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/12322" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12322</a> | Docs: Remove step making cloned repository world-writable for Windows build. by murrayn · Pull Request #12322 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522000' id='599830'>
<a class='timestamp' href='#599830'><time timestamp='2018-02-13T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
eh #12422
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522000' id='599831'>
<a class='timestamp' href='#599831'><time timestamp='2018-02-13T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/12422" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12422</a> | util: Use unique_ptr in locks map (fix OpenBSD 6.2 build) by laanwj · Pull Request #12422 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522000' id='599832'>
<a class='timestamp' href='#599832'><time timestamp='2018-02-13T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-2'> * gmaxwell</span>&gt;
channels some contributor and considers just submitting a PR to remove stuff he doesn&#x27;t understand
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522000' id='599833'>
<a class='timestamp' href='#599833'><time timestamp='2018-02-13T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
wumpus: sure, dunno what the code really intents. i&#x27;d prefer unique_ptr when possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522000' id='599834'>
<a class='timestamp' href='#599834'><time timestamp='2018-02-13T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
but if it&#x27;s trying to reference the lock, then it should be using shared_ptrs
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599835'>
<a class='timestamp' href='#599835'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no, shared_ptre is not necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599836'>
<a class='timestamp' href='#599836'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the lock does not leave the scope at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599837'>
<a class='timestamp' href='#599837'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
the lock exists within the map
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599838'>
<a class='timestamp' href='#599838'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599839'>
<a class='timestamp' href='#599839'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and after the change, it exists inside a unique pointer
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599840'>
<a class='timestamp' href='#599840'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
if you kill the map, if there is a thread with the ptr/reference, it will blow up
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522060' id='599841'>
<a class='timestamp' href='#599841'><time timestamp='2018-02-13T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
which is unique, inside the map
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522120' id='599842'>
<a class='timestamp' href='#599842'><time timestamp='2018-02-13T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no one has a reference to it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522120' id='599843'>
<a class='timestamp' href='#599843'><time timestamp='2018-02-13T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
please read the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522120' id='599844'>
<a class='timestamp' href='#599844'><time timestamp='2018-02-13T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no reference leaves the function
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522180' id='599845'>
<a class='timestamp' href='#599845'><time timestamp='2018-02-13T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
checking
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522180' id='599846'>
<a class='timestamp' href='#599846'><time timestamp='2018-02-13T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the destructor will be called when the process has shut down, after the main function, by automatic cleanup
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522180' id='599847'>
<a class='timestamp' href='#599847'><time timestamp='2018-02-13T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
by that time no one will be using the data dir anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522180' id='599848'>
<a class='timestamp' href='#599848'><time timestamp='2018-02-13T11:43:00Z'>11:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the map exists to hold on to the objects until the process shuts down
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522300' id='599849'>
<a class='timestamp' href='#599849'><time timestamp='2018-02-13T11:45:00Z'>11:45</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
so the locks persist the process?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522360' id='599850'>
<a class='timestamp' href='#599850'><time timestamp='2018-02-13T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
or rather
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522360' id='599851'>
<a class='timestamp' href='#599851'><time timestamp='2018-02-13T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
no method tries to clean them up
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522360' id='599852'>
<a class='timestamp' href='#599852'><time timestamp='2018-02-13T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
as I said, they&#x27;ll be automatically cleaned up by the runtime framework
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522420' id='599853'>
<a class='timestamp' href='#599853'><time timestamp='2018-02-13T11:47:00Z'>11:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&lt;gmaxwell&gt; in general I wouldn&#x27;t expect a lock to be copyable. &lt;- they are; it&#x27;s only moving them at most, not copying
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599854'>
<a class='timestamp' href='#599854'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
wumpus: is it assumed that code gets accessed by only a single thread?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599855'>
<a class='timestamp' href='#599855'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
goatpig: this isn&#x27;t an ordinary lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599856'>
<a class='timestamp' href='#599856'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s a file locking thing
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599857'>
<a class='timestamp' href='#599857'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
goatpig: yes, it&#x27;s only used during initialization, by the init thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599858'>
<a class='timestamp' href='#599858'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
used to keep seperate processes from muckign about with the same data directories.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599859'>
<a class='timestamp' href='#599859'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
goatpig: oh... I&#x27;m actually not sure anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522600' id='599860'>
<a class='timestamp' href='#599860'><time timestamp='2018-02-13T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
i understand that much, but it&#x27;s not thread safe, so im assuming this is every hit once
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599861'>
<a class='timestamp' href='#599861'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
err     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599862'>
<a class='timestamp' href='#599862'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
wallet directories complicated this
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599863'>
<a class='timestamp' href='#599863'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
hit ever once
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599864'>
<a class='timestamp' href='#599864'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
i mean the semantics of the method suggest this is accessed just to check the lock is held at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599865'>
<a class='timestamp' href='#599865'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
as soon as dynamic opening of wallets is supported, this can be called from the RPC thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522660' id='599866'>
<a class='timestamp' href='#599866'><time timestamp='2018-02-13T11:51:00Z'>11:51</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but right now it&#x27;s only used from init
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522720' id='599867'>
<a class='timestamp' href='#599867'><time timestamp='2018-02-13T11:52:00Z'>11:52</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s a good question, the function as it is is certainly not thread safe
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522720' id='599868'>
<a class='timestamp' href='#599868'><time timestamp='2018-02-13T11:52:00Z'>11:52</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
you are adding elements to a map. ideally it should check the map has the element, otherwise grab a mutex, add the element, then go back to regular execution
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599869'>
<a class='timestamp' href='#599869'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it should grab a mutex before accessing the map at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599870'>
<a class='timestamp' href='#599870'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
^     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599871'>
<a class='timestamp' href='#599871'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
<b>*if*</b> it&#x27;s supposed to be thread safe
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599872'>
<a class='timestamp' href='#599872'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
ok, sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599873'>
<a class='timestamp' href='#599873'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and its trivial here in any case.. since the purpose of the map is just lifetime management for the contained objects.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522780' id='599874'>
<a class='timestamp' href='#599874'><time timestamp='2018-02-13T11:53:00Z'>11:53</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522840' id='599875'>
<a class='timestamp' href='#599875'><time timestamp='2018-02-13T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
that would be if the method was not meant to return state of the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522840' id='599876'>
<a class='timestamp' href='#599876'><time timestamp='2018-02-13T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-9'> goatpig</span>&gt;
the semantics just suggest to me that it could be accessed by another thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522840' id='599877'>
<a class='timestamp' href='#599877'><time timestamp='2018-02-13T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I think the intent is to return true if the process has a lock on the directory, whether it&#x27;s new or not. Not sure the code matches that intent, at the moment.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522840' id='599878'>
<a class='timestamp' href='#599878'><time timestamp='2018-02-13T11:54:00Z'>11:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
nah its just init only now. though wumpus is right that dynamic wallet opening/closing will cause accesses from rpc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522900' id='599879'>
<a class='timestamp' href='#599879'><time timestamp='2018-02-13T11:55:00Z'>11:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;ve asked meshcollider (who wrote the code) in the issue just in case
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522900' id='599880'>
<a class='timestamp' href='#599880'><time timestamp='2018-02-13T11:55:00Z'>11:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
for wallet opening we probably want it to return true if it takes a lock and false if it already has it or can&#x27;t take it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522960' id='599881'>
<a class='timestamp' href='#599881'><time timestamp='2018-02-13T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
wumpus: I think ryanofsky suggested the currently used approach as a comment on the PR
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522960' id='599882'>
<a class='timestamp' href='#599882'><time timestamp='2018-02-13T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell:  it&#x27;s a lock on a directory, not on the wallet, bdb takes care of not opening the same wallet multiple times
<br>
</div>

<div class='talk op-msg' data-timestamp='1518522960' id='599883'>
<a class='timestamp' href='#599883'><time timestamp='2018-02-13T11:56:00Z'>11:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: there can be multiple wallets in a directory
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523020' id='599884'>
<a class='timestamp' href='#599884'><time timestamp='2018-02-13T11:57:00Z'>11:57</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: ah point.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523020' id='599885'>
<a class='timestamp' href='#599885'><time timestamp='2018-02-13T11:57:00Z'>11:57</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Carry on then.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523560' id='599886'>
<a class='timestamp' href='#599886'><time timestamp='2018-02-13T12:06:00Z'>12:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we could certainly use unit tests for that function
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523800' id='599887'>
<a class='timestamp' href='#599887'><time timestamp='2018-02-13T12:10:00Z'>12:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
meshcollider: ok adding jnewbery to reviewers
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523920' id='599888'>
<a class='timestamp' href='#599888'><time timestamp='2018-02-13T12:12:00Z'>12:12</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
jnewbery or ryanofsky?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523980' id='599889'>
<a class='timestamp' href='#599889'><time timestamp='2018-02-13T12:13:00Z'>12:13</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
wumpus: your PR looks good to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1518523980' id='599890'>
<a class='timestamp' href='#599890'><time timestamp='2018-02-13T12:13:00Z'>12:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
eh, sorry, yes ryanofsky, added the wrong one
<br>
</div>

<div class='talk op-msg' data-timestamp='1518524100' id='599891'>
<a class='timestamp' href='#599891'><time timestamp='2018-02-13T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
wumpus: didn&#x27;t even think about the dynamic loading/unloading case / thread safety when I wrote it, apologies
<br>
</div>

<div class='talk op-msg' data-timestamp='1518524100' id='599892'>
<a class='timestamp' href='#599892'><time timestamp='2018-02-13T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
Was just trying to fix the issue for 0.16
<br>
</div>

<div class='talk op-msg' data-timestamp='1518524100' id='599893'>
<a class='timestamp' href='#599893'><time timestamp='2018-02-13T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
meshcollider: no worries, we found that issue before it became a problem at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1518525120' id='599894'>
<a class='timestamp' href='#599894'><time timestamp='2018-02-13T12:32:00Z'>12:32</time></a>
&lt;<span class='nick nick-3'> * wumpus</span>&gt;
working on a unit test for LockDataDirectory - part of it will only work on UNIX because fork()
<br>
</div>

<div class='talk op-msg' data-timestamp='1518527460' id='599895'>
<a class='timestamp' href='#599895'><time timestamp='2018-02-13T13:11:00Z'>13:11</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
You have got to be kidding... anyone had to jump through these hoops before? <a href="http://htmlpreview.github.io/?https" class="link" target="_blank">http://htmlpreview.github.io/?https</a>://github.com/JKSH/QtSdkRepoChooser/blob/master/doc/index.html
<br>
</div>

<div class='talk op-msg' data-timestamp='1518527700' id='599896'>
<a class='timestamp' href='#599896'><time timestamp='2018-02-13T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no, not really, though I&#x27;ve had to build qt for embedded devices, the source code is huge, it takes a long time and it&#x27;s a pain to configure for cross compile
<br>
</div>

<div class='talk op-msg' data-timestamp='1518527700' id='599897'>
<a class='timestamp' href='#599897'><time timestamp='2018-02-13T13:15:00Z'>13:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it pretty much regards itself as an operating system in itself
<br>
</div>

<div class='talk op-msg' data-timestamp='1518528120' id='599898'>
<a class='timestamp' href='#599898'><time timestamp='2018-02-13T13:22:00Z'>13:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we can be really happy that linux distributions simply package that stuff pre-built
<br>
</div>

<div class='talk op-msg' data-timestamp='1518531480' id='599899'>
<a class='timestamp' href='#599899'><time timestamp='2018-02-13T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-5'> midnightmagic</span>&gt;
/w/w 59
<br>
</div>

<div class='talk op-msg' data-timestamp='1518531600' id='599900'>
<a class='timestamp' href='#599900'><time timestamp='2018-02-13T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
wumpus: seems it&#x27;s moot now, but I think std::piecewise_construct might be what&#x27;s missing for the emplace
<br>
</div>

<div class='talk op-msg' data-timestamp='1518531780' id='599901'>
<a class='timestamp' href='#599901'><time timestamp='2018-02-13T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
as usual, spoke too soon. Red herring. Nevermind.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518531900' id='599902'>
<a class='timestamp' href='#599902'><time timestamp='2018-02-13T14:25:00Z'>14:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;ll look at that one, never heard of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518531960' id='599903'>
<a class='timestamp' href='#599903'><time timestamp='2018-02-13T14:26:00Z'>14:26</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
wumpus: see for example: <a href="https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L574" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L574</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534120' id='599904'>
<a class='timestamp' href='#599904'><time timestamp='2018-02-13T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
a bit lazy q: am I reading depends/ docs right that there&#x27;s currently no way to use other platforms than x86_64 to build e.g. bdb?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534180' id='599905'>
<a class='timestamp' href='#599905'><time timestamp='2018-02-13T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
so if I&#x27;m compiling code on armv7l and want wallet support, best thing to do is to get on x86_64 instead, and crosscompile towards arm as necessary?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534180' id='599906'>
<a class='timestamp' href='#599906'><time timestamp='2018-02-13T15:03:00Z'>15:03</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
(I did get bdb4.8 compiled from source on armv7l outside of the depends system, but had trouble getting it to be noticed by the build system..)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534360' id='599907'>
<a class='timestamp' href='#599907'><time timestamp='2018-02-13T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
hkjn0: the depends system assumes it&#x27;s building on x86_64, however if you want to build db4 outside the depends system there&#x27;s the script  contrib/install_db4.sh and the flags  BDB_LIBS=&quot;-L${BDB_PREFIX}/lib -ldb_cxx-4.8&quot; BDB_CFLAGS=&quot;-I${BDB_PREFIX}/include&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534420' id='599908'>
<a class='timestamp' href='#599908'><time timestamp='2018-02-13T15:07:00Z'>15:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
would be nice if the depends system also supported building <b>*from*</b> other architectures, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534600' id='599909'>
<a class='timestamp' href='#599909'><time timestamp='2018-02-13T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
ah, great, I bet I was just misisng BDB_LIBS or somesuch.. will try out the contrib/ script
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534600' id='599910'>
<a class='timestamp' href='#599910'><time timestamp='2018-02-13T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
esp. at some point we&#x27;d like to do gitian builds from other architectures
<br>
</div>

<div class='talk op-msg' data-timestamp='1518534660' id='599911'>
<a class='timestamp' href='#599911'><time timestamp='2018-02-13T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
right. I&#x27;ve been setting up these weird build environments already, would be happy to try to contribute to gitian work or otherwise support other build platforms, just need to understand more of how current system hangs together first.. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518538920' id='599912'>
<a class='timestamp' href='#599912'><time timestamp='2018-02-13T16:22:00Z'>16:22</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
depends doesn&#x27;t assume build is x86_64. It&#x27;s the only arch that really gets tested, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1518538980' id='599913'>
<a class='timestamp' href='#599913'><time timestamp='2018-02-13T16:23:00Z'>16:23</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
but, all of the machinery is there to auto-detect the build platform and try to cope.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518539040' id='599914'>
<a class='timestamp' href='#599914'><time timestamp='2018-02-13T16:24:00Z'>16:24</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hkjn0: if you try building native on arm and run into issues, feel free to ping me
<br>
</div>

<div class='talk op-msg' data-timestamp='1518539280' id='599915'>
<a class='timestamp' href='#599915'><time timestamp='2018-02-13T16:28:00Z'>16:28</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
cfield, thanks! building with contrib/install_db4.sh + BDB_LIBS it suggested for ./configure as wumpus suggested seems to work fine so far
<br>
</div>

<div class='talk op-msg' data-timestamp='1518539340' id='599916'>
<a class='timestamp' href='#599916'><time timestamp='2018-02-13T16:29:00Z'>16:29</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
(before that I tried a plain `make` in depends/ and it failed on armv7l, but it is possible I am missing some packages)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518539640' id='599917'>
<a class='timestamp' href='#599917'><time timestamp='2018-02-13T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hkjn0: well if you&#x27;d be willing, I&#x27;d be happy to step through the depends with you and try to get it patched to build
<br>
</div>

<div class='talk op-msg' data-timestamp='1518539700' id='599918'>
<a class='timestamp' href='#599918'><time timestamp='2018-02-13T16:35:00Z'>16:35</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
like wumpus said, it&#x27;d be nice to have several working build arches
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540240' id='599919'>
<a class='timestamp' href='#599919'><time timestamp='2018-02-13T16:44:00Z'>16:44</time></a>
&lt;<span class='nick nick-9'> hkjn0</span>&gt;
cfields: sure, let me know how you&#x27;d like to proceed.. do we take it off the main channel to not clutter it up too much?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540300' id='599920'>
<a class='timestamp' href='#599920'><time timestamp='2018-02-13T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hkjn0: sure, #bitcoin-build
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540840' id='599921'>
<a class='timestamp' href='#599921'><time timestamp='2018-02-13T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
wumpus/cfields: Do you remember (on a describe-in-a-couple-sentences-off-the-top-of-your-head level) what the actual issue is with Xenial and why it&#x27;s broken?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540900' id='599922'>
<a class='timestamp' href='#599922'><time timestamp='2018-02-13T16:55:00Z'>16:55</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And does Artful(/Bionic) just work?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540900' id='599923'>
<a class='timestamp' href='#599923'><time timestamp='2018-02-13T16:55:00Z'>16:55</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
(with cross-compilation for Windows, I mean)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540960' id='599924'>
<a class='timestamp' href='#599924'><time timestamp='2018-02-13T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I tried looking through the issues on GitHub and got confused by the various different threads and things people tried and experienced
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540960' id='599925'>
<a class='timestamp' href='#599925'><time timestamp='2018-02-13T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: by default, the toolchain is configured for win threads rather than posix, which don&#x27;t exist (at least with that gcc version)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518540960' id='599926'>
<a class='timestamp' href='#599926'><time timestamp='2018-02-13T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
further, the ssp is busted
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541020' id='599927'>
<a class='timestamp' href='#599927'><time timestamp='2018-02-13T16:57:00Z'>16:57</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And were those fixed in later versions, e.g. Artful?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541080' id='599928'>
<a class='timestamp' href='#599928'><time timestamp='2018-02-13T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
I believe so. But we should be switching to our own toolchains for 0.17 anyway. Or if not a full switch, probably at least for mingw.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541140' id='599929'>
<a class='timestamp' href='#599929'><time timestamp='2018-02-13T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
That sounds like it would be a good thing
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541200' id='599930'>
<a class='timestamp' href='#599930'><time timestamp='2018-02-13T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I ask because last night and today I spent a bunch of hours trying to see how hard it would be to just backport the version of mingw-w64 that&#x27;s in artful/bionic to xenial
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541260' id='599931'>
<a class='timestamp' href='#599931'><time timestamp='2018-02-13T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I tried the straightforward &quot;`backportpackage` into a PPA&quot;, but ran into chains of missing dependencies
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599932'>
<a class='timestamp' href='#599932'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I won&#x27;t bore you with everything I tried and looked at, but at this point I&#x27;ve come to the realization that I don&#x27;t know enough about Ubuntu packaging and how all that works, and beyond that, more important stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599933'>
<a class='timestamp' href='#599933'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: I can upload a stand-alone mingw toolchain soon, if it would help
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599934'>
<a class='timestamp' href='#599934'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Like, what is mingw-w64, vs what is gcc, vs what is gcc-mingw-w64
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599935'>
<a class='timestamp' href='#599935'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
heh     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599936'>
<a class='timestamp' href='#599936'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
and how do all those interact
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599937'>
<a class='timestamp' href='#599937'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541320' id='599938'>
<a class='timestamp' href='#599938'><time timestamp='2018-02-13T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
well, in case it helps...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541380' id='599939'>
<a class='timestamp' href='#599939'><time timestamp='2018-02-13T17:03:00Z'>17:03</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
In #ubuntu-devel someone said: 18:34:22 &lt;rbasak&gt; michagogo: I would step back and consider your approach. I don&#x27;t know what problem you&#x27;re solving, but there might be an easier way.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541440' id='599940'>
<a class='timestamp' href='#599940'><time timestamp='2018-02-13T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I explained that the version in xenial was broken, and they said this: 18:39:39 &lt;rbasak&gt; Also, if the reason it doesn&#x27;t work in Xenial is due to a bug, we&#x27;re quite happy in general to cherry-pick the fix for all Xenial users to benefit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541440' id='599941'>
<a class='timestamp' href='#599941'><time timestamp='2018-02-13T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
But somehow I suspect if it were that simple it would have already happened...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541440' id='599942'>
<a class='timestamp' href='#599942'><time timestamp='2018-02-13T17:04:00Z'>17:04</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
to build a mingw-w64 toolchain, you need: mingw-w64 headers (think kernel headers), mingw-64 runtime (think glibc), gcc, and binutils. And obviously they need to be built in a way that lets them play nicely.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541500' id='599943'>
<a class='timestamp' href='#599943'><time timestamp='2018-02-13T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Right. So the thing is, I don&#x27;t actually know the difference between mingw-w64 and gcc
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541500' id='599944'>
<a class='timestamp' href='#599944'><time timestamp='2018-02-13T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Well, that&#x27;s not entirely true
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541500' id='599945'>
<a class='timestamp' href='#599945'><time timestamp='2018-02-13T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I sort of know what gcc is
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541500' id='599946'>
<a class='timestamp' href='#599946'><time timestamp='2018-02-13T17:05:00Z'>17:05</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
What I don&#x27;t know is, what is mingw-w64, and how does it interact with/based on/use gcc
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541620' id='599947'>
<a class='timestamp' href='#599947'><time timestamp='2018-02-13T17:07:00Z'>17:07</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
mingw-w64 is a shim that allows for posix-y code to work on windows.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541680' id='599948'>
<a class='timestamp' href='#599948'><time timestamp='2018-02-13T17:08:00Z'>17:08</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So what is gcc-mingw-w64?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541740' id='599949'>
<a class='timestamp' href='#599949'><time timestamp='2018-02-13T17:09:00Z'>17:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
so you can build a compiler (gcc) that&#x27;s able to produce win32 code, but it wouldn&#x27;t do much good if you couldn&#x27;t use standard unixy apis.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541800' id='599950'>
<a class='timestamp' href='#599950'><time timestamp='2018-02-13T17:10:00Z'>17:10</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
so, for example, mingw-w64 can use either win or pthread threading models. Configured without pthread support, you&#x27;ll have trouble with lots of applications. That&#x27;s one of our issues.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541980' id='599951'>
<a class='timestamp' href='#599951'><time timestamp='2018-02-13T17:13:00Z'>17:13</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So gcc-mingw-64, say, is a version of GCC that builds the mingw-w64 layer into the binaries it produces?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518541980' id='599952'>
<a class='timestamp' href='#599952'><time timestamp='2018-02-13T17:13:00Z'>17:13</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
it&#x27;s probably easiest to just think of mingw-w64 as a libc for windows.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542040' id='599953'>
<a class='timestamp' href='#599953'><time timestamp='2018-02-13T17:14:00Z'>17:14</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I guess at this point the knowledge that I&#x27;m missing is: 1) what <u>_exactly_</u> the term &quot;toolchain&quot; refers to and how you build one
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542040' id='599954'>
<a class='timestamp' href='#599954'><time timestamp='2018-02-13T17:14:00Z'>17:14</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
2) How Ubuntu packages work together to make up a toolchain
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542100' id='599955'>
<a class='timestamp' href='#599955'><time timestamp='2018-02-13T17:15:00Z'>17:15</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And all kinds of other things related to those, like how exactly Ubuntu packaging works
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542100' id='599956'>
<a class='timestamp' href='#599956'><time timestamp='2018-02-13T17:15:00Z'>17:15</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
well, the packaging is an entirely different beast
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542160' id='599957'>
<a class='timestamp' href='#599957'><time timestamp='2018-02-13T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I&#x27;m thinking I&#x27;ll drop the issue for now, since I don&#x27;t really have a ton of time and I suspect it would take me at least a few days to sort all these things out
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542160' id='599958'>
<a class='timestamp' href='#599958'><time timestamp='2018-02-13T17:16:00Z'>17:16</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I mean, regarding what rbasak said over in #ubuntu-devel, are the problems we have simple bugs with focused fixes that can be cherry-picked, or more fundamental problems that can&#x27;t really be fixed without a wholesale upgrade to a newer version of MinGW? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542220' id='599959'>
<a class='timestamp' href='#599959'><time timestamp='2018-02-13T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
a toolchain is the group of progs that are required to produce a working binary. Typically that&#x27;s target kernel/os headers in some form, target libc, host compiler, other host apps (in linux, binutils provides ar/ranlib/etc.), and a linker (also provided by binutils on linux)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542220' id='599960'>
<a class='timestamp' href='#599960'><time timestamp='2018-02-13T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
michagogo: it&#x27;s been a little while since i&#x27;ve used gcc-mingw-w64 but i recall in ubuntu that installing that package pulls in all the accessories (runtime, binutils, etc.) that cfields mentioned
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542220' id='599961'>
<a class='timestamp' href='#599961'><time timestamp='2018-02-13T17:17:00Z'>17:17</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And actually, is the issue just with the MinGW component? Meaning, say one were to rebuild the gcc-mingw-w64 packages with the same GCC version and just an upgraded MinGW, would that work?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542340' id='599962'>
<a class='timestamp' href='#599962'><time timestamp='2018-02-13T17:19:00Z'>17:19</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
in late to the conversation here, so not sure you&#x27;re exact goal
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542340' id='599963'>
<a class='timestamp' href='#599963'><time timestamp='2018-02-13T17:19:00Z'>17:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: the thread thing is just a config option. There&#x27;s also the stack issue, which I haven&#x27;t looked into for a while, but afaik that&#x27;s no longer an issue in newer ubuntu versions. So it was either an upstream bug that&#x27;s been fixed, or a config problem that ubuntu has fixed
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542340' id='599964'>
<a class='timestamp' href='#599964'><time timestamp='2018-02-13T17:19:00Z'>17:19</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
jcorgan: Well, at the end of the day, here&#x27;s my big-picture goal
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542400' id='599965'>
<a class='timestamp' href='#599965'><time timestamp='2018-02-13T17:20:00Z'>17:20</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Make <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md#building-for-64-bit-windows" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md#building-for-64-bit-windows</a> die in a fire
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542400' id='599966'>
<a class='timestamp' href='#599966'><time timestamp='2018-02-13T17:20:00Z'>17:20</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Specifically, the lines telling you to sudo add-apt-repository &quot;deb <a href="http://archive.ubuntu.com/ubuntu" class="link" target="_blank">http://archive.ubuntu.com/ubuntu</a> zesty universe&quot;; sudo apt update;sudo apt upgrade
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542400' id='599967'>
<a class='timestamp' href='#599967'><time timestamp='2018-02-13T17:20:00Z'>17:20</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Because besides that not working, because zesty is EOL, that&#x27;s just going to hose your system
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542460' id='599968'>
<a class='timestamp' href='#599968'><time timestamp='2018-02-13T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
ah, i only have experience going from LTS to LTS, never use the ones in between
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542460' id='599969'>
<a class='timestamp' href='#599969'><time timestamp='2018-02-13T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Even doing that, you never ever just add the newer repository like that
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542460' id='599970'>
<a class='timestamp' href='#599970'><time timestamp='2018-02-13T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
There&#x27;s an upgrader
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542520' id='599971'>
<a class='timestamp' href='#599971'><time timestamp='2018-02-13T17:22:00Z'>17:22</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So my thought was, well, can I get the packages from the newer version brought back to xenial?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542580' id='599972'>
<a class='timestamp' href='#599972'><time timestamp='2018-02-13T17:23:00Z'>17:23</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
it might be possible, but that way lies madness
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542580' id='599973'>
<a class='timestamp' href='#599973'><time timestamp='2018-02-13T17:23:00Z'>17:23</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So it seems.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542580' id='599974'>
<a class='timestamp' href='#599974'><time timestamp='2018-02-13T17:23:00Z'>17:23</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I tried just naively `backportpackage`ing into a PPA
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542640' id='599975'>
<a class='timestamp' href='#599975'><time timestamp='2018-02-13T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
you&#x27;re on zesty and need packages that only exist later than that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542640' id='599976'>
<a class='timestamp' href='#599976'><time timestamp='2018-02-13T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: yea, I&#x27;m not sure it&#x27;s worth the trouble. We already have a plan for resolving this, and it means that we don&#x27;t have to rely on Ubuntu anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542640' id='599977'>
<a class='timestamp' href='#599977'><time timestamp='2018-02-13T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I’m not on zesty
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542700' id='599978'>
<a class='timestamp' href='#599978'><time timestamp='2018-02-13T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I’m actually not an active Ubuntu (or Linux) user day to day
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542700' id='599979'>
<a class='timestamp' href='#599979'><time timestamp='2018-02-13T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
you could see if the packages you need are in the &#x27;backports&#x27; repo
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542700' id='599980'>
<a class='timestamp' href='#599980'><time timestamp='2018-02-13T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Nah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542700' id='599981'>
<a class='timestamp' href='#599981'><time timestamp='2018-02-13T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
My idea was to <b>*get*</b> a newer mingw-w64 into -backports
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542760' id='599982'>
<a class='timestamp' href='#599982'><time timestamp='2018-02-13T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I filed the “please backport” bugs
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542760' id='599983'>
<a class='timestamp' href='#599983'><time timestamp='2018-02-13T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: well, that certainly wouldn&#x27;t be a bad thing. It&#x27;s definitely not just us.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542760' id='599984'>
<a class='timestamp' href='#599984'><time timestamp='2018-02-13T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
i expect that would require specialized knowledge of how gcc/binutils/etc are packaged that a typical user wouldn&#x27;t normally need to know
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542820' id='599985'>
<a class='timestamp' href='#599985'><time timestamp='2018-02-13T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
and personally i&#x27;d look for an alternative way to solve whatever problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542820' id='599986'>
<a class='timestamp' href='#599986'><time timestamp='2018-02-13T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I had the naive thought that, well, it should be easy to backport, because it’s a cross-compiler, not anything that the system uses
<br>
</div>

<div class='talk op-msg' data-timestamp='1518542880' id='599987'>
<a class='timestamp' href='#599987'><time timestamp='2018-02-13T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
jcorgan: AIUI “whatever problem” is “mingw-w64 on Xenial is very broken”
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543060' id='599988'>
<a class='timestamp' href='#599988'><time timestamp='2018-02-13T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
personally i&#x27;d see if the must-be-xenial constraint can be relaxed. but if you wanted a challenge you could learn enough about how it works to help fix the issue. that may not be worth your time, but it could also be fun and very educational. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543060' id='599989'>
<a class='timestamp' href='#599989'><time timestamp='2018-02-13T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
(depends on you)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543060' id='599990'>
<a class='timestamp' href='#599990'><time timestamp='2018-02-13T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
A no-changes backport failed, firstly, because it build-depends on gcc-7
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543120' id='599991'>
<a class='timestamp' href='#599991'><time timestamp='2018-02-13T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Which must-be-Xenial constraint?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543120' id='599992'>
<a class='timestamp' href='#599992'><time timestamp='2018-02-13T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
The thing is, 1) that’s the latest LTS
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543120' id='599993'>
<a class='timestamp' href='#599993'><time timestamp='2018-02-13T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
right, i use that extensively
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543120' id='599994'>
<a class='timestamp' href='#599994'><time timestamp='2018-02-13T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And 2) that’s the version that you get with WSL, and as far as I know trying to upgrade just breaks it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543180' id='599995'>
<a class='timestamp' href='#599995'><time timestamp='2018-02-13T17:33:00Z'>17:33</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
ah, another piece of the picture i was unaware of
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543240' id='599996'>
<a class='timestamp' href='#599996'><time timestamp='2018-02-13T17:34:00Z'>17:34</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So the “constraint” is that we really want to let users on Xenial cross-compile is
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543240' id='599997'>
<a class='timestamp' href='#599997'><time timestamp='2018-02-13T17:34:00Z'>17:34</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
you&#x27;re in a maze of twisty passages, all alike
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543240' id='599998'>
<a class='timestamp' href='#599998'><time timestamp='2018-02-13T17:34:00Z'>17:34</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
cross-compile us*
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543360' id='599999'>
<a class='timestamp' href='#599999'><time timestamp='2018-02-13T17:36:00Z'>17:36</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I mean, it’s possible that if I knew Ubuntu packaging and had enough time I could try just reverting the changes that made it build with gcc 7
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543360' id='600000'>
<a class='timestamp' href='#600000'><time timestamp='2018-02-13T17:36:00Z'>17:36</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
so, getting a backport made of mingw does seem like the right way to go, but the number of people who are likely to know how to do that is probably small
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543360' id='600001'>
<a class='timestamp' href='#600001'><time timestamp='2018-02-13T17:36:00Z'>17:36</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And bring it back to 5.whatever
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543360' id='600002'>
<a class='timestamp' href='#600002'><time timestamp='2018-02-13T17:36:00Z'>17:36</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
For all I know it might be just changing the build-depends line back to point at the gcc version that’s in Xenial
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543420' id='600003'>
<a class='timestamp' href='#600003'><time timestamp='2018-02-13T17:37:00Z'>17:37</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543480' id='600004'>
<a class='timestamp' href='#600004'><time timestamp='2018-02-13T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
but there could also be some specific bug in gcc5 that caused gcc7 to be needed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543480' id='600005'>
<a class='timestamp' href='#600005'><time timestamp='2018-02-13T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I doubt it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543480' id='600006'>
<a class='timestamp' href='#600006'><time timestamp='2018-02-13T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I mean, I shouldn’t t say that
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543480' id='600007'>
<a class='timestamp' href='#600007'><time timestamp='2018-02-13T17:38:00Z'>17:38</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
that does sound like a (relatively) easy first thing to try, and you might get lucky
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543540' id='600008'>
<a class='timestamp' href='#600008'><time timestamp='2018-02-13T17:39:00Z'>17:39</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
But I’m pretty sure that the upgrade to gcc 6 in... yakkety or zesty, I think? And to 7 in bionic, was just part of a wholesale upgrade to those versions
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543540' id='600009'>
<a class='timestamp' href='#600009'><time timestamp='2018-02-13T17:39:00Z'>17:39</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
i&#x27;m going to be in pain when i start looking at migrating everything to 18.04, aren&#x27;t I?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543600' id='600010'>
<a class='timestamp' href='#600010'><time timestamp='2018-02-13T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
But besides not knowing even the basics of Ubuntu packaging, I’d need the ability to go over all the other changes to the gcc-mingw-w64 source package and figure out which ones are related to the gcc 5/7 stuff, vs which ones should be there anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543600' id='600011'>
<a class='timestamp' href='#600011'><time timestamp='2018-02-13T17:40:00Z'>17:40</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ryanofsky opened pull request #12424: Fix rescan test failure due to unset g_address_type, g_change_type (master...pr/scang) <a href="https://github.com/bitcoin/bitcoin/pull/12424" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12424</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543660' id='600012'>
<a class='timestamp' href='#600012'><time timestamp='2018-02-13T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
jcorgan: define “everything”
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543660' id='600013'>
<a class='timestamp' href='#600013'><time timestamp='2018-02-13T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
most of the systems i use/support are 16.04, some still 14.04
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543660' id='600014'>
<a class='timestamp' href='#600014'><time timestamp='2018-02-13T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
it sounds like a lot of changes are coming in 18.04
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543660' id='600015'>
<a class='timestamp' href='#600015'><time timestamp='2018-02-13T17:41:00Z'>17:41</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
No idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543720' id='600016'>
<a class='timestamp' href='#600016'><time timestamp='2018-02-13T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
anyway, this is straying a bit from coredev
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543720' id='600017'>
<a class='timestamp' href='#600017'><time timestamp='2018-02-13T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I mean, it’s 2 years of progress in the overall Linux ecosystem
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543720' id='600018'>
<a class='timestamp' href='#600018'><time timestamp='2018-02-13T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Bringing everything up to date
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543720' id='600019'>
<a class='timestamp' href='#600019'><time timestamp='2018-02-13T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
So yeah, some things may break…
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543720' id='600020'>
<a class='timestamp' href='#600020'><time timestamp='2018-02-13T17:42:00Z'>17:42</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
well, the older LTS versions get new packages for everything that isn&#x27;t a fundamental system change
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543780' id='600021'>
<a class='timestamp' href='#600021'><time timestamp='2018-02-13T17:43:00Z'>17:43</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
and the backports repo even lets you run newer kernels and video drivers
<br>
</div>

<div class='talk op-msg' data-timestamp='1518543840' id='600022'>
<a class='timestamp' href='#600022'><time timestamp='2018-02-13T17:44:00Z'>17:44</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
it&#x27;s usually the lower-level stuff like sysvinit/upstart/systemd that causes me pain
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544020' id='600023'>
<a class='timestamp' href='#600023'><time timestamp='2018-02-13T17:47:00Z'>17:47</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Get new packages? What do you mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544080' id='600024'>
<a class='timestamp' href='#600024'><time timestamp='2018-02-13T17:48:00Z'>17:48</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
My understanding is that -updates only has bug fixes, ~never new wholesale versions of software that have features
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544140' id='600025'>
<a class='timestamp' href='#600025'><time timestamp='2018-02-13T17:49:00Z'>17:49</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
maybe i&#x27;m thinking of PPAs, where authors make recent versions of their software for several different ubuntu releases
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544140' id='600026'>
<a class='timestamp' href='#600026'><time timestamp='2018-02-13T17:49:00Z'>17:49</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Yep     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544200' id='600027'>
<a class='timestamp' href='#600027'><time timestamp='2018-02-13T17:50:00Z'>17:50</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
With a PPA you can give people who decide to use you whatever you want, whenever you want
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544200' id='600028'>
<a class='timestamp' href='#600028'><time timestamp='2018-02-13T17:50:00Z'>17:50</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
(Including installing a backdoor on their systems. It’s important that you trust the owners of PPAs you use.)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544260' id='600029'>
<a class='timestamp' href='#600029'><time timestamp='2018-02-13T17:51:00Z'>17:51</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
well, i hope you figure out how to get teh mingw/WSL stuff working
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544260' id='600030'>
<a class='timestamp' href='#600030'><time timestamp='2018-02-13T17:51:00Z'>17:51</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Yeah, I think I&#x27;m just going to drop the issue at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544320' id='600031'>
<a class='timestamp' href='#600031'><time timestamp='2018-02-13T17:52:00Z'>17:52</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
cfields said that we&#x27;re going to be using our own toolchain at some point (soon? ish?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544320' id='600032'>
<a class='timestamp' href='#600032'><time timestamp='2018-02-13T17:52:00Z'>17:52</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: yes. Ubuntu versions/packages won&#x27;t matter for gitian/travis after that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544380' id='600033'>
<a class='timestamp' href='#600033'><time timestamp='2018-02-13T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
cfields: I&#x27;m thinking mostly about the case of someone wanting to cross-build binaries for themselves
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544380' id='600034'>
<a class='timestamp' href='#600034'><time timestamp='2018-02-13T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
Either just not wanting to go through the hassle of setting up gitian, or with something like WSL
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544440' id='600035'>
<a class='timestamp' href='#600035'><time timestamp='2018-02-13T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
I really don&#x27;t like the fact that we&#x27;re giving users broken instructions, especially ones that (were they to work) have them completely mess up their system
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544440' id='600036'>
<a class='timestamp' href='#600036'><time timestamp='2018-02-13T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
michagogo: sure. None of the new stuff will be required, ofc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544440' id='600037'>
<a class='timestamp' href='#600037'><time timestamp='2018-02-13T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
(<a href="https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md#building-for-64-bit-windows" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md#building-for-64-bit-windows</a>)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518544500' id='600038'>
<a class='timestamp' href='#600038'><time timestamp='2018-02-13T17:55:00Z'>17:55</time></a>
&lt;<span class='nick nick-10'> michagogo</span>&gt;
And of course, there&#x27;s the fact that mingw is broken for everyone else
<br>
</div>

<div class='talk op-msg' data-timestamp='1518547500' id='600039'>
<a class='timestamp' href='#600039'><time timestamp='2018-02-13T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] richardkiss opened pull request #12425: Add some script tests (master...feature/bool_tests) <a href="https://github.com/bitcoin/bitcoin/pull/12425" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12425</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553440' id='600040'>
<a class='timestamp' href='#600040'><time timestamp='2018-02-13T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Note: if anyone here uses bitmessage, it has a remote code execution bug. (deserializing using eval)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553500' id='600041'>
<a class='timestamp' href='#600041'><time timestamp='2018-02-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what is it written in?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553560' id='600042'>
<a class='timestamp' href='#600042'><time timestamp='2018-02-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Python.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553560' id='600043'>
<a class='timestamp' href='#600043'><time timestamp='2018-02-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
is today national facepalm security day or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553740' id='600044'>
<a class='timestamp' href='#600044'><time timestamp='2018-02-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
deserializing using eval ???
<br>
</div>

<div class='talk op-msg' data-timestamp='1518553800' id='600045'>
<a class='timestamp' href='#600045'><time timestamp='2018-02-13T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
-_-.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554100' id='600046'>
<a class='timestamp' href='#600046'><time timestamp='2018-02-13T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
the vulnerability is being exploited in the wild as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554100' id='600047'>
<a class='timestamp' href='#600047'><time timestamp='2018-02-13T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
not sure about success, but trying to run windows executables, grab electrum wallets, the like
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554220' id='600048'>
<a class='timestamp' href='#600048'><time timestamp='2018-02-13T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
esotericnonsense: deserializing using eval is a thing I&#x27;ve seen many times w/ javascript, php, and python.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554220' id='600049'>
<a class='timestamp' href='#600049'><time timestamp='2018-02-13T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
java does its own version of that too, if you use their native serialization
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554340' id='600050'>
<a class='timestamp' href='#600050'><time timestamp='2018-02-13T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
gmaxwell: oh sure it&#x27;s a thing. i just feel like it&#x27;s one of the most famous &#x27;don&#x27;t do this&#x27; footguns
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554340' id='600051'>
<a class='timestamp' href='#600051'><time timestamp='2018-02-13T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-7'> esotericnonsense</span>&gt;
evidently not
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554880' id='600052'>
<a class='timestamp' href='#600052'><time timestamp='2018-02-13T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
wouldn&#x27;t use of the json module protect against this?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518554940' id='600053'>
<a class='timestamp' href='#600053'><time timestamp='2018-02-13T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
first json.loads(), then deserialize?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555120' id='600054'>
<a class='timestamp' href='#600054'><time timestamp='2018-02-13T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> reardencode</span>&gt;
mmgen: yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555120' id='600055'>
<a class='timestamp' href='#600055'><time timestamp='2018-02-13T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
strange they didn&#x27;t do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555540' id='600056'>
<a class='timestamp' href='#600056'><time timestamp='2018-02-13T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
the fix: <a href="https://github.com/Bitmessage/PyBitmessage/commit/3a8016d31f517775d226aa8b902480f4a3a148a9" class="link" target="_blank">https://github.com/Bitmessage/PyBitmessage/commit/3a8016d31f517775d226aa8b902480f4a3a148a9</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555720' id='600057'>
<a class='timestamp' href='#600057'><time timestamp='2018-02-13T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
that still seems like an iffy fix, even though the scope for mischief is far more limited
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555780' id='600058'>
<a class='timestamp' href='#600058'><time timestamp='2018-02-13T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
it&#x27;ll basically call an arbitrary method specified by untrusted data on the specified class
<br>
</div>

<div class='talk op-msg' data-timestamp='1518555780' id='600059'>
<a class='timestamp' href='#600059'><time timestamp='2018-02-13T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #12426: qt: Initialize members in WalletModel (master...Mf1802-qtInitializeMembersWalletModel) <a href="https://github.com/bitcoin/bitcoin/pull/12426" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12426</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556020' id='600060'>
<a class='timestamp' href='#600060'><time timestamp='2018-02-13T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
contrapumpkin: hopefully just an emergency fix. far better than nothing in any case
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556020' id='600061'>
<a class='timestamp' href='#600061'><time timestamp='2018-02-13T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
yup :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556620' id='600062'>
<a class='timestamp' href='#600062'><time timestamp='2018-02-13T21:17:00Z'>21:17</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
seems like try: assert data[&quot;&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556680' id='600063'>
<a class='timestamp' href='#600063'><time timestamp='2018-02-13T21:18:00Z'>21:18</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
seems like try: assert data[&quot;&quot;] in (&#x27;message&#x27;,&#x27;vote&#x27;) would have been safer
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556740' id='600064'>
<a class='timestamp' href='#600064'><time timestamp='2018-02-13T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
the hoops people go through to avoid writing a proper parser... 😢
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556740' id='600065'>
<a class='timestamp' href='#600065'><time timestamp='2018-02-13T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
since &#x27;message&#x27; and &#x27;vote&#x27; are the only permissible values
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556740' id='600066'>
<a class='timestamp' href='#600066'><time timestamp='2018-02-13T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s getting a bit off topic for this channel
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556740' id='600067'>
<a class='timestamp' href='#600067'><time timestamp='2018-02-13T21:19:00Z'>21:19</time></a>
&lt;<span class='nick nick-6'> contrapumpkin</span>&gt;
sorry :) I&#x27;ll shut up
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556860' id='600068'>
<a class='timestamp' href='#600068'><time timestamp='2018-02-13T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
sipa: sorry
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556860' id='600069'>
<a class='timestamp' href='#600069'><time timestamp='2018-02-13T21:21:00Z'>21:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
np!     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556920' id='600070'>
<a class='timestamp' href='#600070'><time timestamp='2018-02-13T21:22:00Z'>21:22</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
sipa: though it <b>**was**</b> gmaxwell who brought up the topic
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556980' id='600071'>
<a class='timestamp' href='#600071'><time timestamp='2018-02-13T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;m aware, and i participated too; no blame here
<br>
</div>

<div class='talk op-msg' data-timestamp='1518556980' id='600072'>
<a class='timestamp' href='#600072'><time timestamp='2018-02-13T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just noting that the discussion is getting too far removed from the topic here
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557040' id='600073'>
<a class='timestamp' href='#600073'><time timestamp='2018-02-13T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-16'> mmgen</span>&gt;
mmgen: i know, i&#x27;ll really shut up now ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557340' id='600074'>
<a class='timestamp' href='#600074'><time timestamp='2018-02-13T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] sipa opened pull request #12427: Make signrawtransaction accept P2SH-P2WSH redeemscripts (master...201802_signrawp2shp2wsh) <a href="https://github.com/bitcoin/bitcoin/pull/12427" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/12427</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557400' id='600075'>
<a class='timestamp' href='#600075'><time timestamp='2018-02-13T21:30:00Z'>21:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
doh, how&#x27;d we miss that
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557520' id='600076'>
<a class='timestamp' href='#600076'><time timestamp='2018-02-13T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-6'> grafcaps</span>&gt;
hah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557880' id='600077'>
<a class='timestamp' href='#600077'><time timestamp='2018-02-13T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: it was actually partially being addressed in #11708
<br>
</div>

<div class='talk op-msg' data-timestamp='1518557880' id='600078'>
<a class='timestamp' href='#600078'><time timestamp='2018-02-13T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/11708" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/11708</a> | Add P2SH-P2WSH support to signrawtransaction and listunspent RPC by MeshCollider · Pull Request #11708 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1518558060' id='600079'>
<a class='timestamp' href='#600079'><time timestamp='2018-02-13T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
sipa: is it possible to add a test for #12427?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518558060' id='600080'>
<a class='timestamp' href='#600080'><time timestamp='2018-02-13T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/12427" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/12427</a> | Make signrawtransaction accept P2SH-P2WSH redeemscripts by sipa · Pull Request #12427 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1518558060' id='600081'>
<a class='timestamp' href='#600081'><time timestamp='2018-02-13T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
promag: yes, will look into that
<br>
</div>

<div class='talk op-msg' data-timestamp='1518558060' id='600082'>
<a class='timestamp' href='#600082'><time timestamp='2018-02-13T21:41:00Z'>21:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just wanted to have the PR visible as soon as possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1518558660' id='600083'>
<a class='timestamp' href='#600083'><time timestamp='2018-02-13T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: Is the basic idea that if we can sign the p2sh redeem script, we should be able to sign P2SH(P2WSH())?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518562260' id='600084'>
<a class='timestamp' href='#600084'><time timestamp='2018-02-13T22:51:00Z'>22:51</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
this is kind of cool, i got a build of bitcoind working with systemtap markers (in this case I&#x27;m marking CCoinsViewCache flushes): <a href="https://gist.github.com/eklitzke/8bf6957fe886ddec36cde737d69ac6f5" class="link" target="_blank">https://gist.github.com/eklitzke/8bf6957fe886ddec36cde737d69ac6f5</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518562800' id='600085'>
<a class='timestamp' href='#600085'><time timestamp='2018-02-13T23:00:00Z'>23:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: whats the advantage of that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1518563580' id='600086'>
<a class='timestamp' href='#600086'><time timestamp='2018-02-13T23:13:00Z'>23:13</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
i&#x27;m going to add more probes and then use that to measure some work i&#x27;m trying to do to the ccoinscacheview, e.g. i want to make the cache into a real writeback cache and get cache hit statistics out of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518563640' id='600087'>
<a class='timestamp' href='#600087'><time timestamp='2018-02-13T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
today if you wanted to get cache hit statistics from CCoinCacheView::GetCoin you&#x27;d have to hack up some existing rpc to dump the information (or dump it to a log), with stap/dtrace probes that would be much easier and less invasive
<br>
</div>

<div class='talk op-msg' data-timestamp='1518563760' id='600088'>
<a class='timestamp' href='#600088'><time timestamp='2018-02-13T23:16:00Z'>23:16</time></a>
&lt;<span class='nick nick-3'> warren</span>&gt;
Does anyone have working gitian with qemu-kvm instead of lxc? I want to compare notes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518563880' id='600089'>
<a class='timestamp' href='#600089'><time timestamp='2018-02-13T23:18:00Z'>23:18</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: you&#x27;ll defeat its purpose entirely
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564000' id='600090'>
<a class='timestamp' href='#600090'><time timestamp='2018-02-13T23:20:00Z'>23:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: the cache&#x27;s purpose for existing is not to act as a cache, it&#x27;s purpose is to act as a buffer to prevent writes from hitting the database entirely. And also to allow atomic updates to keep the database consistent with the chain at a block level (this is not as important since we now use a replay for consistency).  It also satisfies reads, but if you defeat that it doesn&#x27;t make a huge p
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564000' id='600091'>
<a class='timestamp' href='#600091'><time timestamp='2018-02-13T23:20:00Z'>23:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
erformance difference in IBD.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564060' id='600092'>
<a class='timestamp' href='#600092'><time timestamp='2018-02-13T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
okay maybe on a non-SSD the read cache matters somewhat more, to be fair I haven&#x27;t benchmarked it with defeated read caching on a spinning disk.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564060' id='600093'>
<a class='timestamp' href='#600093'><time timestamp='2018-02-13T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
i have thought through these issues, you can increase the amount of coins in memory during ibd in a way that&#x27;s safe and still batches disk writes
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564060' id='600094'>
<a class='timestamp' href='#600094'><time timestamp='2018-02-13T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
yes this is primarily for spinning disks
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564120' id='600095'>
<a class='timestamp' href='#600095'><time timestamp='2018-02-13T23:22:00Z'>23:22</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
or worse, people&#x27;s cloud vm instances
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564120' id='600096'>
<a class='timestamp' href='#600096'><time timestamp='2018-02-13T23:22:00Z'>23:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eklitzke: i&#x27;ve experimented with various cache flushing strategies before which try to predict which entries will be more useful in the near future, and keep them longer
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564120' id='600097'>
<a class='timestamp' href='#600097'><time timestamp='2018-02-13T23:22:00Z'>23:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: the purpose of the replay stuff we did in 0.15.x was in part to enable incremental flushing, so yes, I also see advantages there.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564180' id='600098'>
<a class='timestamp' href='#600098'><time timestamp='2018-02-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in practice, anything that reduced the ability to avoid writes slowed things down
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564180' id='600099'>
<a class='timestamp' href='#600099'><time timestamp='2018-02-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but what we did find is that trying to achieve a higher read hit rate is mostly pointless.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564180' id='600100'>
<a class='timestamp' href='#600100'><time timestamp='2018-02-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(on a SSD at least)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564240' id='600101'>
<a class='timestamp' href='#600101'><time timestamp='2018-02-13T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I fear we&#x27;ve more or less given up on performance on non-SSDs :(  esp since many large spinning disks are shingled now and have horrifying performance.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564240' id='600102'>
<a class='timestamp' href='#600102'><time timestamp='2018-02-13T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Incremenal flushing would also give the advantage of getting rid of flushing latency spikes and perhaps better overlap IO and validation.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564240' id='600103'>
<a class='timestamp' href='#600103'><time timestamp='2018-02-13T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
the flushing code right now is pretty inefficient, anyway databases like mysql do this by having a dirty buffer pool watermark that causes them to flush (potentially a large amount of data), and then they retaing data in memory that was flushed to disk if it&#x27;s not dirty
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564300' id='600104'>
<a class='timestamp' href='#600104'><time timestamp='2018-02-13T23:25:00Z'>23:25</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
if you kept exactly the same semantics wrt flushing a large amount of data but didn&#x27;t automatically expire the old coins from memory that would be an improvement (in my opinion)
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564360' id='600105'>
<a class='timestamp' href='#600105'><time timestamp='2018-02-13T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
would love to chat with you about it next week, as i&#x27;m participating in the chaincode labs hacker residency program
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564360' id='600106'>
<a class='timestamp' href='#600106'><time timestamp='2018-02-13T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: We&#x27;ve measured that, it doesn&#x27;t help.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564360' id='600107'>
<a class='timestamp' href='#600107'><time timestamp='2018-02-13T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
i&#x27;ve also measured it and shown that it does
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564360' id='600108'>
<a class='timestamp' href='#600108'><time timestamp='2018-02-13T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Thats the whole reason I brought the subject up-- so you don&#x27;t assume read caching is important.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564420' id='600109'>
<a class='timestamp' href='#600109'><time timestamp='2018-02-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: Interesting, I&#x27;d love to see those results.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564420' id='600110'>
<a class='timestamp' href='#600110'><time timestamp='2018-02-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
if there are any writeups or mailing list posts about experiments in this area i&#x27;d be interested to read them
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564420' id='600111'>
<a class='timestamp' href='#600111'><time timestamp='2018-02-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: probably in the PR introducing the replay on start there are some of them.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564420' id='600112'>
<a class='timestamp' href='#600112'><time timestamp='2018-02-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
ok, i&#x27;ll take a look
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564540' id='600113'>
<a class='timestamp' href='#600113'><time timestamp='2018-02-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eklitzke: i&#x27;ll be at the residency on 22nd and 23rd
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564540' id='600114'>
<a class='timestamp' href='#600114'><time timestamp='2018-02-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;d offer you the specific code I benchmarked but I don&#x27;t have access to the system with it anymore.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564660' id='600115'>
<a class='timestamp' href='#600115'><time timestamp='2018-02-13T23:31:00Z'>23:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eklitzke: the bitcoin utxo set is pretty unique as a data set in that a very large number of newly written entries are almost immediately after deleted again
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564660' id='600116'>
<a class='timestamp' href='#600116'><time timestamp='2018-02-13T23:31:00Z'>23:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
We tested many configurations.  For an example, one of the specific cases we tested was having flush leave the entries in but marking them as non-dirty and existing in the backing store, and seperately removing non-dirty entries when full.  What appeared to be the case is that avoiding the read hit seemed basically irrelevant, because if i got read, that means it is getting spent, which means th
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564660' id='600117'>
<a class='timestamp' href='#600117'><time timestamp='2018-02-13T23:31:00Z'>23:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ere is going to be an erasure which must hit the disk. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564720' id='600118'>
<a class='timestamp' href='#600118'><time timestamp='2018-02-13T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-6'> TD-Linux</span>&gt;
since many large spinning disks are shingled now and have horrifying performance. &lt;- these are still really uncommon
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564720' id='600119'>
<a class='timestamp' href='#600119'><time timestamp='2018-02-13T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
TD-Linux: they seem to be 100% of people showing up and talking about their node performance on spinning disks, but now that I say that outloud...
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564720' id='600120'>
<a class='timestamp' href='#600120'><time timestamp='2018-02-13T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eklitzke: but we should talk more about this
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564780' id='600121'>
<a class='timestamp' href='#600121'><time timestamp='2018-02-13T23:33:00Z'>23:33</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
i would like to change some of the leveldb settings too, but that&#x27;s another matter entirely; for instance leveldb is configured to only open 64 files at once, so during ibd or a reindex you see the process thrashing a lot in a pattern where it opens an lbd file, mmaps it, munmaps it, and closes it
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564780' id='600122'>
<a class='timestamp' href='#600122'><time timestamp='2018-02-13T23:33:00Z'>23:33</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
that&#x27;s another matter entirely though
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564780' id='600123'>
<a class='timestamp' href='#600123'><time timestamp='2018-02-13T23:33:00Z'>23:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: by all means if you have results, great. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564780' id='600124'>
<a class='timestamp' href='#600124'><time timestamp='2018-02-13T23:33:00Z'>23:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: we suffer from FD exhaustion issues currently. :( 
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564840' id='600125'>
<a class='timestamp' href='#600125'><time timestamp='2018-02-13T23:34:00Z'>23:34</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
yeah I talked to BlueMatt about it a bit yesterday, the thing is you can mmap a file, close the fd, and the mmap mapping is still valid
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564840' id='600126'>
<a class='timestamp' href='#600126'><time timestamp='2018-02-13T23:34:00Z'>23:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ah, cute.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564840' id='600127'>
<a class='timestamp' href='#600127'><time timestamp='2018-02-13T23:34:00Z'>23:34</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
so if you didn&#x27;t mind the extra memory overhead from the PTEs, you could potentially mmap all of the ldb files at once and not actually have 1000+ ldb files open
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564900' id='600128'>
<a class='timestamp' href='#600128'><time timestamp='2018-02-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
doing <b>*all*</b> of them is probably too agressive
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564900' id='600129'>
<a class='timestamp' href='#600129'><time timestamp='2018-02-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
leveldb doesn&#x27;t use mmap on 32 bit hosts.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518564900' id='600130'>
<a class='timestamp' href='#600130'><time timestamp='2018-02-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and on 64-bit the only harm is the PTE as you note, which is pretty minor.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565020' id='600131'>
<a class='timestamp' href='#600131'><time timestamp='2018-02-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: if you want to get into leveldb internals there are probably a lot of other gains. E.g. our keys are almost uniformly random, and so bisections in leveldb can probably be replaced with a secant search.  (and if our keys aren&#x27;t random enough, we could fix that)   leveldb block size is tunable too
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565020' id='600132'>
<a class='timestamp' href='#600132'><time timestamp='2018-02-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think I found larger blocks to be a loss, but that might not be as true with a secant search.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565080' id='600133'>
<a class='timestamp' href='#600133'><time timestamp='2018-02-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
yeah I was actually surprised that leveldb itself wasn&#x27;t doing the mmap trick I just described (or at least have it as a tuneable parameter), I want to dig deeper into their code
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565140' id='600134'>
<a class='timestamp' href='#600134'><time timestamp='2018-02-13T23:39:00Z'>23:39</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
ryanofsky: friendly ping <a href="https://github.com/bitcoin/bitcoin/pull/11687#pullrequestreview-94272991" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/11687#pullrequestreview-94272991</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565200' id='600135'>
<a class='timestamp' href='#600135'><time timestamp='2018-02-13T23:40:00Z'>23:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
eklitzke: I have a believe which I&#x27;ve not been able to validate yet, that a lot of the performance limitations of the current dbcache is all the malloc activity... that often doesn&#x27;t show up too clearly in profiles. We&#x27;d talked about changing the main dbcache to an open hashtable with fixed size entries (and some special indirection to an exception map for unusually large entries).. but it&#x27;s a l
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565200' id='600136'>
<a class='timestamp' href='#600136'><time timestamp='2018-02-13T23:40:00Z'>23:40</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ot of work to just try it and see if it helps.  
<br>
</div>

<div class='talk op-msg' data-timestamp='1518565320' id='600137'>
<a class='timestamp' href='#600137'><time timestamp='2018-02-13T23:42:00Z'>23:42</time></a>
&lt;<span class='nick nick-7'> eklitzke</span>&gt;
interesting because glibc malloc already has systemtap probes bulitin, since 2.24 i think, so that would go well with my systemtap branch because you could write stap scripts that correlated activity in malloc with events in bitcoind
<br>
</div>

<div class='talk op-msg' data-timestamp='1518566280' id='600138'>
<a class='timestamp' href='#600138'><time timestamp='2018-02-13T23:58:00Z'>23:58</time></a>
&lt;<span class='nick nick-4'> Madscotslad</span>&gt;
Wow nice to see a full IRC room its been a while :) hey folks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1518566280' id='600139'>
<a class='timestamp' href='#600139'><time timestamp='2018-02-13T23:58:00Z'>23:58</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
if you think this is full, you should see #bitcoin
<br>
</div>

</div>
</section>

</body>
</html>
