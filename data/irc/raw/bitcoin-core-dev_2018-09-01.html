<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2018-09-01
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2018-09-01' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:21 UTC</pre>
<pre><a href="/bitcoin-core-dev/2018-08-01">&lt;</a><span class='header'>  September 2018  </span><a href="/bitcoin-core-dev/2018-10-01">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;                   <a class="current" href="/bitcoin-core-dev/2018-09-01">1</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-09-02">2</a>  <a class="" href="/bitcoin-core-dev/2018-09-03">3</a>  <a class="" href="/bitcoin-core-dev/2018-09-04">4</a>  <a class="" href="/bitcoin-core-dev/2018-09-05">5</a>  <a class="" href="/bitcoin-core-dev/2018-09-06">6</a>  <a class="" href="/bitcoin-core-dev/2018-09-07">7</a>  <a class="" href="/bitcoin-core-dev/2018-09-08">8</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-09-09">9</a> <a class="" href="/bitcoin-core-dev/2018-09-10">10</a> <a class="" href="/bitcoin-core-dev/2018-09-11">11</a> <a class="" href="/bitcoin-core-dev/2018-09-12">12</a> <a class="" href="/bitcoin-core-dev/2018-09-13">13</a> <a class="" href="/bitcoin-core-dev/2018-09-14">14</a> <a class="" href="/bitcoin-core-dev/2018-09-15">15</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-16">16</a> <a class="" href="/bitcoin-core-dev/2018-09-17">17</a> <a class="" href="/bitcoin-core-dev/2018-09-18">18</a> <a class="" href="/bitcoin-core-dev/2018-09-19">19</a> <a class="" href="/bitcoin-core-dev/2018-09-20">20</a> <a class="" href="/bitcoin-core-dev/2018-09-21">21</a> <a class="" href="/bitcoin-core-dev/2018-09-22">22</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-23">23</a> <a class="" href="/bitcoin-core-dev/2018-09-24">24</a> 25 <a class="" href="/bitcoin-core-dev/2018-09-26">26</a> <a class="" href="/bitcoin-core-dev/2018-09-27">27</a> <a class="" href="/bitcoin-core-dev/2018-09-28">28</a> <a class="" href="/bitcoin-core-dev/2018-09-29">29</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1535761860' id='628727'>
<a class='timestamp' href='#628727'><time timestamp='2018-09-01T00:31:00Z'>00:31</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
gmaxwell: By &quot;like the undo data&quot;, do you mean just that there are flat file storing the large values and disk positions stored in LevelDB or are you suggesting specifically that the filters be computed in validation code and referenced by the block index?
<br>
</div>

<div class='talk op-msg' data-timestamp='1535761980' id='628728'>
<a class='timestamp' href='#628728'><time timestamp='2018-09-01T00:33:00Z'>00:33</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
in #14121
<br>
</div>

<div class='talk op-msg' data-timestamp='1535761980' id='628729'>
<a class='timestamp' href='#628729'><time timestamp='2018-09-01T00:33:00Z'>00:33</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/14121" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/14121</a> | Index for BIP 157 block filters by jimpo · Pull Request #14121 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1535764380' id='628730'>
<a class='timestamp' href='#628730'><time timestamp='2018-09-01T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jimpo: the former.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535764380' id='628731'>
<a class='timestamp' href='#628731'><time timestamp='2018-09-01T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Flat files with the filters, indexed by position.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535765580' id='628732'>
<a class='timestamp' href='#628732'><time timestamp='2018-09-01T01:33:00Z'>01:33</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
Yeah, that makes sense to me. I&#x27;ll code that up and compare read/write perf.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766360' id='628733'>
<a class='timestamp' href='#628733'><time timestamp='2018-09-01T01:46:00Z'>01:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i doubt it matters much here; we&#x27;re not throughput limited
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766360' id='628734'>
<a class='timestamp' href='#628734'><time timestamp='2018-09-01T01:46:00Z'>01:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
leveldb writes all data twice, which is a reason against writing huge things like blocks and undo data
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766540' id='628735'>
<a class='timestamp' href='#628735'><time timestamp='2018-09-01T01:49:00Z'>01:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
also has varrious caching behaviors, also stores it somewhat inefficiently.  I think that for recent blocks the filters are about 30KB per block? in any case if you think its okay it probably is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766540' id='628736'>
<a class='timestamp' href='#628736'><time timestamp='2018-09-01T01:49:00Z'>01:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I was also thinking about future dependency on leveldb... since we got non-atomic flushing, there are many other things possible for the chainstate.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766840' id='628737'>
<a class='timestamp' href='#628737'><time timestamp='2018-09-01T01:54:00Z'>01:54</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
mongodb?
<br>
</div>

<div class='talk op-msg' data-timestamp='1535766960' id='628738'>
<a class='timestamp' href='#628738'><time timestamp='2018-09-01T01:56:00Z'>01:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it has webscale
<br>
</div>

<div class='talk op-msg' data-timestamp='1535767020' id='628739'>
<a class='timestamp' href='#628739'><time timestamp='2018-09-01T01:57:00Z'>01:57</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t think that even with non-atomic-flushing would mongo&#x27;s consistency behavior be acceptable. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1535769120' id='628740'>
<a class='timestamp' href='#628740'><time timestamp='2018-09-01T02:32:00Z'>02:32</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
mongo write consistency could be a decent entropy source
<br>
</div>

<div class='talk op-msg' data-timestamp='1535821320' id='628741'>
<a class='timestamp' href='#628741'><time timestamp='2018-09-01T17:02:00Z'>17:02</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
hmm, seems the whole block tree db could be moved to flat files since it&#x27;s all read into memory on startup anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1535826900' id='628742'>
<a class='timestamp' href='#628742'><time timestamp='2018-09-01T18:35:00Z'>18:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jimpo: i guess!
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834640' id='628743'>
<a class='timestamp' href='#628743'><time timestamp='2018-09-01T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I think the idea is to not read it all into memory at some point
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834640' id='628744'>
<a class='timestamp' href='#628744'><time timestamp='2018-09-01T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
just like with the wallet, FWIW
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834700' id='628745'>
<a class='timestamp' href='#628745'><time timestamp='2018-09-01T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for the block index, the pointers could be handles that prompt fetching some more specific data only on demand
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834760' id='628746'>
<a class='timestamp' href='#628746'><time timestamp='2018-09-01T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ken2812221: yes, that is funny
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834760' id='628747'>
<a class='timestamp' href='#628747'><time timestamp='2018-09-01T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ken2812221: the argument handling code is pretty weird in some regards, now
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834820' id='628748'>
<a class='timestamp' href='#628748'><time timestamp='2018-09-01T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I tried to document it, but I guess I failed
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834880' id='628749'>
<a class='timestamp' href='#628749'><time timestamp='2018-09-01T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I guess I&#x27;m going to untag #14105 and #14100 from 0.17.0
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834880' id='628750'>
<a class='timestamp' href='#628750'><time timestamp='2018-09-01T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/14105" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/14105</a> | util: Report parse errors in configuration file by laanwj · Pull Request #14105 · bitcoin/bitcoin · GitHubAsset 1Asset 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834880' id='628751'>
<a class='timestamp' href='#628751'><time timestamp='2018-09-01T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/14100" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/14100</a> | doc: Change documentation for =0 for non-boolean options by laanwj · Pull Request #14100 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1535834940' id='628752'>
<a class='timestamp' href='#628752'><time timestamp='2018-09-01T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
we&#x27;re never going to do a release if we try to solve this first
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835180' id='628753'>
<a class='timestamp' href='#628753'><time timestamp='2018-09-01T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wumpus: aren&#x27;t block indexes so small that it wouldn&#x27;t be worth doing fetch-on-demand handles? (as opposed to fetch-on-demand map)
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835360' id='628754'>
<a class='timestamp' href='#628754'><time timestamp='2018-09-01T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: there is certainly some minimum state that would make no sense to fetch on deman
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835360' id='628755'>
<a class='timestamp' href='#628755'><time timestamp='2018-09-01T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: on the other hand, the structure per block is growing every release, I&#x27;m sure there are also things that don&#x27;t make sense to read and store persistently
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835480' id='628756'>
<a class='timestamp' href='#628756'><time timestamp='2018-09-01T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: I just meant I don&#x27;t want to commit to a flat file because of that; also for updates, that would be much harder to manage
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835540' id='628757'>
<a class='timestamp' href='#628757'><time timestamp='2018-09-01T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
having a block index database makes sense, no matter how exactly it&#x27;s managed now
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835720' id='628758'>
<a class='timestamp' href='#628758'><time timestamp='2018-09-01T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835840' id='628759'>
<a class='timestamp' href='#628759'><time timestamp='2018-09-01T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
what is wrong with travis on master: <a href="https://travis-ci.org/bitcoin/bitcoin/builds/423430634?utm_source=email&amp;utm_medium=notification" class="link" target="_blank">https://travis-ci.org/bitcoin/bitcoin/builds/423430634?utm_source=email&amp;utm_medium=notification</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1535835840' id='628760'>
<a class='timestamp' href='#628760'><time timestamp='2018-09-01T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the linting stage is failing but there are no errors
<br>
</div>

<div class='talk op-msg' data-timestamp='1535836260' id='628761'>
<a class='timestamp' href='#628761'><time timestamp='2018-09-01T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
of course it all passes perfectly locally
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837340' id='628762'>
<a class='timestamp' href='#628762'><time timestamp='2018-09-01T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
luke-jr: so sizeof(CBlockIndex) is 144 bytes, so thats 78MB (and slowly growing) of memory used for little particular purpose, excluding malloc overheads (which I guess are probably at least another 16 bytes per header).  The fact that we also keep so many of them in memory means a longer start time, and constant pressure to not add things to those objects with a result of reducing 
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837340' id='628763'>
<a class='timestamp' href='#628763'><time timestamp='2018-09-01T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
functionality. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837340' id='628764'>
<a class='timestamp' href='#628764'><time timestamp='2018-09-01T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so I think it would make sense to eventually not keep them in memory.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837460' id='628765'>
<a class='timestamp' href='#628765'><time timestamp='2018-09-01T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
there should be no particular reason that someone couldn&#x27;t run a fully functional bitcoin node using a few tens of MB of ram... though obviously not one with the lowest possible latency.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837460' id='628766'>
<a class='timestamp' href='#628766'><time timestamp='2018-09-01T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: sure, I&#x27;m just saying, a handle wouldn&#x27;t be a big improvement
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837520' id='628767'>
<a class='timestamp' href='#628767'><time timestamp='2018-09-01T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
seems to make more sense to just create the indexx object itself on demand
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837520' id='628768'>
<a class='timestamp' href='#628768'><time timestamp='2018-09-01T21:32:00Z'>21:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
and not store anything in memory per-block
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837580' id='628769'>
<a class='timestamp' href='#628769'><time timestamp='2018-09-01T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ah, I think I agree with that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837640' id='628770'>
<a class='timestamp' href='#628770'><time timestamp='2018-09-01T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Well really the access to the block index could be intermediated through a caching layer, so that the policy of what is in memory vs not is hidden from the rest of the code.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535837640' id='628771'>
<a class='timestamp' href='#628771'><time timestamp='2018-09-01T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838420' id='628772'>
<a class='timestamp' href='#628772'><time timestamp='2018-09-01T21:47:00Z'>21:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;so I think it would make sense to eventually not keep them in memory&quot; exactly
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838480' id='628773'>
<a class='timestamp' href='#628773'><time timestamp='2018-09-01T21:48:00Z'>21:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I just meant we shouldn&#x27;t be making any code changes in the direction of making that more difficult
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838540' id='628774'>
<a class='timestamp' href='#628774'><time timestamp='2018-09-01T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
not so much &#x27;we should be doing that now&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838540' id='628775'>
<a class='timestamp' href='#628775'><time timestamp='2018-09-01T21:49:00Z'>21:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;d agree it&#x27;s certainly not the biggest memory sink at the moent
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838720' id='628776'>
<a class='timestamp' href='#628776'><time timestamp='2018-09-01T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maybe one of the least useful ones, however.
<br>
</div>

<div class='talk op-msg' data-timestamp='1535838900' id='628777'>
<a class='timestamp' href='#628777'><time timestamp='2018-09-01T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
true
<br>
</div>

</div>
</section>

</body>
</html>
