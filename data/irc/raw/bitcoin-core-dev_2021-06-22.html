<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2021-06-22
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2021-06-22' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:16 UTC</pre>
<pre><a href="/bitcoin-core-dev/2021-05-22">&lt;</a><span class='header'>    June 2021     </span><a href="/bitcoin-core-dev/2021-07-22">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;       <a class="" href="/bitcoin-core-dev/2021-06-01">1</a>  <a class="" href="/bitcoin-core-dev/2021-06-02">2</a>  <a class="" href="/bitcoin-core-dev/2021-06-03">3</a>  <a class="" href="/bitcoin-core-dev/2021-06-04">4</a>  <a class="" href="/bitcoin-core-dev/2021-06-05">5</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2021-06-06">6</a>  <a class="" href="/bitcoin-core-dev/2021-06-07">7</a>  <a class="" href="/bitcoin-core-dev/2021-06-08">8</a>  <a class="" href="/bitcoin-core-dev/2021-06-09">9</a> <a class="" href="/bitcoin-core-dev/2021-06-10">10</a> <a class="" href="/bitcoin-core-dev/2021-06-11">11</a> <a class="" href="/bitcoin-core-dev/2021-06-12">12</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-06-13">13</a> <a class="" href="/bitcoin-core-dev/2021-06-14">14</a> <a class="" href="/bitcoin-core-dev/2021-06-15">15</a> <a class="" href="/bitcoin-core-dev/2021-06-16">16</a> <a class="" href="/bitcoin-core-dev/2021-06-17">17</a> <a class="" href="/bitcoin-core-dev/2021-06-18">18</a> <a class="" href="/bitcoin-core-dev/2021-06-19">19</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-06-20">20</a> <a class="" href="/bitcoin-core-dev/2021-06-21">21</a> <a class="current" href="/bitcoin-core-dev/2021-06-22">22</a> <a class="" href="/bitcoin-core-dev/2021-06-23">23</a> <a class="" href="/bitcoin-core-dev/2021-06-24">24</a> <a class="" href="/bitcoin-core-dev/2021-06-25">25</a> <a class="" href="/bitcoin-core-dev/2021-06-26">26</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-06-27">27</a> <a class="" href="/bitcoin-core-dev/2021-06-28">28</a> <a class="" href="/bitcoin-core-dev/2021-06-29">29</a> <a class="" href="/bitcoin-core-dev/2021-06-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1624320840' id='369653'>
<a class='timestamp' href='#369653'><time timestamp='2021-06-22T00:14:00Z'>00:14</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hebasto: any reason you limited palette updates to macOS?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624320900' id='369654'>
<a class='timestamp' href='#369654'><time timestamp='2021-06-22T00:15:00Z'>00:15</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
luke-jr: not limited, rather focused on macOS
<br>
</div>

<div class='talk op-msg' data-timestamp='1624321020' id='369655'>
<a class='timestamp' href='#369655'><time timestamp='2021-06-22T00:17:00Z'>00:17</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
and macOS has auto-change of appearance feature
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324320' id='369656'>
<a class='timestamp' href='#369656'><time timestamp='2021-06-22T01:12:00Z'>01:12</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hebasto: #ifdef Q_OS_MACOS
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324380' id='369657'>
<a class='timestamp' href='#369657'><time timestamp='2021-06-22T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
windows and linux were not goals for that pr, and were not tested
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324440' id='369658'>
<a class='timestamp' href='#369658'><time timestamp='2021-06-22T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
I agree it could be accepted for other platforms
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324680' id='369659'>
<a class='timestamp' href='#369659'><time timestamp='2021-06-22T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
limiting features to one platform arbitrarily doesn&#x27;t seem to make sense, especially when it&#x27;s the hardest-to-test platform :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324740' id='369660'>
<a class='timestamp' href='#369660'><time timestamp='2021-06-22T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
I don&#x27;t understand your point. it was not &quot;arbitrarily&quot; -- there was users&#x27; request
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324860' id='369661'>
<a class='timestamp' href='#369661'><time timestamp='2021-06-22T01:21:00Z'>01:21</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
getting dark mode work on linux highly depends on DE, btw
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324920' id='369662'>
<a class='timestamp' href='#369662'><time timestamp='2021-06-22T01:22:00Z'>01:22</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] hebasto opened pull request #22305: build: Avoid fcntl64@GLIBC_2.28 in libsqlite3.a (master...210622-fcntl) <a href="https://github.com/bitcoin/bitcoin/pull/22305" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22305</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624324980' id='369663'>
<a class='timestamp' href='#369663'><time timestamp='2021-06-22T01:23:00Z'>01:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hebasto: but it&#x27;s certain to have the same issues without this code
<br>
</div>

<div class='talk op-msg' data-timestamp='1624325100' id='369664'>
<a class='timestamp' href='#369664'><time timestamp='2021-06-22T01:25:00Z'>01:25</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] amitiuttarwar opened pull request #22306: [test] Improvements to p2p_addr_relay.py (master...2021-06-addr-tests) <a href="https://github.com/bitcoin/bitcoin/pull/22306" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22306</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624325340' id='369665'>
<a class='timestamp' href='#369665'><time timestamp='2021-06-22T01:29:00Z'>01:29</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
luke-jr: ofc, because it was not its goal to change behavior on Linux or Windows
<br>
</div>

<div class='talk op-msg' data-timestamp='1624327860' id='369666'>
<a class='timestamp' href='#369666'><time timestamp='2021-06-22T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
win 5
<br>
</div>

<div class='talk op-msg' data-timestamp='1624327860' id='369667'>
<a class='timestamp' href='#369667'><time timestamp='2021-06-22T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
whoops
<br>
</div>

<div class='talk op-msg' data-timestamp='1624334580' id='369668'>
<a class='timestamp' href='#369668'><time timestamp='2021-06-22T04:03:00Z'>04:03</time></a>
&lt;<span class='nick nick-11'> robertspigler</span>&gt;
re: travel restrictions for developer meetup, the Kayak travel website has a world map where you can select any origin country, and then see all the restrictions
<br>
</div>

<div class='talk op-msg' data-timestamp='1624336140' id='369669'>
<a class='timestamp' href='#369669'><time timestamp='2021-06-22T04:29:00Z'>04:29</time></a>
&lt;<span class='nick nick-15'> Bullit</span>&gt;
Yeah if you didnt know google has 1379 members and the stockbroker application Alphabet A and Alphabet C are runaway CEO´s saddly what is suggested about the kayak is googles suggestion in from europe to america by kayak
<br>
</div>

<div class='talk op-msg' data-timestamp='1624342380' id='369670'>
<a class='timestamp' href='#369670'><time timestamp='2021-06-22T06:13:00Z'>06:13</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/398dd6783389...672870ab7ba5" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/398dd6783389...672870ab7ba5</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624342380' id='369671'>
<a class='timestamp' href='#369671'><time timestamp='2021-06-22T06:13:00Z'>06:13</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 168b6c3 Josiah Baker: add dummy file param to fix jupyter
<br>
</div>

<div class='talk op-msg' data-timestamp='1624342380' id='369672'>
<a class='timestamp' href='#369672'><time timestamp='2021-06-22T06:13:00Z'>06:13</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 672870a MarcoFalke: Merge bitcoin/bitcoin#22201: test: Fix TestShell to allow running in Jupyt...
<br>
</div>

<div class='talk op-msg' data-timestamp='1624342440' id='369673'>
<a class='timestamp' href='#369673'><time timestamp='2021-06-22T06:14:00Z'>06:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #22201: test: Fix TestShell to allow running in Jupyter Notebook (master...josibake-parse-only-known-arguments-in-testshell) <a href="https://github.com/bitcoin/bitcoin/pull/22201" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22201</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624349220' id='369674'>
<a class='timestamp' href='#369674'><time timestamp='2021-06-22T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] rebroad opened pull request #22307: Detect when GETBLOCKTXN requests are ignored. (master...DetectIngoredGetblocktxns) <a href="https://github.com/bitcoin/bitcoin/pull/22307" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22307</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624349220' id='369675'>
<a class='timestamp' href='#369675'><time timestamp='2021-06-22T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #22308: wallet: Add missing BlockUntilSyncedToCurrentChain (master...2106-wallet) <a href="https://github.com/bitcoin/bitcoin/pull/22308" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22308</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624352880' id='369676'>
<a class='timestamp' href='#369676'><time timestamp='2021-06-22T09:08:00Z'>09:08</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #22309: blockstorage: Add missing atomic include (master...2106-include) <a href="https://github.com/bitcoin/bitcoin/pull/22309" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22309</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624353420' id='369677'>
<a class='timestamp' href='#369677'><time timestamp='2021-06-22T09:17:00Z'>09:17</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
wumpus / sipa:  can you please block Davidbrizio
<br>
</div>

<div class='talk op-msg' data-timestamp='1624353720' id='369678'>
<a class='timestamp' href='#369678'><time timestamp='2021-06-22T09:22:00Z'>09:22</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
fanquake: can&#x27;t find the user
<br>
</div>

<div class='talk op-msg' data-timestamp='1624353780' id='369679'>
<a class='timestamp' href='#369679'><time timestamp='2021-06-22T09:23:00Z'>09:23</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
I think they&#x27;ve been deleted  already: <a href="https://github.com/Davidbrizio" class="link" target="_blank">https://github.com/Davidbrizio</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624370040' id='369680'>
<a class='timestamp' href='#369680'><time timestamp='2021-06-22T13:54:00Z'>13:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/672870ab7ba5...327e2691f6e0" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/672870ab7ba5...327e2691f6e0</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624370040' id='369681'>
<a class='timestamp' href='#369681'><time timestamp='2021-06-22T13:54:00Z'>13:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa2d21f MarcoFalke: add missing atomic include
<br>
</div>

<div class='talk op-msg' data-timestamp='1624370040' id='369682'>
<a class='timestamp' href='#369682'><time timestamp='2021-06-22T13:54:00Z'>13:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 327e269 MarcoFalke: Merge bitcoin/bitcoin#22309: blockstorage: Add missing atomic include
<br>
</div>

<div class='talk op-msg' data-timestamp='1624370040' id='369683'>
<a class='timestamp' href='#369683'><time timestamp='2021-06-22T13:54:00Z'>13:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #22309: blockstorage: Add missing atomic include (master...2106-include) <a href="https://github.com/bitcoin/bitcoin/pull/22309" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22309</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624382460' id='369684'>
<a class='timestamp' href='#369684'><time timestamp='2021-06-22T17:21:00Z'>17:21</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ariard opened pull request #22310: test: Add functional test for replacement penalty check  (master...2021-06-add-rbf5-test) <a href="https://github.com/bitcoin/bitcoin/pull/22310" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22310</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624383900' id='369685'>
<a class='timestamp' href='#369685'><time timestamp='2021-06-22T17:45:00Z'>17:45</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #22311: test: Add missing syncwithvalidationinterfacequeue in p2p_blockfilters (master...2106-testsyncwithvalidationinterfacequeue) <a href="https://github.com/bitcoin/bitcoin/pull/22311" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22311</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624385340' id='369686'>
<a class='timestamp' href='#369686'><time timestamp='2021-06-22T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] siv2r opened pull request #22312: changes for wait_for_getheaders to include hash_list (master...modify-wait-getheaders) <a href="https://github.com/bitcoin/bitcoin/pull/22312" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22312</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624385820' id='369687'>
<a class='timestamp' href='#369687'><time timestamp='2021-06-22T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #22313: test: Add missing sync_all to feature_coinstatsindex (master...2106-testSync) <a href="https://github.com/bitcoin/bitcoin/pull/22313" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22313</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388160' id='369688'>
<a class='timestamp' href='#369688'><time timestamp='2021-06-22T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
I know this is an age old and time honored tradition, but just for fun: when&#x27;s the last time someone looked seriously at replacing leveldb with something bespoke for our access patterns?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388160' id='369689'>
<a class='timestamp' href='#369689'><time timestamp='2021-06-22T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
not saying it&#x27;s something I want to do but may be a fun project for a new contributor/summer intern or something who&#x27;s so inclined
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388220' id='369690'>
<a class='timestamp' href='#369690'><time timestamp='2021-06-22T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
even having a relatively thorough enumeration of those access patterns and what exactly we need from such a library would be interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388280' id='369691'>
<a class='timestamp' href='#369691'><time timestamp='2021-06-22T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
having the entire utxo set in memory still works best :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388580' id='369692'>
<a class='timestamp' href='#369692'><time timestamp='2021-06-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
could just write it out as a linear file on shutdown (and read it in on startup); the drawback of not using a database is, besides the memory use, that unexpected crashes of the daemon lose the entire state, as it cannot be written incrementally
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388580' id='369693'>
<a class='timestamp' href='#369693'><time timestamp='2021-06-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
laanwj: absolutely :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388580' id='369694'>
<a class='timestamp' href='#369694'><time timestamp='2021-06-22T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
but ofc we don&#x27;t want to make running a full node require 10gb of memory or whatever it is these days
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388640' id='369695'>
<a class='timestamp' href='#369695'><time timestamp='2021-06-22T19:04:00Z'>19:04</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
probably not, and after the initial sync the performance tradeoff becomes different anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388760' id='369696'>
<a class='timestamp' href='#369696'><time timestamp='2021-06-22T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
after that there&#x27;s pretty much two use cases, either you want verification to go as quickly as possible (e.g. miners), which warrants keeping everything in memory, or the speed is pretty much irrelevalt (personal nodes)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388820' id='369697'>
<a class='timestamp' href='#369697'><time timestamp='2021-06-22T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
in which case leveldb is good enough?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624388940' id='369698'>
<a class='timestamp' href='#369698'><time timestamp='2021-06-22T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
jamesob: i think it&#x27;d be fun to have some decidedly <b>*worse*</b> databases too -- e.g. a Filesystem tree 
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389000' id='369699'>
<a class='timestamp' href='#369699'><time timestamp='2021-06-22T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
jeremyru_: totally; would be fun to see to what extent that degrades performance
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389060' id='369700'>
<a class='timestamp' href='#369700'><time timestamp='2021-06-22T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
laanwj: right absolutely. I guess I&#x27;m just compelled to think about it because I wonder if we couldn&#x27;t come up with something equally robust/performant but simpler. After dealing with the issue underlying #22263 I was reminded that leveldb definitely isn&#x27;t perfect and drags in some stuff we may not need (e.g. snaphots)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389060' id='369701'>
<a class='timestamp' href='#369701'><time timestamp='2021-06-22T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
it&#x27;d also be interesting to put in sqlite because then you can build out more indexing stuff, and sqlite is already a dependency for wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389060' id='369702'>
<a class='timestamp' href='#369702'><time timestamp='2021-06-22T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-4'>@gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/22263" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/22263</a> | refactor: wrap CCoinsViewCursor in unique_ptr by jamesob · Pull Request #22263 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389120' id='369703'>
<a class='timestamp' href='#369703'><time timestamp='2021-06-22T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
back in the day we tried some experiments with LMDB but while read performance was somewhat better, write performance was worse
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389120' id='369704'>
<a class='timestamp' href='#369704'><time timestamp='2021-06-22T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
jeremyru_: problem with that is that would drag sqlite into consensus which we definitely don&#x27;t want
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389120' id='369705'>
<a class='timestamp' href='#369705'><time timestamp='2021-06-22T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
snapshots are useful for being able to run utxo statistics or backup in the background
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389180' id='369706'>
<a class='timestamp' href='#369706'><time timestamp='2021-06-22T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
yeah that&#x27;s a good point, and probably not something we&#x27;d want to implement ourselves
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389180' id='369707'>
<a class='timestamp' href='#369707'><time timestamp='2021-06-22T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
jamesob: true, just thinking more generally about things a node operator might want to have, as experimental/run as an internal API node stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389180' id='369708'>
<a class='timestamp' href='#369708'><time timestamp='2021-06-22T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
i doubt we need more indexing stuff, a key/value database is fine for utxos
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389240' id='369709'>
<a class='timestamp' href='#369709'><time timestamp='2021-06-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389240' id='369710'>
<a class='timestamp' href='#369710'><time timestamp='2021-06-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we tried sqlite
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389240' id='369711'>
<a class='timestamp' href='#369711'><time timestamp='2021-06-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the time it had terrible performance for this kind of load
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389240' id='369712'>
<a class='timestamp' href='#369712'><time timestamp='2021-06-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389240' id='369713'>
<a class='timestamp' href='#369713'><time timestamp='2021-06-22T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think that has changed; it&#x27;s just not designed for this
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389300' id='369714'>
<a class='timestamp' href='#369714'><time timestamp='2021-06-22T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
having everything in memory performance wise should be doable mostly as command line options right on cache sizes? I guess the flushes need to be sync on some responses.
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369715'>
<a class='timestamp' href='#369715'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you run with -dbcache=infinity and reindex you&#x27;ll effectively do the entire sync without a single db write
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369716'>
<a class='timestamp' href='#369716'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
jeremyru_: mem only a nonstarter for reasons laanwj mentioned; need to have durability for crashes
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369717'>
<a class='timestamp' href='#369717'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(the blocks will be written to disk, but no flushes would occur)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369718'>
<a class='timestamp' href='#369718'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
sipa: what happens on crash?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369719'>
<a class='timestamp' href='#369719'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
jamesob: I mean it&#x27;s fine for specific scenarios where you have UPS backup, or fallback nodes
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389360' id='369720'>
<a class='timestamp' href='#369720'><time timestamp='2021-06-22T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
right but we can&#x27;t assume that as a generality ofc
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389420' id='369721'>
<a class='timestamp' href='#369721'><time timestamp='2021-06-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
sure, but if you want to specialize for use cases
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389420' id='369722'>
<a class='timestamp' href='#369722'><time timestamp='2021-06-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyru_: you&#x27;ll start over from scratch
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389420' id='369723'>
<a class='timestamp' href='#369723'><time timestamp='2021-06-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
nor can we assume a lot of RAM... but I do like this idea of an optional &quot;sync as fast as you can&quot; mode that ensures sufficient memory and just blazes through an ibd
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389420' id='369724'>
<a class='timestamp' href='#369724'><time timestamp='2021-06-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jamesob: that exists, just set dbcache to all your memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389420' id='369725'>
<a class='timestamp' href='#369725'><time timestamp='2021-06-22T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
(not to mention makes tip maintenance as fast as possible for miners)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389480' id='369726'>
<a class='timestamp' href='#369726'><time timestamp='2021-06-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
sipa: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389480' id='369727'>
<a class='timestamp' href='#369727'><time timestamp='2021-06-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
sipa: although I guess such a mode would preclude periodic flushing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389480' id='369728'>
<a class='timestamp' href='#369728'><time timestamp='2021-06-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
jamesob that should give you a good estimate on how much gain to be had
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389480' id='369729'>
<a class='timestamp' href='#369729'><time timestamp='2021-06-22T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
sipa: yes, it just lacks a way to read in the entire database at node restart at the moment
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389540' id='369730'>
<a class='timestamp' href='#369730'><time timestamp='2021-06-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
laanwj: right, that would be easy to add
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389540' id='369731'>
<a class='timestamp' href='#369731'><time timestamp='2021-06-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-6'> laanwj</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389540' id='369732'>
<a class='timestamp' href='#369732'><time timestamp='2021-06-22T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
jamesob: you could make a double buffered thing if memory really = infinity 
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389600' id='369733'>
<a class='timestamp' href='#369733'><time timestamp='2021-06-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
jeremyru_: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389600' id='369734'>
<a class='timestamp' href='#369734'><time timestamp='2021-06-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
so that you just copy the entire utxo cache, and then write the snapshot periodically
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389600' id='369735'>
<a class='timestamp' href='#369735'><time timestamp='2021-06-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] nourou4them opened pull request #22314: doc: Install WSL on non-system drive and compile Bitcoin (master...patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/22314" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22314</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389600' id='369736'>
<a class='timestamp' href='#369736'><time timestamp='2021-06-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
avoid the restart from scratch issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389600' id='369737'>
<a class='timestamp' href='#369737'><time timestamp='2021-06-22T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
or you could add another cache layer temoporarily
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389660' id='369738'>
<a class='timestamp' href='#369738'><time timestamp='2021-06-22T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
so that all the reads/writes while flushing are temporarily against another layer while you flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389720' id='369739'>
<a class='timestamp' href='#369739'><time timestamp='2021-06-22T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s surprisingly hard to do right
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389720' id='369740'>
<a class='timestamp' href='#369740'><time timestamp='2021-06-22T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in combination with the &quot;delete entries that are spent if they have been created before the last flush&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389720' id='369741'>
<a class='timestamp' href='#369741'><time timestamp='2021-06-22T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
optimization (which we benefit massively from, as all utxos are written once, read once, deleted once)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389840' id='369742'>
<a class='timestamp' href='#369742'><time timestamp='2021-06-22T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
haha you know I&#x27;m now remembering why I arrived at &quot;screw all this ~10% optimization stuff, let&#x27;s just work on assumeutxo&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389960' id='369743'>
<a class='timestamp' href='#369743'><time timestamp='2021-06-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
jamesob: hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389960' id='369744'>
<a class='timestamp' href='#369744'><time timestamp='2021-06-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
one idea:
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389960' id='369745'>
<a class='timestamp' href='#369745'><time timestamp='2021-06-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
just write your assumeutxo rolling hashes to disk as you go
<br>
</div>

<div class='talk op-msg' data-timestamp='1624389960' id='369746'>
<a class='timestamp' href='#369746'><time timestamp='2021-06-22T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
fully verified, but you could re download if you corrupt?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390020' id='369747'>
<a class='timestamp' href='#369747'><time timestamp='2021-06-22T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
that&#x27;s kind of interesting, but you&#x27;ve still gotta keep the block data (and index) somewhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390020' id='369748'>
<a class='timestamp' href='#369748'><time timestamp='2021-06-22T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
anyway sounds precarious/complex relative to the benefits
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390020' id='369749'>
<a class='timestamp' href='#369749'><time timestamp='2021-06-22T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[gui] luke-jr opened pull request #366: Dark Mode fixes/portability (master...gui_palettechange) <a href="https://github.com/bitcoin-core/gui/pull/366" class="link" target="_blank">https://github.com/bitcoin-core/gui/pull/366</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390020' id='369750'>
<a class='timestamp' href='#369750'><time timestamp='2021-06-22T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
I think it&#x27;s one thing if there&#x27;s a sizable optimization we can make for tip maintenance (like avoiding synchronous flushes), but otherwise maybe not worth it to get too fancy
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390140' id='369751'>
<a class='timestamp' href='#369751'><time timestamp='2021-06-22T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i had a design a few years ago that would permit concurrent flushing with cache updating (so it doesn&#x27;t need stop-the-clock and wipe-all-memory on every flush), but it was pretty nontrivial
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390200' id='369752'>
<a class='timestamp' href='#369752'><time timestamp='2021-06-22T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
while still maintaining the soon-spend-never-hits-disk optimization within some window of blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390320' id='369753'>
<a class='timestamp' href='#369753'><time timestamp='2021-06-22T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
also the long-neglected #17487 seems pretty relevant here
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390320' id='369754'>
<a class='timestamp' href='#369754'><time timestamp='2021-06-22T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-4'>@gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/17487" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/17487</a> | coins: allow write to disk without cache drop by jamesob · Pull Request #17487 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390380' id='369755'>
<a class='timestamp' href='#369755'><time timestamp='2021-06-22T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
&gt; the soon-spend-never-hits-disk optimization 
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390380' id='369756'>
<a class='timestamp' href='#369756'><time timestamp='2021-06-22T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
yeah this one is pretty interesting, feel like there&#x27;s some potential there
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390440' id='369757'>
<a class='timestamp' href='#369757'><time timestamp='2021-06-22T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well, we already use it
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390440' id='369758'>
<a class='timestamp' href='#369758'><time timestamp='2021-06-22T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s the reason why -dbcache=huge is so much faster than smaller caches
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390440' id='369759'>
<a class='timestamp' href='#369759'><time timestamp='2021-06-22T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s not just avoiding reads from disk - it&#x27;s mostly preventing things from being written in the first place
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390500' id='369760'>
<a class='timestamp' href='#369760'><time timestamp='2021-06-22T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but combining it with partial flushing is hard, because it leaves you in an inconsistent state
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390500' id='369761'>
<a class='timestamp' href='#369761'><time timestamp='2021-06-22T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
every utxo individually on disk will be consistent with the state it had at some point between the last fully flushed block, and the last processed block
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390500' id='369762'>
<a class='timestamp' href='#369762'><time timestamp='2021-06-22T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but you can&#x27;t guarantee they&#x27;re all consistent with each other
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390680' id='369763'>
<a class='timestamp' href='#369763'><time timestamp='2021-06-22T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
so basically you&#x27;d have to use an ordered map for cacheCoins to do any better than we&#x27;re doing right now I think, right? or have some index for insertion order
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369764'>
<a class='timestamp' href='#369764'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
insertion order does not help
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369765'>
<a class='timestamp' href='#369765'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or at least, not on its own
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369766'>
<a class='timestamp' href='#369766'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
will younger coins are more likely to be spent, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369767'>
<a class='timestamp' href='#369767'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
*well
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369768'>
<a class='timestamp' href='#369768'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
if you were to, say, download N blocks at a time, you could make a lookahead cache that tells you what you should flush to disk and what will be deleted before you actually process the blocks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369769'>
<a class='timestamp' href='#369769'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the problem is that the order in which you delete never-written-to-disk entries from your cache isn&#x27;t the same as the order the utxos are created it
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390740' id='369770'>
<a class='timestamp' href='#369770'><time timestamp='2021-06-22T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
jeremyru_: there&#x27;s some kind of optimization like that the utreexo guys are doing
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390800' id='369771'>
<a class='timestamp' href='#369771'><time timestamp='2021-06-22T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jamesob: oh you just mean as an access optimization? i don&#x27;t think that&#x27;s the bottleneck
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390800' id='369772'>
<a class='timestamp' href='#369772'><time timestamp='2021-06-22T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
sipa: no, I mean when partial flushing, avoid flushing coins that are likely soon to be spent
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390800' id='369773'>
<a class='timestamp' href='#369773'><time timestamp='2021-06-22T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jamesob: there is no solution for that problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390800' id='369774'>
<a class='timestamp' href='#369774'><time timestamp='2021-06-22T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you just need to keep track of the range of blocks that your state on disk corresponds to
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390860' id='369775'>
<a class='timestamp' href='#369775'><time timestamp='2021-06-22T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and on restart, reprocess those blocks to fix the db
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390860' id='369776'>
<a class='timestamp' href='#369776'><time timestamp='2021-06-22T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we do that already btw, to a limited extent, if you crash in the middle of a disk flush
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390860' id='369777'>
<a class='timestamp' href='#369777'><time timestamp='2021-06-22T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390860' id='369778'>
<a class='timestamp' href='#369778'><time timestamp='2021-06-22T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but doing it asynchronously makes tracking a lot harder, because you can have reorgs mixing different histories that all get written to disk at once
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390920' id='369779'>
<a class='timestamp' href='#369779'><time timestamp='2021-06-22T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(and triggering a full flush on reorg would be disasterous for orphan rates)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390920' id='369780'>
<a class='timestamp' href='#369780'><time timestamp='2021-06-22T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right now we only have an inconsistent state on disk from the moment a flush begins until the point where it finishes
<br>
</div>

<div class='talk op-msg' data-timestamp='1624390980' id='369781'>
<a class='timestamp' href='#369781'><time timestamp='2021-06-22T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
continuously partial flushing (which would be far better for performance) would mean you&#x27;re effectively <b>*always*</b> inconsistent on disk, but need to retain the ability to recover from it
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391040' id='369782'>
<a class='timestamp' href='#369782'><time timestamp='2021-06-22T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-11'> jeremyru_</span>&gt;
sipa: if crash during that do we corrupt recoverably? detectably? or just requires reindex?
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391040' id='369783'>
<a class='timestamp' href='#369783'><time timestamp='2021-06-22T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyru_: it gets detected at startup, and reliably recovered without full reindex
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391040' id='369784'>
<a class='timestamp' href='#369784'><time timestamp='2021-06-22T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(unless you have disk errors of course)
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391100' id='369785'>
<a class='timestamp' href='#369785'><time timestamp='2021-06-22T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the start of a flush, a record is written of the form &quot;sync started, block range A...B&quot; where B is the current tip, and A is the old tip that was flushed to
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391100' id='369786'>
<a class='timestamp' href='#369786'><time timestamp='2021-06-22T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at the end, that record is removed and replaced with &quot;synced to block B&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391160' id='369787'>
<a class='timestamp' href='#369787'><time timestamp='2021-06-22T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
at startup, if a range block is present, those blocks are processed again, and their UTXO updated are applied to disk, without any other validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391340' id='369788'>
<a class='timestamp' href='#369788'><time timestamp='2021-06-22T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
one problem with this is that due to fewer consistency guarantees at that point, certain optimizations can&#x27;t be used, and this reprocessing is surprisingly slower than actual validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1624391340' id='369789'>
<a class='timestamp' href='#369789'><time timestamp='2021-06-22T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so if the range is too big, it&#x27;s actually slower than just a reindex
<br>
</div>

<div class='talk op-msg' data-timestamp='1624393980' id='369790'>
<a class='timestamp' href='#369790'><time timestamp='2021-06-22T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-1'> dhruv</span>&gt;
BIP324 question: Does the 3-byte encrypted length in the proposed AEAD construct include the 3 bytes of the length itself? The test vector here seems to imply so but it would be nice to confirm: <a href="https://github.com/bitcoin/bitcoin/blob/327e2691f6e0498aa868af965bb4a951c5be17c5/src/test/crypto_tests.cpp#L710" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/327e2691f6e0498aa868af965bb4a951c5be17c5/src/test/crypto_tests.cpp#L710</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624394100' id='369791'>
<a class='timestamp' href='#369791'><time timestamp='2021-06-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-11'> dongcarl</span>&gt;
meshcollider: Do you remember why you added a -r flag here: <a href="https://github.com/bitcoin-core/gitian.sigs/blob/dfaecb5fa5062a3b2443e1f93933139b864745d8/scripts/files-touched-check.py#L16" class="link" target="_blank">https://github.com/bitcoin-core/gitian.sigs/blob/dfaecb5fa5062a3b2443e1f93933139b864745d8/scripts/files-touched-check.py#L16</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624394100' id='369792'>
<a class='timestamp' href='#369792'><time timestamp='2021-06-22T20:35:00Z'>20:35</time></a>
&lt;<span class='nick nick-11'> dongcarl</span>&gt;
I don&#x27;t see it documented anywhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1624396200' id='369793'>
<a class='timestamp' href='#369793'><time timestamp='2021-06-22T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/327e2691f6e0...c93e123dc72b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/327e2691f6e0...c93e123dc72b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624396200' id='369794'>
<a class='timestamp' href='#369794'><time timestamp='2021-06-22T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fadb550 MarcoFalke: wallet: Add missing BlockUntilSyncedToCurrentChain
<br>
</div>

<div class='talk op-msg' data-timestamp='1624396200' id='369795'>
<a class='timestamp' href='#369795'><time timestamp='2021-06-22T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa27baa MarcoFalke: Revert &quot;test: Add temporary logging to debug #20975&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1624396200' id='369796'>
<a class='timestamp' href='#369796'><time timestamp='2021-06-22T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master c93e123 MarcoFalke: Merge bitcoin/bitcoin#22308: wallet: Add missing BlockUntilSyncedToCurrent...
<br>
</div>

<div class='talk op-msg' data-timestamp='1624396260' id='369797'>
<a class='timestamp' href='#369797'><time timestamp='2021-06-22T21:11:00Z'>21:11</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #22308: wallet: Add missing BlockUntilSyncedToCurrentChain (master...2106-wallet) <a href="https://github.com/bitcoin/bitcoin/pull/22308" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/22308</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1624402920' id='369798'>
<a class='timestamp' href='#369798'><time timestamp='2021-06-22T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-15'> darosior</span>&gt;
morcos: why does the fee estimator disregard CPFP? You mentioned in <a href="https://www.mail-archive.com/bitcoin-development@lists.sourceforge.net/msg06405.html" class="link" target="_blank">https://www.mail-archive.com/bitcoin-development@lists.sourceforge.net/msg06405.html</a> that it would skew estimates, but how so? I don&#x27;t have statistics but i think CPFP is widely used on the network and might be even more in the future with package relay and it becoming a first
<br>
</div>

<div class='talk op-msg' data-timestamp='1624402920' id='369799'>
<a class='timestamp' href='#369799'><time timestamp='2021-06-22T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-15'> darosior</span>&gt;
class citizen in L2 protocols. It seems to me it could bias estimates downward as you would see a low-fee transaction (or actually lot of them) being confirmed quickly whereas you should not rely on their feerate as a decent estimate for being confirmed quickly. Accounting for their parent might be conservative, and accounting for it as a package
<br>
</div>

<div class='talk op-msg' data-timestamp='1624402920' id='369800'>
<a class='timestamp' href='#369800'><time timestamp='2021-06-22T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-15'> darosior</span>&gt;
would be accurate
<br>
</div>

<div class='talk op-msg' data-timestamp='1624402920' id='369801'>
<a class='timestamp' href='#369801'><time timestamp='2021-06-22T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-15'> darosior</span>&gt;
s/for their parent/for their child/
<br>
</div>

</div>
</section>

</body>
</html>
