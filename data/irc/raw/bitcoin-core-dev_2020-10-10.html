<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2020-10-10
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2020-10-10' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:17 UTC</pre>
<pre><a href="/bitcoin-core-dev/2020-09-10">&lt;</a><span class='header'>   October 2020   </span><a href="/bitcoin-core-dev/2020-11-10">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2020-10-01">1</a>  <a class="" href="/bitcoin-core-dev/2020-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2020-10-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2020-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2020-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2020-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2020-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2020-10-08">8</a>  <a class="" href="/bitcoin-core-dev/2020-10-09">9</a> <a class="current" href="/bitcoin-core-dev/2020-10-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-10-11">11</a> <a class="" href="/bitcoin-core-dev/2020-10-12">12</a> <a class="" href="/bitcoin-core-dev/2020-10-13">13</a> <a class="" href="/bitcoin-core-dev/2020-10-14">14</a> <a class="" href="/bitcoin-core-dev/2020-10-15">15</a> <a class="" href="/bitcoin-core-dev/2020-10-16">16</a> <a class="" href="/bitcoin-core-dev/2020-10-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-10-18">18</a> <a class="" href="/bitcoin-core-dev/2020-10-19">19</a> <a class="" href="/bitcoin-core-dev/2020-10-20">20</a> <a class="" href="/bitcoin-core-dev/2020-10-21">21</a> <a class="" href="/bitcoin-core-dev/2020-10-22">22</a> <a class="" href="/bitcoin-core-dev/2020-10-23">23</a> <a class="" href="/bitcoin-core-dev/2020-10-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-10-25">25</a> <a class="" href="/bitcoin-core-dev/2020-10-26">26</a> <a class="" href="/bitcoin-core-dev/2020-10-27">27</a> <a class="" href="/bitcoin-core-dev/2020-10-28">28</a> <a class="" href="/bitcoin-core-dev/2020-10-29">29</a> <a class="" href="/bitcoin-core-dev/2020-10-30">30</a> <a class="" href="/bitcoin-core-dev/2020-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1602291480' id='407668'>
<a class='timestamp' href='#407668'><time timestamp='2020-10-10T00:58:00Z'>00:58</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] leozz37 opened pull request #20116: Implemented GitHub Actions workflow for MacOS and Ubuntu (master...github-actions) <a href="https://github.com/bitcoin/bitcoin/pull/20116" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/20116</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1602291720' id='407669'>
<a class='timestamp' href='#407669'><time timestamp='2020-10-10T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
I&#x27;m getting weird errors while building Bitcoin Core, but everything seems to work fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1602291720' id='407670'>
<a class='timestamp' href='#407670'><time timestamp='2020-10-10T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
&gt; /usr/bin/ld: error: leveldb/libleveldb.a(libleveldb_a-crc32c.o): &lt;corrupt x86 feature size: 0x8&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1602291720' id='407671'>
<a class='timestamp' href='#407671'><time timestamp='2020-10-10T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
for what seems to be every .o file
<br>
</div>

<div class='talk op-msg' data-timestamp='1602291720' id='407672'>
<a class='timestamp' href='#407672'><time timestamp='2020-10-10T01:02:00Z'>01:02</time></a>
&lt;<span class='nick nick-6'> yanmaani</span>&gt;
didn&#x27;t find anything about it on the Internet. Is this a known issue?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602292440' id='407673'>
<a class='timestamp' href='#407673'><time timestamp='2020-10-10T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake closed pull request #20116: Implemented GitHub Actions workflow for MacOS and Ubuntu (master...github-actions) <a href="https://github.com/bitcoin/bitcoin/pull/20116" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/20116</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1602292620' id='407674'>
<a class='timestamp' href='#407674'><time timestamp='2020-10-10T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
vasild: i was wrong; when making an outbound connection, we overwrite the addrman services with the peer&#x27;s reported ones
<br>
</div>

<div class='talk op-msg' data-timestamp='1602292620' id='407675'>
<a class='timestamp' href='#407675'><time timestamp='2020-10-10T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
see CAddrMan::SetServices
<br>
</div>

<div class='talk op-msg' data-timestamp='1602296580' id='407676'>
<a class='timestamp' href='#407676'><time timestamp='2020-10-10T02:23:00Z'>02:23</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
jonatack: okay, put it on my list
<br>
</div>

<div class='talk op-msg' data-timestamp='1602296700' id='407677'>
<a class='timestamp' href='#407677'><time timestamp='2020-10-10T02:25:00Z'>02:25</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Murch: I just put something on your list
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297060' id='407678'>
<a class='timestamp' href='#407678'><time timestamp='2020-10-10T02:31:00Z'>02:31</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
sorry, I meant that I had put it on my list. I realize now that the conjugations of this particular irregular word make my brevity particularly misleading
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297120' id='407679'>
<a class='timestamp' href='#407679'><time timestamp='2020-10-10T02:32:00Z'>02:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
lalalala <a href="http://ncf.idallen.com/english.html" class="link" target="_blank">http://ncf.idallen.com/english.html</a> 
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297180' id='407680'>
<a class='timestamp' href='#407680'><time timestamp='2020-10-10T02:33:00Z'>02:33</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
Yes, let&#x27;s all learn Esperanto or Klingon
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297180' id='407681'>
<a class='timestamp' href='#407681'><time timestamp='2020-10-10T02:33:00Z'>02:33</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
Although, this had nothing to do with homophones or irregular pronunciation :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297240' id='407682'>
<a class='timestamp' href='#407682'><time timestamp='2020-10-10T02:34:00Z'>02:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
put and put are arguably homophones 
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297300' id='407683'>
<a class='timestamp' href='#407683'><time timestamp='2020-10-10T02:35:00Z'>02:35</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
more importantly for my communication mishap, they&#x27;re homonyms
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297300' id='407684'>
<a class='timestamp' href='#407684'><time timestamp='2020-10-10T02:35:00Z'>02:35</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Murch: I wasn&#x27;t trying to correct your spelling hah, I meant I&#x27;d  just tagged you in #20040.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297300' id='407685'>
<a class='timestamp' href='#407685'><time timestamp='2020-10-10T02:35:00Z'>02:35</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/20040" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/20040</a> | wallet: Refactor OutputGroups to handle fees and spending eligibility on grouping by achow101 · Pull Request #20040 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297360' id='407686'>
<a class='timestamp' href='#407686'><time timestamp='2020-10-10T02:36:00Z'>02:36</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
fanquake: I thank ye kindly!
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297360' id='407687'>
<a class='timestamp' href='#407687'><time timestamp='2020-10-10T02:36:00Z'>02:36</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
moar refactor
<br>
</div>

<div class='talk op-msg' data-timestamp='1602297720' id='407688'>
<a class='timestamp' href='#407688'><time timestamp='2020-10-10T02:42:00Z'>02:42</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
I&#x27;ve passed on more feedback to GitHub, now that we&#x27;re seeing even  more comment related issues: <a href="https://0bin.net/paste/9HgV-Dyl#sZlLldWLuSFQGiT1-yYS5ikMyCIIkRLd5lK3fuAD/ql" class="link" target="_blank">https://0bin.net/paste/9HgV-Dyl#sZlLldWLuSFQGiT1-yYS5ikMyCIIkRLd5lK3fuAD/ql</a> &amp; <a href="https://imgur.com/a/mUVsDSX" class="link" target="_blank">https://imgur.com/a/mUVsDSX</a>.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602305340' id='407689'>
<a class='timestamp' href='#407689'><time timestamp='2020-10-10T04:49:00Z'>04:49</time></a>
&lt;<span class='nick nick-5'> tryphe</span>&gt;
sipa, such a great piece
<br>
</div>

<div class='talk op-msg' data-timestamp='1602306360' id='407690'>
<a class='timestamp' href='#407690'><time timestamp='2020-10-10T05:06:00Z'>05:06</time></a>
&lt;<span class='nick nick-5'> tryphe</span>&gt;
or how about white night, wight knight
<br>
</div>

<div class='talk op-msg' data-timestamp='1602306480' id='407691'>
<a class='timestamp' href='#407691'><time timestamp='2020-10-10T05:08:00Z'>05:08</time></a>
&lt;<span class='nick nick-5'> tryphe</span>&gt;
or white knight and wight night :D
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314160' id='407692'>
<a class='timestamp' href='#407692'><time timestamp='2020-10-10T07:16:00Z'>07:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: no, not really since last night, it seems to be a curious case of miscompilation, I still have a broken binary but can&#x27;t reproduce it anymore when building even exactly the same commit. Things have been working since.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314280' id='407693'>
<a class='timestamp' href='#407693'><time timestamp='2020-10-10T07:18:00Z'>07:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
my only guess is a hardware problem or a weird bug with FreeBSD&#x27;s clang 8-derived compiler. The binaries are sufficiently different too, it&#x27;s not like there&#x27;s a few bytes different so it&#x27;s easy to compare.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314340' id='407694'>
<a class='timestamp' href='#407694'><time timestamp='2020-10-10T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
okay
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314340' id='407695'>
<a class='timestamp' href='#407695'><time timestamp='2020-10-10T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i couldn&#x27;t reproduce it either
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314340' id='407696'>
<a class='timestamp' href='#407696'><time timestamp='2020-10-10T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i don&#x27;t know the exact circumstancs
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314400' id='407697'>
<a class='timestamp' href='#407697'><time timestamp='2020-10-10T07:20:00Z'>07:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you can&#x27;t even reproduce it with the same commit (and same peers.dat?), i guess we&#x27;ll need to assume it was a very local problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314400' id='407698'>
<a class='timestamp' href='#407698'><time timestamp='2020-10-10T07:20:00Z'>07:20</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
in any csae, if anyone still wants to figure it out, I two binaries built from the same commit, one with the issue one without
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314400' id='407699'>
<a class='timestamp' href='#407699'><time timestamp='2020-10-10T07:20:00Z'>07:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the binaries differ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314460' id='407700'>
<a class='timestamp' href='#407700'><time timestamp='2020-10-10T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, very significantly
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314460' id='407701'>
<a class='timestamp' href='#407701'><time timestamp='2020-10-10T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
stripped size is the same but everything is in a different place
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314460' id='407702'>
<a class='timestamp' href='#407702'><time timestamp='2020-10-10T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
different compiler/compileflags?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314520' id='407703'>
<a class='timestamp' href='#407703'><time timestamp='2020-10-10T07:22:00Z'>07:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
no, not intentially at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314580' id='407704'>
<a class='timestamp' href='#407704'><time timestamp='2020-10-10T07:23:00Z'>07:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
might have been some cruft in the build dir, who knows... the curious thing is that it happened with 19954 and not without though. I still can&#x27;t explain that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314640' id='407705'>
<a class='timestamp' href='#407705'><time timestamp='2020-10-10T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but I don&#x27;t think it&#x27;s anything to worry about for that PR
<br>
</div>

<div class='talk op-msg' data-timestamp='1602314820' id='407706'>
<a class='timestamp' href='#407706'><time timestamp='2020-10-10T07:27:00Z'>07:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(no, peers.dat nor anything in the data directory is at fault, it only depends on what binary is run)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315000' id='407707'>
<a class='timestamp' href='#407707'><time timestamp='2020-10-10T07:30:00Z'>07:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315300' id='407708'>
<a class='timestamp' href='#407708'><time timestamp='2020-10-10T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I guess it will always remain a mystery, running that particular binary still has the same issue: every outgoing peer is disconnected quickly (usually after sending feefilter), no reason logged in debug.log
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315540' id='407709'>
<a class='timestamp' href='#407709'><time timestamp='2020-10-10T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(correction: *always after &quot;sending feefilter (8 bytes) peer=X&quot; there&#x27;s &quot;disconnecting peer=X&quot;, sometimes with &quot;Cleared nodestate for peer=X&quot; in between*)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315540' id='407710'>
<a class='timestamp' href='#407710'><time timestamp='2020-10-10T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
anything interesting if you run in valgrind?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315660' id='407711'>
<a class='timestamp' href='#407711'><time timestamp='2020-10-10T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
havne&#x27;t tried that yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315900' id='407712'>
<a class='timestamp' href='#407712'><time timestamp='2020-10-10T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it could be thinking that every outgong connection is a feeler connection, it&#x27;s the only fDisconnect I could find without associated NET logging so quickly
<br>
</div>

<div class='talk op-msg' data-timestamp='1602315960' id='407713'>
<a class='timestamp' href='#407713'><time timestamp='2020-10-10T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I wonder what level of debug information FreeBSSD toolchain adds by default
<br>
</div>

<div class='talk op-msg' data-timestamp='1602316140' id='407714'>
<a class='timestamp' href='#407714'><time timestamp='2020-10-10T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
given that there&#x27;s 95MB of size difference between the stripped binary and the plain one, quite a lot would be my guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1602316140' id='407715'>
<a class='timestamp' href='#407715'><time timestamp='2020-10-10T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
could try setting some breakpoints
<br>
</div>

<div class='talk op-msg' data-timestamp='1602320280' id='407716'>
<a class='timestamp' href='#407716'><time timestamp='2020-10-10T08:58:00Z'>08:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: ... okay ... after finally figuring out how to set a hardware memory breakpoint on an atomic value (to see when fDisconnect changes), I discovered something shocking: two parts of the program have different CNode layouts
<br>
</div>

<div class='talk op-msg' data-timestamp='1602320280' id='407717'>
<a class='timestamp' href='#407717'><time timestamp='2020-10-10T08:58:00Z'>08:58</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: there&#x27;s an off-by-one where   pfrom.fSuccessfullyConnected = true; happens to set pfrom.fDisconnected = true ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1602320400' id='407718'>
<a class='timestamp' href='#407718'><time timestamp='2020-10-10T09:00:00Z'>09:00</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: so it&#x27;s clear, a miscompile! I think a stale .o file somehow as linked in, I have --disable-dependency-tracing as it wouldn&#x27;t build on FreeBSD otherwise
<br>
</div>

<div class='talk op-msg' data-timestamp='1602320820' id='407719'>
<a class='timestamp' href='#407719'><time timestamp='2020-10-10T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
vasild: phew, we can ignore the issue, <a href="https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-705504702" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19954#issuecomment-705504702</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1602321240' id='407720'>
<a class='timestamp' href='#407720'><time timestamp='2020-10-10T09:14:00Z'>09:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
anyhow happy I got to the bottom of this, a &quot;silent link issue&quot; must be one of the most evil things I&#x27;ve ever debugged
<br>
</div>

<div class='talk op-msg' data-timestamp='1602321300' id='407721'>
<a class='timestamp' href='#407721'><time timestamp='2020-10-10T09:15:00Z'>09:15</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
wumpus: great to know it
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330060' id='407722'>
<a class='timestamp' href='#407722'><time timestamp='2020-10-10T11:41:00Z'>11:41</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
sipa: right, so we overwrite the service flags when we outbound-connect to a peer from the received version message, and via gossip we | the flags together if we already have an entry for that addr:port
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330120' id='407723'>
<a class='timestamp' href='#407723'><time timestamp='2020-10-10T11:42:00Z'>11:42</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
wumpus: ccache?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330240' id='407724'>
<a class='timestamp' href='#407724'><time timestamp='2020-10-10T11:44:00Z'>11:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
vasild: no, lack of dependency tracking inside automake
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330300' id='407725'>
<a class='timestamp' href='#407725'><time timestamp='2020-10-10T11:45:00Z'>11:45</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
this is what I wrote to hebasto just a few days ago when discussing #18750: &quot;long time ago I ran into some obscure compilation issues and after long debugging I figured out that it is due to ccache and I have never been using it after that!&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330300' id='407726'>
<a class='timestamp' href='#407726'><time timestamp='2020-10-10T11:45:00Z'>11:45</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/18750" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/18750</a> | build: optionally skip external warnings by vasild · Pull Request #18750 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330360' id='407727'>
<a class='timestamp' href='#407727'><time timestamp='2020-10-10T11:46:00Z'>11:46</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
wumpus: &quot;I have --disable-dependency-tracing as it wouldn&#x27;t build on FreeBSD otherwise&quot; -- hmm, I don&#x27;t use that option and it compiles just fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330480' id='407728'>
<a class='timestamp' href='#407728'><time timestamp='2020-10-10T11:48:00Z'>11:48</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
wen cmake?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602330540' id='407729'>
<a class='timestamp' href='#407729'><time timestamp='2020-10-10T11:49:00Z'>11:49</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
:-D
<br>
</div>

<div class='talk op-msg' data-timestamp='1602331800' id='407730'>
<a class='timestamp' href='#407730'><time timestamp='2020-10-10T12:10:00Z'>12:10</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
hopefully no time soon
<br>
</div>

<div class='talk op-msg' data-timestamp='1602331800' id='407731'>
<a class='timestamp' href='#407731'><time timestamp='2020-10-10T12:10:00Z'>12:10</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
We’ve got lots more important things to deal with than swapping build systems, and god forbid we have to maintain two at once.
<br>
</div>

<div class='talk op-msg' data-timestamp='1602331980' id='407732'>
<a class='timestamp' href='#407732'><time timestamp='2020-10-10T12:13:00Z'>12:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
vasild: you are probably following the new, better build instructions for freebsd that tack on MAKE=gmake instead
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332100' id='407733'>
<a class='timestamp' href='#407733'><time timestamp='2020-10-10T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
wumpus: I run ./autogen.sh &amp;&amp; ./configure &amp;&amp; gmake
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332160' id='407734'>
<a class='timestamp' href='#407734'><time timestamp='2020-10-10T12:16:00Z'>12:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
all build systems have their own set of warts using cmake would just switch one for the other
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332160' id='407735'>
<a class='timestamp' href='#407735'><time timestamp='2020-10-10T12:16:00Z'>12:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
vasild: that doesn&#x27;t work for me
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332220' id='407736'>
<a class='timestamp' href='#407736'><time timestamp='2020-10-10T12:17:00Z'>12:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(and for many other people it doesn&#x27;t either which is why that is in the build instructions)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332280' id='407737'>
<a class='timestamp' href='#407737'><time timestamp='2020-10-10T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
might be a automake/autoconf version thing but in any case I&#x27;m not very interested in debugging that now :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332280' id='407738'>
<a class='timestamp' href='#407738'><time timestamp='2020-10-10T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
I saw some mentions of build failures and --disable-dependency-tracing but never bothered to study that, especially that it works for me :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332280' id='407739'>
<a class='timestamp' href='#407739'><time timestamp='2020-10-10T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
I mean build works for me without --disable-dependency-tracing
<br>
</div>

<div class='talk op-msg' data-timestamp='1602332280' id='407740'>
<a class='timestamp' href='#407740'><time timestamp='2020-10-10T12:18:00Z'>12:18</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
disabling dependency tracking will result in madness and insanity don&#x27;t do it, override MAKE intead
<br>
</div>

<div class='talk op-msg' data-timestamp='1602341160' id='407741'>
<a class='timestamp' href='#407741'><time timestamp='2020-10-10T14:46:00Z'>14:46</time></a>
&lt;<span class='nick nick-10'> ariard</span>&gt;
vasild: I&#x27;m still not understanding how a BIP155 node is supposed to discover the list of network IDs supported by its BIP155-peers ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602341220' id='407742'>
<a class='timestamp' href='#407742'><time timestamp='2020-10-10T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-10'> ariard</span>&gt;
for now the table is hardcoded but I assume it will be extended in the future
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350580' id='407743'>
<a class='timestamp' href='#407743'><time timestamp='2020-10-10T17:23:00Z'>17:23</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
sipa: could protecting `m_txrequest` with its own mutex rather with `cs_main` be safe and provide more concurrency?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350640' id='407744'>
<a class='timestamp' href='#407744'><time timestamp='2020-10-10T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hebasto: no, because all call sites already hold cs_main
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350640' id='407745'>
<a class='timestamp' href='#407745'><time timestamp='2020-10-10T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
sipa: ok, thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350640' id='407746'>
<a class='timestamp' href='#407746'><time timestamp='2020-10-10T17:24:00Z'>17:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s also pointless, as net_processing is inherently single-threaded (there is only one message handler thread)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350700' id='407747'>
<a class='timestamp' href='#407747'><time timestamp='2020-10-10T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think net_processing should move to its own locks, instead of cs_main, but that&#x27;s a larger scope thing, and doing that for just m_txrequest doesn&#x27;t provide benefits until the rest of the file can make use of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350700' id='407748'>
<a class='timestamp' href='#407748'><time timestamp='2020-10-10T17:25:00Z'>17:25</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
then why protecting `m_txrequest` at all?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350760' id='407749'>
<a class='timestamp' href='#407749'><time timestamp='2020-10-10T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350760' id='407750'>
<a class='timestamp' href='#407750'><time timestamp='2020-10-10T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
if the only thread has access
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350760' id='407751'>
<a class='timestamp' href='#407751'><time timestamp='2020-10-10T17:26:00Z'>17:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because we don&#x27;t want to introduce bugs
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350820' id='407752'>
<a class='timestamp' href='#407752'><time timestamp='2020-10-10T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the code is perfect, all thread annotations/checks are wasted effort
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350820' id='407753'>
<a class='timestamp' href='#407753'><time timestamp='2020-10-10T17:27:00Z'>17:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we could also delete all tests ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350880' id='407754'>
<a class='timestamp' href='#407754'><time timestamp='2020-10-10T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
no, please :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350880' id='407755'>
<a class='timestamp' href='#407755'><time timestamp='2020-10-10T17:28:00Z'>17:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it isn&#x27;t the case that only one thread has access - it&#x27;s that (i assume!) in the current code, only one thread actually accesses it
<br>
</div>

<div class='talk op-msg' data-timestamp='1602350940' id='407756'>
<a class='timestamp' href='#407756'><time timestamp='2020-10-10T17:29:00Z'>17:29</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
re &quot;i think net_processing should move to its own locks, instead of cs_main&quot; agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360720' id='407757'>
<a class='timestamp' href='#407757'><time timestamp='2020-10-10T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
is there any protocol rule limiting future env type identifiers to 32 bytes?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360720' id='407758'>
<a class='timestamp' href='#407758'><time timestamp='2020-10-10T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
or can it in principle be any length?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360780' id='407759'>
<a class='timestamp' href='#407759'><time timestamp='2020-10-10T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
&quot;env type identifiers&quot; ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360840' id='407760'>
<a class='timestamp' href='#407760'><time timestamp='2020-10-10T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
inv*
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360900' id='407761'>
<a class='timestamp' href='#407761'><time timestamp='2020-10-10T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
from the inventory messages
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360900' id='407762'>
<a class='timestamp' href='#407762'><time timestamp='2020-10-10T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
txid, wtixd, block hash, ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360900' id='407763'>
<a class='timestamp' href='#407763'><time timestamp='2020-10-10T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa: ^
<br>
</div>

<div class='talk op-msg' data-timestamp='1602360900' id='407764'>
<a class='timestamp' href='#407764'><time timestamp='2020-10-10T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
all current ones are some variant of sha256 hash, but I&#x27;m not sure if that&#x27;s a hard rule
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361020' id='407765'>
<a class='timestamp' href='#407765'><time timestamp='2020-10-10T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no, they&#x27;re just 32-bit numbers
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361020' id='407766'>
<a class='timestamp' href='#407766'><time timestamp='2020-10-10T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
I mean CInv is currently hash256, so Core would refuse any future inv variants that are &gt; 32 bytes. perhaps that&#x27;s enough to make sure it won&#x27;t every be any other length
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361020' id='407767'>
<a class='timestamp' href='#407767'><time timestamp='2020-10-10T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the current protocol defines a CInv as 32-bit type + 256-bit value
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361020' id='407768'>
<a class='timestamp' href='#407768'><time timestamp='2020-10-10T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
key thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361080' id='407769'>
<a class='timestamp' href='#407769'><time timestamp='2020-10-10T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there isn&#x27;t even a way to convey anything else
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361080' id='407770'>
<a class='timestamp' href='#407770'><time timestamp='2020-10-10T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s not like the &quot;CInv value length&quot; is sent anywhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361140' id='407771'>
<a class='timestamp' href='#407771'><time timestamp='2020-10-10T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a negotiated protocol change could modify that of course
<br>
</div>

<div class='talk op-msg' data-timestamp='1602361260' id='407772'>
<a class='timestamp' href='#407772'><time timestamp='2020-10-10T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ah good point there is no length indicator, hadn&#x27;t thought about that
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362220' id='407773'>
<a class='timestamp' href='#407773'><time timestamp='2020-10-10T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
stevenroose: until very recently, CInv type was implemented as an int and was changed to uint32_t in #19818 
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362220' id='407774'>
<a class='timestamp' href='#407774'><time timestamp='2020-10-10T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/19818" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/19818</a> | p2p: change `CInv::type` from `int` to `uint32_t`, fix UBSan warning by jonatack · Pull Request #19818 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362220' id='407775'>
<a class='timestamp' href='#407775'><time timestamp='2020-10-10T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
though it was documented as uint32_t in <a href="https://en.bitcoin.it/wiki/Protocol_documentation#Inventory_Vectors" class="link" target="_blank">https://en.bitcoin.it/wiki/Protocol_documentation#Inventory_Vectors</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362220' id='407776'>
<a class='timestamp' href='#407776'><time timestamp='2020-10-10T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
and in <a href="https://btcinformation.org/en/developer-reference#data-messages" class="link" target="_blank">https://btcinformation.org/en/developer-reference#data-messages</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362340' id='407777'>
<a class='timestamp' href='#407777'><time timestamp='2020-10-10T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
jonatack: awesome :) yeah in rust-bitcoin it&#x27;s been a u32 always AFAIK, but I was confused, my question didn&#x27;t make much sense because as Pieter pointed out, the inv message can only have 32-byte hashes as there is no way to convey items of other lengths
<br>
</div>

<div class='talk op-msg' data-timestamp='1602362340' id='407778'>
<a class='timestamp' href='#407778'><time timestamp='2020-10-10T20:39:00Z'>20:39</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
(by MagicalTux and harding, respectively)
<br>
</div>

<div class='talk op-msg' data-timestamp='1602363000' id='407779'>
<a class='timestamp' href='#407779'><time timestamp='2020-10-10T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
jonatack: on all supported platforms, int is 32-bit
<br>
</div>

<div class='talk op-msg' data-timestamp='1602363540' id='407780'>
<a class='timestamp' href='#407780'><time timestamp='2020-10-10T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
luke-jr: right (<a href="https://en.cppreference.com/w/cpp/language/types)" class="link" target="_blank">https://en.cppreference.com/w/cpp/language/types)</a>, recent change was signedness
<br>
</div>

<div class='talk op-msg' data-timestamp='1602363960' id='407781'>
<a class='timestamp' href='#407781'><time timestamp='2020-10-10T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
not sure it matters :P
<br>
</div>

</div>
</section>

</body>
</html>
