<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2021-04-07
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2021-04-07' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:16 UTC</pre>
<pre><a href="/bitcoin-core-dev/2021-03-07">&lt;</a><span class='header'>    April 2021    </span><a href="/bitcoin-core-dev/2021-05-07">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2021-04-01">1</a>  <a class="" href="/bitcoin-core-dev/2021-04-02">2</a>  <a class="" href="/bitcoin-core-dev/2021-04-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2021-04-04">4</a>  <a class="" href="/bitcoin-core-dev/2021-04-05">5</a>  <a class="" href="/bitcoin-core-dev/2021-04-06">6</a>  <a class="current" href="/bitcoin-core-dev/2021-04-07">7</a>  <a class="" href="/bitcoin-core-dev/2021-04-08">8</a>  <a class="" href="/bitcoin-core-dev/2021-04-09">9</a> <a class="" href="/bitcoin-core-dev/2021-04-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-04-11">11</a> <a class="" href="/bitcoin-core-dev/2021-04-12">12</a> <a class="" href="/bitcoin-core-dev/2021-04-13">13</a> <a class="" href="/bitcoin-core-dev/2021-04-14">14</a> <a class="" href="/bitcoin-core-dev/2021-04-15">15</a> <a class="" href="/bitcoin-core-dev/2021-04-16">16</a> <a class="" href="/bitcoin-core-dev/2021-04-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-04-18">18</a> <a class="" href="/bitcoin-core-dev/2021-04-19">19</a> <a class="" href="/bitcoin-core-dev/2021-04-20">20</a> <a class="" href="/bitcoin-core-dev/2021-04-21">21</a> <a class="" href="/bitcoin-core-dev/2021-04-22">22</a> <a class="" href="/bitcoin-core-dev/2021-04-23">23</a> <a class="" href="/bitcoin-core-dev/2021-04-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2021-04-25">25</a> <a class="" href="/bitcoin-core-dev/2021-04-26">26</a> <a class="" href="/bitcoin-core-dev/2021-04-27">27</a> <a class="" href="/bitcoin-core-dev/2021-04-28">28</a> <a class="" href="/bitcoin-core-dev/2021-04-29">29</a> <a class="" href="/bitcoin-core-dev/2021-04-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1617762360' id='360054'>
<a class='timestamp' href='#360054'><time timestamp='2021-04-07T02:26:00Z'>02:26</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
wumpus: whenever is convenient, would you mind swapping my high-prio PR for #21523? I think it should be a pretty uncontroversial change
<br>
</div>

<div class='talk op-msg' data-timestamp='1617762360' id='360055'>
<a class='timestamp' href='#360055'><time timestamp='2021-04-07T02:26:00Z'>02:26</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/21523" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/21523</a> | validation: run VerifyDB on all chainstates by jamesob · Pull Request #21523 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1617762420' id='360056'>
<a class='timestamp' href='#360056'><time timestamp='2021-04-07T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
jamesob: have done
<br>
</div>

<div class='talk op-msg' data-timestamp='1617762420' id='360057'>
<a class='timestamp' href='#360057'><time timestamp='2021-04-07T02:27:00Z'>02:27</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
fanquake: tyty
<br>
</div>

<div class='talk op-msg' data-timestamp='1617770880' id='360058'>
<a class='timestamp' href='#360058'><time timestamp='2021-04-07T04:48:00Z'>04:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/9be7fe484931...245a5cd5604a" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/9be7fe484931...245a5cd5604a</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617770880' id='360059'>
<a class='timestamp' href='#360059'><time timestamp='2021-04-07T04:48:00Z'>04:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 6965456 Andrew Chow: Introduce DeferringSignatureChecker and inherit with SignatureExtractor
<br>
</div>

<div class='talk op-msg' data-timestamp='1617770880' id='360060'>
<a class='timestamp' href='#360060'><time timestamp='2021-04-07T04:48:00Z'>04:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master a97a929 Andrew Chow: Test that signrawtx works when a signed CSV and CLTV inputs are present
<br>
</div>

<div class='talk op-msg' data-timestamp='1617770880' id='360061'>
<a class='timestamp' href='#360061'><time timestamp='2021-04-07T04:48:00Z'>04:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 245a5cd fanquake: Merge #21166: Introduce DeferredSignatureChecker and have SignatureExtract...
<br>
</div>

<div class='talk op-msg' data-timestamp='1617770880' id='360062'>
<a class='timestamp' href='#360062'><time timestamp='2021-04-07T04:48:00Z'>04:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #21166: Introduce DeferredSignatureChecker and have SignatureExtractorClass subclass it (master...fix-sig-extractor-checker) <a href="https://github.com/bitcoin/bitcoin/pull/21166" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21166</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773100' id='360063'>
<a class='timestamp' href='#360063'><time timestamp='2021-04-07T05:25:00Z'>05:25</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Am I misremembering or did someone recently report seeing terrible performance with sqlite based wallets?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773160' id='360064'>
<a class='timestamp' href='#360064'><time timestamp='2021-04-07T05:26:00Z'>05:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think phantomcircuit was complaining about that a while ago
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773220' id='360065'>
<a class='timestamp' href='#360065'><time timestamp='2021-04-07T05:27:00Z'>05:27</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
I&#x27;m currently seeing a 100x performance difference in the wallet tests
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773280' id='360066'>
<a class='timestamp' href='#360066'><time timestamp='2021-04-07T05:28:00Z'>05:28</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
202536866us to run CreateWallet with sqlite vs 2037701us with bdb.
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773340' id='360067'>
<a class='timestamp' href='#360067'><time timestamp='2021-04-07T05:29:00Z'>05:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s no good
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773580' id='360068'>
<a class='timestamp' href='#360068'><time timestamp='2021-04-07T05:33:00Z'>05:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #21616: [0.21] build: link against -lsocket if required for *ifaddrs (0.21...backport_21486) <a href="https://github.com/bitcoin/bitcoin/pull/21616" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21616</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773640' id='360069'>
<a class='timestamp' href='#360069'><time timestamp='2021-04-07T05:34:00Z'>05:34</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/245a5cd5604a...41a8d2b96ff5" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/245a5cd5604a...41a8d2b96ff5</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773640' id='360070'>
<a class='timestamp' href='#360070'><time timestamp='2021-04-07T05:34:00Z'>05:34</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa8fffe MarcoFalke: refactor: Prefer clean assert over UB in coinstats
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773640' id='360071'>
<a class='timestamp' href='#360071'><time timestamp='2021-04-07T05:34:00Z'>05:34</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa9b74f MarcoFalke: Fix assumeutxo crash due to missing base_blockhash
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773640' id='360072'>
<a class='timestamp' href='#360072'><time timestamp='2021-04-07T05:34:00Z'>05:34</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 41a8d2b MarcoFalke: Merge #21582: Fix assumeutxo crash due to missing base_blockhash
<br>
</div>

<div class='talk op-msg' data-timestamp='1617773700' id='360073'>
<a class='timestamp' href='#360073'><time timestamp='2021-04-07T05:35:00Z'>05:35</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #21582: Fix assumeutxo crash due to missing base_blockhash (master...2104-assumeutxoCrash01) <a href="https://github.com/bitcoin/bitcoin/pull/21582" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21582</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617775260' id='360074'>
<a class='timestamp' href='#360074'><time timestamp='2021-04-07T06:01:00Z'>06:01</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Thought it might be some dumb macOS thing, but looks like it&#x27;s happening on Linux too, althought not as bad. Only 27x difference
<br>
</div>

<div class='talk op-msg' data-timestamp='1617776280' id='360075'>
<a class='timestamp' href='#360075'><time timestamp='2021-04-07T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/41a8d2b96ff5...c0160ea52ea8" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/41a8d2b96ff5...c0160ea52ea8</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617776280' id='360076'>
<a class='timestamp' href='#360076'><time timestamp='2021-04-07T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 9a36709 Sebastian Falbesoner: wallet: refactor: dedup sqlite statement preparations
<br>
</div>

<div class='talk op-msg' data-timestamp='1617776280' id='360077'>
<a class='timestamp' href='#360077'><time timestamp='2021-04-07T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master ea19cc8 Sebastian Falbesoner: wallet: refactor: dedup sqlite statement deletions
<br>
</div>

<div class='talk op-msg' data-timestamp='1617776280' id='360078'>
<a class='timestamp' href='#360078'><time timestamp='2021-04-07T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master c0160ea fanquake: Merge #21540: wallet: refactor: dedup sqlite statement preparations/deleti...
<br>
</div>

<div class='talk op-msg' data-timestamp='1617776280' id='360079'>
<a class='timestamp' href='#360079'><time timestamp='2021-04-07T06:18:00Z'>06:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #21540: wallet: refactor: dedup sqlite statement preparations/deletions (master...2021-wallet-dedup_setupsqlstatements) <a href="https://github.com/bitcoin/bitcoin/pull/21540" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21540</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617779580' id='360080'>
<a class='timestamp' href='#360080'><time timestamp='2021-04-07T07:13:00Z'>07:13</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[gui] hebasto opened pull request #274: [PoC] [do not merge]: Support runtime appearance adjustment on macOS (master...210407-dark-poc) <a href="https://github.com/bitcoin-core/gui/pull/274" class="link" target="_blank">https://github.com/bitcoin-core/gui/pull/274</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617784860' id='360081'>
<a class='timestamp' href='#360081'><time timestamp='2021-04-07T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/c0160ea52ea8...6154291cf9ab" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c0160ea52ea8...6154291cf9ab</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617784860' id='360082'>
<a class='timestamp' href='#360082'><time timestamp='2021-04-07T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 3333375 MarcoFalke: fuzz: Fix uninitialized read in test
<br>
</div>

<div class='talk op-msg' data-timestamp='1617784860' id='360083'>
<a class='timestamp' href='#360083'><time timestamp='2021-04-07T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 6154291 MarcoFalke: Merge #21617: fuzz: Fix uninitialized read in i2p test
<br>
</div>

<div class='talk op-msg' data-timestamp='1617784860' id='360084'>
<a class='timestamp' href='#360084'><time timestamp='2021-04-07T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #21617: fuzz: Fix uninitialized read in i2p test (master...2104-fuzzValgrind) <a href="https://github.com/bitcoin/bitcoin/pull/21617" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21617</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785280' id='360085'>
<a class='timestamp' href='#360085'><time timestamp='2021-04-07T08:48:00Z'>08:48</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake opened pull request #21629: build: fix configuring when building depends with NO_BDB=1 (master...fixup_depends_sqlite_only_build) <a href="https://github.com/bitcoin/bitcoin/pull/21629" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21629</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785400' id='360086'>
<a class='timestamp' href='#360086'><time timestamp='2021-04-07T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 4 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/6154291cf9ab...2b3e5bf4c0dc" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/6154291cf9ab...2b3e5bf4c0dc</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785400' id='360087'>
<a class='timestamp' href='#360087'><time timestamp='2021-04-07T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master c6edcf1 fanquake: build: suppress libevent warnings if supressing external warnings
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785400' id='360088'>
<a class='timestamp' href='#360088'><time timestamp='2021-04-07T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 3b0078f fanquake: doc: fixup -Wdocumentation issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785400' id='360089'>
<a class='timestamp' href='#360089'><time timestamp='2021-04-07T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master a4e970a fanquake: build: enable -Wdocumentation if suppressing external warnings
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785400' id='360090'>
<a class='timestamp' href='#360090'><time timestamp='2021-04-07T08:50:00Z'>08:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #21613: build: enable -Wdocumentation (master...enable_wdocumentation) <a href="https://github.com/bitcoin/bitcoin/pull/21613" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21613</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785640' id='360091'>
<a class='timestamp' href='#360091'><time timestamp='2021-04-07T08:54:00Z'>08:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2b3e5bf4c0dc...aa69471ecd55" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2b3e5bf4c0dc...aa69471ecd55</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785640' id='360092'>
<a class='timestamp' href='#360092'><time timestamp='2021-04-07T08:54:00Z'>08:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 937fd4a Russell Yanofsky: Fix wrong wallet RPC context set after #21366
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785640' id='360093'>
<a class='timestamp' href='#360093'><time timestamp='2021-04-07T08:54:00Z'>08:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master aa69471 MarcoFalke: Merge #21572: Fix wrong wallet RPC context set after #21366
<br>
</div>

<div class='talk op-msg' data-timestamp='1617785700' id='360094'>
<a class='timestamp' href='#360094'><time timestamp='2021-04-07T08:55:00Z'>08:55</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke merged pull request #21572: Fix wrong wallet RPC context set after #21366 (master...pr/fixref) <a href="https://github.com/bitcoin/bitcoin/pull/21572" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21572</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617786720' id='360095'>
<a class='timestamp' href='#360095'><time timestamp='2021-04-07T09:12:00Z'>09:12</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] vasild opened pull request #21630: fuzz: split FuzzedSock interface and implementation (master...FuzzedSock_move) <a href="https://github.com/bitcoin/bitcoin/pull/21630" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21630</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617797940' id='360096'>
<a class='timestamp' href='#360096'><time timestamp='2021-04-07T12:19:00Z'>12:19</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] vasild opened pull request #21631: i2p: always check the return value of Sock::Wait() (master...SockWait_usage_fix) <a href="https://github.com/bitcoin/bitcoin/pull/21631" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21631</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617802200' id='360097'>
<a class='timestamp' href='#360097'><time timestamp='2021-04-07T13:30:00Z'>13:30</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] luke-jr reopened pull request #19573: Replace unused BIP 9 logic with draft BIP 8 (master...bip8) <a href="https://github.com/bitcoin/bitcoin/pull/19573" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19573</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617802560' id='360098'>
<a class='timestamp' href='#360098'><time timestamp='2021-04-07T13:36:00Z'>13:36</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake opened pull request #21633: refactor: add [[noreturn]] attribute where applicable (master...build_with_noreturn) <a href="https://github.com/bitcoin/bitcoin/pull/21633" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21633</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617809220' id='360099'>
<a class='timestamp' href='#360099'><time timestamp='2021-04-07T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
fanquake: that sounds bad, i wonder what costs so much time, it&#x27;s not like we&#x27;re using any of sqlite&#x27;s advanced features
<br>
</div>

<div class='talk op-msg' data-timestamp='1617809700' id='360100'>
<a class='timestamp' href='#360100'><time timestamp='2021-04-07T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
is this about fuzzing timeouts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617814560' id='360101'>
<a class='timestamp' href='#360101'><time timestamp='2021-04-07T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 4 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/aa69471ecd55...cb79cabdd9d9" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/aa69471ecd55...cb79cabdd9d9</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617814560' id='360102'>
<a class='timestamp' href='#360102'><time timestamp='2021-04-07T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 3bb6e7b Jon Atack: rpc: add network field to rpc getnodeaddresses
<br>
</div>

<div class='talk op-msg' data-timestamp='1617814560' id='360103'>
<a class='timestamp' href='#360103'><time timestamp='2021-04-07T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 1b91898 Jon Atack: rpc: simplify/constify getnodeaddresses code
<br>
</div>

<div class='talk op-msg' data-timestamp='1617814560' id='360104'>
<a class='timestamp' href='#360104'><time timestamp='2021-04-07T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 5c44678 Jon Atack: rpc: improve getnodeaddresses help
<br>
</div>

<div class='talk op-msg' data-timestamp='1617814620' id='360105'>
<a class='timestamp' href='#360105'><time timestamp='2021-04-07T16:57:00Z'>16:57</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj merged pull request #21594: rpc: add network field to getnodeaddresses (master...getnodeaddresses-network) <a href="https://github.com/bitcoin/bitcoin/pull/21594" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/21594</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617817620' id='360106'>
<a class='timestamp' href='#360106'><time timestamp='2021-04-07T17:47:00Z'>17:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
jeremyrubin: from what i understand, it is about simply running the wallet tests with sqlite, don&#x27;t think fuzzing is involved here
<br>
</div>

<div class='talk op-msg' data-timestamp='1617825720' id='360107'>
<a class='timestamp' href='#360107'><time timestamp='2021-04-07T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
maybe it&#x27;s a performance regression in some version? I don&#x27;t see this issue on my syste with sqlite 3.35.4
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826080' id='360108'>
<a class='timestamp' href='#360108'><time timestamp='2021-04-07T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
achow101: perhaps it is related to disk i/o speed?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826080' id='360109'>
<a class='timestamp' href='#360109'><time timestamp='2021-04-07T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
I&#x27;m thinking it is related to that
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826080' id='360110'>
<a class='timestamp' href='#360110'><time timestamp='2021-04-07T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
I just tried 3.34.1 and did not see the same performance issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360111'>
<a class='timestamp' href='#360111'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if it&quot;s doing lots of fsyncs, it may be super slow on network-connected spinning disk storage, but barely noticable on fast nvme ssd
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360112'>
<a class='timestamp' href='#360112'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
i remember some issues with fsyncing being really slow when used inside VMs
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360113'>
<a class='timestamp' href='#360113'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes that
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360114'>
<a class='timestamp' href='#360114'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
maybe it&#x27;s doing a lot of write transactions separately
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360115'>
<a class='timestamp' href='#360115'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
well the test datadir is /tmp, which IIRC is a ramdisk
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360116'>
<a class='timestamp' href='#360116'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
*is in /tmp
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360117'>
<a class='timestamp' href='#360117'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not on my system
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826140' id='360118'>
<a class='timestamp' href='#360118'><time timestamp='2021-04-07T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
so disk shouldn&#x27;t matter there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826200' id='360119'>
<a class='timestamp' href='#360119'><time timestamp='2021-04-07T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826200' id='360120'>
<a class='timestamp' href='#360120'><time timestamp='2021-04-07T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826200' id='360121'>
<a class='timestamp' href='#360121'><time timestamp='2021-04-07T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
 /tmp is definitely not a ramdisk on all linux distros
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826200' id='360122'>
<a class='timestamp' href='#360122'><time timestamp='2021-04-07T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as soon as descriotor wallets were merged, the parallellism i could run the tests with dramatically reduced
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826200' id='360123'>
<a class='timestamp' href='#360123'><time timestamp='2021-04-07T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
went from 60 without problems to 10 or so
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826260' id='360124'>
<a class='timestamp' href='#360124'><time timestamp='2021-04-07T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and i often still see a few time out that i need to rerun manually
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826260' id='360125'>
<a class='timestamp' href='#360125'><time timestamp='2021-04-07T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
I will try this on a slower drive
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826320' id='360126'>
<a class='timestamp' href='#360126'><time timestamp='2021-04-07T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s always descriptor wallet tests that time out for me
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826380' id='360127'>
<a class='timestamp' href='#360127'><time timestamp='2021-04-07T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
being disk i/o bound does make sense to me
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826380' id='360128'>
<a class='timestamp' href='#360128'><time timestamp='2021-04-07T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(not all of them, and not deterministically, so i nevrr thought too much about it)
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826440' id='360129'>
<a class='timestamp' href='#360129'><time timestamp='2021-04-07T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, the performance issue i saw wasn&#x27;t in a vm btw
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826440' id='360130'>
<a class='timestamp' href='#360130'><time timestamp='2021-04-07T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wait actually it was im dumb
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826500' id='360131'>
<a class='timestamp' href='#360131'><time timestamp='2021-04-07T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so if this is related, i don&#x27;t think it&#x27;s a regression
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826500' id='360132'>
<a class='timestamp' href='#360132'><time timestamp='2021-04-07T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
how do I make test_bitcoin use a different datadir?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826500' id='360133'>
<a class='timestamp' href='#360133'><time timestamp='2021-04-07T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
chroot? :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826560' id='360134'>
<a class='timestamp' href='#360134'><time timestamp='2021-04-07T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or just moujt another fs over /tmp
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826620' id='360135'>
<a class='timestamp' href='#360135'><time timestamp='2021-04-07T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
mkdir /non-tmpfs-tmp &amp;&amp; sudo mount --bind /non-tmpfs-tmp /tmp
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826680' id='360136'>
<a class='timestamp' href='#360136'><time timestamp='2021-04-07T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
achow101: oh it&#x27;s the functional tests that time out for m; unit tests are never a problrm
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826680' id='360137'>
<a class='timestamp' href='#360137'><time timestamp='2021-04-07T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
I have other things appear to be using tmp, so I&#x27;d rather not mount over it. I think I&#x27;ll just modify the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826740' id='360138'>
<a class='timestamp' href='#360138'><time timestamp='2021-04-07T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
or pass a different TMPDIR
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826740' id='360139'>
<a class='timestamp' href='#360139'><time timestamp='2021-04-07T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
it seems like the the unit tests can reliably show the performance issue, so I&#x27;ll go with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826740' id='360140'>
<a class='timestamp' href='#360140'><time timestamp='2021-04-07T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(assuming nothing is hardcoding /tmp which would be bad)
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826860' id='360141'>
<a class='timestamp' href='#360141'><time timestamp='2021-04-07T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
alternatively a chroot with everything bind-mounted execept tmp, but that seems overkill in this case
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826860' id='360142'>
<a class='timestamp' href='#360142'><time timestamp='2021-04-07T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
hard coding the path was easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826860' id='360143'>
<a class='timestamp' href='#360143'><time timestamp='2021-04-07T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
i think setting TMPDIR should work i had to do it once for a system with only a small /tmp partition
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826920' id='360144'>
<a class='timestamp' href='#360144'><time timestamp='2021-04-07T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
definitely appears to be disk io
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826980' id='360145'>
<a class='timestamp' href='#360145'><time timestamp='2021-04-07T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
100% disk utilization and the CreateWallet test is now taking a very long time
<br>
</div>

<div class='talk op-msg' data-timestamp='1617826980' id='360146'>
<a class='timestamp' href='#360146'><time timestamp='2021-04-07T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
we may be using sqlite subotimally
<br>
</div>

<div class='talk op-msg' data-timestamp='1617827160' id='360147'>
<a class='timestamp' href='#360147'><time timestamp='2021-04-07T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
&quot;it&#x27;s always descriptor wallet tests that time out for me&quot; --&gt; same  (apart from other timeouts/races)
<br>
</div>

<div class='talk op-msg' data-timestamp='1617827220' id='360148'>
<a class='timestamp' href='#360148'><time timestamp='2021-04-07T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
achow101: i can give you ssh access on my system if that helps, but it sounds like you&#x27;re already able to reproduce?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617827220' id='360149'>
<a class='timestamp' href='#360149'><time timestamp='2021-04-07T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
yes, I believe I have reproduced it
<br>
</div>

<div class='talk op-msg' data-timestamp='1617828000' id='360150'>
<a class='timestamp' href='#360150'><time timestamp='2021-04-07T20:40:00Z'>20:40</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
can you just pass a ramdisk in for where to create the DB for testing lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1617828060' id='360151'>
<a class='timestamp' href='#360151'><time timestamp='2021-04-07T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
ah i guess this is already discussed above my b
<br>
</div>

<div class='talk op-msg' data-timestamp='1617828060' id='360152'>
<a class='timestamp' href='#360152'><time timestamp='2021-04-07T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
the functional tests let you specify the tempdir the datadirs are made in
<br>
</div>

<div class='talk op-msg' data-timestamp='1617829800' id='360153'>
<a class='timestamp' href='#360153'><time timestamp='2021-04-07T21:10:00Z'>21:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that does require a lot of memory though, the bitcoin functional tests (especially with high parallelism) tend to create many files
<br>
</div>

<div class='talk op-msg' data-timestamp='1617830640' id='360154'>
<a class='timestamp' href='#360154'><time timestamp='2021-04-07T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
with tmpfs /tmp, functional tests at -j60: 126 s runtime, all tests pass
<br>
</div>

<div class='talk op-msg' data-timestamp='1617830940' id='360155'>
<a class='timestamp' href='#360155'><time timestamp='2021-04-07T21:29:00Z'>21:29</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, through the magic of fsync() {}
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831180' id='360156'>
<a class='timestamp' href='#360156'><time timestamp='2021-04-07T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
with normal /tmp, the same takes 488 s, and 3 tests fail
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831180' id='360157'>
<a class='timestamp' href='#360157'><time timestamp='2021-04-07T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(this is a 16-core/32-thread system with 32G RAM)
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831180' id='360158'>
<a class='timestamp' href='#360158'><time timestamp='2021-04-07T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
there&#x27;s a bunch of functional tests that randomly timeout iirc
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831420' id='360159'>
<a class='timestamp' href='#360159'><time timestamp='2021-04-07T21:37:00Z'>21:37</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
We are currently enabling fullfsync (someone suggested we do this to ensure that everything is truly flushed), but the sqlite docs says this &quot;But the implementation of fullfsync involves resetting the disk controller. And so not only is it profoundly slow, it also slows down other unrelated disk I/O. So its use is not recommended.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831480' id='360160'>
<a class='timestamp' href='#360160'><time timestamp='2021-04-07T21:38:00Z'>21:38</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
but that would only affect macs
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831720' id='360161'>
<a class='timestamp' href='#360161'><time timestamp='2021-04-07T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
I would guess that the slow down is because sqlite does an (or two) fsync per write
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831780' id='360162'>
<a class='timestamp' href='#360162'><time timestamp='2021-04-07T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
doesn&#x27;t fsync on Linux also wait for everything else writing to get to disk too?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617831780' id='360163'>
<a class='timestamp' href='#360163'><time timestamp='2021-04-07T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
or at least things queued before you
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832020' id='360164'>
<a class='timestamp' href='#360164'><time timestamp='2021-04-07T21:47:00Z'>21:47</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, performance sensitive sqlite requires using the write ahead log
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832020' id='360165'>
<a class='timestamp' href='#360165'><time timestamp='2021-04-07T21:47:00Z'>21:47</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
and a write ahead log is why we don&#x27;t want bdb
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832080' id='360166'>
<a class='timestamp' href='#360166'><time timestamp='2021-04-07T21:48:00Z'>21:48</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
luke-jr, yes, fsync and fdatasync are for the entire filesystem despite being called on a file or directory
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832200' id='360167'>
<a class='timestamp' href='#360167'><time timestamp='2021-04-07T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, which journal mode are we using?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832200' id='360168'>
<a class='timestamp' href='#360168'><time timestamp='2021-04-07T21:50:00Z'>21:50</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
rollback
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832260' id='360169'>
<a class='timestamp' href='#360169'><time timestamp='2021-04-07T21:51:00Z'>21:51</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, you mean DELETE ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832320' id='360170'>
<a class='timestamp' href='#360170'><time timestamp='2021-04-07T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
we use the rollback journal in PERSIST mode
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832320' id='360171'>
<a class='timestamp' href='#360171'><time timestamp='2021-04-07T21:52:00Z'>21:52</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
PERSIST is because that&#x27;s what it does when locking_mode=EXCLUSIVE
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832380' id='360172'>
<a class='timestamp' href='#360172'><time timestamp='2021-04-07T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, i guess the real issue is that there basically two categories of &#x27;written&#x27; we care about, key material and not-key material
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832440' id='360173'>
<a class='timestamp' href='#360173'><time timestamp='2021-04-07T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i don&#x27;t think with PERSIST requires using synchronous=FULL, but can be NORMAL instead
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832440' id='360174'>
<a class='timestamp' href='#360174'><time timestamp='2021-04-07T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if it&#x27;s just creation that&#x27;s painful, these paranoid modes could also just be enabled after creation
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832440' id='360175'>
<a class='timestamp' href='#360175'><time timestamp='2021-04-07T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
there&#x27;s also these flags <a href="https://sqlite.org/c3ref/c_sync_dataonly.html" class="link" target="_blank">https://sqlite.org/c3ref/c_sync_dataonly.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832500' id='360176'>
<a class='timestamp' href='#360176'><time timestamp='2021-04-07T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
which are separate from the journal_mode and the synchronous pragmas
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832500' id='360177'>
<a class='timestamp' href='#360177'><time timestamp='2021-04-07T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i suspect it&#x27;s a more general sign of a i/o boundness issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832500' id='360178'>
<a class='timestamp' href='#360178'><time timestamp='2021-04-07T21:55:00Z'>21:55</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: well, corruption is the reason we don&#x27;t want bdb… is sqlite&#x27;s WAL just as prone to loss?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832560' id='360179'>
<a class='timestamp' href='#360179'><time timestamp='2021-04-07T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, everywhere that key material is written could be sandwiched in a bunch of flushing logic, but also that&#x27;s kinda of asking for missing that somewhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832560' id='360180'>
<a class='timestamp' href='#360180'><time timestamp='2021-04-07T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
luke-jr, if you lose the WAL you lose what was written, but don&#x27;t corrupt the database
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832560' id='360181'>
<a class='timestamp' href='#360181'><time timestamp='2021-04-07T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: WAL (in general) means we have to do the thing where we constantly flush the log back to the db file. this adds additional overhead, another thread, and is just kind of a pain. It&#x27;s one of the things bdb does that results in a lot of complexity in that code
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832620' id='360182'>
<a class='timestamp' href='#360182'><time timestamp='2021-04-07T21:57:00Z'>21:57</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
sipa: I think if we did all of setup as a single transaction a large part of this would go away.
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832680' id='360183'>
<a class='timestamp' href='#360183'><time timestamp='2021-04-07T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
and doing setup as a single transaction is probably safe
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832680' id='360184'>
<a class='timestamp' href='#360184'><time timestamp='2021-04-07T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
achow101: but so long as it doesn&#x27;t corrupt, it&#x27;s tolerable IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832680' id='360185'>
<a class='timestamp' href='#360185'><time timestamp='2021-04-07T21:58:00Z'>21:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yes sqlite performance is almost entirely based on commits
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832740' id='360186'>
<a class='timestamp' href='#360186'><time timestamp='2021-04-07T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
a thousand writes with one commit is going to be faster than hundreds of writes with 10 commits
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832740' id='360187'>
<a class='timestamp' href='#360187'><time timestamp='2021-04-07T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: WAL has the risk of losing data if that log is lost, and I think that isn&#x27;t tolerable for a completely new db system
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832800' id='360188'>
<a class='timestamp' href='#360188'><time timestamp='2021-04-07T22:00:00Z'>22:00</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, wrapping the entire setup in a transaction has the issue of making the logic tied more closely to the data layer so
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832860' id='360189'>
<a class='timestamp' href='#360189'><time timestamp='2021-04-07T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
iono options etc
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832920' id='360190'>
<a class='timestamp' href='#360190'><time timestamp='2021-04-07T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
aright; is that hard to do?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832980' id='360191'>
<a class='timestamp' href='#360191'><time timestamp='2021-04-07T22:03:00Z'>22:03</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
shouldn&#x27;t be hard to transaction-ize large portions of setup
<br>
</div>

<div class='talk op-msg' data-timestamp='1617832980' id='360192'>
<a class='timestamp' href='#360192'><time timestamp='2021-04-07T22:03:00Z'>22:03</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
especially the parts that write a few thousand records
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833040' id='360193'>
<a class='timestamp' href='#360193'><time timestamp='2021-04-07T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
won&#x27;t break abstractions?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833040' id='360194'>
<a class='timestamp' href='#360194'><time timestamp='2021-04-07T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
no, WalletBatch already has transaction create and commit
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833100' id='360195'>
<a class='timestamp' href='#360195'><time timestamp='2021-04-07T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
although now that I think about it, descriptor wallets don&#x27;t have a whole lot of records to write
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833100' id='360196'>
<a class='timestamp' href='#360196'><time timestamp='2021-04-07T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
unless the test is making a legacy wallet with sqlite
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833160' id='360197'>
<a class='timestamp' href='#360197'><time timestamp='2021-04-07T22:06:00Z'>22:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
do they not pregenerate a bunch of keys?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833160' id='360198'>
<a class='timestamp' href='#360198'><time timestamp='2021-04-07T22:06:00Z'>22:06</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
they&#x27;re generated on the fly and kept in memory only
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360199'>
<a class='timestamp' href='#360199'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360200'>
<a class='timestamp' href='#360200'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the key cache isn&#x27;t written?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360201'>
<a class='timestamp' href='#360201'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
Only the parent xpub is written
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360202'>
<a class='timestamp' href='#360202'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, right
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360203'>
<a class='timestamp' href='#360203'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s nice
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360204'>
<a class='timestamp' href='#360204'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
is that recent?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833220' id='360205'>
<a class='timestamp' href='#360205'><time timestamp='2021-04-07T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
that was in the original
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833280' id='360206'>
<a class='timestamp' href='#360206'><time timestamp='2021-04-07T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833280' id='360207'>
<a class='timestamp' href='#360207'><time timestamp='2021-04-07T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what if you have a blabla/*h descriptor?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833340' id='360208'>
<a class='timestamp' href='#360208'><time timestamp='2021-04-07T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
then it stores all of the derived keys
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833340' id='360209'>
<a class='timestamp' href='#360209'><time timestamp='2021-04-07T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i see, ok
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833340' id='360210'>
<a class='timestamp' href='#360210'><time timestamp='2021-04-07T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
but you have to import such a descriptor explicitly, so the CreateWallet test shouldn&#x27;t be doing that
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833340' id='360211'>
<a class='timestamp' href='#360211'><time timestamp='2021-04-07T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833460' id='360212'>
<a class='timestamp' href='#360212'><time timestamp='2021-04-07T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
still, a 1000x slowdown... kind of suggests it&#x27;s more than a few records?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833460' id='360213'>
<a class='timestamp' href='#360213'><time timestamp='2021-04-07T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
... it&#x27;s making a legacy wallet with sqlite
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833520' id='360214'>
<a class='timestamp' href='#360214'><time timestamp='2021-04-07T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
sipa: which descriptor wallet functional tests timeout?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833520' id='360215'>
<a class='timestamp' href='#360215'><time timestamp='2021-04-07T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
the functional tests shouldn&#x27;t be making legacy wallets with sqlite
<br>
</div>

<div class='talk op-msg' data-timestamp='1617833880' id='360216'>
<a class='timestamp' href='#360216'><time timestamp='2021-04-07T22:18:00Z'>22:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ha.
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834000' id='360217'>
<a class='timestamp' href='#360217'><time timestamp='2021-04-07T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
rpc_fundrawtransaction.py --descriptors            | ✖ Failed  | 488 s
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834000' id='360218'>
<a class='timestamp' href='#360218'><time timestamp='2021-04-07T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wallet_create_tx.py --descriptors                  | ✖ Failed  | 94 s
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834000' id='360219'>
<a class='timestamp' href='#360219'><time timestamp='2021-04-07T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wallet_keypool.py --descriptors                    | ✖ Failed  | 116 s
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834060' id='360220'>
<a class='timestamp' href='#360220'><time timestamp='2021-04-07T22:21:00Z'>22:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
what about phantomcircuit&#x27;s slow test?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834120' id='360221'>
<a class='timestamp' href='#360221'><time timestamp='2021-04-07T22:22:00Z'>22:22</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i was definitely using a descriptor wallet
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834180' id='360222'>
<a class='timestamp' href='#360222'><time timestamp='2021-04-07T22:23:00Z'>22:23</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah format sqlite descriptors true
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834300' id='360223'>
<a class='timestamp' href='#360223'><time timestamp='2021-04-07T22:25:00Z'>22:25</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
phantomcircuit: what were you testing specifcally that was slow?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834360' id='360224'>
<a class='timestamp' href='#360224'><time timestamp='2021-04-07T22:26:00Z'>22:26</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
achow101, just creating the wallet took a very long time
<br>
</div>

<div class='talk op-msg' data-timestamp='1617834420' id='360225'>
<a class='timestamp' href='#360225'><time timestamp='2021-04-07T22:27:00Z'>22:27</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
ok..
<br>
</div>

<div class='talk op-msg' data-timestamp='1617836160' id='360226'>
<a class='timestamp' href='#360226'><time timestamp='2021-04-07T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
sipa: do those timeout on a createwallet call or something else?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617836160' id='360227'>
<a class='timestamp' href='#360227'><time timestamp='2021-04-07T22:56:00Z'>22:56</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
phantomcircuit: were you using an older version of the descriptor wallet pr? there was an iteration that wrote a few thousand records.
<br>
</div>

<div class='talk op-msg' data-timestamp='1617836760' id='360228'>
<a class='timestamp' href='#360228'><time timestamp='2021-04-07T23:06:00Z'>23:06</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
it seems like functional test timeout might be from writing all of the transactions that generatetoaddress produces
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837180' id='360229'>
<a class='timestamp' href='#360229'><time timestamp='2021-04-07T23:13:00Z'>23:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
if it&#x27;s only a performance problem in the tests, what about disabling the fsyncing in the tests?
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837240' id='360230'>
<a class='timestamp' href='#360230'><time timestamp='2021-04-07T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
i&#x27;m not sure there is any real life scenario where the wallet would generate so many writes
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837240' id='360231'>
<a class='timestamp' href='#360231'><time timestamp='2021-04-07T23:14:00Z'>23:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s not like lightning: <a href="https://github.com/lightningnetwork/lnd/issues/5186" class="link" target="_blank">https://github.com/lightningnetwork/lnd/issues/5186</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837360' id='360232'>
<a class='timestamp' href='#360232'><time timestamp='2021-04-07T23:16:00Z'>23:16</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
wumpus: this could be an issue for wallets that receive a lot of transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837420' id='360233'>
<a class='timestamp' href='#360233'><time timestamp='2021-04-07T23:17:00Z'>23:17</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
if they are all in one block, it can be optimized to use a db transaction there, but if a lot of unconfirmed txs, that might be a problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1617837420' id='360234'>
<a class='timestamp' href='#360234'><time timestamp='2021-04-07T23:17:00Z'>23:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
nah, i doubt any single wallet will receive enough on-network transactions for that to really add up enough
<br>
</div>

</div>
</section>

</body>
</html>
