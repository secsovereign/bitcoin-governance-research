<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2020-06-01
 ‚Äî 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2020-06-01' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:18 UTC</pre>
<pre><a href="/bitcoin-core-dev/2020-05-01">&lt;</a><span class='header'>    June 2020     </span><a href="/bitcoin-core-dev/2020-07-01">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;    <a class="current" href="/bitcoin-core-dev/2020-06-01">1</a>  <a class="" href="/bitcoin-core-dev/2020-06-02">2</a>  <a class="" href="/bitcoin-core-dev/2020-06-03">3</a>  <a class="" href="/bitcoin-core-dev/2020-06-04">4</a>  <a class="" href="/bitcoin-core-dev/2020-06-05">5</a>  <a class="" href="/bitcoin-core-dev/2020-06-06">6</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2020-06-07">7</a>  <a class="" href="/bitcoin-core-dev/2020-06-08">8</a>  <a class="" href="/bitcoin-core-dev/2020-06-09">9</a> <a class="" href="/bitcoin-core-dev/2020-06-10">10</a> <a class="" href="/bitcoin-core-dev/2020-06-11">11</a> <a class="" href="/bitcoin-core-dev/2020-06-12">12</a> <a class="" href="/bitcoin-core-dev/2020-06-13">13</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-06-14">14</a> <a class="" href="/bitcoin-core-dev/2020-06-15">15</a> <a class="" href="/bitcoin-core-dev/2020-06-16">16</a> <a class="" href="/bitcoin-core-dev/2020-06-17">17</a> <a class="" href="/bitcoin-core-dev/2020-06-18">18</a> <a class="" href="/bitcoin-core-dev/2020-06-19">19</a> <a class="" href="/bitcoin-core-dev/2020-06-20">20</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-06-21">21</a> <a class="" href="/bitcoin-core-dev/2020-06-22">22</a> <a class="" href="/bitcoin-core-dev/2020-06-23">23</a> <a class="" href="/bitcoin-core-dev/2020-06-24">24</a> <a class="" href="/bitcoin-core-dev/2020-06-25">25</a> <a class="" href="/bitcoin-core-dev/2020-06-26">26</a> <a class="" href="/bitcoin-core-dev/2020-06-27">27</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2020-06-28">28</a> <a class="" href="/bitcoin-core-dev/2020-06-29">29</a> <a class="" href="/bitcoin-core-dev/2020-06-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1590985740' id='389909'>
<a class='timestamp' href='#389909'><time timestamp='2020-06-01T04:29:00Z'>04:29</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ajtowns opened pull request #19130: doc: make it easier to work out size of bloom filter (master...202005-bloom-doc) <a href="https://github.com/bitcoin/bitcoin/pull/19130" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19130</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1590997140' id='389910'>
<a class='timestamp' href='#389910'><time timestamp='2020-06-01T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 5 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/a65b55fa45d4...a8327fd71f5c" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/a65b55fa45d4...a8327fd71f5c</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1590997140' id='389911'>
<a class='timestamp' href='#389911'><time timestamp='2020-06-01T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fab893e MarcoFalke: doc: Fix unrelated typos reported by codespell
<br>
</div>

<div class='talk op-msg' data-timestamp='1590997140' id='389912'>
<a class='timestamp' href='#389912'><time timestamp='2020-06-01T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 100000d MarcoFalke: doc: Add headings to CONTRIBUTING.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1590997140' id='389913'>
<a class='timestamp' href='#389913'><time timestamp='2020-06-01T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fae2fb2 MarcoFalke: doc: Expand section on Getting Started
<br>
</div>

<div class='talk op-msg' data-timestamp='1590997140' id='389914'>
<a class='timestamp' href='#389914'><time timestamp='2020-06-01T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #19072: doc: Expand section on Getting Started (master...2005-docContribClarif) <a href="https://github.com/bitcoin/bitcoin/pull/19072" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19072</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1590998820' id='389915'>
<a class='timestamp' href='#389915'><time timestamp='2020-06-01T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/a8327fd71f5c...9bc7751cadbd" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/a8327fd71f5c...9bc7751cadbd</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1590998820' id='389916'>
<a class='timestamp' href='#389916'><time timestamp='2020-06-01T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa86179 MarcoFalke: doc: Add release notes for 17219
<br>
</div>

<div class='talk op-msg' data-timestamp='1590998820' id='389917'>
<a class='timestamp' href='#389917'><time timestamp='2020-06-01T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fac0ed1 MarcoFalke: doc: Sync &quot;how to upgrade&quot; with 0.20.0 release notes
<br>
</div>

<div class='talk op-msg' data-timestamp='1590998820' id='389918'>
<a class='timestamp' href='#389918'><time timestamp='2020-06-01T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 9bc7751 fanquake: Merge #19115: doc: Add release notes for 17219
<br>
</div>

<div class='talk op-msg' data-timestamp='1590998820' id='389919'>
<a class='timestamp' href='#389919'><time timestamp='2020-06-01T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #19115: doc: Add release notes for 17219 (master...2005-docRel) <a href="https://github.com/bitcoin/bitcoin/pull/19115" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19115</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1590999900' id='389920'>
<a class='timestamp' href='#389920'><time timestamp='2020-06-01T08:25:00Z'>08:25</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jonathanschoeller opened pull request #19131: refactor: Fix unreachable code in init arg checks (master...fix-Wunreachable-code-loop-increment) <a href="https://github.com/bitcoin/bitcoin/pull/19131" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19131</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591006320' id='389921'>
<a class='timestamp' href='#389921'><time timestamp='2020-06-01T10:12:00Z'>10:12</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
practicalswift asked for #18288 to be their high-prio PR; so I&#x27;ve added it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591006320' id='389922'>
<a class='timestamp' href='#389922'><time timestamp='2020-06-01T10:12:00Z'>10:12</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/18288" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/18288</a> | build: Add MemorySanitizer (MSan) in Travis to detect use of uninitialized memory by practicalswift ¬∑ Pull Request #18288 ¬∑ bitcoin/bitcoin ¬∑ GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1591011120' id='389923'>
<a class='timestamp' href='#389923'><time timestamp='2020-06-01T11:32:00Z'>11:32</time></a>
&lt;<span class='nick nick-12'> Kiminuo</span>&gt;
Hi, can I make my PR <a href="https://github.com/bitcoin/bitcoin/pull/18210" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/18210</a> more attractive for review somehow? I have just rewritten the first post to articulate more clearly what the PR does.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591012140' id='389924'>
<a class='timestamp' href='#389924'><time timestamp='2020-06-01T11:49:00Z'>11:49</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
Kiminuo: rebasing promptly helps, and giving review is a good way to (a) to see the review bottleneck and (b) receive review back
<br>
</div>

<div class='talk op-msg' data-timestamp='1591012200' id='389925'>
<a class='timestamp' href='#389925'><time timestamp='2020-06-01T11:50:00Z'>11:50</time></a>
&lt;<span class='nick nick-14'> jonatack</span>&gt;
Kiminuo: because there are more people who open PRs than people who review them
<br>
</div>

<div class='talk op-msg' data-timestamp='1591014480' id='389926'>
<a class='timestamp' href='#389926'><time timestamp='2020-06-01T12:28:00Z'>12:28</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] vasild opened pull request #19132: qt: lock cs_main, m_cached_tip_mutex in that order (master...lock_order_m_cached_tip_mutex) <a href="https://github.com/bitcoin/bitcoin/pull/19132" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19132</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591014780' id='389927'>
<a class='timestamp' href='#389927'><time timestamp='2020-06-01T12:33:00Z'>12:33</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jonatack opened pull request #19133: rpc, cli, test: add bitcoin-cli -generate command (master...cli-generate-command) <a href="https://github.com/bitcoin/bitcoin/pull/19133" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19133</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015200' id='389928'>
<a class='timestamp' href='#389928'><time timestamp='2020-06-01T12:40:00Z'>12:40</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
Maybe #19132 should be included in the coming release. It fixes a regression since 0.19.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015200' id='389929'>
<a class='timestamp' href='#389929'><time timestamp='2020-06-01T12:40:00Z'>12:40</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/19132" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/19132</a> | qt: lock cs_main, m_cached_tip_mutex in that order by vasild ¬∑ Pull Request #19132 ¬∑ bitcoin/bitcoin ¬∑ GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015320' id='389930'>
<a class='timestamp' href='#389930'><time timestamp='2020-06-01T12:42:00Z'>12:42</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
Either a deadlock (infinite hang) or a crash if the (possible) deadlock is detected. I am not sure if the deadlock detecting code is always enabled - in release builds and for all compilers?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015320' id='389931'>
<a class='timestamp' href='#389931'><time timestamp='2020-06-01T12:42:00Z'>12:42</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
vasild: how is it an issue since 0.19 if the PR that supposedly introduced it (17993), was only merged 3 days ago?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015380' id='389932'>
<a class='timestamp' href='#389932'><time timestamp='2020-06-01T12:43:00Z'>12:43</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
well, the problem does not exist in 0.19
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015380' id='389933'>
<a class='timestamp' href='#389933'><time timestamp='2020-06-01T12:43:00Z'>12:43</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Right. So the issue only currently exists in master?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015440' id='389934'>
<a class='timestamp' href='#389934'><time timestamp='2020-06-01T12:44:00Z'>12:44</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015440' id='389935'>
<a class='timestamp' href='#389935'><time timestamp='2020-06-01T12:44:00Z'>12:44</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
If so, there is no need to backport anything.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015440' id='389936'>
<a class='timestamp' href='#389936'><time timestamp='2020-06-01T12:44:00Z'>12:44</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
by &quot;regression since 0.19&quot; I mean that the problem does not exist in 0.19 but would exist in 0.20 (if released without a fix)
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015500' id='389937'>
<a class='timestamp' href='#389937'><time timestamp='2020-06-01T12:45:00Z'>12:45</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
right, I think no need to backport anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015500' id='389938'>
<a class='timestamp' href='#389938'><time timestamp='2020-06-01T12:45:00Z'>12:45</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
I don&#x27;t see how it can exist in 0.20 if it&#x27;s only been merged into master
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015500' id='389939'>
<a class='timestamp' href='#389939'><time timestamp='2020-06-01T12:45:00Z'>12:45</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
It will be fixed in master, and should hopefully never exist in any release.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015620' id='389940'>
<a class='timestamp' href='#389940'><time timestamp='2020-06-01T12:47:00Z'>12:47</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
It <u>_would_</u> exist in 0.20 if 0.20 is released without a fix.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015680' id='389941'>
<a class='timestamp' href='#389941'><time timestamp='2020-06-01T12:48:00Z'>12:48</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
All I am saying is that this is a new problem that IMO should be fixed before the release. If the problem existed in 0.19 (an old one), maybe it would have been less important to get the fix into 0.20.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015800' id='389942'>
<a class='timestamp' href='#389942'><time timestamp='2020-06-01T12:50:00Z'>12:50</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
vasild: the 0.20 release is currently based on the 0.20. branch: <a href="https://github.com/bitcoin/bitcoin/tree/0.20" class="link" target="_blank">https://github.com/bitcoin/bitcoin/tree/0.20</a> (not master), so if the PR introduced the issue (17993) has. only been merged into master, then there is no issue with 0.20.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015800' id='389943'>
<a class='timestamp' href='#389943'><time timestamp='2020-06-01T12:50:00Z'>12:50</time></a>
&lt;<span class='nick nick-12'> Kiminuo</span>&gt;
jonatack, My PR is buried at this point, so I don&#x27;t expect anyone to find it really.. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015860' id='389944'>
<a class='timestamp' href='#389944'><time timestamp='2020-06-01T12:51:00Z'>12:51</time></a>
&lt;<span class='nick nick-12'> Kiminuo</span>&gt;
and rebasing also does not make too much sense because it only claims valuable resources for other PRs
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015860' id='389945'>
<a class='timestamp' href='#389945'><time timestamp='2020-06-01T12:51:00Z'>12:51</time></a>
&lt;<span class='nick nick-12'> Kiminuo</span>&gt;
(I don&#x27;t modify cpp code)
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015920' id='389946'>
<a class='timestamp' href='#389946'><time timestamp='2020-06-01T12:52:00Z'>12:52</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
fanquake: oh, this is my confusion - I assumed that 0.20 is yet to be created from master, sorry. So 0.20 does not have the bug, meaning it should only be fixed before 0.21! :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1591015980' id='389947'>
<a class='timestamp' href='#389947'><time timestamp='2020-06-01T12:53:00Z'>12:53</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
vasild: üëç
<br>
</div>

<div class='talk op-msg' data-timestamp='1591016640' id='389948'>
<a class='timestamp' href='#389948'><time timestamp='2020-06-01T13:04:00Z'>13:04</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
What about attaching a &quot;lock order&quot; number to each mutex (hardcoded in the source code) and enforce that locking always happens in ascending order?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020000' id='389949'>
<a class='timestamp' href='#389949'><time timestamp='2020-06-01T14:00:00Z'>14:00</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
vasild: maybe some of thread safety annotations could be useful?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020240' id='389950'>
<a class='timestamp' href='#389950'><time timestamp='2020-06-01T14:04:00Z'>14:04</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
hebasto: you mean for detecting cycles in the waits-for DAG? That would be excellent as I think our deadlock detection mechanism has a deficiency. <a href="https://github.com/google/sanitizers/wiki/ThreadSanitizerDeadlockDetector" class="link" target="_blank">https://github.com/google/sanitizers/wiki/ThreadSanitizerDeadlockDetector</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020240' id='389951'>
<a class='timestamp' href='#389951'><time timestamp='2020-06-01T14:04:00Z'>14:04</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
is relevant
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020360' id='389952'>
<a class='timestamp' href='#389952'><time timestamp='2020-06-01T14:06:00Z'>14:06</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
what a deficiency?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020540' id='389953'>
<a class='timestamp' href='#389953'><time timestamp='2020-06-01T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
hebasto: <a href="https://paste.gg/p/anonymous/4f3dd080b5ef4a09a0cba6a6eaffc6a6" class="link" target="_blank">https://paste.gg/p/anonymous/4f3dd080b5ef4a09a0cba6a6eaffc6a6</a> -- if somebody can confirm that this is indeed a problem and I am not delusional, then I will open a bug report about it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591020540' id='389954'>
<a class='timestamp' href='#389954'><time timestamp='2020-06-01T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
The push_lock() function is in src/sync.cpp
<br>
</div>

<div class='talk op-msg' data-timestamp='1591021080' id='389955'>
<a class='timestamp' href='#389955'><time timestamp='2020-06-01T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
vasild: does TSan detect such deadlock possibilities?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591021860' id='389956'>
<a class='timestamp' href='#389956'><time timestamp='2020-06-01T14:31:00Z'>14:31</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
no idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023000' id='389957'>
<a class='timestamp' href='#389957'><time timestamp='2020-06-01T14:50:00Z'>14:50</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] dboures opened pull request #19134: test: Replace global wait_until with mininode.wait_until (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/19134" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19134</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023240' id='389958'>
<a class='timestamp' href='#389958'><time timestamp='2020-06-01T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
hebasto: <a href="https://clang.llvm.org/docs/ThreadSafetyAnalysis.html#acquired-before-acquired-after" class="link" target="_blank">https://clang.llvm.org/docs/ThreadSafetyAnalysis.html#acquired-before-acquired-after</a> is promising, but it is only limited to things that can be detected at compile time.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023240' id='389959'>
<a class='timestamp' href='#389959'><time timestamp='2020-06-01T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-14'> hebasto</span>&gt;
vasild: <a href="https://clang.llvm.org/docs/ThreadSafetyAnalysis.html#acquired-before-and-acquired-after-are-currently-unimplemented" class="link" target="_blank">https://clang.llvm.org/docs/ThreadSafetyAnalysis.html#acquired-before-and-acquired-after-are-currently-unimplemented</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023300' id='389960'>
<a class='timestamp' href='#389960'><time timestamp='2020-06-01T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
I just tried the following on master (which has #19132):
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023300' id='389961'>
<a class='timestamp' href='#389961'><time timestamp='2020-06-01T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/19132" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/19132</a> | qt: lock cs_main, m_cached_tip_mutex in that order by vasild ¬∑ Pull Request #19132 ¬∑ bitcoin/bitcoin ¬∑ GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023300' id='389962'>
<a class='timestamp' href='#389962'><time timestamp='2020-06-01T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
-    Mutex m_cached_tip_mutex;
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023300' id='389963'>
<a class='timestamp' href='#389963'><time timestamp='2020-06-01T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
+    Mutex m_cached_tip_mutex ACQUIRED_AFTER(cs_main);
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023300' id='389964'>
<a class='timestamp' href='#389964'><time timestamp='2020-06-01T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
1. it compiled and 2. it abort()ed at runtime, detecting the deadlock from inside our push_lock()
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023360' id='389965'>
<a class='timestamp' href='#389965'><time timestamp='2020-06-01T14:56:00Z'>14:56</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
oh, are currently unimplemented :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1591023420' id='389966'>
<a class='timestamp' href='#389966'><time timestamp='2020-06-01T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-5'> vasild</span>&gt;
but even if they are implemented I doubt it would be possible to detect complicated lock order violations at compile time
<br>
</div>

<div class='talk op-msg' data-timestamp='1591033740' id='389967'>
<a class='timestamp' href='#389967'><time timestamp='2020-06-01T17:49:00Z'>17:49</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] andersonbr opened pull request #19135: Update bitcoin_pt_BR.ts (master...andersonbr-patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/19135" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19135</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591042140' id='389968'>
<a class='timestamp' href='#389968'><time timestamp='2020-06-01T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> gwillen</span>&gt;
MarcoFalke: I&#x27;m curious what inspired you to fix all the codespell typos a few days ago -- I was never sure if those only show up for me, or for mac users, or what
<br>
</div>

<div class='talk op-msg' data-timestamp='1591042140' id='389969'>
<a class='timestamp' href='#389969'><time timestamp='2020-06-01T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> gwillen</span>&gt;
I always assumed they must not be in whatever dictionary Travis uses, or something
<br>
</div>

<div class='talk op-msg' data-timestamp='1591042680' id='389970'>
<a class='timestamp' href='#389970'><time timestamp='2020-06-01T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] achow101 opened pull request #19136: wallet: add dumpwalletdescriptor RPC (master...export-descriptor) <a href="https://github.com/bitcoin/bitcoin/pull/19136" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19136</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591050600' id='389971'>
<a class='timestamp' href='#389971'><time timestamp='2020-06-01T22:30:00Z'>22:30</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] achow101 opened pull request #19137: wallettool: Add dump and createfromdump commands (master...dumpwalletrecords) <a href="https://github.com/bitcoin/bitcoin/pull/19137" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19137</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591052520' id='389972'>
<a class='timestamp' href='#389972'><time timestamp='2020-06-01T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
are there real benefits of rpc batching?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591052640' id='389973'>
<a class='timestamp' href='#389973'><time timestamp='2020-06-01T23:04:00Z'>23:04</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake closed pull request #19135: qt: Update bitcoin_pt_BR.ts (master...andersonbr-patch-1) <a href="https://github.com/bitcoin/bitcoin/pull/19135" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/19135</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053660' id='389974'>
<a class='timestamp' href='#389974'><time timestamp='2020-06-01T23:21:00Z'>23:21</time></a>
&lt;<span class='nick nick-5'> jarthur</span>&gt;
promag: definitely, at least vs single RPC per HTTP request. A new HTTP request is expensive. From dynamic languages that have an expensive stack like Python and JavaScript, not having to go up and down the stack as much for multiple sends carries a performance benefit. JSON-RPC Pipelining is better on memory usage than batching, just harder to program support for.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053720' id='389975'>
<a class='timestamp' href='#389975'><time timestamp='2020-06-01T23:22:00Z'>23:22</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
at least vs single RPC per HTTP request &lt;- yeah I don&#x27;t mind in this case
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053840' id='389976'>
<a class='timestamp' href='#389976'><time timestamp='2020-06-01T23:24:00Z'>23:24</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
so in the case the connection is established, only saving is on http protocol right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053900' id='389977'>
<a class='timestamp' href='#389977'><time timestamp='2020-06-01T23:25:00Z'>23:25</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
because for the server batching is actually worse, at least memory wise
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053960' id='389978'>
<a class='timestamp' href='#389978'><time timestamp='2020-06-01T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
s/mind in /mean/
<br>
</div>

<div class='talk op-msg' data-timestamp='1591053960' id='389979'>
<a class='timestamp' href='#389979'><time timestamp='2020-06-01T23:26:00Z'>23:26</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
sipa: &quot;after how much time are we okay with attackers knowing everything that was in the mempool at the time?&quot; -- if 99.9% of tx&#x27;s are relayed to 99.9% of nodes within X seconds, then 2*X seconds? (fsv of 2 and 99.9%)
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054020' id='389980'>
<a class='timestamp' href='#389980'><time timestamp='2020-06-01T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
aj: maybe that&#x27;s even to strong a question
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054020' id='389981'>
<a class='timestamp' href='#389981'><time timestamp='2020-06-01T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
&quot;after how much time beyond the time it takes to send an INV are we ok with attackers knowing our mempool&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054080' id='389982'>
<a class='timestamp' href='#389982'><time timestamp='2020-06-01T23:28:00Z'>23:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the answer is: whenever we send an INV, attackers can know our entire mempool before that point... it&#x27;s very easy
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054080' id='389983'>
<a class='timestamp' href='#389983'><time timestamp='2020-06-01T23:28:00Z'>23:28</time></a>
&lt;<span class='nick nick-5'> jarthur</span>&gt;
promag: right, assuming the server supports pipelining multiple requests on the same connection (like JSON-RPC 2.0 TCP Transport w/ JSON Splitting, Stratum Mining TCP Transport, Stratum Wallet TCP Transport etc), I don&#x27;t see an advantage batching would have.
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054320' id='389984'>
<a class='timestamp' href='#389984'><time timestamp='2020-06-01T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
aj: if so, we&#x27;d just keep track of the last timestamp when we sent out a tx INV, and respond to requests for anything that was in the mempool before that point
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054320' id='389985'>
<a class='timestamp' href='#389985'><time timestamp='2020-06-01T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we&#x27;d still need a relay pool + bloom filter for dealing with things not in the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054320' id='389986'>
<a class='timestamp' href='#389986'><time timestamp='2020-06-01T23:32:00Z'>23:32</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
sipa: &quot;whenever we send an INV, an attacker can know the presence or absence of every tx that entered our mempool prior to the latest tx in that INV&quot; maybe. i don&#x27;t see a lot of benefit to doing much else, since an attacker could just make more connections to get around it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054380' id='389987'>
<a class='timestamp' href='#389987'><time timestamp='2020-06-01T23:33:00Z'>23:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but the latter can go away once fast NOTFOUND handling is widespread on the network
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054680' id='389988'>
<a class='timestamp' href='#389988'><time timestamp='2020-06-01T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
sipa: is this protecting against anything other than tracing transaction sources?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591054680' id='389989'>
<a class='timestamp' href='#389989'><time timestamp='2020-06-01T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t think so
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055460' id='389990'>
<a class='timestamp' href='#389990'><time timestamp='2020-06-01T23:51:00Z'>23:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
aj: here is a downside: for a very new connection, by observing the difference between what we actually announce to a peer, and what they can request (after our first INV)... they get an exact point distinguishing transaction we learned right before and right after the connection was created
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055640' id='389991'>
<a class='timestamp' href='#389991'><time timestamp='2020-06-01T23:54:00Z'>23:54</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
sipa: ha. could hack around that by not sending the first INV worth of tx&#x27;s to them?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055700' id='389992'>
<a class='timestamp' href='#389992'><time timestamp='2020-06-01T23:55:00Z'>23:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
does that help?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055760' id='389993'>
<a class='timestamp' href='#389993'><time timestamp='2020-06-01T23:56:00Z'>23:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right, it does a bit
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055760' id='389994'>
<a class='timestamp' href='#389994'><time timestamp='2020-06-01T23:56:00Z'>23:56</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
sipa: it makes it no more leaky than anytime you get an INV after the two prior INVs had less than 100 txids, i think?
<br>
</div>

<div class='talk op-msg' data-timestamp='1591055820' id='389995'>
<a class='timestamp' href='#389995'><time timestamp='2020-06-01T23:57:00Z'>23:57</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
wish it was easier to keep all the relay related rules in my head at the same time
<br>
</div>

</div>
</section>

</body>
</html>
