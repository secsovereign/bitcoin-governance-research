<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2017-06-30
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2017-06-30' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:24 UTC</pre>
<pre><a href="/bitcoin-core-dev/2017-05-30">&lt;</a><span class='header'>    June 2017     </span><a href="/bitcoin-core-dev/2017-07-30">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2017-06-01">1</a>  <a class="" href="/bitcoin-core-dev/2017-06-02">2</a>  <a class="" href="/bitcoin-core-dev/2017-06-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2017-06-04">4</a>  <a class="" href="/bitcoin-core-dev/2017-06-05">5</a>  <a class="" href="/bitcoin-core-dev/2017-06-06">6</a>  <a class="" href="/bitcoin-core-dev/2017-06-07">7</a>  <a class="" href="/bitcoin-core-dev/2017-06-08">8</a>  <a class="" href="/bitcoin-core-dev/2017-06-09">9</a> <a class="" href="/bitcoin-core-dev/2017-06-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-06-11">11</a> <a class="" href="/bitcoin-core-dev/2017-06-12">12</a> <a class="" href="/bitcoin-core-dev/2017-06-13">13</a> <a class="" href="/bitcoin-core-dev/2017-06-14">14</a> <a class="" href="/bitcoin-core-dev/2017-06-15">15</a> <a class="" href="/bitcoin-core-dev/2017-06-16">16</a> <a class="" href="/bitcoin-core-dev/2017-06-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-06-18">18</a> <a class="" href="/bitcoin-core-dev/2017-06-19">19</a> <a class="" href="/bitcoin-core-dev/2017-06-20">20</a> <a class="" href="/bitcoin-core-dev/2017-06-21">21</a> <a class="" href="/bitcoin-core-dev/2017-06-22">22</a> <a class="" href="/bitcoin-core-dev/2017-06-23">23</a> <a class="" href="/bitcoin-core-dev/2017-06-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2017-06-25">25</a> <a class="" href="/bitcoin-core-dev/2017-06-26">26</a> <a class="" href="/bitcoin-core-dev/2017-06-27">27</a> <a class="" href="/bitcoin-core-dev/2017-06-28">28</a> <a class="" href="/bitcoin-core-dev/2017-06-29">29</a> <a class="current" href="/bitcoin-core-dev/2017-06-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1498784880' id='553640'>
<a class='timestamp' href='#553640'><time timestamp='2017-06-30T01:08:00Z'>01:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields: I mean mine&#x27;s like 3 LOC long, but, really, I dont care....I have nothing in 15 which is in any way related to that, and only a 16 stretch goal which needs a fix there
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553641'>
<a class='timestamp' href='#553641'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
BlueMatt: ok. I&#x27;m actually finishing it up now
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553642'>
<a class='timestamp' href='#553642'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
it&#x27;s really big, but very worth it imo. It&#x27;ll just be a big one to review
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553643'>
<a class='timestamp' href='#553643'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields: I&#x27;m down for a touch-everything sharedptr change for 16 here
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553644'>
<a class='timestamp' href='#553644'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yea, I think its worth it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553645'>
<a class='timestamp' href='#553645'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I mean isnt it mostly mechanical?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498784940' id='553646'>
<a class='timestamp' href='#553646'><time timestamp='2017-06-30T01:09:00Z'>01:09</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
nah, there&#x27;s lots to it :\
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553647'>
<a class='timestamp' href='#553647'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
well, the shared-ptr part is pretty mechanical
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553648'>
<a class='timestamp' href='#553648'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hmm, ok, will reserve judgement for now, but the idea sounds good
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553649'>
<a class='timestamp' href='#553649'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
but then you still have the refcounting on top
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553650'>
<a class='timestamp' href='#553650'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and I&#x27;m totally for a big overhaul of that shit for 16
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553651'>
<a class='timestamp' href='#553651'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
and once you get rid of that, tons of LOCK(cs_vNodes) go away
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785000' id='553652'>
<a class='timestamp' href='#553652'><time timestamp='2017-06-30T01:10:00Z'>01:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
why bother refcounting on top? just relay on ~CNode and use the shared_ptr refcounting for it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553653'>
<a class='timestamp' href='#553653'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
have to control the thread it deletes from
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553654'>
<a class='timestamp' href='#553654'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553655'>
<a class='timestamp' href='#553655'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553656'>
<a class='timestamp' href='#553656'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
anyway, it&#x27;s nice and tidy imo. Very straigtforward. Just large.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553657'>
<a class='timestamp' href='#553657'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
alright, well will reserve judgement, sounds reasonably in principle, then
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785060' id='553658'>
<a class='timestamp' href='#553658'><time timestamp='2017-06-30T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
yea, large is ok...for 16
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785120' id='553659'>
<a class='timestamp' href='#553659'><time timestamp='2017-06-30T01:12:00Z'>01:12</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
gonna sit for 1.5 months first, then, though :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785120' id='553660'>
<a class='timestamp' href='#553660'><time timestamp='2017-06-30T01:12:00Z'>01:12</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
i don&#x27;t quite understand that arguement. We have a feature freeze for a reason. That&#x27;s when stuff bakes. It&#x27;s not a code freeze.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785180' id='553661'>
<a class='timestamp' href='#553661'><time timestamp='2017-06-30T01:13:00Z'>01:13</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hmm? I mean i doubt this would land pre-15, and if it doesnt then we&#x27;re all gonna be focused on getting lots of testing in on 15 and likely wont review/merge all that much before the final gets shipped
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785240' id='553662'>
<a class='timestamp' href='#553662'><time timestamp='2017-06-30T01:14:00Z'>01:14</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sure, if there&#x27;s no time, that&#x27;s one thing. But I don&#x27;t see any need for stuff to bake for a while before feature freeze just to let it bake
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785300' id='553663'>
<a class='timestamp' href='#553663'><time timestamp='2017-06-30T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
ohoh, you mean maybe this will land for 15? I mean id be surprised...lots to clean up and try to land before then that is probably higher prio, but, ok, fair :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785300' id='553664'>
<a class='timestamp' href='#553664'><time timestamp='2017-06-30T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
higher prio in the next 3 weeks with folks in the us on vacation for the next week, even :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785360' id='553665'>
<a class='timestamp' href='#553665'><time timestamp='2017-06-30T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
well i&#x27;d like to do some benches before i push, but i&#x27;m thinking that cs_vNodes is blocking a significant percentage of the time
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785420' id='553666'>
<a class='timestamp' href='#553666'><time timestamp='2017-06-30T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oh? alright, well may be worth pushing, then...still, two weeks to merge is an incredibly tight schedule
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785420' id='553667'>
<a class='timestamp' href='#553667'><time timestamp='2017-06-30T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
and i have other stuff that relies on this (I was just putting it off until last). But yea, I agree that it&#x27;s not really hight priority. If it doesn&#x27;t make it, it doesn&#x27;t make it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785420' id='553668'>
<a class='timestamp' href='#553668'><time timestamp='2017-06-30T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
*high
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785420' id='553669'>
<a class='timestamp' href='#553669'><time timestamp='2017-06-30T01:17:00Z'>01:17</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
I&#x27;m mainly just happy that I finally worked out an approach I like. It&#x27;ll wear off in a few hours :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785480' id='553670'>
<a class='timestamp' href='#553670'><time timestamp='2017-06-30T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
pr quickly, then
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785480' id='553671'>
<a class='timestamp' href='#553671'><time timestamp='2017-06-30T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and dont close it this time when it wears off :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785480' id='553672'>
<a class='timestamp' href='#553672'><time timestamp='2017-06-30T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
hehe
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785540' id='553673'>
<a class='timestamp' href='#553673'><time timestamp='2017-06-30T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
ok, back to coding/testing. I haven&#x27;t actually run the thing yet. Time to see how badly it crashes/burns :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498785540' id='553674'>
<a class='timestamp' href='#553674'><time timestamp='2017-06-30T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
lol, sg
<br>
</div>

<div class='talk op-msg' data-timestamp='1498806660' id='553675'>
<a class='timestamp' href='#553675'><time timestamp='2017-06-30T07:11:00Z'>07:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
whoa, validation really became a lot quicker with recent changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807260' id='553676'>
<a class='timestamp' href='#553676'><time timestamp='2017-06-30T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: IBD or at tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807260' id='553677'>
<a class='timestamp' href='#553677'><time timestamp='2017-06-30T07:21:00Z'>07:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
?     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807320' id='553678'>
<a class='timestamp' href='#553678'><time timestamp='2017-06-30T07:22:00Z'>07:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
at tip
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807320' id='553679'>
<a class='timestamp' href='#553679'><time timestamp='2017-06-30T07:22:00Z'>07:22</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(a node catching up a few days)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807440' id='553680'>
<a class='timestamp' href='#553680'><time timestamp='2017-06-30T07:24:00Z'>07:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, i mean while in full sync processing newly mined blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807500' id='553681'>
<a class='timestamp' href='#553681'><time timestamp='2017-06-30T07:25:00Z'>07:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it used to bring this particular system to a halt while slowly syncing blocks, now the blocks breeze by
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807500' id='553682'>
<a class='timestamp' href='#553682'><time timestamp='2017-06-30T07:25:00Z'>07:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you have slow I/O, pertxout likely helps a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807500' id='553683'>
<a class='timestamp' href='#553683'><time timestamp='2017-06-30T07:25:00Z'>07:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
because it causes far fewer flushes
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807560' id='553684'>
<a class='timestamp' href='#553684'><time timestamp='2017-06-30T07:26:00Z'>07:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
definitely slow i/o
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807560' id='553685'>
<a class='timestamp' href='#553685'><time timestamp='2017-06-30T07:26:00Z'>07:26</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I need to kill my btrfs..
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807680' id='553686'>
<a class='timestamp' href='#553686'><time timestamp='2017-06-30T07:28:00Z'>07:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but that&#x27;s great, a lot of users, esp windows users, tend to have slow i/o laptops
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807680' id='553687'>
<a class='timestamp' href='#553687'><time timestamp='2017-06-30T07:28:00Z'>07:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so that&#x27;s a decent thing to optimize for
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807740' id='553688'>
<a class='timestamp' href='#553688'><time timestamp='2017-06-30T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: why?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807740' id='553689'>
<a class='timestamp' href='#553689'><time timestamp='2017-06-30T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wumpus: slow I/O. very slow. :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807800' id='553690'>
<a class='timestamp' href='#553690'><time timestamp='2017-06-30T07:30:00Z'>07:30</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
even Chromium gets slow on btrfs home :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807800' id='553691'>
<a class='timestamp' href='#553691'><time timestamp='2017-06-30T07:30:00Z'>07:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
which reminds me I should probably do some window testing again pre-0.15 <b>*sigh*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807860' id='553692'>
<a class='timestamp' href='#553692'><time timestamp='2017-06-30T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: so btrfs is better in everything except performance?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807860' id='553693'>
<a class='timestamp' href='#553693'><time timestamp='2017-06-30T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wumpus: and reliability, I guess. had some kernel panics in btrfs code a few times several months ago
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807860' id='553694'>
<a class='timestamp' href='#553694'><time timestamp='2017-06-30T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
and someone in #btrfs told me to add a mount option to avoid a very rare data corruption bug
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807920' id='553695'>
<a class='timestamp' href='#553695'><time timestamp='2017-06-30T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
oh, and ioctls don&#x27;t work in 32-bit mode, but I use 64-bit now
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807920' id='553696'>
<a class='timestamp' href='#553696'><time timestamp='2017-06-30T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;ve never tried btrfs yet, just sticking with extN on linux, I guess I&#x27;m extremely conservative with regard to file systems
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807980' id='553697'>
<a class='timestamp' href='#553697'><time timestamp='2017-06-30T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i tend to use ext4 as root fs, and zfs for all the rest
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807980' id='553698'>
<a class='timestamp' href='#553698'><time timestamp='2017-06-30T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(where &quot;all the rest&quot; is not much)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498807980' id='553699'>
<a class='timestamp' href='#553699'><time timestamp='2017-06-30T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
hm, it probably doesn&#x27;t help I/O that I have btrfs compression enabled
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808040' id='553700'>
<a class='timestamp' href='#553700'><time timestamp='2017-06-30T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
although you&#x27;d think modern CPUs would be fast enough it didn&#x27;t matter
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808040' id='553701'>
<a class='timestamp' href='#553701'><time timestamp='2017-06-30T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: doesn&#x27;t zfs on linux require custom patches?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808100' id='553702'>
<a class='timestamp' href='#553702'><time timestamp='2017-06-30T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not on ubuntu at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808100' id='553703'>
<a class='timestamp' href='#553703'><time timestamp='2017-06-30T07:35:00Z'>07:35</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
O.o     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808160' id='553704'>
<a class='timestamp' href='#553704'><time timestamp='2017-06-30T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: for encryption that&#x27;s mostly true, for compression (especially when writing) I&#x27;d expect a reasonable perf loss with compression, for reading you might get a perf gain in some cases (but only if you store files that are well-compressible on a slow medium)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808220' id='553705'>
<a class='timestamp' href='#553705'><time timestamp='2017-06-30T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
tempting to hack btrfs to notice when files get modified often and not compress those.. but I don&#x27;t really want to hack on my filesystem, so not happening ☺
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808220' id='553706'>
<a class='timestamp' href='#553706'><time timestamp='2017-06-30T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
also, even if throughput higher, latency might be worse because of the extra decompression step
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808280' id='553707'>
<a class='timestamp' href='#553707'><time timestamp='2017-06-30T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
oh, ZFS is the filesystem that&#x27;s GPL-infringing XD
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808340' id='553708'>
<a class='timestamp' href='#553708'><time timestamp='2017-06-30T07:39:00Z'>07:39</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
prob just go back to ext4
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808460' id='553709'>
<a class='timestamp' href='#553709'><time timestamp='2017-06-30T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
disk compression seems a waste of time in the 201x&#x27;s, most large files (video, images, music) are already compressed so I&#x27;d dare say it helps very little in practice
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808520' id='553710'>
<a class='timestamp' href='#553710'><time timestamp='2017-06-30T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
even if you store raw video/music then generic gzip compression is not very suited
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808580' id='553711'>
<a class='timestamp' href='#553711'><time timestamp='2017-06-30T07:43:00Z'>07:43</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
maybe I should try just turning it off before giving up on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808640' id='553712'>
<a class='timestamp' href='#553712'><time timestamp='2017-06-30T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
thinking, something it might help with is compiler object files, those tend to be well-compressible
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808640' id='553713'>
<a class='timestamp' href='#553713'><time timestamp='2017-06-30T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and large (in case of c++)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808700' id='553714'>
<a class='timestamp' href='#553714'><time timestamp='2017-06-30T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-14'> * luke-jr</span>&gt;
changes it to use LZO compression rather than gzip
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808760' id='553715'>
<a class='timestamp' href='#553715'><time timestamp='2017-06-30T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
(supposedly it&#x27;s faster)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808760' id='553716'>
<a class='timestamp' href='#553716'><time timestamp='2017-06-30T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: i use lzo compression for the blockchain
<br>
</div>

<div class='talk op-msg' data-timestamp='1498808820' id='553717'>
<a class='timestamp' href='#553717'><time timestamp='2017-06-30T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
lzo is much faster
<br>
</div>

<div class='talk op-msg' data-timestamp='1498809120' id='553718'>
<a class='timestamp' href='#553718'><time timestamp='2017-06-30T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: until recently the gap between disk IO speed and the rest of the system was making it so that compression (at least fast compression like LZO) actually increased performance... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1498809240' id='553719'>
<a class='timestamp' href='#553719'><time timestamp='2017-06-30T07:54:00Z'>07:54</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
recently = SSD?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498809300' id='553720'>
<a class='timestamp' href='#553720'><time timestamp='2017-06-30T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
I also made the mistake of moving my home to 5400 RPM.. &gt;_&lt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1498810860' id='553721'>
<a class='timestamp' href='#553721'><time timestamp='2017-06-30T08:21:00Z'>08:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
not just SSD but newer pcie ssds.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498813560' id='553722'>
<a class='timestamp' href='#553722'><time timestamp='2017-06-30T09:06:00Z'>09:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: also for writing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498813620' id='553723'>
<a class='timestamp' href='#553723'><time timestamp='2017-06-30T09:07:00Z'>09:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I guess it depends on the kind of data
<br>
</div>

<div class='talk op-msg' data-timestamp='1498813740' id='553724'>
<a class='timestamp' href='#553724'><time timestamp='2017-06-30T09:09:00Z'>09:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
for reading performance it can be quite obviously true
<br>
</div>

<div class='talk op-msg' data-timestamp='1498813920' id='553725'>
<a class='timestamp' href='#553725'><time timestamp='2017-06-30T09:12:00Z'>09:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: custom patch, or at the file system level?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498821480' id='553726'>
<a class='timestamp' href='#553726'><time timestamp='2017-06-30T11:18:00Z'>11:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] Mirobit opened pull request #10710: REST/RPC example update (master...docupt) <a href="https://github.com/bitcoin/bitcoin/pull/10710" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10710</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830360' id='553727'>
<a class='timestamp' href='#553727'><time timestamp='2017-06-30T13:46:00Z'>13:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: I&#x27;m trying to review #10333 and I was trying to understand the ReturnKey() behavior.  How come it is not a bug (also in master) that we call ReturnKey() even in the case where CoinControl gave us a destination address (so we never reserved a new key)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830360' id='553728'>
<a class='timestamp' href='#553728'><time timestamp='2017-06-30T13:46:00Z'>13:46</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/10333" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/10333</a> | [wallet] fee fixes: always create change, adjust value, and p… by instagibbs · Pull Request #10333 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830480' id='553729'>
<a class='timestamp' href='#553729'><time timestamp='2017-06-30T13:48:00Z'>13:48</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
calling return is a nop if you haven&#x27;t marked a key as reserved IIRC
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830600' id='553730'>
<a class='timestamp' href='#553730'><time timestamp='2017-06-30T13:50:00Z'>13:50</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
oh i see what you mean, lemme continue reading...
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553731'>
<a class='timestamp' href='#553731'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: i just figured it out
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553732'>
<a class='timestamp' href='#553732'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i didn&#x27;t know how reservekey&#x27;s work
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553733'>
<a class='timestamp' href='#553733'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but yeah the reservekey object has nIndex -1 until you ask it to actually get a reserved key
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553734'>
<a class='timestamp' href='#553734'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
yep     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553735'>
<a class='timestamp' href='#553735'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so calling return on it is a no-op
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830660' id='553736'>
<a class='timestamp' href='#553736'><time timestamp='2017-06-30T13:51:00Z'>13:51</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
so yeah i think the logic is right
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830720' id='553737'>
<a class='timestamp' href='#553737'><time timestamp='2017-06-30T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
while i have you, aren&#x27;t you missing a continue at the bottom of your loop in the subtractFeeFromAmount &gt; 0 case
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830720' id='553738'>
<a class='timestamp' href='#553738'><time timestamp='2017-06-30T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
it&#x27;s safe to call returnkey unless you actively are saving a usage
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830720' id='553739'>
<a class='timestamp' href='#553739'><time timestamp='2017-06-30T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
checking
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830720' id='553740'>
<a class='timestamp' href='#553740'><time timestamp='2017-06-30T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: yes agreed on the returnkey
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830720' id='553741'>
<a class='timestamp' href='#553741'><time timestamp='2017-06-30T13:52:00Z'>13:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
after line 2378
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830840' id='553742'>
<a class='timestamp' href='#553742'><time timestamp='2017-06-30T13:54:00Z'>13:54</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
wallet.cpp? That&#x27;s in SelectCoins on my end
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830900' id='553743'>
<a class='timestamp' href='#553743'><time timestamp='2017-06-30T13:55:00Z'>13:55</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jnewbery opened pull request #10711: [tests] Introduce TestNode (master...testnode2) <a href="https://github.com/bitcoin/bitcoin/pull/10711" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10711</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830900' id='553744'>
<a class='timestamp' href='#553744'><time timestamp='2017-06-30T13:55:00Z'>13:55</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
it&#x27;s just going to loop, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498830960' id='553745'>
<a class='timestamp' href='#553745'><time timestamp='2017-06-30T13:56:00Z'>13:56</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
if subtractFeeFromAmount != 0 and you don&#x27;t have enough fee, it just hits the end and loops
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831080' id='553746'>
<a class='timestamp' href='#553746'><time timestamp='2017-06-30T13:58:00Z'>13:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but it&#x27;ll sign first?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831140' id='553747'>
<a class='timestamp' href='#553747'><time timestamp='2017-06-30T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also you seem to have a regression in the subtractFeeFromAmount &gt; 0 case where you have isDust change.  Previously that change was getting deleted and added to fees, now I think you&#x27;re not doing that
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831140' id='553748'>
<a class='timestamp' href='#553748'><time timestamp='2017-06-30T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
ah yeah i wrote this previous to that behavior, will fix
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831140' id='553749'>
<a class='timestamp' href='#553749'><time timestamp='2017-06-30T13:59:00Z'>13:59</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
not sure what you mean about signing first, I&#x27;m probably looking at the wrong line
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831200' id='553750'>
<a class='timestamp' href='#553750'><time timestamp='2017-06-30T14:00:00Z'>14:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh maybe i am, i was looking without whitespace, hold on
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831380' id='553751'>
<a class='timestamp' href='#553751'><time timestamp='2017-06-30T14:03:00Z'>14:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah my fault on that, seems fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831560' id='553752'>
<a class='timestamp' href='#553752'><time timestamp='2017-06-30T14:06:00Z'>14:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
We ought to be able to avoid looping completely when subtractFeeFromAmount &gt; 0 though...
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831620' id='553753'>
<a class='timestamp' href='#553753'><time timestamp='2017-06-30T14:07:00Z'>14:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
If we changed the logic when subtractFeeFromAmount &gt; 0 to first check for dust change, and if that exists move it to fee, then reduce the recipient amounts as necessary to get to the fee.  (unless the recipient amounts aren&#x27;t big enough, which is a failure anyway)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831680' id='553754'>
<a class='timestamp' href='#553754'><time timestamp='2017-06-30T14:08:00Z'>14:08</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
I mean it can still be considered at the end in the &quot;Fee adjustment&quot; stage right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831740' id='553755'>
<a class='timestamp' href='#553755'><time timestamp='2017-06-30T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I think it would be better to eliminate dust change to fee first, b/c then you can just subtract less from the recipients (only in the case where subtractFeeFroAmount &gt; 0)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831740' id='553756'>
<a class='timestamp' href='#553756'><time timestamp='2017-06-30T14:09:00Z'>14:09</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
mm right
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831860' id='553757'>
<a class='timestamp' href='#553757'><time timestamp='2017-06-30T14:11:00Z'>14:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
If you have a minute, indulge me for a second while we walk through exactly what scenario 10333 is trying to solve
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831920' id='553758'>
<a class='timestamp' href='#553758'><time timestamp='2017-06-30T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
so it&#x27;s the same situation as the previous fix you made, where it grabs a lot of inputs, fails, then next time overpays in fees. Your fix adds fees to existing change output
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831920' id='553759'>
<a class='timestamp' href='#553759'><time timestamp='2017-06-30T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
This is to make it also cover the &quot;no change output&quot; case
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831920' id='553760'>
<a class='timestamp' href='#553760'><time timestamp='2017-06-30T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
meaning we calculate what the change would look like every time, adjust as necessary
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831980' id='553761'>
<a class='timestamp' href='#553761'><time timestamp='2017-06-30T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
In the no change output case though, doesn&#x27;t that by definition mean we&#x27;ve tried via the knapsack algorithm to get inputs that add up as closely as possible to the desired target
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831980' id='553762'>
<a class='timestamp' href='#553762'><time timestamp='2017-06-30T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
for that crazy fee level, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1498831980' id='553763'>
<a class='timestamp' href='#553763'><time timestamp='2017-06-30T14:13:00Z'>14:13</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
nFeeRet in pathological case can be many times higher than required
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832040' id='553764'>
<a class='timestamp' href='#553764'><time timestamp='2017-06-30T14:14:00Z'>14:14</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
change is only calculated via valuein-valuetoselect, nFeeRet is part of the latter term
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832160' id='553765'>
<a class='timestamp' href='#553765'><time timestamp='2017-06-30T14:16:00Z'>14:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Yeah maybe it&#x27;s not made worse by your PR, but it seems like the algorithm that tries to find an exact match is always going to try to find an exact match assuming a change ouput, and then therefore will always overpay fees by the feerate*1 extra output in the case where we do find a match which doesn&#x27;t require change
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832220' id='553766'>
<a class='timestamp' href='#553766'><time timestamp='2017-06-30T14:17:00Z'>14:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
 but if that amount is &gt; dust, which i think it always is, then we&#x27;ll always revert to the second step of trying to find MIN_CHANGE?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832220' id='553767'>
<a class='timestamp' href='#553767'><time timestamp='2017-06-30T14:17:00Z'>14:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i don&#x27;t know, i guess it just seems like in some ways its changing the coin selection algorithm
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832280' id='553768'>
<a class='timestamp' href='#553768'><time timestamp='2017-06-30T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
maybe not for the worse, but its a weird way to change it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832280' id='553769'>
<a class='timestamp' href='#553769'><time timestamp='2017-06-30T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
the real fix is to do effective value selection
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832280' id='553770'>
<a class='timestamp' href='#553770'><time timestamp='2017-06-30T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Yes, that combined with not trying to find an EXACT match, but trying to find a match within some tolerance that you are willing to lose to extra fees
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832280' id='553771'>
<a class='timestamp' href='#553771'><time timestamp='2017-06-30T14:18:00Z'>14:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
EXACT match finding is stupid
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832340' id='553772'>
<a class='timestamp' href='#553772'><time timestamp='2017-06-30T14:19:00Z'>14:19</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
morcos: BranchAndBound assumes no change output.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832340' id='553773'>
<a class='timestamp' href='#553773'><time timestamp='2017-06-30T14:19:00Z'>14:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that tolerance already kidn of happens via the remove dust output to fees , but we could make it explicit and do better
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832400' id='553774'>
<a class='timestamp' href='#553774'><time timestamp='2017-06-30T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
Yeah imo the weakness of 10333 is that it&#x27;s only needed to avoid stupidity, and will likely poorly interact with real fixes
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832400' id='553775'>
<a class='timestamp' href='#553775'><time timestamp='2017-06-30T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
right now we&#x27;re just so bad at estimating, we almost never exact match
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832400' id='553776'>
<a class='timestamp' href='#553776'><time timestamp='2017-06-30T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Murch: yeah i need to review that, but I think it shoudl be aware of the amount its wiling to discard in excess fees, and return success if it finds a result under that tolerance, and if not, assume a change output and aim for TARGET_CHANGE (probably just MIN_CHANGE)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832400' id='553777'>
<a class='timestamp' href='#553777'><time timestamp='2017-06-30T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
instagibbs: If it is only a minuscule amount missing for the fees, wouldn&#x27;t it perhaps be acceptable to take that from the change output?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832400' id='553778'>
<a class='timestamp' href='#553778'><time timestamp='2017-06-30T14:20:00Z'>14:20</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
Murch, it already does
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832460' id='553779'>
<a class='timestamp' href='#553779'><time timestamp='2017-06-30T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
it&#x27;s the case of it not having a fee output to make larger in which is currently just SFYL
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832460' id='553780'>
<a class='timestamp' href='#553780'><time timestamp='2017-06-30T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: what would you think about another approach, that perhaps changed the logic less 
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832460' id='553781'>
<a class='timestamp' href='#553781'><time timestamp='2017-06-30T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
morcos: It allows for excess up to the cost of creating a change output. In my original proposal also the cost of creating an input (spending the output later), but with the high fee rate volatility, maybe only the change is a better measure.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832460' id='553782'>
<a class='timestamp' href='#553782'><time timestamp='2017-06-30T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m wary of unintended consequences...
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832460' id='553783'>
<a class='timestamp' href='#553783'><time timestamp='2017-06-30T14:21:00Z'>14:21</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
morcos, very open to it, if you have the idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832520' id='553784'>
<a class='timestamp' href='#553784'><time timestamp='2017-06-30T14:22:00Z'>14:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but suppose in the no-change case if we overpay the fee by too much, we just be willing to loop again (to some limit so its not unbounded)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832520' id='553785'>
<a class='timestamp' href='#553785'><time timestamp='2017-06-30T14:22:00Z'>14:22</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
morcos: BranchAndBound is only for the &quot;no-change&quot; case. If you&#x27;re going to create a change output anyway, I don&#x27;t understand why you&#x27;re going to work so hard to minimize it to an arbitrary number. ;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553786'>
<a class='timestamp' href='#553786'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Murch: ok, good that makes sense.  Yes.  Agreed with that too!
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553787'>
<a class='timestamp' href='#553787'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
morcos, maybe keep the caching logic, and just loop?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553788'>
<a class='timestamp' href='#553788'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
with some anti-exhaustion param?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553789'>
<a class='timestamp' href='#553789'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
I mean, you don&#x27;t want to have all of your money in transit, but besides that, why is 0.01 BTC a great size for output?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553790'>
<a class='timestamp' href='#553790'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
actually the caching logic isn&#x27;t somehting i love
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553791'>
<a class='timestamp' href='#553791'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it just seems to had logistical complexity
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832580' id='553792'>
<a class='timestamp' href='#553792'><time timestamp='2017-06-30T14:23:00Z'>14:23</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
s/had/add/
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832640' id='553793'>
<a class='timestamp' href='#553793'><time timestamp='2017-06-30T14:24:00Z'>14:24</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
so any looping change will have to guarantee efficient convergence to a valid tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832760' id='553794'>
<a class='timestamp' href='#553794'><time timestamp='2017-06-30T14:26:00Z'>14:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: well in the dumbest implementation... just have a bool, triedAgain, and if nFeeRet &lt; nFeeNeeded OR  (nFeeRet &gt; nFeeNeeded + too_much_extra  AND !tried_again) then you loop again
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832760' id='553795'>
<a class='timestamp' href='#553795'><time timestamp='2017-06-30T14:26:00Z'>14:26</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
morcos: BranchAndBound does an exhaustive search, so looping again will yield no other results. We should just do a stricter limit if we feel that we&#x27;re overpaying.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832760' id='553796'>
<a class='timestamp' href='#553796'><time timestamp='2017-06-30T14:26:00Z'>14:26</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Murch: we&#x27;re talking about for 0.15 before BAB
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832820' id='553797'>
<a class='timestamp' href='#553797'><time timestamp='2017-06-30T14:27:00Z'>14:27</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
ah, I&#x27;m sorry.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832820' id='553798'>
<a class='timestamp' href='#553798'><time timestamp='2017-06-30T14:27:00Z'>14:27</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
morcos, heh, that&#x27;s basically what I tried earlier
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832820' id='553799'>
<a class='timestamp' href='#553799'><time timestamp='2017-06-30T14:27:00Z'>14:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: do we have a sense for how rare these overpayments are?  my gut is they are extremely rare, and just being willing to discard it one time will make them all but disappear
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832820' id='553800'>
<a class='timestamp' href='#553800'><time timestamp='2017-06-30T14:27:00Z'>14:27</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
well, with more complex logic on top
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832820' id='553801'>
<a class='timestamp' href='#553801'><time timestamp='2017-06-30T14:27:00Z'>14:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: and what happened?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832880' id='553802'>
<a class='timestamp' href='#553802'><time timestamp='2017-06-30T14:28:00Z'>14:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sorry btw, for engaging on this so late, was too caught up in the fee estimate stuff  (so many edge cases to get right there too, but probably this should have been more important)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498832880' id='553803'>
<a class='timestamp' href='#553803'><time timestamp='2017-06-30T14:28:00Z'>14:28</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
appreciate the feedback
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833000' id='553804'>
<a class='timestamp' href='#553804'><time timestamp='2017-06-30T14:30:00Z'>14:30</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
so to happen twice you&#x27;d basically have to oscillate twice, and get exact matches twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833000' id='553805'>
<a class='timestamp' href='#553805'><time timestamp='2017-06-30T14:30:00Z'>14:30</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
Here&#x27;s an idea: How about we just raise the target for the knapsack a little, and use that adjustment to buffer missing fees but remain over MIN_CHANGE?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833060' id='553806'>
<a class='timestamp' href='#553806'><time timestamp='2017-06-30T14:31:00Z'>14:31</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
Murch: we allow reducing MIN_CHANGE to MIN_CHANGE/2 to achieve that affect, its only the case where we found an exact match but used fewer inputs that we have a problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833120' id='553807'>
<a class='timestamp' href='#553807'><time timestamp='2017-06-30T14:32:00Z'>14:32</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
ah okay
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833120' id='553808'>
<a class='timestamp' href='#553808'><time timestamp='2017-06-30T14:32:00Z'>14:32</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
sorry, I&#x27;m late to the conversation, maybe I&#x27;m not helping :-I
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833240' id='553809'>
<a class='timestamp' href='#553809'><time timestamp='2017-06-30T14:34:00Z'>14:34</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: ok here is an even more obviously correct idea i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833240' id='553810'>
<a class='timestamp' href='#553810'><time timestamp='2017-06-30T14:34:00Z'>14:34</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
yeah I&#x27;m not quite convincing myself on previous idea
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833240' id='553811'>
<a class='timestamp' href='#553811'><time timestamp='2017-06-30T14:34:00Z'>14:34</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
I&#x27;d like to say &quot;no worse&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833300' id='553812'>
<a class='timestamp' href='#553812'><time timestamp='2017-06-30T14:35:00Z'>14:35</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what if we put an additional loop around the section that starts at: const CAmount nChange = nValueIn - nValueToSelect;
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833360' id='553813'>
<a class='timestamp' href='#553813'><time timestamp='2017-06-30T14:36:00Z'>14:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
where we only repeat that section if nFeeRet - nFeeNeeded is too high..  and if it was, then we change nValueToSelect to reflect the new fee, but we don&#x27;t redo the coinselction
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833360' id='553814'>
<a class='timestamp' href='#553814'><time timestamp='2017-06-30T14:36:00Z'>14:36</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
This will result in just calculating that now we do have positive change, and creating the change output for us as expected
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833420' id='553815'>
<a class='timestamp' href='#553815'><time timestamp='2017-06-30T14:37:00Z'>14:37</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I like avoiding the unintended consequences in either of the other two approaches of redoing coin selection if some criteria happens
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833480' id='553816'>
<a class='timestamp' href='#553816'><time timestamp='2017-06-30T14:38:00Z'>14:38</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
as long as that redefinition doesn&#x27;t do anything weird, sounds reasonable
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833480' id='553817'>
<a class='timestamp' href='#553817'><time timestamp='2017-06-30T14:38:00Z'>14:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
In this case we&#x27;re only running coin selection exactly as many times as we currently do, we&#x27;re just adding a change output if we didn&#x27;t have one and the fee is way too high
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833480' id='553818'>
<a class='timestamp' href='#553818'><time timestamp='2017-06-30T14:38:00Z'>14:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
you don&#x27;t have to reuse the same variable
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833480' id='553819'>
<a class='timestamp' href='#553819'><time timestamp='2017-06-30T14:38:00Z'>14:38</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
structure that little loop to make sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833540' id='553820'>
<a class='timestamp' href='#553820'><time timestamp='2017-06-30T14:39:00Z'>14:39</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also i&#x27;m happy to write up that idea if you want to take a look
<br>
</div>

<div class='talk op-msg' data-timestamp='1498833780' id='553821'>
<a class='timestamp' href='#553821'><time timestamp='2017-06-30T14:43:00Z'>14:43</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
let me take a look and give it a shot
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834140' id='553822'>
<a class='timestamp' href='#553822'><time timestamp='2017-06-30T14:49:00Z'>14:49</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok, i already started, i&#x27;ll shoot you a link in a few mins, but i&#x27;m happy to let you do in your PR, i just wanted to see if it would work out easily.  it might still have issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834320' id='553823'>
<a class='timestamp' href='#553823'><time timestamp='2017-06-30T14:52:00Z'>14:52</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
actually go ahead and work on it, I&#x27;ve got to wrap up work stuff before 4 day weekend
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834320' id='553824'>
<a class='timestamp' href='#553824'><time timestamp='2017-06-30T14:52:00Z'>14:52</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
thanks
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834620' id='553825'>
<a class='timestamp' href='#553825'><time timestamp='2017-06-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
heh, damn... there are few details that need to be worked out that i was hoping you&#x27;d do.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834620' id='553826'>
<a class='timestamp' href='#553826'><time timestamp='2017-06-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
instagibbs: anywhere here is what i started. <a href="https://github.com/morcos/bitcoin/commit/d180deabc9a6cfd94814546c48931dfb06eacc3b?w=1" class="link" target="_blank">https://github.com/morcos/bitcoin/commit/d180deabc9a6cfd94814546c48931dfb06eacc3b?w=1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834680' id='553827'>
<a class='timestamp' href='#553827'><time timestamp='2017-06-30T14:58:00Z'>14:58</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
hah, just dont tell gmaxwell I&#x27;m working on it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834680' id='553828'>
<a class='timestamp' href='#553828'><time timestamp='2017-06-30T14:58:00Z'>14:58</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
looking
<br>
</div>

<div class='talk op-msg' data-timestamp='1498834740' id='553829'>
<a class='timestamp' href='#553829'><time timestamp='2017-06-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
if thats right , i think we just need to smartly determine the threshold, and we need to convince ourselves or add logic so it can&#x27;t get stuck in some infinite loop, i don&#x27;t knwo if the pick_new_inputs bool needs to be reset or its too confusing to just be confident it&#x27;ll complete next time or what
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835460' id='553830'>
<a class='timestamp' href='#553830'><time timestamp='2017-06-30T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
smells right, leaning towards &quot;no need to reset&quot; but will need to think more
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835520' id='553831'>
<a class='timestamp' href='#553831'><time timestamp='2017-06-30T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i don&#x27;t think reseting could hurt...  just in an else to if (pick_new_inputs) you reset it to true...   but not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835520' id='553832'>
<a class='timestamp' href='#553832'><time timestamp='2017-06-30T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also not sure what to do about the threshold, but i think that problem is no different than 10333, it&#x27;s just more explicit
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835580' id='553833'>
<a class='timestamp' href='#553833'><time timestamp='2017-06-30T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
sure, I think reset would be more &quot;default&quot; behavior, easier to review
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553834'>
<a class='timestamp' href='#553834'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
I think something simplish like GetMinimumFee(Approx size of change output) + Min_Change_size (Dust Threshold of change output) is about right 
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553835'>
<a class='timestamp' href='#553835'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
re:threshhold, I think you should also be adding the current nChange in the calc
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553836'>
<a class='timestamp' href='#553836'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it&#x27;s maybe a bit hacky, but could be cleaned up once we have effective value machinery in the future
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553837'>
<a class='timestamp' href='#553837'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
huh? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553838'>
<a class='timestamp' href='#553838'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
there is no current nChange
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835640' id='553839'>
<a class='timestamp' href='#553839'><time timestamp='2017-06-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
that section is only it if changeouput position == -1
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835700' id='553840'>
<a class='timestamp' href='#553840'><time timestamp='2017-06-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
only hit
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835700' id='553841'>
<a class='timestamp' href='#553841'><time timestamp='2017-06-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
anyway, afk for a few
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835700' id='553842'>
<a class='timestamp' href='#553842'><time timestamp='2017-06-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
right, but that is going to fees, and you may not need to after
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835700' id='553843'>
<a class='timestamp' href='#553843'><time timestamp='2017-06-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
later
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835700' id='553844'>
<a class='timestamp' href='#553844'><time timestamp='2017-06-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wait what
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835760' id='553845'>
<a class='timestamp' href='#553845'><time timestamp='2017-06-30T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
ill annotate on github...
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835760' id='553846'>
<a class='timestamp' href='#553846'><time timestamp='2017-06-30T15:16:00Z'>15:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498835820' id='553847'>
<a class='timestamp' href='#553847'><time timestamp='2017-06-30T15:17:00Z'>15:17</time></a>
&lt;<span class='nick nick-11'> instagibbs</span>&gt;
nevermind, was wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1498837380' id='553848'>
<a class='timestamp' href='#553848'><time timestamp='2017-06-30T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: zfs
<br>
</div>

<div class='talk op-msg' data-timestamp='1498843800' id='553849'>
<a class='timestamp' href='#553849'><time timestamp='2017-06-30T17:30:00Z'>17:30</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] morcos opened pull request #10712: Add change output if necessary to reduce excess fee (master...addchangehwenoverpaying) <a href="https://github.com/bitcoin/bitcoin/pull/10712" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10712</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847040' id='553850'>
<a class='timestamp' href='#553850'><time timestamp='2017-06-30T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jnewbery closed pull request #10015: Wallet should reject long chains by default (master...walletrejectlongchains) <a href="https://github.com/bitcoin/bitcoin/pull/10015" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/10015</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847220' id='553851'>
<a class='timestamp' href='#553851'><time timestamp='2017-06-30T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wumpus: is your current key on bitcoin.org? <a href="https://bitcoin.org/laanwj-releases.asc" class="link" target="_blank">https://bitcoin.org/laanwj-releases.asc</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847220' id='553852'>
<a class='timestamp' href='#553852'><time timestamp='2017-06-30T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jnewbery closed pull request #9943: Make script.py wildcard importable. (master...rpctestsprimitives) <a href="https://github.com/bitcoin/bitcoin/pull/9943" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9943</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847460' id='553853'>
<a class='timestamp' href='#553853'><time timestamp='2017-06-30T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
luke-jr: that&#x27;s the release signing key, not my personal key, that&#x27;s laanwj.asc
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847460' id='553854'>
<a class='timestamp' href='#553854'><time timestamp='2017-06-30T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but both should be up to date
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847520' id='553855'>
<a class='timestamp' href='#553855'><time timestamp='2017-06-30T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
wumpus: hmm, someone&#x27;s saying it doesn&#x27;t match the UASF sigs
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847520' id='553856'>
<a class='timestamp' href='#553856'><time timestamp='2017-06-30T18:32:00Z'>18:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
the release key certainly won&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847580' id='553857'>
<a class='timestamp' href='#553857'><time timestamp='2017-06-30T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I only use that for sha256sums.asc, which wasn&#x27;t provided for uasf sigs
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847580' id='553858'>
<a class='timestamp' href='#553858'><time timestamp='2017-06-30T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
ah     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847580' id='553859'>
<a class='timestamp' href='#553859'><time timestamp='2017-06-30T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
so he should use the laanwj.asc?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847580' id='553860'>
<a class='timestamp' href='#553860'><time timestamp='2017-06-30T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498847640' id='553861'>
<a class='timestamp' href='#553861'><time timestamp='2017-06-30T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
0x1E4AED62986CD25D is the only subkey I use for signing
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849620' id='553862'>
<a class='timestamp' href='#553862'><time timestamp='2017-06-30T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
strange, I can&#x27;t get one node to sync from another with master, which works with 0.14
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849680' id='553863'>
<a class='timestamp' href='#553863'><time timestamp='2017-06-30T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(the node I&#x27;m syncing from is not up-to-date, but does that matter? it&#x27;s sending the &#x27;headers&#x27;, just seems to get ignored)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849860' id='553864'>
<a class='timestamp' href='#553864'><time timestamp='2017-06-30T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i believe nodes don&#x27;t respond to headers question until they&#x27;re in sync
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849860' id='553865'>
<a class='timestamp' href='#553865'><time timestamp='2017-06-30T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
just trying to do a benchmark, why does this have to be so difficut every time :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849920' id='553866'>
<a class='timestamp' href='#553866'><time timestamp='2017-06-30T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, I already patched the client node for this, it responds to all getheaders
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849920' id='553867'>
<a class='timestamp' href='#553867'><time timestamp='2017-06-30T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I&#x27;m sure the headers is being sent, the 0.14 branch node synced fine from it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849980' id='553868'>
<a class='timestamp' href='#553868'><time timestamp='2017-06-30T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so what is the setup exactly?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498849980' id='553869'>
<a class='timestamp' href='#553869'><time timestamp='2017-06-30T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you have a not-fully synced node A, and a new node B, connected to A?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850040' id='553870'>
<a class='timestamp' href='#553870'><time timestamp='2017-06-30T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/9923" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/9923</a> is the problem you&#x27;re talking about, but I know about that one :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850040' id='553871'>
<a class='timestamp' href='#553871'><time timestamp='2017-06-30T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850100' id='553872'>
<a class='timestamp' href='#553872'><time timestamp='2017-06-30T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
A only listens, has a part of the block chain, B only connects, and should sync from A so that they end up with the same blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850100' id='553873'>
<a class='timestamp' href='#553873'><time timestamp='2017-06-30T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(and most important, same utxo database)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850460' id='553874'>
<a class='timestamp' href='#553874'><time timestamp='2017-06-30T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
A has blocks up to 430241
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850520' id='553875'>
<a class='timestamp' href='#553875'><time timestamp='2017-06-30T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
A sends getheaders, B responds with headers?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553876'>
<a class='timestamp' href='#553876'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
eh, other way around
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553877'>
<a class='timestamp' href='#553877'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
if you&#x27;re too far back you&#x27;ll stay stuck in IBD. In particular you have to at least meet the minimum chain work to get out of IBD.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553878'>
<a class='timestamp' href='#553878'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
2017-06-30 19:22:11 received: getheaders (997 bytes) peer=5
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553879'>
<a class='timestamp' href='#553879'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
2017-06-30 19:22:11 getheaders 430241 to end from peer=5
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553880'>
<a class='timestamp' href='#553880'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and I believe 430241 will not.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553881'>
<a class='timestamp' href='#553881'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
2017-06-30 19:22:11 sending headers (82 bytes) peer=5
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553882'>
<a class='timestamp' href='#553882'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(that&#x27;s on A)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553883'>
<a class='timestamp' href='#553883'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
B gets a headers message with one entry: 2017-06-30 19:22:11 ProcessNewBlockHeaders: 000000000000000003f1410b194facc9092a2b76e99db8653ec1a32edfd2ab29
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553884'>
<a class='timestamp' href='#553884'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s a remarkably small headers packet
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850580' id='553885'>
<a class='timestamp' href='#553885'><time timestamp='2017-06-30T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
if you make IsInitialBlockDownload return true, you&#x27;ll be good to go; my bet.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553886'>
<a class='timestamp' href='#553886'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
(that&#x27;s the blockhash for block 430241 )
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553887'>
<a class='timestamp' href='#553887'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
er return false.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553888'>
<a class='timestamp' href='#553888'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
on A or B?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553889'>
<a class='timestamp' href='#553889'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so it looks like B already has all the headers?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553890'>
<a class='timestamp' href='#553890'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(up to 430241)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850640' id='553891'>
<a class='timestamp' href='#553891'><time timestamp='2017-06-30T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
on the thing with 430241 blocks (I believe that is A?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850700' id='553892'>
<a class='timestamp' href='#553892'><time timestamp='2017-06-30T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: seems so! I can delete B&#x27;s state and retry if that helps
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850700' id='553893'>
<a class='timestamp' href='#553893'><time timestamp='2017-06-30T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: what does getblockchaininfo on B say?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850700' id='553894'>
<a class='timestamp' href='#553894'><time timestamp='2017-06-30T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(though if B has the headers this sounds like it might be something else!)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850700' id='553895'>
<a class='timestamp' href='#553895'><time timestamp='2017-06-30T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or even getchaintips
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850700' id='553896'>
<a class='timestamp' href='#553896'><time timestamp='2017-06-30T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
  &quot;headers&quot;: 430241,
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850760' id='553897'>
<a class='timestamp' href='#553897'><time timestamp='2017-06-30T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so it has all the headers, but only blocks up to the genesis block
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850820' id='553898'>
<a class='timestamp' href='#553898'><time timestamp='2017-06-30T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
so the problem is in B which is not requesting any blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850820' id='553899'>
<a class='timestamp' href='#553899'><time timestamp='2017-06-30T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so while B is in IBD, there are some restrinction on where it downloads from
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850880' id='553900'>
<a class='timestamp' href='#553900'><time timestamp='2017-06-30T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: yes I already patched out the code on A that would make it refuse to send headers when in IBD, I struggled with that one too many times to forget
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850880' id='553901'>
<a class='timestamp' href='#553901'><time timestamp='2017-06-30T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or it did but A didn&#x27;t reply? (I assume you have debug=net and so you can tell?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850880' id='553902'>
<a class='timestamp' href='#553902'><time timestamp='2017-06-30T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
B only has one connection?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850880' id='553903'>
<a class='timestamp' href='#553903'><time timestamp='2017-06-30T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: getpeerinfo on B does not list any blocks in flight?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850880' id='553904'>
<a class='timestamp' href='#553904'><time timestamp='2017-06-30T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
sipa: yes, B can get only one connection, and nothing inflight
<br>
</div>

<div class='talk op-msg' data-timestamp='1498850940' id='553905'>
<a class='timestamp' href='#553905'><time timestamp='2017-06-30T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: no getblocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851000' id='553906'>
<a class='timestamp' href='#553906'><time timestamp='2017-06-30T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
does getchaintips say anything about invalid chains?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851000' id='553907'>
<a class='timestamp' href='#553907'><time timestamp='2017-06-30T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sweet, sounds like a bug.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851120' id='553908'>
<a class='timestamp' href='#553908'><time timestamp='2017-06-30T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
getchaintips for A and B (guess B is the relevant one) <a href="https://0bin.net/paste/6Kqmm+1VMAhkOTJy#T9erOX4pcLnHu0uW" class="link" target="_blank">https://0bin.net/paste/6Kqmm+1VMAhkOTJy#T9erOX4pcLnHu0uW</a>++cugcWEkwDSFdKPlrefkP1nL86
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851120' id='553909'>
<a class='timestamp' href='#553909'><time timestamp='2017-06-30T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to debug (if the behaviour remains after a restart of B, perhaps add LogPrintf&#x27;s to all the return statements in FindNextBlocksToDownload on B
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851120' id='553910'>
<a class='timestamp' href='#553910'><time timestamp='2017-06-30T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there are many cases in which it decides not to return anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851120' id='553911'>
<a class='timestamp' href='#553911'><time timestamp='2017-06-30T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;d be helpful to know if a) it is being invoked and b) if yes, why it does not return anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851180' id='553912'>
<a class='timestamp' href='#553912'><time timestamp='2017-06-30T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
getchaintips looks totally normal
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851180' id='553913'>
<a class='timestamp' href='#553913'><time timestamp='2017-06-30T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or just attach gdb breakpoint at FindNextBlocksToDownload  and restart node A and step through it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851180' id='553914'>
<a class='timestamp' href='#553914'><time timestamp='2017-06-30T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
trying with a C (fresh B) first, to see if it getting stuck after the headers is reproducible
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851240' id='553915'>
<a class='timestamp' href='#553915'><time timestamp='2017-06-30T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yep, same problem second time
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851240' id='553916'>
<a class='timestamp' href='#553916'><time timestamp='2017-06-30T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
received all the headers but making no block requests
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851360' id='553917'>
<a class='timestamp' href='#553917'><time timestamp='2017-06-30T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
wumpus: i&#x27;ll give you a patch to debug
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851420' id='553918'>
<a class='timestamp' href='#553918'><time timestamp='2017-06-30T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, i think i found it
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851420' id='553919'>
<a class='timestamp' href='#553919'><time timestamp='2017-06-30T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if (state-&gt;pindexBestKnownBlock-&gt;nChainWork &lt; UintToArith256(consensusParams.nMinimumChainWork)) { // This peer has nothing interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851480' id='553920'>
<a class='timestamp' href='#553920'><time timestamp='2017-06-30T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
ah!     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851480' id='553921'>
<a class='timestamp' href='#553921'><time timestamp='2017-06-30T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
&quot;This peer has nothing interesting.&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851480' id='553922'>
<a class='timestamp' href='#553922'><time timestamp='2017-06-30T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yes, just narrowed it down to there
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851480' id='553923'>
<a class='timestamp' href='#553923'><time timestamp='2017-06-30T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
0.14.2 thinks the peer does have something interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851480' id='553924'>
<a class='timestamp' href='#553924'><time timestamp='2017-06-30T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea, thats it. e2652002b6011f793185d473f87f1730c625593b added that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553925'>
<a class='timestamp' href='#553925'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
--     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553926'>
<a class='timestamp' href='#553926'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
    Delay parallel block download until chain has sufficient work
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553927'>
<a class='timestamp' href='#553927'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
    
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553928'>
<a class='timestamp' href='#553928'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
    nMinimumChainWork is an anti-DoS threshold; wait until we have a proposed
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553929'>
<a class='timestamp' href='#553929'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
    tip with more work than that before downloading blocks towards that tip.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553930'>
<a class='timestamp' href='#553930'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
--     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553931'>
<a class='timestamp' href='#553931'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
just going to delete that code for now, see if it works then
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851540' id='553932'>
<a class='timestamp' href='#553932'><time timestamp='2017-06-30T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
basically it impedes a dos attack where I make a long fork of low difficulty blocks with an asic miner and run you out of diskspace fetching those blocks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851600' id='553933'>
<a class='timestamp' href='#553933'><time timestamp='2017-06-30T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
can we please have a mode for benchmarking that disables all these annoying checks :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851720' id='553934'>
<a class='timestamp' href='#553934'><time timestamp='2017-06-30T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wumpus: IIRC sdaftuar wanted a hidden commandline option to let you set the nMinimumChainWork to another value.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553935'>
<a class='timestamp' href='#553935'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
now there&#x27;s this one, as well as #9923, every time it becomes more difficult to sync nodes to each other in synthethic circumstances
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553936'>
<a class='timestamp' href='#553936'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/9923" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/9923</a> | Whitelisting outgoing connections · Issue #9923 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553937'>
<a class='timestamp' href='#553937'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
ok     
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553938'>
<a class='timestamp' href='#553938'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
#10357
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553939'>
<a class='timestamp' href='#553939'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/10357" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/10357</a> | Allow setting nMinimumChainWork on command line by sdaftuar · Pull Request #10357 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851780' id='553940'>
<a class='timestamp' href='#553940'><time timestamp='2017-06-30T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hurray I remembered who was doing what for once.
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851840' id='553941'>
<a class='timestamp' href='#553941'><time timestamp='2017-06-30T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
lol apparently that was a bad idea, now it segfaults
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851840' id='553942'>
<a class='timestamp' href='#553942'><time timestamp='2017-06-30T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
you can&#x27;t remove the null check. :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851840' id='553943'>
<a class='timestamp' href='#553943'><time timestamp='2017-06-30T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
git revert e2652002b6011f793185d473f87f1730c625593b
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851900' id='553944'>
<a class='timestamp' href='#553944'><time timestamp='2017-06-30T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
478             state-&gt;pindexLastCommonBlock = chainActive[std::min(state-&gt;pindexBestKnownBlock-&gt;nHeight, chainActive.Height())];
<br>
</div>

<div class='talk op-msg' data-timestamp='1498851960' id='553945'>
<a class='timestamp' href='#553945'><time timestamp='2017-06-30T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1498852020' id='553946'>
<a class='timestamp' href='#553946'><time timestamp='2017-06-30T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that did it, it&#x27;s syncing
<br>
</div>

<div class='talk op-msg' data-timestamp='1498852080' id='553947'>
<a class='timestamp' href='#553947'><time timestamp='2017-06-30T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
thanks!
<br>
</div>

</div>
</section>

</body>
</html>
