<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2015-10-21
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2015-10-21' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:28 UTC</pre>
<pre><a href="/bitcoin-core-dev/2015-09-21">&lt;</a><span class='header'>   October 2015   </span><a href="/bitcoin-core-dev/2015-11-21">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;             <a class="" href="/bitcoin-core-dev/2015-10-01">1</a>  <a class="" href="/bitcoin-core-dev/2015-10-02">2</a>  <a class="" href="/bitcoin-core-dev/2015-10-03">3</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2015-10-04">4</a>  <a class="" href="/bitcoin-core-dev/2015-10-05">5</a>  <a class="" href="/bitcoin-core-dev/2015-10-06">6</a>  <a class="" href="/bitcoin-core-dev/2015-10-07">7</a>  <a class="" href="/bitcoin-core-dev/2015-10-08">8</a>  <a class="" href="/bitcoin-core-dev/2015-10-09">9</a> <a class="" href="/bitcoin-core-dev/2015-10-10">10</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-11">11</a> <a class="" href="/bitcoin-core-dev/2015-10-12">12</a> <a class="" href="/bitcoin-core-dev/2015-10-13">13</a> <a class="" href="/bitcoin-core-dev/2015-10-14">14</a> <a class="" href="/bitcoin-core-dev/2015-10-15">15</a> <a class="" href="/bitcoin-core-dev/2015-10-16">16</a> <a class="" href="/bitcoin-core-dev/2015-10-17">17</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-18">18</a> <a class="" href="/bitcoin-core-dev/2015-10-19">19</a> <a class="" href="/bitcoin-core-dev/2015-10-20">20</a> <a class="current" href="/bitcoin-core-dev/2015-10-21">21</a> <a class="" href="/bitcoin-core-dev/2015-10-22">22</a> <a class="" href="/bitcoin-core-dev/2015-10-23">23</a> <a class="" href="/bitcoin-core-dev/2015-10-24">24</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2015-10-25">25</a> <a class="" href="/bitcoin-core-dev/2015-10-26">26</a> <a class="" href="/bitcoin-core-dev/2015-10-27">27</a> <a class="" href="/bitcoin-core-dev/2015-10-28">28</a> <a class="" href="/bitcoin-core-dev/2015-10-29">29</a> <a class="" href="/bitcoin-core-dev/2015-10-30">30</a> <a class="" href="/bitcoin-core-dev/2015-10-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1445410200' id='430403'>
<a class='timestamp' href='#430403'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
[bitcoin] laanwj pushed 14 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/c6de5cc88614...3b20e239c602" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/c6de5cc88614...3b20e239c602</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410200' id='430404'>
<a class='timestamp' href='#430404'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master 78b82f4 Suhas Daftuar: Reverse the sort on the mempool&#x27;s feerate index
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410200' id='430405'>
<a class='timestamp' href='#430405'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master 49b6fd5 Pieter Wuille: Add Mempool Expire function to remove old transactions...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410200' id='430406'>
<a class='timestamp' href='#430406'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-2'> GitHub9</span>&gt;
bitcoin/master 9c9b66f Matt Corallo: Fix calling mempool directly, instead of pool, in ATMP
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410200' id='430407'>
<a class='timestamp' href='#430407'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-4'> GitHub173</span>&gt;
[bitcoin] laanwj closed pull request #6722: Limit mempool by throwing away the cheapest txn and setting min relay fee to it (master...mempoollimit) <a href="https://github.com/bitcoin/bitcoin/pull/6722" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6722</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410200' id='430408'>
<a class='timestamp' href='#430408'><time timestamp='2015-10-21T06:50:00Z'>06:50</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
heyyyyyyyy
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410620' id='430409'>
<a class='timestamp' href='#430409'><time timestamp='2015-10-21T06:57:00Z'>06:57</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Nice
<br>
</div>

<div class='talk op-msg' data-timestamp='1445410680' id='430410'>
<a class='timestamp' href='#430410'><time timestamp='2015-10-21T06:58:00Z'>06:58</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Finally
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411100' id='430411'>
<a class='timestamp' href='#430411'><time timestamp='2015-10-21T07:05:00Z'>07:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, great now i can start reviewing it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411100' id='430412'>
<a class='timestamp' href='#430412'><time timestamp='2015-10-21T07:05:00Z'>07:05</time></a>
&lt;<span class='nick nick-3'> * phantomcircuit</span>&gt;
flees for his life
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411100' id='430413'>
<a class='timestamp' href='#430413'><time timestamp='2015-10-21T07:05:00Z'>07:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: Ive done that before :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411280' id='430414'>
<a class='timestamp' href='#430414'><time timestamp='2015-10-21T07:08:00Z'>07:08</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: would be interesting to check at least; switching to tcmalloc is as simple as LD_PRELOAD a library, don&#x27;t know about jemalloc
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411340' id='430415'>
<a class='timestamp' href='#430415'><time timestamp='2015-10-21T07:09:00Z'>07:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
same thing for jemalloc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411520' id='430416'>
<a class='timestamp' href='#430416'><time timestamp='2015-10-21T07:12:00Z'>07:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i wonder how much it would mess up things to put all the global config things into a locked object
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411580' id='430417'>
<a class='timestamp' href='#430417'><time timestamp='2015-10-21T07:13:00Z'>07:13</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
good as a workaround but I&#x27;d prefer a solution that doesn&#x27;t involve making changes at that level. C++ makes it possible to use own memory pools/allocators for specific things, that can be discarded in one block (say) at the end of the function, that seems to be a more predictable way
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411700' id='430418'>
<a class='timestamp' href='#430418'><time timestamp='2015-10-21T07:15:00Z'>07:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I wish the standard API just let you hint short and long lived objects.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411700' id='430419'>
<a class='timestamp' href='#430419'><time timestamp='2015-10-21T07:15:00Z'>07:15</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
phantomcircuit: which things aren&#x27;t protected by mutexes that should be ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411700' id='430420'>
<a class='timestamp' href='#430420'><time timestamp='2015-10-21T07:15:00Z'>07:15</time></a>
&lt;<span class='nick nick-3'> * phantomcircuit</span>&gt;
looks at gmaxwell 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411760' id='430421'>
<a class='timestamp' href='#430421'><time timestamp='2015-10-21T07:16:00Z'>07:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
at the least you&#x27;d want a configuration object per module, not single global one, there is already too much lock centralization
<br>
</div>

<div class='talk op-msg' data-timestamp='1445411940' id='430422'>
<a class='timestamp' href='#430422'><time timestamp='2015-10-21T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wumpus, i believe we do bad things with stuff like fReindex and nPruneTarget
<br>
</div>

<div class='talk op-msg' data-timestamp='1445412540' id='430423'>
<a class='timestamp' href='#430423'><time timestamp='2015-10-21T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
gmaxwell: yes, unfortunately C and C++ are very much lacking with regard to giving hints to your compiler or runtime, it presupposes them to be much more important
<br>
</div>

<div class='talk op-msg' data-timestamp='1445412540' id='430424'>
<a class='timestamp' href='#430424'><time timestamp='2015-10-21T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
s/important/smart
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413860' id='430425'>
<a class='timestamp' href='#430425'><time timestamp='2015-10-21T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: what are the deployment options for SG?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413860' id='430426'>
<a class='timestamp' href='#430426'><time timestamp='2015-10-21T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
err, SW.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413860' id='430427'>
<a class='timestamp' href='#430427'><time timestamp='2015-10-21T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: a flag day swap of the network and all software to use a different transaction seralization. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413920' id='430428'>
<a class='timestamp' href='#430428'><time timestamp='2015-10-21T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I don&#x27;t think it can be done.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413920' id='430429'>
<a class='timestamp' href='#430429'><time timestamp='2015-10-21T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: if we&#x27;re going to have a hard fork, we may as well take the opportunity then...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413920' id='430430'>
<a class='timestamp' href='#430430'><time timestamp='2015-10-21T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-8'> * btcdrak</span>&gt;
runs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445413920' id='430431'>
<a class='timestamp' href='#430431'><time timestamp='2015-10-21T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
btcdrak, there&#x27;s a huge list of things that should absolutely be in a flag day
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414040' id='430432'>
<a class='timestamp' href='#430432'><time timestamp='2015-10-21T07:54:00Z'>07:54</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
SW is a big win, solves a lot of problems and would make a flagday worth the hassle. If we do end up with a blocksize increase, SW should be added at the same time imo.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414040' id='430433'>
<a class='timestamp' href='#430433'><time timestamp='2015-10-21T07:54:00Z'>07:54</time></a>
&lt;<span class='nick nick-3'> * wumpus</span>&gt;
throws a hard frok after btcdrak
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414100' id='430434'>
<a class='timestamp' href='#430434'><time timestamp='2015-10-21T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: I thought I had convinced sipa a softfork was possible for SW a week or two ago. Or is that just too ugly?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414100' id='430435'>
<a class='timestamp' href='#430435'><time timestamp='2015-10-21T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-8'> * btcdrak</span>&gt;
has never tried to cross-dress before
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414160' id='430436'>
<a class='timestamp' href='#430436'><time timestamp='2015-10-21T07:56:00Z'>07:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
btcdrak, the blocksize thing is spv backwards compatible, the only other hard fork proposal im aware of that is, is for commitment schemes in the merkle tree root
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414160' id='430437'>
<a class='timestamp' href='#430437'><time timestamp='2015-10-21T07:56:00Z'>07:56</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
note: i dont actually see that as being very useful
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414220' id='430438'>
<a class='timestamp' href='#430438'><time timestamp='2015-10-21T07:57:00Z'>07:57</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
Luke-Jr: I&#x27;m sure I had a conversation with someone recently, maaku or BlueMatt maybe, about how SW could be a soft fork.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414220' id='430439'>
<a class='timestamp' href='#430439'><time timestamp='2015-10-21T07:57:00Z'>07:57</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
spv clients can all be updated remotely by the devs since they&#x27;re apps in an app store thingie
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414220' id='430440'>
<a class='timestamp' href='#430440'><time timestamp='2015-10-21T07:57:00Z'>07:57</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
agrees SPV-backward-compatible is not a particularly desirable attribute.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414280' id='430441'>
<a class='timestamp' href='#430441'><time timestamp='2015-10-21T07:58:00Z'>07:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
SW cannot really be a soft fork, you can commit to the sw mtr as a sf but that only gets you the uninteresting part of it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414280' id='430442'>
<a class='timestamp' href='#430442'><time timestamp='2015-10-21T07:58:00Z'>07:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
oh but actually you can force the tx to commit to the sw txid in the script sig
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414280' id='430443'>
<a class='timestamp' href='#430443'><time timestamp='2015-10-21T07:58:00Z'>07:58</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
ha you could but... please no
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414340' id='430444'>
<a class='timestamp' href='#430444'><time timestamp='2015-10-21T07:59:00Z'>07:59</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
phantomcircuit: would it really be worse than this thing cdecker is proposing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414340' id='430445'>
<a class='timestamp' href='#430445'><time timestamp='2015-10-21T07:59:00Z'>07:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: it cannot be a softfork. only a weak approximation of it can be, which is what the decker email is.  But that approximation doesn&#x27;t get you benefits like being able to sync blocks without downloading signatures. (itself likely elimiating most of the need for bloom filtered lite wallets, among other benefits);  ... and the approximation has costs like a considerable utxo size overhead, a
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414340' id='430446'>
<a class='timestamp' href='#430446'><time timestamp='2015-10-21T07:59:00Z'>07:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
nd doubling the amount of transaction hashing we have to do.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414400' id='430447'>
<a class='timestamp' href='#430447'><time timestamp='2015-10-21T08:00:00Z'>08:00</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: I don&#x27;t see why you can&#x27;t sync without downloading signatures in the softfork.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414400' id='430448'>
<a class='timestamp' href='#430448'><time timestamp='2015-10-21T08:00:00Z'>08:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: because you can&#x27;t verify a txout you learn without the whole transaction. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414460' id='430449'>
<a class='timestamp' href='#430449'><time timestamp='2015-10-21T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(unless in a softfork you mean extensionblock like softforks)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414520' id='430450'>
<a class='timestamp' href='#430450'><time timestamp='2015-10-21T08:02:00Z'>08:02</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
gmaxwell: the witness wouldn&#x27;t be part of the &quot;whole transaction&quot;; it would be stored in a separate piece of data the block commits to
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414520' id='430451'>
<a class='timestamp' href='#430451'><time timestamp='2015-10-21T08:02:00Z'>08:02</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
SW was quite well received in this thread: <a href="https://www.reddit.com/r/Bitcoin/comments/3ngtx5/could_the_segregated_witness_part_of_the/" class="link" target="_blank">https://www.reddit.com/r/Bitcoin/comments/3ngtx5/could_the_segregated_witness_part_of_the/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414580' id='430452'>
<a class='timestamp' href='#430452'><time timestamp='2015-10-21T08:03:00Z'>08:03</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
block commits to the normal txid as normal and the sw id &amp; script hash separately
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414580' id='430453'>
<a class='timestamp' href='#430453'><time timestamp='2015-10-21T08:03:00Z'>08:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: hm. interesting, you have a point. So you&#x27;d basically have a scriptpubkey that says &quot;go look elsewhere for the signature&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414580' id='430454'>
<a class='timestamp' href='#430454'><time timestamp='2015-10-21T08:03:00Z'>08:03</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414640' id='430455'>
<a class='timestamp' href='#430455'><time timestamp='2015-10-21T08:04:00Z'>08:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
still ends up needing to store two IDs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414640' id='430456'>
<a class='timestamp' href='#430456'><time timestamp='2015-10-21T08:04:00Z'>08:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
hm. or maybe it doesn&#x27;t.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414700' id='430457'>
<a class='timestamp' href='#430457'><time timestamp='2015-10-21T08:05:00Z'>08:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, segregated witness id should match transaction id if you simply require all the scripts in the normal transaction to be OP_1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414700' id='430458'>
<a class='timestamp' href='#430458'><time timestamp='2015-10-21T08:05:00Z'>08:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: damn you&#x27;re right. This is pretty cool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414700' id='430459'>
<a class='timestamp' href='#430459'><time timestamp='2015-10-21T08:05:00Z'>08:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: yea.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414760' id='430460'>
<a class='timestamp' href='#430460'><time timestamp='2015-10-21T08:06:00Z'>08:06</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
☺
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414760' id='430461'>
<a class='timestamp' href='#430461'><time timestamp='2015-10-21T08:06:00Z'>08:06</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: empty is better.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414820' id='430462'>
<a class='timestamp' href='#430462'><time timestamp='2015-10-21T08:07:00Z'>08:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So the idea there would be a new p2sh like scriptpubkey which requires the scriptsig to be empty.  The signatures are &#x27;external&#x27;, and commited in another hashtree commited to by the block.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414880' id='430463'>
<a class='timestamp' href='#430463'><time timestamp='2015-10-21T08:08:00Z'>08:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s identical to SW over whatever span of tx history is exclusively using this scriptpubkey type..
<br>
</div>

<div class='talk op-msg' data-timestamp='1445414940' id='430464'>
<a class='timestamp' href='#430464'><time timestamp='2015-10-21T08:09:00Z'>08:09</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
(which could be enforced by the softfork, if it was desirable)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415060' id='430465'>
<a class='timestamp' href='#430465'><time timestamp='2015-10-21T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Luke-Jr: then it turns it into a flagday which is the hard thing to avoid.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415060' id='430466'>
<a class='timestamp' href='#430466'><time timestamp='2015-10-21T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415060' id='430467'>
<a class='timestamp' href='#430467'><time timestamp='2015-10-21T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
personally I think we might as well just do it in a hardfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415060' id='430468'>
<a class='timestamp' href='#430468'><time timestamp='2015-10-21T08:11:00Z'>08:11</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
but a softfork is possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415120' id='430469'>
<a class='timestamp' href='#430469'><time timestamp='2015-10-21T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the problem is that it is not very reasonable to demand the entire bitcoin ecosystem cut cold to new code all at once.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415120' id='430470'>
<a class='timestamp' href='#430470'><time timestamp='2015-10-21T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(I mean, you could try to demand it but the result would be epic amounts of failure)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415120' id='430471'>
<a class='timestamp' href='#430471'><time timestamp='2015-10-21T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
esp at the high degree that people reimplement everything themselves.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415120' id='430472'>
<a class='timestamp' href='#430472'><time timestamp='2015-10-21T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
we&#x27;d need to ship a version with both code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415120' id='430473'>
<a class='timestamp' href='#430473'><time timestamp='2015-10-21T08:12:00Z'>08:12</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
but that&#x27;s true of any hardfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415180' id='430474'>
<a class='timestamp' href='#430474'><time timestamp='2015-10-21T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Sure, yea yea, the issue isn&#x27;t us. it&#x27;s j random wallet thingy that hardly works at all _currently_.  It might even manage to ship code for both modes, but then the other one just won&#x27;t actually work.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415180' id='430475'>
<a class='timestamp' href='#430475'><time timestamp='2015-10-21T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
oh, you mean tx creation :D
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415180' id='430476'>
<a class='timestamp' href='#430476'><time timestamp='2015-10-21T08:13:00Z'>08:13</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
because outside of bitcoin core most software (but by no means all) in the ecosystem is developed by teams of one or two people, and shipped with little to no systematic testing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415240' id='430477'>
<a class='timestamp' href='#430477'><time timestamp='2015-10-21T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
not just creation but handling.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415240' id='430478'>
<a class='timestamp' href='#430478'><time timestamp='2015-10-21T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Not how we still have no remotely decent block explorer thingy for elements alpha.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415240' id='430479'>
<a class='timestamp' href='#430479'><time timestamp='2015-10-21T08:14:00Z'>08:14</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
yeah, I guess that&#x27;s a big problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415300' id='430480'>
<a class='timestamp' href='#430480'><time timestamp='2015-10-21T08:15:00Z'>08:15</time></a>
&lt;<span class='nick nick-4'> * Luke-Jr</span>&gt;
ponders if we can do the softfork way that remains tx-compatible with a future hardfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415480' id='430481'>
<a class='timestamp' href='#430481'><time timestamp='2015-10-21T08:18:00Z'>08:18</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think it&#x27;s almost that already, without special considerations.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445415480' id='430482'>
<a class='timestamp' href='#430482'><time timestamp='2015-10-21T08:18:00Z'>08:18</time></a>
&lt;<span class='nick nick-2'> Luke-Jr</span>&gt;
maybe
<br>
</div>

<div class='talk op-msg' data-timestamp='1445419200' id='430483'>
<a class='timestamp' href='#430483'><time timestamp='2015-10-21T09:20:00Z'>09:20</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
[bitcoin] laanwj pushed 2 new commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/3b20e239c602...0fbfc5106cd9" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/3b20e239c602...0fbfc5106cd9</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445419200' id='430484'>
<a class='timestamp' href='#430484'><time timestamp='2015-10-21T09:20:00Z'>09:20</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
bitcoin/master 41db8c4 Wladimir J. van der Laan: http: Restrict maximum size of request line + headers...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445419200' id='430485'>
<a class='timestamp' href='#430485'><time timestamp='2015-10-21T09:20:00Z'>09:20</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
bitcoin/master 0fbfc51 Wladimir J. van der Laan: Merge pull request #6859...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445419200' id='430486'>
<a class='timestamp' href='#430486'><time timestamp='2015-10-21T09:20:00Z'>09:20</time></a>
&lt;<span class='nick nick-4'> GitHub199</span>&gt;
[bitcoin] laanwj closed pull request #6859: http: Restrict maximum size of http + headers (master...2015_10_max_http_headers) <a href="https://github.com/bitcoin/bitcoin/pull/6859" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6859</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445421480' id='430487'>
<a class='timestamp' href='#430487'><time timestamp='2015-10-21T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Is there a reason that for fee purposes we are not using max(size, sigops*BLOCK_MAX_BYTES/BLOCK_MAX_SIGOPS) as the size of a transaction?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445421480' id='430488'>
<a class='timestamp' href='#430488'><time timestamp='2015-10-21T09:58:00Z'>09:58</time></a>
&lt;<span class='nick nick-12'> GitHub192</span>&gt;
[bitcoin] domob1812 opened pull request #6863: [Test Suite] Fix test for null tx input (master...null-txin-test) <a href="https://github.com/bitcoin/bitcoin/pull/6863" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6863</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445421720' id='430489'>
<a class='timestamp' href='#430489'><time timestamp='2015-10-21T10:02:00Z'>10:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;d like to see this go in <a href="https://github.com/bitcoin/bitcoin/pull/6622" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6622</a>  I&#x27;ve had this in testing on several nodes (including one acting as a gateway to the outside world) for several others for over a month now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445421720' id='430490'>
<a class='timestamp' href='#430490'><time timestamp='2015-10-21T10:02:00Z'>10:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Does anyone have any views on what else we need? for #6622?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445422020' id='430491'>
<a class='timestamp' href='#430491'><time timestamp='2015-10-21T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
libevent related compile fail on one of my older fedora hosts,   error: ‘EVENT_LOG_WARN’ was not declared in this scope
<br>
</div>

<div class='talk op-msg' data-timestamp='1445422620' id='430492'>
<a class='timestamp' href='#430492'><time timestamp='2015-10-21T10:17:00Z'>10:17</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: if this is the first time compiling since libevent merge you need to do a git clean -dfx
<br>
</div>

<div class='talk op-msg' data-timestamp='1445422860' id='430493'>
<a class='timestamp' href='#430493'><time timestamp='2015-10-21T10:21:00Z'>10:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
btcdrak: fwiw, in my case no concern but you might want to take care in advising people to git clean -d :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445422860' id='430494'>
<a class='timestamp' href='#430494'><time timestamp='2015-10-21T10:21:00Z'>10:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
&quot;omg I was keeping my wallet in my source directory!&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423100' id='430495'>
<a class='timestamp' href='#430495'><time timestamp='2015-10-21T10:25:00Z'>10:25</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
at least mention what it does
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423160' id='430496'>
<a class='timestamp' href='#430496'><time timestamp='2015-10-21T10:26:00Z'>10:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423160' id='430497'>
<a class='timestamp' href='#430497'><time timestamp='2015-10-21T10:26:00Z'>10:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So in any case, cleaning doesn&#x27;t make that go away. I see some other EVENT logging stuff appears to be ifdef guarded.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423160' id='430498'>
<a class='timestamp' href='#430498'><time timestamp='2015-10-21T10:26:00Z'>10:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
but after larger changes to the build system it&#x27;s good advice
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423220' id='430499'>
<a class='timestamp' href='#430499'><time timestamp='2015-10-21T10:27:00Z'>10:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
this appears to have libevent-2.0.so.5.1.6
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423280' id='430500'>
<a class='timestamp' href='#430500'><time timestamp='2015-10-21T10:28:00Z'>10:28</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t know what the minimum version of libevent is that is supported, may be too old
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423340' id='430501'>
<a class='timestamp' href='#430501'><time timestamp='2015-10-21T10:29:00Z'>10:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well hacking out that one like got it to build.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423340' id='430502'>
<a class='timestamp' href='#430502'><time timestamp='2015-10-21T10:29:00Z'>10:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
though if it just errors about the logging stuff, commenting that out may make it compile further
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423340' id='430503'>
<a class='timestamp' href='#430503'><time timestamp='2015-10-21T10:29:00Z'>10:29</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
good
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423340' id='430504'>
<a class='timestamp' href='#430504'><time timestamp='2015-10-21T10:29:00Z'>10:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
er one line.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423400' id='430505'>
<a class='timestamp' href='#430505'><time timestamp='2015-10-21T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
testing now.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423400' id='430506'>
<a class='timestamp' href='#430506'><time timestamp='2015-10-21T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
warren: what libevent version does current RHES have?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423400' id='430507'>
<a class='timestamp' href='#430507'><time timestamp='2015-10-21T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it&#x27;s not necessary, it&#x27;s just nice, redirects libevent errors to our debug log, likely you could put some #ifdef guard around it...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423400' id='430508'>
<a class='timestamp' href='#430508'><time timestamp='2015-10-21T10:30:00Z'>10:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
unit tests pass. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423460' id='430509'>
<a class='timestamp' href='#430509'><time timestamp='2015-10-21T10:31:00Z'>10:31</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
#if LIBEVENT_VERSION_NUMBER &gt;= 0x....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423760' id='430510'>
<a class='timestamp' href='#430510'><time timestamp='2015-10-21T10:36:00Z'>10:36</time></a>
&lt;<span class='nick nick-3'> warren</span>&gt;
gmaxwell: RHEL7 you mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423760' id='430511'>
<a class='timestamp' href='#430511'><time timestamp='2015-10-21T10:36:00Z'>10:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
warren: Yes, whatever version is most current.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423820' id='430512'>
<a class='timestamp' href='#430512'><time timestamp='2015-10-21T10:37:00Z'>10:37</time></a>
&lt;<span class='nick nick-3'> warren</span>&gt;
libevent-2.0.21-4.el7
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423820' id='430513'>
<a class='timestamp' href='#430513'><time timestamp='2015-10-21T10:37:00Z'>10:37</time></a>
&lt;<span class='nick nick-3'> warren</span>&gt;
Keep in mind that if &lt;whatever&gt; is important you need to actually look at the source package as they often will forward port things.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423820' id='430514'>
<a class='timestamp' href='#430514'><time timestamp='2015-10-21T10:37:00Z'>10:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
warren: okay, thats newer than what this host has in any case.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423880' id='430515'>
<a class='timestamp' href='#430515'><time timestamp='2015-10-21T10:38:00Z'>10:38</time></a>
&lt;<span class='nick nick-3'> warren</span>&gt;
wow, that&#x27;s the same version in Fedora 22.  I guess it didn&#x27;t change upstream in a while.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445423940' id='430516'>
<a class='timestamp' href='#430516'><time timestamp='2015-10-21T10:39:00Z'>10:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the particular host I was trying on is my oldest still running fedora box, with F19.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445424420' id='430517'>
<a class='timestamp' href='#430517'><time timestamp='2015-10-21T10:47:00Z'>10:47</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
2.0.21 is the one-to-latest stable of libevent, they have been working on 2.1 for a long time but it&#x27;s still in alpha
<br>
</div>

<div class='talk op-msg' data-timestamp='1445425080' id='430518'>
<a class='timestamp' href='#430518'><time timestamp='2015-10-21T10:58:00Z'>10:58</time></a>
&lt;<span class='nick nick-13'> GitHub79</span>&gt;
[bitcoin] MarcoFalke opened pull request #6864: [qt] Use monospace font (master...MarcoFalke-2015-qtMonospace) <a href="https://github.com/bitcoin/bitcoin/pull/6864" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6864</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445427600' id='430519'>
<a class='timestamp' href='#430519'><time timestamp='2015-10-21T11:40:00Z'>11:40</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
gmaxwell: omg
<br>
</div>

<div class='talk op-msg' data-timestamp='1445432760' id='430520'>
<a class='timestamp' href='#430520'><time timestamp='2015-10-21T13:06:00Z'>13:06</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
gmaxwell, ok to merge #6622, IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449140' id='430521'>
<a class='timestamp' href='#430521'><time timestamp='2015-10-21T17:39:00Z'>17:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
cfields_: Any thoughts on #6622?  If you look at it-- it&#x27;s largely orthorgonal with your overall networking work, happening at a higher level. (later rate limiting support would probably compliment it nicely)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449440' id='430522'>
<a class='timestamp' href='#430522'><time timestamp='2015-10-21T17:44:00Z'>17:44</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: hmm
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449560' id='430523'>
<a class='timestamp' href='#430523'><time timestamp='2015-10-21T17:46:00Z'>17:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
wow, we never went and set TCP_NODELAY on our sockets? we should do that right away-- perhaps even in backports.  We&#x27;ve talked about it before but apparently never did it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449800' id='430524'>
<a class='timestamp' href='#430524'><time timestamp='2015-10-21T17:50:00Z'>17:50</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
gmaxwell, not that I disagree, but... what&#x27;s your specific motivation to use NODELAY &amp; disable Nagel?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449920' id='430525'>
<a class='timestamp' href='#430525'><time timestamp='2015-10-21T17:52:00Z'>17:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jgarzik: now that we&#x27;ve removed all the gratitious sleeps from the networking, nagle is almost certantly slowing our performance. Consider how chatting the bitcoin protocol is.  It likely also makes the traffic more bursty, which isn&#x27;t good for other users sharing the network.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449980' id='430526'>
<a class='timestamp' href='#430526'><time timestamp='2015-10-21T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Basically all of our writes should be large enough that nagle shouldn&#x27;t be saving us much, and the smaller writes we to tend to be latency important.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449980' id='430527'>
<a class='timestamp' href='#430527'><time timestamp='2015-10-21T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
gmaxwell, nod
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449980' id='430528'>
<a class='timestamp' href='#430528'><time timestamp='2015-10-21T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
gmaxwell, just theory or is someone reporting this?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445449980' id='430529'>
<a class='timestamp' href='#430529'><time timestamp='2015-10-21T17:53:00Z'>17:53</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
certainly appears low hanging fruit
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450040' id='430530'>
<a class='timestamp' href='#430530'><time timestamp='2015-10-21T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
gmaxwell: agree that the logic for deciding what to avoid sending belongs at a higher level. The implementation itself seems a bit naive, though?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450040' id='430531'>
<a class='timestamp' href='#430531'><time timestamp='2015-10-21T17:54:00Z'>17:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jgarzik: Suhas mentioned in an email some testing that seemed impacted by it.  I&#x27;m just surprised we hadn&#x27;t done this already, historical analysis suggests it&#x27;s somewhat my fault! :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450100' id='430532'>
<a class='timestamp' href='#430532'><time timestamp='2015-10-21T17:55:00Z'>17:55</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
jgarzik: yeah tcp_nodelay speeds up block relay by a round trip
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450100' id='430533'>
<a class='timestamp' href='#430533'><time timestamp='2015-10-21T17:55:00Z'>17:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(jgarzik you brought it up previously, and I (thinking of the 100ms sleeps) said we had much more low hanging fruit. :P )
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450160' id='430534'>
<a class='timestamp' href='#430534'><time timestamp='2015-10-21T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
yep it was an issue when I rewrote low level network reads/writes code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450160' id='430535'>
<a class='timestamp' href='#430535'><time timestamp='2015-10-21T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;d previously gone around to miner software and p2pool and had them fix it, even before it had been brought up in bitcoin core.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450160' id='430536'>
<a class='timestamp' href='#430536'><time timestamp='2015-10-21T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
thanks.  I was curious where it would first trip up ppl
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450160' id='430537'>
<a class='timestamp' href='#430537'><time timestamp='2015-10-21T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
can someone with rights please restart this travis job please? <a href="https://travis-ci.org/bitcoin/bitcoin/jobs/86431798" class="link" target="_blank">https://travis-ci.org/bitcoin/bitcoin/jobs/86431798</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450280' id='430538'>
<a class='timestamp' href='#430538'><time timestamp='2015-10-21T17:58:00Z'>17:58</time></a>
&lt;<span class='nick nick-3'> cfields_</span>&gt;
btcdrak: just force-push
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450280' id='430539'>
<a class='timestamp' href='#430539'><time timestamp='2015-10-21T17:58:00Z'>17:58</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
not my PR
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450400' id='430540'>
<a class='timestamp' href='#430540'><time timestamp='2015-10-21T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: sipa: i&#x27;ve been trying to learn a bit more about this intensive memory usage in getblocktemplate.  i still haven&#x27;t quite figured out why the framentation is so bad that nothing can get clean up, but there are a few things happening
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450400' id='430541'>
<a class='timestamp' href='#430541'><time timestamp='2015-10-21T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
during CreateNewBlock, we fetch all the coins needed for all the txs in our mempool.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450460' id='430542'>
<a class='timestamp' href='#430542'><time timestamp='2015-10-21T18:01:00Z'>18:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
there is a 2x hit for this, as we make a copy in pcoinstip (assuming they aren&#x27;t already cached there) and a copy in the view in miner.cpp
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450520' id='430543'>
<a class='timestamp' href='#430543'><time timestamp='2015-10-21T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also note that the dbcache size we set here will have just been ignored as we&#x27;re loading up pcoinstip.  so if we&#x27;re over that it&#x27;ll just get flushed again once we&#x27;re done with CNB
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450520' id='430544'>
<a class='timestamp' href='#430544'><time timestamp='2015-10-21T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
also because the rpc call is running in a different thread, if the populating of the cache in pcoinstip trips the loadfactor of the CCoinsMap.  Then we&#x27;ll end up moving the CCoinsMap memory to a different arena.   
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450580' id='430545'>
<a class='timestamp' href='#430545'><time timestamp='2015-10-21T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right, that is how it will happen with the coinsview caches
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450580' id='430546'>
<a class='timestamp' href='#430546'><time timestamp='2015-10-21T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so both the size of the coins in the miner.cpp view and the size in the coins of pcoinstip could possibly be replicated in #rpcthreads + 1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430547'>
<a class='timestamp' href='#430547'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430548'>
<a class='timestamp' href='#430548'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: sipa and BlueMatt have been been working on the view cache memory usage.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430549'>
<a class='timestamp' href='#430549'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m curious as to what they&#x27;re doing
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430550'>
<a class='timestamp' href='#430550'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
it seems a bit redundant that the child cache also stores everything
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430551'>
<a class='timestamp' href='#430551'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
morcos, RE fragmentation part of that has to do with the low level allocator that how that memory is returned to the OS.  Older allocators use sbrk(), which make it impossible to release memory unless there is absolutely no data structure, including hidden-from-app mgmt ADTs, within the memory range.  Ditto newer mmap-based allocators, which will not munmap unless there is perfect reclamation by app + libc.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450640' id='430552'>
<a class='timestamp' href='#430552'><time timestamp='2015-10-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, thats what i was thinking
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450700' id='430553'>
<a class='timestamp' href='#430553'><time timestamp='2015-10-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
So you&#x27;re stuck even if libc allocation structs are left behind
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450700' id='430554'>
<a class='timestamp' href='#430554'><time timestamp='2015-10-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
(typically two pointers, in negative offsets from your DS)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450700' id='430555'>
<a class='timestamp' href='#430555'><time timestamp='2015-10-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430556'>
<a class='timestamp' href='#430556'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
especially as this is a read-only view
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430557'>
<a class='timestamp' href='#430557'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wumpus: which is the child cache?  The cache in view has to store everything b/c it might get modified by in mempool txs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430558'>
<a class='timestamp' href='#430558'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
oh it isn&#x27;t?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430559'>
<a class='timestamp' href='#430559'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
however the cache in pcoinstip doesn&#x27;t need to be populated
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430560'>
<a class='timestamp' href='#430560'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
view (in miner.cpp) is backed by pcoinstip is backed by the database
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450760' id='430561'>
<a class='timestamp' href='#430561'><time timestamp='2015-10-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
that&#x27;s the parent cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450820' id='430562'>
<a class='timestamp' href='#430562'><time timestamp='2015-10-21T18:07:00Z'>18:07</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
and sure - the modified coins need to be stored
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450820' id='430563'>
<a class='timestamp' href='#430563'><time timestamp='2015-10-21T18:07:00Z'>18:07</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i think its kind of silly that you set a dbcache size, but then can blow through that inside CreateNewBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450880' id='430564'>
<a class='timestamp' href='#430564'><time timestamp='2015-10-21T18:08:00Z'>18:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
of course its also made much worse by the organization of the mining code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450880' id='430565'>
<a class='timestamp' href='#430565'><time timestamp='2015-10-21T18:08:00Z'>18:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
no reason to go through every single tx
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450940' id='430566'>
<a class='timestamp' href='#430566'><time timestamp='2015-10-21T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
e.g. the coins that are the same in the child and parent cache don&#x27;t need to be stored twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450940' id='430567'>
<a class='timestamp' href='#430567'><time timestamp='2015-10-21T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
only if the one in the child cache starts to deviate because ti is changed by a mempool transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445450940' id='430568'>
<a class='timestamp' href='#430568'><time timestamp='2015-10-21T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, thats what i&#x27;m suggesting.. when you do a fetch from the child cache, just pass them down from the grandparent cache without storing them intermediately in the parent cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451000' id='430569'>
<a class='timestamp' href='#430569'><time timestamp='2015-10-21T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
right, assuming they aren&#x27;t changed in the parent cache, they don&#x27;t need to be cached there
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451000' id='430570'>
<a class='timestamp' href='#430570'><time timestamp='2015-10-21T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
this is related to #5967
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451060' id='430571'>
<a class='timestamp' href='#430571'><time timestamp='2015-10-21T18:11:00Z'>18:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
where i change the assumptions that the parent cache can&#x27;t be flushed 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451180' id='430572'>
<a class='timestamp' href='#430572'><time timestamp='2015-10-21T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
slight shift of subject, how do most miners use bitcoind now?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451180' id='430573'>
<a class='timestamp' href='#430573'><time timestamp='2015-10-21T18:13:00Z'>18:13</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
they do use getblocktemplate?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430574'>
<a class='timestamp' href='#430574'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
is there another way?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430575'>
<a class='timestamp' href='#430575'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
and in effect have CreateNewBlock control their mining algorithm, or they do something else?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430576'>
<a class='timestamp' href='#430576'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i don&#x27;t know i thought i saw chatter somewhere about miners not using it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430577'>
<a class='timestamp' href='#430577'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i dont&#x27; knwo what else you would do
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430578'>
<a class='timestamp' href='#430578'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I think they all use getblocktemplate in some form or another, although some may have made large changes to the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451240' id='430579'>
<a class='timestamp' href='#430579'><time timestamp='2015-10-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;m wondering how to think about rewriting the mining code
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451300' id='430580'>
<a class='timestamp' href='#430580'><time timestamp='2015-10-21T18:15:00Z'>18:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it could use a substantial rewrite
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451300' id='430581'>
<a class='timestamp' href='#430581'><time timestamp='2015-10-21T18:15:00Z'>18:15</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but i guess it doesn&#x27;t have to be thought of as consensus critical if the testing/submitting aspects of it haven&#x27;t changed?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430582'>
<a class='timestamp' href='#430582'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
block validation is consensus critical, creating blocks from the mempool isn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430583'>
<a class='timestamp' href='#430583'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: I suspect you misunderstood whatever that chatter was (or someone was confused); everyone uses GBT to get work from bitcoind.  Many parties also do other stuff as well.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430584'>
<a class='timestamp' href='#430584'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-1'> gavinand1esen</span>&gt;
morcos: +1 . I&#x27;d suggest starting with a clean sheet of paper, and figuring out what would be best for solo miners / mining pools
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430585'>
<a class='timestamp' href='#430585'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems like there is some low hanging fruit.  once you already have 999,900 bytes in a block, you don&#x27;t need to scan the remaining 2GB of txs just to see if you find a magical 100 byte tx for instance
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430586'>
<a class='timestamp' href='#430586'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: ok good... i definitely didn&#x27;t understand whatever i read
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451360' id='430587'>
<a class='timestamp' href='#430587'><time timestamp='2015-10-21T18:16:00Z'>18:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so long as the resulting block is valid I don&#x27;t think it matters how it was done; so I think it&#x27;s fine to rewrite.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451420' id='430588'>
<a class='timestamp' href='#430588'><time timestamp='2015-10-21T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: might have been a comment that few/no one is using GBT to go from pools to mining devices; which is the case.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451420' id='430589'>
<a class='timestamp' href='#430589'><time timestamp='2015-10-21T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
yeah it obviously matters that it generates correct blocks, but the exact algorithm is not set in stone
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451480' id='430590'>
<a class='timestamp' href='#430590'><time timestamp='2015-10-21T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: as far as rewrite goes, being able to get createnewblock out of the latency critical path for mining would be the biggest win from the user&#x27;s perspective.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451480' id='430591'>
<a class='timestamp' href='#430591'><time timestamp='2015-10-21T18:18:00Z'>18:18</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
does it make sense to start with a simple improvement to the existing algorithm, and then separately or later try to use more advanced logic that takes ancestor packages into account?  would it make sense to ever support 2 different algorithms
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451540' id='430592'>
<a class='timestamp' href='#430592'><time timestamp='2015-10-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: can you explain that a bit more?  you mean once a new block comes in, the time it takes to have a new potential header to work on?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451540' id='430593'>
<a class='timestamp' href='#430593'><time timestamp='2015-10-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(e.g. by returning an empty template when there isn&#x27;t one precomputed, then computing a template in the background.).. and thats independant of the algorithims, but it means that more computationally expensive algorithims would be reasonable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451540' id='430594'>
<a class='timestamp' href='#430594'><time timestamp='2015-10-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
even if its not optimal
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451540' id='430595'>
<a class='timestamp' href='#430595'><time timestamp='2015-10-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, ok that makes a lot of sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451600' id='430596'>
<a class='timestamp' href='#430596'><time timestamp='2015-10-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: what I was thinking was: there is a cached block template, when a new block comes in, it&#x27;s no longer valid (as we have a new block) so its flushed. If there is no cached template available, just generate one that has no transactions (fast), and trigger creating a template in the background.... and the background one can get recomputed on a timer or on new-block arrival, so long as GBT re
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451600' id='430597'>
<a class='timestamp' href='#430597'><time timestamp='2015-10-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
quests keep coming in.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451600' id='430598'>
<a class='timestamp' href='#430598'><time timestamp='2015-10-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
we cache CNB right now, but it&#x27;s &quot;too late&quot; :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451660' id='430599'>
<a class='timestamp' href='#430599'><time timestamp='2015-10-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
+1
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451660' id='430600'>
<a class='timestamp' href='#430600'><time timestamp='2015-10-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
that&#x27;s been the general template for a rewrite, for years
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451720' id='430601'>
<a class='timestamp' href='#430601'><time timestamp='2015-10-21T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yes, thats what we were just discussing... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451900' id='430602'>
<a class='timestamp' href='#430602'><time timestamp='2015-10-21T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so a new thread for template generation is ok?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451960' id='430603'>
<a class='timestamp' href='#430603'><time timestamp='2015-10-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: I think so!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451960' id='430604'>
<a class='timestamp' href='#430604'><time timestamp='2015-10-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
practically required
<br>
</div>

<div class='talk op-msg' data-timestamp='1445451960' id='430605'>
<a class='timestamp' href='#430605'><time timestamp='2015-10-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-16'> wumpus</span>&gt;
I don&#x27;t see why not, but make sure to only do the work if a node is actually mining
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452020' id='430606'>
<a class='timestamp' href='#430606'><time timestamp='2015-10-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what should a call to getblocktemplate do if cs_main is locked?  seems too bad that you really dont&#x27; care for a lot of the cs_main locks
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452020' id='430607'>
<a class='timestamp' href='#430607'><time timestamp='2015-10-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but if the chain is being updated, you might prefer to wait for that to happen before the template is returned
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452020' id='430608'>
<a class='timestamp' href='#430608'><time timestamp='2015-10-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
does it need cs_main if it&#x27;s simply returning a cached version?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452080' id='430609'>
<a class='timestamp' href='#430609'><time timestamp='2015-10-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
seems like the RPC call should return cached version, and b/g compute thread is what needs the lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452080' id='430610'>
<a class='timestamp' href='#430610'><time timestamp='2015-10-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i suppose maybe you could lock the template if you know you&#x27;re activating a new chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452080' id='430611'>
<a class='timestamp' href='#430611'><time timestamp='2015-10-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok i guess i need to learn more about how notification of new tips works anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452080' id='430612'>
<a class='timestamp' href='#430612'><time timestamp='2015-10-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
if a new block comes in, the cache is invalidated + regenerated as an empty template + kicks off new gen thread
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452080' id='430613'>
<a class='timestamp' href='#430613'><time timestamp='2015-10-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but yes i agree in theory you should just need a tiny lock on whether your template is switched to the new one
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452140' id='430614'>
<a class='timestamp' href='#430614'><time timestamp='2015-10-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-1'> gavinand1esen</span>&gt;
I was very close to refactoring the block validation code a tiny bit so the cs_main lock was released while transaction validity was checked... theoretically not a difficult change
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452140' id='430615'>
<a class='timestamp' href='#430615'><time timestamp='2015-10-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gavinand1esen: that seems scary
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452140' id='430616'>
<a class='timestamp' href='#430616'><time timestamp='2015-10-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-1'> gavinand1esen</span>&gt;
that&#x27;s why theoretically....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452140' id='430617'>
<a class='timestamp' href='#430617'><time timestamp='2015-10-21T18:29:00Z'>18:29</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
should just need a quick swap upon new-block, not a long term lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452200' id='430618'>
<a class='timestamp' href='#430618'><time timestamp='2015-10-21T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
jgarzik: isn&#x27;t the technical word for that &quot;tiny&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452200' id='430619'>
<a class='timestamp' href='#430619'><time timestamp='2015-10-21T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
can be lockless technically :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452260' id='430620'>
<a class='timestamp' href='#430620'><time timestamp='2015-10-21T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yes, the cache could be RCU, but I don&#x27;t think thats needed. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452260' id='430621'>
<a class='timestamp' href='#430621'><time timestamp='2015-10-21T18:31:00Z'>18:31</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
I was thinking more std::atomic
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452380' id='430622'>
<a class='timestamp' href='#430622'><time timestamp='2015-10-21T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ok all sounds good... i&#x27;ll give it a shot
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452440' id='430623'>
<a class='timestamp' href='#430623'><time timestamp='2015-10-21T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-1'> gavinand1esen</span>&gt;
morcos: I was mapping out the work needed to validate blocks in parallel (as part of prep work for looking at broadcasting &#x27;weak blocks&#x27;); was pondering an extension to CCoinsViewCache that used leveldb read-only snapshots to validate against the UTXO set as of the last block, which could let validation against two different CCoinsViewCache&#x27;s happen in parallel without the cs_main lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452500' id='430624'>
<a class='timestamp' href='#430624'><time timestamp='2015-10-21T18:35:00Z'>18:35</time></a>
&lt;<span class='nick nick-1'> gavinand1esen</span>&gt;
morcos: that idea might work for a cs_main-free CreateNewBlock, too....
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452560' id='430625'>
<a class='timestamp' href='#430625'><time timestamp='2015-10-21T18:36:00Z'>18:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
signature validation already happens without the cs_main lock
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452860' id='430626'>
<a class='timestamp' href='#430626'><time timestamp='2015-10-21T18:41:00Z'>18:41</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: you mean b/c they are happening in other threads?  but the cs_main lock is held and any further processing waits for them to finish
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452920' id='430627'>
<a class='timestamp' href='#430627'><time timestamp='2015-10-21T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: btw, did you see my comments about doing threaded signature checking in ATMP in addition to in ConnectBlock?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445452920' id='430628'>
<a class='timestamp' href='#430628'><time timestamp='2015-10-21T18:42:00Z'>18:42</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems thats when the actually work is being done a lot of the time anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453040' id='430629'>
<a class='timestamp' href='#430629'><time timestamp='2015-10-21T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: i did not see that, but it certainly may make sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453040' id='430630'>
<a class='timestamp' href='#430630'><time timestamp='2015-10-21T18:44:00Z'>18:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i&#x27;d like to move signature checking to be something fully asynchronous though
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453100' id='430631'>
<a class='timestamp' href='#430631'><time timestamp='2015-10-21T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
with a queue that is worked on by threads, and notification callbacks happen when validatiin succeeds/fails
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430632'>
<a class='timestamp' href='#430632'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh...  huh, so a block could just assume that all signatures were valid and keep processing the rest of the blcok, but only at the very end wait
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430633'>
<a class='timestamp' href='#430633'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wow that would be way better
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430634'>
<a class='timestamp' href='#430634'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s nontrivial :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430635'>
<a class='timestamp' href='#430635'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
not for you!
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430636'>
<a class='timestamp' href='#430636'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-8'> jcorgan</span>&gt;
i think it would be a great idea...if sipa does it :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453160' id='430637'>
<a class='timestamp' href='#430637'><time timestamp='2015-10-21T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: yes, ... behold the sadness of CHECKSIG NOT, however.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453220' id='430638'>
<a class='timestamp' href='#430638'><time timestamp='2015-10-21T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
hmm... so you don&#x27;t even know whether you want it to be valid or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453220' id='430639'>
<a class='timestamp' href='#430639'><time timestamp='2015-10-21T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
if all of script is async then that goes away.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453220' id='430640'>
<a class='timestamp' href='#430640'><time timestamp='2015-10-21T18:47:00Z'>18:47</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i thought processors were good at branching. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453280' id='430641'>
<a class='timestamp' href='#430641'><time timestamp='2015-10-21T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
what do you mean goes away?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453280' id='430642'>
<a class='timestamp' href='#430642'><time timestamp='2015-10-21T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I mean that if the thing you dispatch is the whole script and not just ecdsa then there is no chance that you really want it to fail.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453280' id='430643'>
<a class='timestamp' href='#430643'><time timestamp='2015-10-21T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
processors try to predict branching because they suck at it ;p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453280' id='430644'>
<a class='timestamp' href='#430644'><time timestamp='2015-10-21T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
oh... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453280' id='430645'>
<a class='timestamp' href='#430645'><time timestamp='2015-10-21T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but then the state that needs to be dispatched is large.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453340' id='430646'>
<a class='timestamp' href='#430646'><time timestamp='2015-10-21T18:49:00Z'>18:49</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
The kernel compiles Berkeley packet filters in a JIT - would be amusing to JIT scripts &amp; sigs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453340' id='430647'>
<a class='timestamp' href='#430647'><time timestamp='2015-10-21T18:49:00Z'>18:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
jgarzik: by amusing you mean the tremendous fun in finding all the attacks...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453340' id='430648'>
<a class='timestamp' href='#430648'><time timestamp='2015-10-21T18:49:00Z'>18:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
:P
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453400' id='430649'>
<a class='timestamp' href='#430649'><time timestamp='2015-10-21T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: in Elements alpha we turned CHECKSIG into CHECKSIGVERIFY  (if you want a checksig thats allowed to fail, wrap it in an if).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453400' id='430650'>
<a class='timestamp' href='#430650'><time timestamp='2015-10-21T18:50:00Z'>18:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: i mean parallellizing script validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453460' id='430651'>
<a class='timestamp' href='#430651'><time timestamp='2015-10-21T18:51:00Z'>18:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not signature validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453460' id='430652'>
<a class='timestamp' href='#430652'><time timestamp='2015-10-21T18:51:00Z'>18:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: k. then the negation problem goes away... but lots of data to manage.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453520' id='430653'>
<a class='timestamp' href='#430653'><time timestamp='2015-10-21T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(the CHECKSIGVERIFY vs CHECKSIG is also motivated by batch EC signature checking, which is faster and only gives you a pass/fail for the whole batch).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453520' id='430654'>
<a class='timestamp' href='#430654'><time timestamp='2015-10-21T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
i&#x27;d feel better about if we more formally declared what the state that can affect script validation is
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453520' id='430655'>
<a class='timestamp' href='#430655'><time timestamp='2015-10-21T18:52:00Z'>18:52</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah do we need CHECKSIG?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453640' id='430656'>
<a class='timestamp' href='#430656'><time timestamp='2015-10-21T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
No, there is no need for CHECKSIG--- in theory we could softfork convert existing checksig into a CHECKSIGVERIFY; though some risk of breaking some crazy existing scriptpubkey and making it unspendable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453640' id='430657'>
<a class='timestamp' href='#430657'><time timestamp='2015-10-21T18:54:00Z'>18:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So thats probably not advisable, but any future checksig like operators will certantly be VERIFY only.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453700' id='430658'>
<a class='timestamp' href='#430658'><time timestamp='2015-10-21T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
wouldn&#x27;t that not be a soft fork because of the CHECKSIG NOT&#x27;s
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453700' id='430659'>
<a class='timestamp' href='#430659'><time timestamp='2015-10-21T18:55:00Z'>18:55</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
it seems like you could just bump tx version if you didn&#x27;t want to worry about existing scriptpubkeys
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453760' id='430660'>
<a class='timestamp' href='#430660'><time timestamp='2015-10-21T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: it would be a soft fork: If you had a CHECKSIG NOT with a bad input  you&#x27;d just get denied before you got to the NOT.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453820' id='430661'>
<a class='timestamp' href='#430661'><time timestamp='2015-10-21T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Less agressive but probably equally useful is CHECKSIG requiring that the only signature that is allowed to fail is the zero length signature. (so you can decide if it fails or not without doing anything but checking the length)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453880' id='430662'>
<a class='timestamp' href='#430662'><time timestamp='2015-10-21T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
morcos: key criteria for a soft-fork is that it cannot turn any invalid thing valid. So a soft fork that just added additional reasons for the script to fail when excuting a checksig would be a softfork (if not an advisable one!)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453880' id='430663'>
<a class='timestamp' href='#430663'><time timestamp='2015-10-21T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the only-zero-length can fail also has the advantage of being less potentially incompatible with existing scriptpubkeys.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453880' id='430664'>
<a class='timestamp' href='#430664'><time timestamp='2015-10-21T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
gmaxwell: yes, i just got confused about whether verify shortcircuited or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453940' id='430665'>
<a class='timestamp' href='#430665'><time timestamp='2015-10-21T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ah so its the tx version of the spending tx that matters
<br>
</div>

<div class='talk op-msg' data-timestamp='1445453940' id='430666'>
<a class='timestamp' href='#430666'><time timestamp='2015-10-21T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
As far as version, it&#x27;s a little complicated. We don&#x27;t have versions on txouts in transactions.  Though we do track the transaction version in the utxo set at least.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454000' id='430667'>
<a class='timestamp' href='#430667'><time timestamp='2015-10-21T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so one could use that utxo version to decide what rules to apply. alternatively one could use the spending transaction, version... and if you need to make a signature with the old rules to have it pass, then use the old version.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454000' id='430668'>
<a class='timestamp' href='#430668'><time timestamp='2015-10-21T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
So I think that would work.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454000' id='430669'>
<a class='timestamp' href='#430669'><time timestamp='2015-10-21T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yeah, but its more messy than i hope
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454000' id='430670'>
<a class='timestamp' href='#430670'><time timestamp='2015-10-21T19:00:00Z'>19:00</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
d
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454060' id='430671'>
<a class='timestamp' href='#430671'><time timestamp='2015-10-21T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
one step at a time - just getting a b/g regen would be nice
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454060' id='430672'>
<a class='timestamp' href='#430672'><time timestamp='2015-10-21T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-5'> jgarzik</span>&gt;
;p
<br>
</div>

<div class='talk op-msg' data-timestamp='1445454060' id='430673'>
<a class='timestamp' href='#430673'><time timestamp='2015-10-21T19:01:00Z'>19:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Not really sure if it&#x27;s worth it for the existing checksig... esp since for ECDSA with our current encoding it only gives you the async gains.  For the schnorr in elements it allows a 2x verification speedup from batch verification.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445455320' id='430674'>
<a class='timestamp' href='#430674'><time timestamp='2015-10-21T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: can you please get cdecker to not call his work &quot;normalized transaction ids&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445455320' id='430675'>
<a class='timestamp' href='#430675'><time timestamp='2015-10-21T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
(or have you met with him already?)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445456400' id='430676'>
<a class='timestamp' href='#430676'><time timestamp='2015-10-21T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: just did
<br>
</div>

<div class='talk op-msg' data-timestamp='1445456400' id='430677'>
<a class='timestamp' href='#430677'><time timestamp='2015-10-21T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
why not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445459760' id='430678'>
<a class='timestamp' href='#430678'><time timestamp='2015-10-21T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: because of the instant automatic assumption that this results in a transaction ID that cannot change.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445459760' id='430679'>
<a class='timestamp' href='#430679'><time timestamp='2015-10-21T20:36:00Z'>20:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: did you see that luke figured out how to make SW a soft-fork, rather elegantly too?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445459820' id='430680'>
<a class='timestamp' href='#430680'><time timestamp='2015-10-21T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no, but i did talk about it with cdecker
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460240' id='430681'>
<a class='timestamp' href='#430681'><time timestamp='2015-10-21T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: well it&#x27;d be a second id... transactions would have a txid and an ntxid
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460300' id='430682'>
<a class='timestamp' href='#430682'><time timestamp='2015-10-21T20:45:00Z'>20:45</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
+1 to getting rid of scriptSig :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460360' id='430683'>
<a class='timestamp' href='#430683'><time timestamp='2015-10-21T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: but the ntxid is not actually non-malleable. So if you write software expecting that it is, you will be disappointed (and maybe even suffer funds loss).
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460420' id='430684'>
<a class='timestamp' href='#430684'><time timestamp='2015-10-21T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
It&#x27;s non-malleable against certian kinds of operations under certian conditions, and quite useful. But we had this problem before that people assume this ID is actually more useful for accounting purposes than it is (with your prior writeup)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460480' id='430685'>
<a class='timestamp' href='#430685'><time timestamp='2015-10-21T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
anything except sighash flags that isn&#x27;t covered?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460540' id='430686'>
<a class='timestamp' href='#430686'><time timestamp='2015-10-21T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
signer just modifying the transaction; e.g. I pay you and it takes two hours to confirm, and during that time I RBF the payment (to boost the fees, for example).  You still get paid all the same but now your software is confused when the ntxid changed out from under you.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460540' id='430687'>
<a class='timestamp' href='#430687'><time timestamp='2015-10-21T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
you can also stick in some NO_OPs into the script just to mess with the system :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430688'>
<a class='timestamp' href='#430688'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
And if you go look at the malleability paper from fc2015 thats the kind of thing wallets were doing with txid and getting horribly confused.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430689'>
<a class='timestamp' href='#430689'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
or write a different script with equivalent logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430690'>
<a class='timestamp' href='#430690'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: that&#x27;s not malleability
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430691'>
<a class='timestamp' href='#430691'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but fair enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430692'>
<a class='timestamp' href='#430692'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
do you have a better idea?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460600' id='430693'>
<a class='timestamp' href='#430693'><time timestamp='2015-10-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
name
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460660' id='430694'>
<a class='timestamp' href='#430694'><time timestamp='2015-10-21T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-9'> CodeShark</span>&gt;
so the main feature is that malleating the transaction requires creating a new signature/new signatures?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460660' id='430695'>
<a class='timestamp' href='#430695'><time timestamp='2015-10-21T20:51:00Z'>20:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I think we should do the SW instead, and then it&#x27;s just the same old txid and we do not introduce yet another ID that people need to deal with which is supposted to help malleabiity but still can&#x27;t actually be used as a payment identifier.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460720' id='430696'>
<a class='timestamp' href='#430696'><time timestamp='2015-10-21T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
SW doesn&#x27;t help against these
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460720' id='430697'>
<a class='timestamp' href='#430697'><time timestamp='2015-10-21T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it also changes txid on resigning/modifying a transaction
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460720' id='430698'>
<a class='timestamp' href='#430698'><time timestamp='2015-10-21T20:52:00Z'>20:52</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Indeed, it doesn&#x27;t but it doesn&#x27;t introduce yet another ID which also doesn&#x27;t do what people expect it to do unconditionally (because the expectation is unreasonable)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460780' id='430699'>
<a class='timestamp' href='#430699'><time timestamp='2015-10-21T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
and it has a number of additional benefits. (e.g. allowing private lite wallets that don&#x27;t download signatures; or syncing the history without syncing the signatures)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460780' id='430700'>
<a class='timestamp' href='#430700'><time timestamp='2015-10-21T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i fear this is a lot more work than you think
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460780' id='430701'>
<a class='timestamp' href='#430701'><time timestamp='2015-10-21T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not just in bitcoin core
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460780' id='430702'>
<a class='timestamp' href='#430702'><time timestamp='2015-10-21T20:53:00Z'>20:53</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
And not increasing the size of the utxo set.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430703'>
<a class='timestamp' href='#430703'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it means we need new messages for blocks and transactions
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430704'>
<a class='timestamp' href='#430704'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to relay extra data
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430705'>
<a class='timestamp' href='#430705'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
store that on disk
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430706'>
<a class='timestamp' href='#430706'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
You can use it in a softfork manner without updating. Actually the bitcoin protocol <u>_used_</u> to relay extra data outside of transactions but that got removed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430707'>
<a class='timestamp' href='#430707'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
go fetch it from peers that have it
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460840' id='430708'>
<a class='timestamp' href='#430708'><time timestamp='2015-10-21T20:54:00Z'>20:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Yes, it complicates relay; which is the downside compared to the approach in EA.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460900' id='430709'>
<a class='timestamp' href='#430709'><time timestamp='2015-10-21T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it introduces a new type of block witholding
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460900' id='430710'>
<a class='timestamp' href='#430710'><time timestamp='2015-10-21T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: I don&#x27;t think it does.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460900' id='430711'>
<a class='timestamp' href='#430711'><time timestamp='2015-10-21T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if an old client gives you a block without the witness you need to go fetch it elsewhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460900' id='430712'>
<a class='timestamp' href='#430712'><time timestamp='2015-10-21T20:55:00Z'>20:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: or you just require that the network of updated nodes be connected.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460960' id='430713'>
<a class='timestamp' href='#430713'><time timestamp='2015-10-21T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so you stop accepting blocks from old nodes? yuck...
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460960' id='430714'>
<a class='timestamp' href='#430714'><time timestamp='2015-10-21T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
E.g. you wouldn&#x27;t fetch a block from a older protocol version.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445460960' id='430715'>
<a class='timestamp' href='#430715'><time timestamp='2015-10-21T20:56:00Z'>20:56</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
which, of course, could be deployed first.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461080' id='430716'>
<a class='timestamp' href='#430716'><time timestamp='2015-10-21T20:58:00Z'>20:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
In exchange you: Avoid giving the public two txids both of which don&#x27;t do what they expect, you avoid increasing the UTXO set size by 30%, you allow new sync methods that don&#x27;t transfer the signatures (saving 2/3rd the bandwidth), and you avoid double hashing transaction data to compute two IDs on it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461140' id='430717'>
<a class='timestamp' href='#430717'><time timestamp='2015-10-21T20:59:00Z'>20:59</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
9 blocks in the last 20 mins?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461200' id='430718'>
<a class='timestamp' href='#430718'><time timestamp='2015-10-21T21:00:00Z'>21:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and you get a single txid that equally doesn&#x27;t do what you expect, pretty much need everyone to upgrade anyway, or you need to keep supporting chains of transactions in which some are old-version which breaks even the intended effect
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461260' id='430719'>
<a class='timestamp' href='#430719'><time timestamp='2015-10-21T21:01:00Z'>21:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
while ntxid is strictly better at accomplishing the goal of malleability protection, and is a simple new opcode to softfork in
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461320' id='430720'>
<a class='timestamp' href='#430720'><time timestamp='2015-10-21T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(with the downsides you mentioned, yes)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461320' id='430721'>
<a class='timestamp' href='#430721'><time timestamp='2015-10-21T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: the txid is functonally the same as the ntxid but at least it&#x27;s not confusing people by being something new that they&#x27;ll understand as existing to accomplish something that cannot be accomplished.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461320' id='430722'>
<a class='timestamp' href='#430722'><time timestamp='2015-10-21T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: it is strictly inferior.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461320' id='430723'>
<a class='timestamp' href='#430723'><time timestamp='2015-10-21T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ntxid is recursive; sw is not - if some transactions in the chain do not use sw, it breaks; ntxid does not break
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461380' id='430724'>
<a class='timestamp' href='#430724'><time timestamp='2015-10-21T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: okay point... This is true, but the cost is a 30% increase in utxo size. I don&#x27;t think that is reasonable.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461380' id='430725'>
<a class='timestamp' href='#430725'><time timestamp='2015-10-21T21:03:00Z'>21:03</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats a significant and perminant increase in the total operating cost of the system.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461440' id='430726'>
<a class='timestamp' href='#430726'><time timestamp='2015-10-21T21:04:00Z'>21:04</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
as far as recursive case, it&#x27;s not so simple-- for contracts all the participants are using the new style scriptpubkeys and you can enforce it so its fine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461500' id='430727'>
<a class='timestamp' href='#430727'><time timestamp='2015-10-21T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hmm, i thought i did the math before, and it was 20% extra
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461500' id='430728'>
<a class='timestamp' href='#430728'><time timestamp='2015-10-21T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
now it seems to be 50% extra
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461500' id='430729'>
<a class='timestamp' href='#430729'><time timestamp='2015-10-21T21:05:00Z'>21:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
for ntxid none of the existing software is using these IDs, so gain none of the protection, and nodes need reference rewriting to fixup transactions when their parents change.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461560' id='430730'>
<a class='timestamp' href='#430730'><time timestamp='2015-10-21T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yeah, that fixup is annoying
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430731'>
<a class='timestamp' href='#430731'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I agree its somewhat less annyoing then having to provide an upgraded relay mechenism, but we need to upgrade relay regardless... and doing weird topology things to assure connectivity, but these are one time and short term costs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430732'>
<a class='timestamp' href='#430732'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
this makes no sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430733'>
<a class='timestamp' href='#430733'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the average serialized size of txouts in the utxo set (excluding txid) is 7 bytes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430734'>
<a class='timestamp' href='#430734'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
  &quot;transactions&quot;: 7386379,
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430735'>
<a class='timestamp' href='#430735'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
  &quot;txouts&quot;: 32564578,
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461620' id='430736'>
<a class='timestamp' href='#430736'><time timestamp='2015-10-21T21:07:00Z'>21:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
  &quot;bytes_serialized&quot;: 480114635,
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461680' id='430737'>
<a class='timestamp' href='#430737'><time timestamp='2015-10-21T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
My 30% was just 22+22+22+4+4+32  vs that plus 32 more.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461680' id='430738'>
<a class='timestamp' href='#430738'><time timestamp='2015-10-21T21:08:00Z'>21:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: f2pools empty pubkey attack... but I didn&#x27;t think it was that many.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461740' id='430739'>
<a class='timestamp' href='#430739'><time timestamp='2015-10-21T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, i though the total size was way larger than 480 MB
<br>
</div>

<div class='talk op-msg' data-timestamp='1445461740' id='430740'>
<a class='timestamp' href='#430740'><time timestamp='2015-10-21T21:09:00Z'>21:09</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh indeed, something there is screwed. lemme check.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462640' id='430741'>
<a class='timestamp' href='#430741'><time timestamp='2015-10-21T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Myserty solved, obfscuation change broke the stats by cherry-picking bugged code from sipa&#x27;s addrindex branch.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462640' id='430742'>
<a class='timestamp' href='#430742'><time timestamp='2015-10-21T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Author: Pieter Wuille &lt;pieter.wuille@gmail.com&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462640' id='430743'>
<a class='timestamp' href='#430743'><time timestamp='2015-10-21T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
Date:   Wed Oct 7 17:12:24 2015 -0700
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462640' id='430744'>
<a class='timestamp' href='#430744'><time timestamp='2015-10-21T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
-                stats.nSerializedSize += 32 + slValue.size();
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462640' id='430745'>
<a class='timestamp' href='#430745'><time timestamp='2015-10-21T21:24:00Z'>21:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
+                stats.nSerializedSize += 32 + pcursor-&gt;GetKeySize();
<br>
</div>

<div class='talk op-msg' data-timestamp='1445462700' id='430746'>
<a class='timestamp' href='#430746'><time timestamp='2015-10-21T21:25:00Z'>21:25</time></a>
&lt;<span class='nick nick-4'> GitHub125</span>&gt;
[bitcoin] sipa opened pull request #6865: Fix chainstate serialized_size computation (master...fixchainsize) <a href="https://github.com/bitcoin/bitcoin/pull/6865" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6865</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463060' id='430747'>
<a class='timestamp' href='#430747'><time timestamp='2015-10-21T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so, it&#x27;s a 22% increase to add ntxid at this point
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463060' id='430748'>
<a class='timestamp' href='#430748'><time timestamp='2015-10-21T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
  &quot;bytes_serialized&quot;: 1065420089
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463180' id='430749'>
<a class='timestamp' href='#430749'><time timestamp='2015-10-21T21:33:00Z'>21:33</time></a>
&lt;<span class='nick nick-6'> btcdrak</span>&gt;
sipa: that&#x27;s a lot
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463240' id='430750'>
<a class='timestamp' href='#430750'><time timestamp='2015-10-21T21:34:00Z'>21:34</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
indeed, its a figure that is artifically lowered by the spam attacks... 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463300' id='430751'>
<a class='timestamp' href='#430751'><time timestamp='2015-10-21T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
lowered?
<br>
</div>

<div class='talk op-msg' data-timestamp='1445463300' id='430752'>
<a class='timestamp' href='#430752'><time timestamp='2015-10-21T21:35:00Z'>21:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, the 22% is lowered - yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1445465940' id='430753'>
<a class='timestamp' href='#430753'><time timestamp='2015-10-21T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-10'> GitHub36</span>&gt;
[bitcoin] MarcoFalke opened pull request #6866: [trivial] fix white space in rpc help messages (master...MarcoFalke-2015-rpcWhitespace) <a href="https://github.com/bitcoin/bitcoin/pull/6866" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6866</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471160' id='430754'>
<a class='timestamp' href='#430754'><time timestamp='2015-10-21T23:46:00Z'>23:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: your headers first relay test... can you try that with nagle disabled? :P (e.g. is most of the benefit from the change nagle?  (trivial patch)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471280' id='430755'>
<a class='timestamp' href='#430755'><time timestamp='2015-10-21T23:48:00Z'>23:48</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
gmaxwell: basically all the benefit is nagle
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471280' id='430756'>
<a class='timestamp' href='#430756'><time timestamp='2015-10-21T23:48:00Z'>23:48</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
if we turn it off, the existing relay code works as it&#x27;s supposed to (one round trip instead of two)
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471340' id='430757'>
<a class='timestamp' href='#430757'><time timestamp='2015-10-21T23:49:00Z'>23:49</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
#6494 wasn&#x27;t intended to &quot;fix&quot; that bug, it&#x27;s intended to make relaying generally work better in the case of reorgs
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471340' id='430758'>
<a class='timestamp' href='#430758'><time timestamp='2015-10-21T23:49:00Z'>23:49</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
it just happens to not trigger nagle 
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471340' id='430759'>
<a class='timestamp' href='#430759'><time timestamp='2015-10-21T23:49:00Z'>23:49</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea, obviously #6494 is good and we should do it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471400' id='430760'>
<a class='timestamp' href='#430760'><time timestamp='2015-10-21T23:50:00Z'>23:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh actually it was gavin that was testing it sorry.
<br>
</div>

<div class='talk op-msg' data-timestamp='1445471700' id='430761'>
<a class='timestamp' href='#430761'><time timestamp='2015-10-21T23:55:00Z'>23:55</time></a>
&lt;<span class='nick nick-14'> GitHub20</span>&gt;
[bitcoin] gmaxwell opened pull request #6867: Set TCP_NODELAY on P2P sockets. (master...nodelay) <a href="https://github.com/bitcoin/bitcoin/pull/6867" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/6867</a>
<br>
</div>

</div>
</section>

</body>
</html>
