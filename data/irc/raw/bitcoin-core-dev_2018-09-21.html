<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2018-09-21
 — 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2018-09-21' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:21 UTC</pre>
<pre><a href="/bitcoin-core-dev/2018-08-21">&lt;</a><span class='header'>  September 2018  </span><a href="/bitcoin-core-dev/2018-10-21">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;                   <a class="" href="/bitcoin-core-dev/2018-09-01">1</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-09-02">2</a>  <a class="" href="/bitcoin-core-dev/2018-09-03">3</a>  <a class="" href="/bitcoin-core-dev/2018-09-04">4</a>  <a class="" href="/bitcoin-core-dev/2018-09-05">5</a>  <a class="" href="/bitcoin-core-dev/2018-09-06">6</a>  <a class="" href="/bitcoin-core-dev/2018-09-07">7</a>  <a class="" href="/bitcoin-core-dev/2018-09-08">8</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2018-09-09">9</a> <a class="" href="/bitcoin-core-dev/2018-09-10">10</a> <a class="" href="/bitcoin-core-dev/2018-09-11">11</a> <a class="" href="/bitcoin-core-dev/2018-09-12">12</a> <a class="" href="/bitcoin-core-dev/2018-09-13">13</a> <a class="" href="/bitcoin-core-dev/2018-09-14">14</a> <a class="" href="/bitcoin-core-dev/2018-09-15">15</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-16">16</a> <a class="" href="/bitcoin-core-dev/2018-09-17">17</a> <a class="" href="/bitcoin-core-dev/2018-09-18">18</a> <a class="" href="/bitcoin-core-dev/2018-09-19">19</a> <a class="" href="/bitcoin-core-dev/2018-09-20">20</a> <a class="current" href="/bitcoin-core-dev/2018-09-21">21</a> <a class="" href="/bitcoin-core-dev/2018-09-22">22</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-23">23</a> <a class="" href="/bitcoin-core-dev/2018-09-24">24</a> 25 <a class="" href="/bitcoin-core-dev/2018-09-26">26</a> <a class="" href="/bitcoin-core-dev/2018-09-27">27</a> <a class="" href="/bitcoin-core-dev/2018-09-28">28</a> <a class="" href="/bitcoin-core-dev/2018-09-29">29</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2018-09-30">30</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1537489380' id='631534'>
<a class='timestamp' href='#631534'><time timestamp='2018-09-21T00:23:00Z'>00:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
<a href="https://bitcoincore.org/en/2018/09/20/notice/" class="link" target="_blank">https://bitcoincore.org/en/2018/09/20/notice/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489500' id='631535'>
<a class='timestamp' href='#631535'><time timestamp='2018-09-21T00:25:00Z'>00:25</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
this seems way too premature; only 2% of the network&#x27;s upgraded :/
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489620' id='631536'>
<a class='timestamp' href='#631536'><time timestamp='2018-09-21T00:27:00Z'>00:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
unfortunately, the issue was made public.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489620' id='631537'>
<a class='timestamp' href='#631537'><time timestamp='2018-09-21T00:27:00Z'>00:27</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
:/
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489680' id='631538'>
<a class='timestamp' href='#631538'><time timestamp='2018-09-21T00:28:00Z'>00:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it wasn&#x27;t clear if it would propagate or die out, but since it was moderatly easy to discover on your own, even just the rumors of it risked someone exploiting it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489860' id='631539'>
<a class='timestamp' href='#631539'><time timestamp='2018-09-21T00:31:00Z'>00:31</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
gmaxwell: luke-jr: there&#x27;s an r/btc thread about someone finding the bug
<br>
</div>

<div class='talk op-msg' data-timestamp='1537489920' id='631540'>
<a class='timestamp' href='#631540'><time timestamp='2018-09-21T00:32:00Z'>00:32</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
achow101: it&#x27;s referenced in the message. &#x27;circulating&#x27;
<br>
</div>

<div class='talk op-msg' data-timestamp='1537490040' id='631541'>
<a class='timestamp' href='#631541'><time timestamp='2018-09-21T00:34:00Z'>00:34</time></a>
&lt;<span class='nick nick-4'> jamesob</span>&gt;
Wow, that was fast
<br>
</div>

<div class='talk op-msg' data-timestamp='1537490400' id='631542'>
<a class='timestamp' href='#631542'><time timestamp='2018-09-21T00:40:00Z'>00:40</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
jnewbery: fyi #14283
<br>
</div>

<div class='talk op-msg' data-timestamp='1537492260' id='631543'>
<a class='timestamp' href='#631543'><time timestamp='2018-09-21T01:11:00Z'>01:11</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
theymos has a new announcement up <a href="https://www.reddit.com/r/Bitcoin/comments/9hkoo6/new_info_escalates_importance_upgrading_to_0163/" class="link" target="_blank">https://www.reddit.com/r/Bitcoin/comments/9hkoo6/new_info_escalates_importance_upgrading_to_0163/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537492800' id='631544'>
<a class='timestamp' href='#631544'><time timestamp='2018-09-21T01:20:00Z'>01:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
should I PR the extended test case?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537493880' id='631545'>
<a class='timestamp' href='#631545'><time timestamp='2018-09-21T01:38:00Z'>01:38</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
gmaxwell: I&#x27;d wait
<br>
</div>

<div class='talk op-msg' data-timestamp='1537493940' id='631546'>
<a class='timestamp' href='#631546'><time timestamp='2018-09-21T01:39:00Z'>01:39</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
OK.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537494960' id='631547'>
<a class='timestamp' href='#631547'><time timestamp='2018-09-21T01:56:00Z'>01:56</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
did anyone mail the announcement ML about 0.16.3? I don&#x27;t think I saw one..
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495080' id='631548'>
<a class='timestamp' href='#631548'><time timestamp='2018-09-21T01:58:00Z'>01:58</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
luke-jr: there was an announcement for it
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495200' id='631549'>
<a class='timestamp' href='#631549'><time timestamp='2018-09-21T02:00:00Z'>02:00</time></a>
&lt;<span class='nick nick-3'> aj</span>&gt;
is bitcoin-core-dev the announcement list? <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-core-dev/2018-September/000060.html" class="link" target="_blank">https://lists.linuxfoundation.org/pipermail/bitcoin-core-dev/2018-September/000060.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495200' id='631550'>
<a class='timestamp' href='#631550'><time timestamp='2018-09-21T02:00:00Z'>02:00</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495200' id='631551'>
<a class='timestamp' href='#631551'><time timestamp='2018-09-21T02:00:00Z'>02:00</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
this one <a href="https://bitcoincore.org/en/list/announcements/join/" class="link" target="_blank">https://bitcoincore.org/en/list/announcements/join/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495380' id='631552'>
<a class='timestamp' href='#631552'><time timestamp='2018-09-21T02:03:00Z'>02:03</time></a>
&lt;<span class='nick nick-2'> nanotube</span>&gt;
would it make sense to propose a &#x27;contact&#x27; page on bitcoin.org  similar to the one on bitcoincore.org? it appears it is non-trivial to find where to privately report security issues unless one knows to go to bitcoincore.org, since earlz had to come asking on #bitcoin-dev and -core-dev for a way to report.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495500' id='631553'>
<a class='timestamp' href='#631553'><time timestamp='2018-09-21T02:05:00Z'>02:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
nanotube: :( I feel really uncomfortable with people going to bitcoin.org for that kind of information. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495500' id='631554'>
<a class='timestamp' href='#631554'><time timestamp='2018-09-21T02:05:00Z'>02:05</time></a>
&lt;<span class='nick nick-5'> harding</span>&gt;
nanotube: any page on Bitcoin.org, top menu, Participate, Development, &quot;to report an issue, please see the Bug Reporting page&quot;, Responsible Disclosure.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495500' id='631555'>
<a class='timestamp' href='#631555'><time timestamp='2018-09-21T02:05:00Z'>02:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but its there
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495500' id='631556'>
<a class='timestamp' href='#631556'><time timestamp='2018-09-21T02:05:00Z'>02:05</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
yea
<br>
</div>

<div class='talk op-msg' data-timestamp='1537495860' id='631557'>
<a class='timestamp' href='#631557'><time timestamp='2018-09-21T02:11:00Z'>02:11</time></a>
&lt;<span class='nick nick-2'> nanotube</span>&gt;
yes not ideal, but people probably still go there unless they know to check bitcoincore.org... so, good that it has the bug reporting page in there somewhere. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537498680' id='631558'>
<a class='timestamp' href='#631558'><time timestamp='2018-09-21T02:58:00Z'>02:58</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
there used to be bitcoin-security, but that was handled sort of poorly. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537498740' id='631559'>
<a class='timestamp' href='#631559'><time timestamp='2018-09-21T02:59:00Z'>02:59</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
the contents of it ended up being published when someone stole the old satoshi email address. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537503420' id='631560'>
<a class='timestamp' href='#631560'><time timestamp='2018-09-21T04:17:00Z'>04:17</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
hi. mailing list admin has hit a bug and is unusable at the moment.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537503480' id='631561'>
<a class='timestamp' href='#631561'><time timestamp='2018-09-21T04:18:00Z'>04:18</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
We&#x27;re sorry, we hit a bug!
<br>
</div>

<div class='talk op-msg' data-timestamp='1537503480' id='631562'>
<a class='timestamp' href='#631562'><time timestamp='2018-09-21T04:18:00Z'>04:18</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
Please inform the webmaster for this site of this problem. Printing of traceback and other system information has been explicitly inhibited, but the webmaster can find this information in the Mailman error logs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537503720' id='631563'>
<a class='timestamp' href='#631563'><time timestamp='2018-09-21T04:22:00Z'>04:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
great.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537504380' id='631564'>
<a class='timestamp' href='#631564'><time timestamp='2018-09-21T04:33:00Z'>04:33</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
I was looking at one of the public internet mapping tools for bitcoin core versions. there&#x27;s a pretty disturbing number of hosts that have 8332 open. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537504560' id='631565'>
<a class='timestamp' href='#631565'><time timestamp='2018-09-21T04:36:00Z'>04:36</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
is there some tool or setup guide that is telling people to open this port? I thought it was pretty difficult (not a single switch) to get Bitcoin Core to bind the RPC interface to 0.0.0.0. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537505160' id='631566'>
<a class='timestamp' href='#631566'><time timestamp='2018-09-21T04:46:00Z'>04:46</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
of 8000 IPv4 nodes, 1142 have a RPC port 8332 that respond to a SYN. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537506600' id='631567'>
<a class='timestamp' href='#631567'><time timestamp='2018-09-21T05:10:00Z'>05:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
maybe honeypots?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537506600' id='631568'>
<a class='timestamp' href='#631568'><time timestamp='2018-09-21T05:10:00Z'>05:10</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
as you note, you must take extra steps to bind..
<br>
</div>

<div class='talk op-msg' data-timestamp='1537509120' id='631569'>
<a class='timestamp' href='#631569'><time timestamp='2018-09-21T05:52:00Z'>05:52</time></a>
&lt;<span class='nick nick-15'> echeveria</span>&gt;
I don&#x27;t think so. they&#x27;re over a huge number of different hosts, old and new.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537513560' id='631570'>
<a class='timestamp' href='#631570'><time timestamp='2018-09-21T07:06:00Z'>07:06</time></a>
&lt;<span class='nick nick-2'> ken2812221_</span>&gt;
MarcoFalke: Your gpg signing key has expired
<br>
</div>

<div class='talk op-msg' data-timestamp='1537531500' id='631571'>
<a class='timestamp' href='#631571'><time timestamp='2018-09-21T12:05:00Z'>12:05</time></a>
&lt;<span class='nick nick-9'> Jmabsd</span>&gt;
the code that qualifies and validates a segwit transaction starts on what code locations?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537531800' id='631572'>
<a class='timestamp' href='#631572'><time timestamp='2018-09-21T12:10:00Z'>12:10</time></a>
&lt;<span class='nick nick-9'> Jmabsd</span>&gt;
mostly validation.cpp&#x27;s AcceptToMemoryPoolWorker 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537532460' id='631573'>
<a class='timestamp' href='#631573'><time timestamp='2018-09-21T12:21:00Z'>12:21</time></a>
&lt;<span class='nick nick-9'> Jmabsd</span>&gt;
Where is the code that checks the witness merkle root in the coinbase transaction?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537543980' id='631574'>
<a class='timestamp' href='#631574'><time timestamp='2018-09-21T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-5'> emilengler</span>&gt;
If I download the linux tarball, will I be able to select a download path for the blockchain ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537543980' id='631575'>
<a class='timestamp' href='#631575'><time timestamp='2018-09-21T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
yes, if you know how or use the GUI
<br>
</div>

<div class='talk op-msg' data-timestamp='1537544040' id='631576'>
<a class='timestamp' href='#631576'><time timestamp='2018-09-21T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
better topic for #Bitcoin
<br>
</div>

<div class='talk op-msg' data-timestamp='1537544040' id='631577'>
<a class='timestamp' href='#631577'><time timestamp='2018-09-21T15:34:00Z'>15:34</time></a>
&lt;<span class='nick nick-5'> emilengler</span>&gt;
Ok I will keep this in mind excuse me
<br>
</div>

<div class='talk op-msg' data-timestamp='1537551060' id='631578'>
<a class='timestamp' href='#631578'><time timestamp='2018-09-21T17:31:00Z'>17:31</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I used invalidateblock on a remote node to go back to ~ 475000, but  lost the connection after a few hours. The last debug message is from an hour ago, an updatetip down to 508954. It&#x27;s in a weird state.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537551120' id='631579'>
<a class='timestamp' href='#631579'><time timestamp='2018-09-21T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Memory usage was swinging between 5GB and 8GB. I was able to shut it down via rpc, though the last message was &quot;net thread exit&quot; which sounds like an unclean exit.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537551240' id='631580'>
<a class='timestamp' href='#631580'><time timestamp='2018-09-21T17:34:00Z'>17:34</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Restarting the node, now it&#x27;s &quot;Replaying blocks&quot;, &quot;Rolling back ... 542229&quot; and down from there.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552740' id='631581'>
<a class='timestamp' href='#631581'><time timestamp='2018-09-21T17:59:00Z'>17:59</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
provoostenator: what version bitcoind was it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552800' id='631582'>
<a class='timestamp' href='#631582'><time timestamp='2018-09-21T18:00:00Z'>18:00</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
sdaftuar: v0.17.0rc2 (I was actually dumb enough to not upgrade it before doing this)
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552860' id='631583'>
<a class='timestamp' href='#631583'><time timestamp='2018-09-21T18:01:00Z'>18:01</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I also don&#x27;t know if invalidateblock is supposed to work for such a huge rollback. Though if not, then perhaps the documentation should warn against that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552920' id='631584'>
<a class='timestamp' href='#631584'><time timestamp='2018-09-21T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
well, i think we do want it to work
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552920' id='631585'>
<a class='timestamp' href='#631585'><time timestamp='2018-09-21T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Also, the RPC call is blocking. Does getting disconnected have any bearing on that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552920' id='631586'>
<a class='timestamp' href='#631586'><time timestamp='2018-09-21T18:02:00Z'>18:02</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
no, the invalidateblock function should continue even after the rpc client disconnects, i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552980' id='631587'>
<a class='timestamp' href='#631587'><time timestamp='2018-09-21T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
i believe if you had waited long enough, it probably would have finished?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552980' id='631588'>
<a class='timestamp' href='#631588'><time timestamp='2018-09-21T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
but it might be several hours 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537552980' id='631589'>
<a class='timestamp' href='#631589'><time timestamp='2018-09-21T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
The logs also suggest it continued for about 30 minutes after disconnecting.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553040' id='631590'>
<a class='timestamp' href='#631590'><time timestamp='2018-09-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
disconnecting blocks is heavily disk-bound. when i last looked at it (on different hardware than i use today), i think i noticed i could disconnect on the order of 3-5 blocks/second, on average
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553040' id='631591'>
<a class='timestamp' href='#631591'><time timestamp='2018-09-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
It got about halfway in 2-3 hours, so indeed it looked like it would have made it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553040' id='631592'>
<a class='timestamp' href='#631592'><time timestamp='2018-09-21T18:04:00Z'>18:04</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
This is an iMac with SSD and plenty of memory.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631593'>
<a class='timestamp' href='#631593'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
we used to have an issue where the memory usage could grow sort of unbounded, as disconnected blocks would have their transactions added to the mempool
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631594'>
<a class='timestamp' href='#631594'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
but that was fixed
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631595'>
<a class='timestamp' href='#631595'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Yeah the weird thing I noticed is how dbcache kept growing as it was disconnecting.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631596'>
<a class='timestamp' href='#631596'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
but your comment about 5-8GB of memory has me slightly concerned
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631597'>
<a class='timestamp' href='#631597'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
The machine has 64 GB so it didn&#x27;t run out.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553100' id='631598'>
<a class='timestamp' href='#631598'><time timestamp='2018-09-21T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
what is -dbcache set to?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553160' id='631599'>
<a class='timestamp' href='#631599'><time timestamp='2018-09-21T18:06:00Z'>18:06</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
5000, so that&#x27;s bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553220' id='631600'>
<a class='timestamp' href='#631600'><time timestamp='2018-09-21T18:07:00Z'>18:07</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
The mempool is just the default, so that shouldn&#x27;t have grown so much, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553220' id='631601'>
<a class='timestamp' href='#631601'><time timestamp='2018-09-21T18:07:00Z'>18:07</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
yeah assuming the code works correctly, the mempool&#x27;s memory usage would have been bounded pretty well
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553280' id='631602'>
<a class='timestamp' href='#631602'><time timestamp='2018-09-21T18:08:00Z'>18:08</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Last log entry had cache=4650.7MiB
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553340' id='631603'>
<a class='timestamp' href='#631603'><time timestamp='2018-09-21T18:09:00Z'>18:09</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
oh so that seems good then
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553400' id='631604'>
<a class='timestamp' href='#631604'><time timestamp='2018-09-21T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
The 5-8 GB RAM usage was an hour after the last log entry, when I reconnected, found through &quot;top&quot;. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553640' id='631605'>
<a class='timestamp' href='#631605'><time timestamp='2018-09-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
alright well maybe this is all expected (crappy) behavior.  i don&#x27;t know of any clever ideas to speed up block disconnection, unfortunately.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553640' id='631606'>
<a class='timestamp' href='#631606'><time timestamp='2018-09-21T18:14:00Z'>18:14</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
maybe someone could implement <a href="https://github.com/bitcoin/bitcoin/issues/8037" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/8037</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553820' id='631607'>
<a class='timestamp' href='#631607'><time timestamp='2018-09-21T18:17:00Z'>18:17</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Maybe invalidateblock could have a &quot;don&#x27;t bother adding to the mempool&quot; option?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553940' id='631608'>
<a class='timestamp' href='#631608'><time timestamp='2018-09-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I just noticed I have txindex=1, so that could be another issue.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553940' id='631609'>
<a class='timestamp' href='#631609'><time timestamp='2018-09-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
provoostenator: yeah that&#x27;s fair but i suspect it would still take hours 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553940' id='631610'>
<a class='timestamp' href='#631610'><time timestamp='2018-09-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
provoostenator: it&#x27;s not clear to me what you&#x27;re saying you saw
<br>
</div>

<div class='talk op-msg' data-timestamp='1537553940' id='631611'>
<a class='timestamp' href='#631611'><time timestamp='2018-09-21T18:19:00Z'>18:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
provoostenator: was it still rolling back when you stopped it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554000' id='631612'>
<a class='timestamp' href='#631612'><time timestamp='2018-09-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
if it was then it just sounds like expected behavior.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554000' id='631613'>
<a class='timestamp' href='#631613'><time timestamp='2018-09-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
gmaxwell: rolling back was after I restarted (it&#x27;s still doing that now).
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554000' id='631614'>
<a class='timestamp' href='#631614'><time timestamp='2018-09-21T18:20:00Z'>18:20</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
I&#x27;ve rolled back all the way to block 0 many times, though not recently.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554060' id='631615'>
<a class='timestamp' href='#631615'><time timestamp='2018-09-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
provoostenator: yea, it&#x27;ll keep going until it finishes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554060' id='631616'>
<a class='timestamp' href='#631616'><time timestamp='2018-09-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
mailing list bug has been reoslved; can someone send the post mortem link to the mailing list subscribers plzkthx?  like <a href="https://bitcoincore.org/en/2018/09/20/notice/" class="link" target="_blank">https://bitcoincore.org/en/2018/09/20/notice/</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554060' id='631617'>
<a class='timestamp' href='#631617'><time timestamp='2018-09-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
kanzure: didn&#x27;t BlueMatt send one?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554060' id='631618'>
<a class='timestamp' href='#631618'><time timestamp='2018-09-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Before I disconnected (a few hours ago) it was doing &quot;UpdateTip: new best ...&quot; in reverse order, as expcted from doing invalidateblock 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554060' id='631619'>
<a class='timestamp' href='#631619'><time timestamp='2018-09-21T18:21:00Z'>18:21</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
i don&#x27;t see one in the mod queue
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554120' id='631620'>
<a class='timestamp' href='#631620'><time timestamp='2018-09-21T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
and i don&#x27;t see it on <a href="https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-September/thread.html" class="link" target="_blank">https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-September/thread.html</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554120' id='631621'>
<a class='timestamp' href='#631621'><time timestamp='2018-09-21T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
The logs shows it kept doing that for 30 mins after I disconnected from the machine.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554180' id='631622'>
<a class='timestamp' href='#631622'><time timestamp='2018-09-21T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
When I logged back into the machine, bitcoind was still running, using 5-8 GB of RAM (it was actually going up and down in the space of minutes), but log wasn&#x27;t updating. I then stopped it via rpc and restarted.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554180' id='631623'>
<a class='timestamp' href='#631623'><time timestamp='2018-09-21T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
So it seems it was still doing _something_, despite not logging.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554180' id='631624'>
<a class='timestamp' href='#631624'><time timestamp='2018-09-21T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
FYI, I still didn&#x27;t get anything for 0.6.3/CVE from <a href="https://bitcoincore.org/en/list/announcements/join/" class="link" target="_blank">https://bitcoincore.org/en/list/announcements/join/</a> yet
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554240' id='631625'>
<a class='timestamp' href='#631625'><time timestamp='2018-09-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
provoostenator: what you&#x27;re seeing without the logs is the atomic flush roll forward probably.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554240' id='631626'>
<a class='timestamp' href='#631626'><time timestamp='2018-09-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-16'> luke-jr</span>&gt;
sipa: ^ since you are one of the 3 who can apparently send those
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554240' id='631627'>
<a class='timestamp' href='#631627'><time timestamp='2018-09-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
provoostenator: gmaxwell: it does seem surprising i guess that an unclean shutdown happened?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554240' id='631628'>
<a class='timestamp' href='#631628'><time timestamp='2018-09-21T18:24:00Z'>18:24</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
how would that be possible if you just use rpc to stop the node?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554300' id='631629'>
<a class='timestamp' href='#631629'><time timestamp='2018-09-21T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
gmaxwell: what is a &quot;atomic flush roll forward&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554300' id='631630'>
<a class='timestamp' href='#631630'><time timestamp='2018-09-21T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
provoostenator: on startup, we detect if the utxo state wasn&#x27;t finished being written as of what we think our tip is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554360' id='631631'>
<a class='timestamp' href='#631631'><time timestamp='2018-09-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
in that situation, we have a rollback / rollforward mechanism to fix the utxo
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554360' id='631632'>
<a class='timestamp' href='#631632'><time timestamp='2018-09-21T18:26:00Z'>18:26</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
by disconnecting blocks that are no longer on our chain, and replaying the blocks that might need applying to the utxo state
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554420' id='631633'>
<a class='timestamp' href='#631633'><time timestamp='2018-09-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
that should only happen after an unclean shutdown though
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554420' id='631634'>
<a class='timestamp' href='#631634'><time timestamp='2018-09-21T18:27:00Z'>18:27</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
not to change subject but anyone know what this is? <a href="https://www.reddit.com/r/Bitcoin/comments/9hrusk/orhpan_blocks/e6e4zhk/?context=3" class="link" target="_blank">https://www.reddit.com/r/Bitcoin/comments/9hrusk/orhpan_blocks/e6e4zhk/?context=3</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537554480' id='631635'>
<a class='timestamp' href='#631635'><time timestamp='2018-09-21T18:28:00Z'>18:28</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sdaftuar: indeed. I missed that the shutdown was supposted to be clean.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537555080' id='631636'>
<a class='timestamp' href='#631636'><time timestamp='2018-09-21T18:38:00Z'>18:38</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
gmaxwell: that warning is triggered here: <a href="https://github.com/bitcoinj/bitcoinj/blob/master/core/src/main/java/org/bitcoinj/core/AbstractBlockChain.java#L584" class="link" target="_blank">https://github.com/bitcoinj/bitcoinj/blob/master/core/src/main/java/org/bitcoinj/core/AbstractBlockChain.java#L584</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537555500' id='631637'>
<a class='timestamp' href='#631637'><time timestamp='2018-09-21T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
&quot;duplicate block&quot; seems to mean that it already processed it, nothing to do with orphans.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537555980' id='631638'>
<a class='timestamp' href='#631638'><time timestamp='2018-09-21T18:53:00Z'>18:53</time></a>
&lt;<span class='nick nick-4'> kanzure</span>&gt;
<b>*poke*</b> postmortem email plzkthx
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557120' id='631639'>
<a class='timestamp' href='#631639'><time timestamp='2018-09-21T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Ok, so roll back made it to 509650 and all seems well. Except the node seems to have forgotten I invalidated block 485000, because it jumped right into IBD and is moving forward again.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557360' id='631640'>
<a class='timestamp' href='#631640'><time timestamp='2018-09-21T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I guess that&#x27;s because the node doesn&#x27;t check the full block index at launch.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557540' id='631641'>
<a class='timestamp' href='#631641'><time timestamp='2018-09-21T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Restarted, now using v0.17.0rc4, doing nanother invalidateblock. Memory usage is almost 2GB higher than cache= shown in the logs, and seems to outpace it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557540' id='631642'>
<a class='timestamp' href='#631642'><time timestamp='2018-09-21T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I&#x27;ve also turned off the index.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557660' id='631643'>
<a class='timestamp' href='#631643'><time timestamp='2018-09-21T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
what are the actual dirty page counts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557660' id='631644'>
<a class='timestamp' href='#631644'><time timestamp='2018-09-21T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
we recently realized that OS cached pages in mmaped files show up in res.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557720' id='631645'>
<a class='timestamp' href='#631645'><time timestamp='2018-09-21T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Also, it&#x27;s still going even though bitcoin-cli stop said it would stop. I&#x27;ll look at the dirty page counts...
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557720' id='631646'>
<a class='timestamp' href='#631646'><time timestamp='2018-09-21T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
(note to self: do not google &quot;top dirty pages&quot;)
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557780' id='631647'>
<a class='timestamp' href='#631647'><time timestamp='2018-09-21T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
lol
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557780' id='631648'>
<a class='timestamp' href='#631648'><time timestamp='2018-09-21T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
oh sorry, pmap -x $(pidof bitcoind) | tail -n 1 | tr -s &#x27; &#x27; | cut -d&#x27; &#x27; -f 4
<br>
</div>

<div class='talk op-msg' data-timestamp='1537557960' id='631649'>
<a class='timestamp' href='#631649'><time timestamp='2018-09-21T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
macOS doesn&#x27;t have pmap, but vmmap gives me this summary: <a href="https://gist.github.com/Sjors/6b01711ccd0f96128c7db5230c85ae8f" class="link" target="_blank">https://gist.github.com/Sjors/6b01711ccd0f96128c7db5230c85ae8f</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558080' id='631650'>
<a class='timestamp' href='#631650'><time timestamp='2018-09-21T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Also a long list of &quot;mapped file&quot;, e.g. many &quot;locks/index/*.ldb&quot; 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558140' id='631651'>
<a class='timestamp' href='#631651'><time timestamp='2018-09-21T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
k, so ~2GB of your resident size is mapped files.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558140' id='631652'>
<a class='timestamp' href='#631652'><time timestamp='2018-09-21T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
whats your dbcache setting?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558200' id='631653'>
<a class='timestamp' href='#631653'><time timestamp='2018-09-21T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
dbcache=5000 MB, the log currently says cache=2300 MiB, so that part makes sense?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558200' id='631654'>
<a class='timestamp' href='#631654'><time timestamp='2018-09-21T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
It&#x27;s the just the other 6 GB that needs explaining. Memory usage is now 10 GB. 38 more and the machine is going to OOM, which I&#x27;m not going to allow.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558320' id='631655'>
<a class='timestamp' href='#631655'><time timestamp='2018-09-21T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
MALLOC_TINY is now at 8.7, so that seems to be the thing that&#x27;s mooning.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558560' id='631656'>
<a class='timestamp' href='#631656'><time timestamp='2018-09-21T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
(actually this is still v0.17.0rc2, sorry, though hopefully that doesn&#x27;t matter here)
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558560' id='631657'>
<a class='timestamp' href='#631657'><time timestamp='2018-09-21T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
(no, it is v0.17.0rc4)
<br>
</div>

<div class='talk op-msg' data-timestamp='1537558620' id='631658'>
<a class='timestamp' href='#631658'><time timestamp='2018-09-21T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
kill has no effect, kill -9 did
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559160' id='631659'>
<a class='timestamp' href='#631659'><time timestamp='2018-09-21T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Getting fairly consistent behavior now, even with disablewallet=1.  bitcoin-cli stop seems to stop the RPC server, but not the invalidation process. Curious if anyone can reproduce. I&#x27;ll let it sync to the tip before trying again. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559220' id='631660'>
<a class='timestamp' href='#631660'><time timestamp='2018-09-21T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if invalidateblock does not succeed, its state isn&#x27;t writte 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559280' id='631661'>
<a class='timestamp' href='#631661'><time timestamp='2018-09-21T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it first disconnects the blocks, and then marks them as invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559280' id='631662'>
<a class='timestamp' href='#631662'><time timestamp='2018-09-21T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so at startup they will be connected again if bitcoind was killed in the middle
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559400' id='631663'>
<a class='timestamp' href='#631663'><time timestamp='2018-09-21T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
That makes sense. I wonder if it matter that I was essentially interrupting IBD with that invalidateblock call. Memory usage seemed way worse than what I saw earlier today. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559400' id='631664'>
<a class='timestamp' href='#631664'><time timestamp='2018-09-21T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
invalidateblock also keeps a list of transactions to re-add to the mempool after the invalidation completes
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559460' id='631665'>
<a class='timestamp' href='#631665'><time timestamp='2018-09-21T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i assume that&#x27;s the memory usage you see
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559460' id='631666'>
<a class='timestamp' href='#631666'><time timestamp='2018-09-21T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Is it also not abortable once in progress?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559520' id='631667'>
<a class='timestamp' href='#631667'><time timestamp='2018-09-21T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559580' id='631668'>
<a class='timestamp' href='#631668'><time timestamp='2018-09-21T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Ok, so in that case the way to roll back a long way would be to do it in smaller increments.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559640' id='631669'>
<a class='timestamp' href='#631669'><time timestamp='2018-09-21T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559640' id='631670'>
<a class='timestamp' href='#631670'><time timestamp='2018-09-21T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that should work
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559700' id='631671'>
<a class='timestamp' href='#631671'><time timestamp='2018-09-21T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: the mempool usage is limited.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559700' id='631672'>
<a class='timestamp' href='#631672'><time timestamp='2018-09-21T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: how?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537559880' id='631673'>
<a class='timestamp' href='#631673'><time timestamp='2018-09-21T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/pull/9208" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/9208</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560060' id='631674'>
<a class='timestamp' href='#631674'><time timestamp='2018-09-21T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: it doesn&#x27;t look like DisconnectedBlockTransactions enforces any memory limits
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560060' id='631675'>
<a class='timestamp' href='#631675'><time timestamp='2018-09-21T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
MAX_DISCONNECTED_TX_POOL_SIZE
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560120' id='631676'>
<a class='timestamp' href='#631676'><time timestamp='2018-09-21T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560120' id='631677'>
<a class='timestamp' href='#631677'><time timestamp='2018-09-21T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
There&#x27;s also this open issue: #9027
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560120' id='631678'>
<a class='timestamp' href='#631678'><time timestamp='2018-09-21T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/9027" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/9027</a> | Unbounded reorg memory usage · Issue #9027 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560120' id='631679'>
<a class='timestamp' href='#631679'><time timestamp='2018-09-21T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560180' id='631680'>
<a class='timestamp' href='#631680'><time timestamp='2018-09-21T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i was expecting the code to be elsewhere, my bad
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560300' id='631681'>
<a class='timestamp' href='#631681'><time timestamp='2018-09-21T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I take great pride in doing stupid things that lead to a new release candidate, so hopefully you&#x27;ll find something :-)
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560480' id='631682'>
<a class='timestamp' href='#631682'><time timestamp='2018-09-21T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
provoostenator: are you running txindex?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560480' id='631683'>
<a class='timestamp' href='#631683'><time timestamp='2018-09-21T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
No, I did the first time today, but turned that off in more recent attempts.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560780' id='631684'>
<a class='timestamp' href='#631684'><time timestamp='2018-09-21T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Re incremental approach: I rolled back ~10,000 blocks using about 13GB of RAM, cache=2200 at the peak. Sounds like it&#x27;s holding all transactions in memory.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537560960' id='631685'>
<a class='timestamp' href='#631685'><time timestamp='2018-09-21T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
But then it gets weird. ERROR: AcceptToMemoryPoolWorker: Consensus::CheckTxInputs: ... bad-txns-premature-spend-of-coinbase, tried to spend coinbase at depth 92
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561020' id='631686'>
<a class='timestamp' href='#631686'><time timestamp='2018-09-21T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
InvalidChainFound: invalid block [the block I invalidated]
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561020' id='631687'>
<a class='timestamp' href='#631687'><time timestamp='2018-09-21T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
thats normal.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561020' id='631688'>
<a class='timestamp' href='#631688'><time timestamp='2018-09-21T20:17:00Z'>20:17</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Yeah, but then it starts syncing again.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561320' id='631689'>
<a class='timestamp' href='#631689'><time timestamp='2018-09-21T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
Ok, now I think I destroyed my chain :-)  At boot: &quot;assertion failed: (!setBlockIndexCandidates.empty()), function PruneBlockIndexCandidates, file validation.cpp, line 2547&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561920' id='631690'>
<a class='timestamp' href='#631690'><time timestamp='2018-09-21T20:32:00Z'>20:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
provoostenator: i found the issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561980' id='631691'>
<a class='timestamp' href='#631691'><time timestamp='2018-09-21T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s specific to InvalidateBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1537561980' id='631692'>
<a class='timestamp' href='#631692'><time timestamp='2018-09-21T20:33:00Z'>20:33</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
sipa: nice!
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562460' id='631693'>
<a class='timestamp' href='#631693'><time timestamp='2018-09-21T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
sipa: is it because disconnectpool holds on to transactions which reference a shared_ptr&lt;CBlock&gt; pblock, so those don&#x27;t get deallocated?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562460' id='631694'>
<a class='timestamp' href='#631694'><time timestamp='2018-09-21T20:41:00Z'>20:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
provoostenator: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562640' id='631695'>
<a class='timestamp' href='#631695'><time timestamp='2018-09-21T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the event queue holds on to the shared_ptr&lt;CBlock&gt; objects in callbacks to DisconnectedBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562640' id='631696'>
<a class='timestamp' href='#631696'><time timestamp='2018-09-21T20:44:00Z'>20:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and InvalidateBlock doesn&#x27;t limit the size of the queue
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562760' id='631697'>
<a class='timestamp' href='#631697'><time timestamp='2018-09-21T20:46:00Z'>20:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
provoostenator: could you check whether this issue also occurs when Rewinding?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562820' id='631698'>
<a class='timestamp' href='#631698'><time timestamp='2018-09-21T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
create a 0.13.0 node, sync it to tip, and then upgrade to 0.17+
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562820' id='631699'>
<a class='timestamp' href='#631699'><time timestamp='2018-09-21T20:47:00Z'>20:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i suspect it is, and if that&#x27;s the case, i would consider it a release blocker
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562880' id='631700'>
<a class='timestamp' href='#631700'><time timestamp='2018-09-21T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
That&#x27;s the rewind that happens if you upgrade a non-segwit node to a segwit node?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562880' id='631701'>
<a class='timestamp' href='#631701'><time timestamp='2018-09-21T20:48:00Z'>20:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562940' id='631702'>
<a class='timestamp' href='#631702'><time timestamp='2018-09-21T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I&#x27;ll give it a try this weekend or early next week. Getting a bit late here. Maybe someone else gets to it first.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537562940' id='631703'>
<a class='timestamp' href='#631703'><time timestamp='2018-09-21T20:49:00Z'>20:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1537563000' id='631704'>
<a class='timestamp' href='#631704'><time timestamp='2018-09-21T20:50:00Z'>20:50</time></a>
&lt;<span class='nick nick-15'> provoostenator</span>&gt;
I&#x27;m not looking forward to doing another release notes for 0.14 and 0.15 backports :-) 
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566120' id='631705'>
<a class='timestamp' href='#631705'><time timestamp='2018-09-21T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
About #14289, was it ever supported to call invalidateblock on a block very far back?
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566120' id='631706'>
<a class='timestamp' href='#631706'><time timestamp='2018-09-21T21:42:00Z'>21:42</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/14289" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/14289</a> | Unbounded growth of scheduler queue · Issue #14289 · bitcoin/bitcoin · GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566180' id='631707'>
<a class='timestamp' href='#631707'><time timestamp='2018-09-21T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
MarcoFalke: i would say no, but it&#x27;d be a nice-to-have if it worked
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566180' id='631708'>
<a class='timestamp' href='#631708'><time timestamp='2018-09-21T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
having invalidateblock 100000 blocks deep use a massive amount of memory is not a blocker, i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566180' id='631709'>
<a class='timestamp' href='#631709'><time timestamp='2018-09-21T21:43:00Z'>21:43</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
Ok, that was my impression because every time I tried that it would deadlock the node a bit until I got impatient and CTRL+C out
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566240' id='631710'>
<a class='timestamp' href='#631710'><time timestamp='2018-09-21T21:44:00Z'>21:44</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
If that is supported with reasonable memory gurantees, we should add a test/benchmark so it doesn&#x27;t randomly regress
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566300' id='631711'>
<a class='timestamp' href='#631711'><time timestamp='2018-09-21T21:45:00Z'>21:45</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
Also my key is de-expired, but I am having issues uploading it to keyservers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566300' id='631712'>
<a class='timestamp' href='#631712'><time timestamp='2018-09-21T21:45:00Z'>21:45</time></a>
&lt;<span class='nick nick-7'> MarcoFalke</span>&gt;
All of them return some obscure proxy error or timeout or ...
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566360' id='631713'>
<a class='timestamp' href='#631713'><time timestamp='2018-09-21T21:46:00Z'>21:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
MarcoFalke: yes worked fine since 9208.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537566360' id='631714'>
<a class='timestamp' href='#631714'><time timestamp='2018-09-21T21:46:00Z'>21:46</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the rpc will disconnect, because the rpc timeout isn&#x27;t long enough for it to finish, but a node will happly work its way back to block 0.
<br>
</div>

<div class='talk op-msg' data-timestamp='1537567320' id='631715'>
<a class='timestamp' href='#631715'><time timestamp='2018-09-21T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-4'> Murch</span>&gt;
MarcoFalke: Luckily Keyservers may soonish be a thing of the past: <a href="https://wiki.gnupg.org/WKD" class="link" target="_blank">https://wiki.gnupg.org/WKD</a>
<br>
</div>

</div>
</section>

</body>
</html>
