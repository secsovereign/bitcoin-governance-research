<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2016-07-13
 â€” 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2016-07-13' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:26 UTC</pre>
<pre><a href="/bitcoin-core-dev/2016-06-13">&lt;</a><span class='header'>    July 2016     </span><a href="/bitcoin-core-dev/2016-08-13">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;                <a class="" href="/bitcoin-core-dev/2016-07-01">1</a>  <a class="" href="/bitcoin-core-dev/2016-07-02">2</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2016-07-03">3</a>  <a class="" href="/bitcoin-core-dev/2016-07-04">4</a>  <a class="" href="/bitcoin-core-dev/2016-07-05">5</a>  <a class="" href="/bitcoin-core-dev/2016-07-06">6</a>  <a class="" href="/bitcoin-core-dev/2016-07-07">7</a>  <a class="" href="/bitcoin-core-dev/2016-07-08">8</a>  <a class="" href="/bitcoin-core-dev/2016-07-09">9</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-07-10">10</a> <a class="" href="/bitcoin-core-dev/2016-07-11">11</a> <a class="" href="/bitcoin-core-dev/2016-07-12">12</a> <a class="current" href="/bitcoin-core-dev/2016-07-13">13</a> <a class="" href="/bitcoin-core-dev/2016-07-14">14</a> <a class="" href="/bitcoin-core-dev/2016-07-15">15</a> <a class="" href="/bitcoin-core-dev/2016-07-16">16</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-07-17">17</a> <a class="" href="/bitcoin-core-dev/2016-07-18">18</a> <a class="" href="/bitcoin-core-dev/2016-07-19">19</a> <a class="" href="/bitcoin-core-dev/2016-07-20">20</a> <a class="" href="/bitcoin-core-dev/2016-07-21">21</a> <a class="" href="/bitcoin-core-dev/2016-07-22">22</a> <a class="" href="/bitcoin-core-dev/2016-07-23">23</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-07-24">24</a> <a class="" href="/bitcoin-core-dev/2016-07-25">25</a> <a class="" href="/bitcoin-core-dev/2016-07-26">26</a> <a class="" href="/bitcoin-core-dev/2016-07-27">27</a> <a class="" href="/bitcoin-core-dev/2016-07-28">28</a> <a class="" href="/bitcoin-core-dev/2016-07-29">29</a> <a class="" href="/bitcoin-core-dev/2016-07-30">30</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2016-07-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1468371180' id='479302'>
<a class='timestamp' href='#479302'><time timestamp='2016-07-13T00:53:00Z'>00:53</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, i want to (optinally) save the mempool and sigcache
<br>
</div>

<div class='talk op-msg' data-timestamp='1468371180' id='479303'>
<a class='timestamp' href='#479303'><time timestamp='2016-07-13T00:53:00Z'>00:53</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
on shutdown
<br>
</div>

<div class='talk op-msg' data-timestamp='1468371180' id='479304'>
<a class='timestamp' href='#479304'><time timestamp='2016-07-13T00:53:00Z'>00:53</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
where&#x27;s the right place to put that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468371240' id='479305'>
<a class='timestamp' href='#479305'><time timestamp='2016-07-13T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
don&#x27;t save the sigcache. the reload of the mempool from disk will repopulate it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468371240' id='479306'>
<a class='timestamp' href='#479306'><time timestamp='2016-07-13T00:54:00Z'>00:54</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
the stuff that doesn&#x27;t get repopulated shouldn&#x27;t be there in any case.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372320' id='479307'>
<a class='timestamp' href='#479307'><time timestamp='2016-07-13T01:12:00Z'>01:12</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, yes but repopulating the mempool will take forever without saving the sigcache
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372500' id='479308'>
<a class='timestamp' href='#479308'><time timestamp='2016-07-13T01:15:00Z'>01:15</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: 300mb of validation isn&#x27;t ~that~ big a deal.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372560' id='479309'>
<a class='timestamp' href='#479309'><time timestamp='2016-07-13T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
at least so long as it reloads the mempool in the background.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372560' id='479310'>
<a class='timestamp' href='#479310'><time timestamp='2016-07-13T01:16:00Z'>01:16</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
okay, perhaps worse than I&#x27;m thinking due to the fact that the signature validation isn&#x27;t parallel
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372680' id='479311'>
<a class='timestamp' href='#479311'><time timestamp='2016-07-13T01:18:00Z'>01:18</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
but even if the 300mbytes is alll txins, thats 145 bytes per signature, or about 2 million signatures, which even on a single moderately fast core should only be about 121 cpu seconds.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468372740' id='479312'>
<a class='timestamp' href='#479312'><time timestamp='2016-07-13T01:19:00Z'>01:19</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
well whatever, 30% slower since I&#x27;m assuming libsecp256k1 with performance features we&#x27;re not using yet.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373040' id='479313'>
<a class='timestamp' href='#479313'><time timestamp='2016-07-13T01:24:00Z'>01:24</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, it&#x27;s quite a bit more than 300MiB on my system :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373100' id='479314'>
<a class='timestamp' href='#479314'><time timestamp='2016-07-13T01:25:00Z'>01:25</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: having a mempool much larger than typical shouldn&#x27;t increase your hitrate much and if you&#x27;re mining may cause your to mine poorly propagated crap.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373220' id='479315'>
<a class='timestamp' href='#479315'><time timestamp='2016-07-13T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it wont improve the hitrate for sigcache or compact blocks very much
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373220' id='479316'>
<a class='timestamp' href='#479316'><time timestamp='2016-07-13T01:27:00Z'>01:27</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i dont see how it can result in you mining poorly propagated things though?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373400' id='479317'>
<a class='timestamp' href='#479317'><time timestamp='2016-07-13T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
say someone advertises a txn with a very low feerate, it doesn&#x27;t enter or quickly falls out of most nodes mempools. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373400' id='479318'>
<a class='timestamp' href='#479318'><time timestamp='2016-07-13T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
If I add a different version of boost to my /usr/include I end up getting errors with core not being able to find it, is there some where I need to reference a newer version?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373400' id='479319'>
<a class='timestamp' href='#479319'><time timestamp='2016-07-13T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
cfields: 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468373400' id='479320'>
<a class='timestamp' href='#479320'><time timestamp='2016-07-13T01:30:00Z'>01:30</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: but not yours... later, the network runs low on transactions in the pool or CPFP ranks that straggler up. now you mine it. And it&#x27;s a surprise to everyone.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468375020' id='479321'>
<a class='timestamp' href='#479321'><time timestamp='2016-07-13T01:57:00Z'>01:57</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
bsm117532: for consensus critical applications, you&#x27;re going to need to use the raw iterator, and even worse, follow the byte-level tests in the segwit codebase exactly
<br>
</div>

<div class='talk op-msg' data-timestamp='1468379040' id='479322'>
<a class='timestamp' href='#479322'><time timestamp='2016-07-13T03:04:00Z'>03:04</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
gmaxwell, true
<br>
</div>

<div class='talk op-msg' data-timestamp='1468379040' id='479323'>
<a class='timestamp' href='#479323'><time timestamp='2016-07-13T03:04:00Z'>03:04</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i think that is generally not easily solved though
<br>
</div>

<div class='talk op-msg' data-timestamp='1468379040' id='479324'>
<a class='timestamp' href='#479324'><time timestamp='2016-07-13T03:04:00Z'>03:04</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
indeed unless you have the exact same limit as the entire rest of the network
<br>
</div>

<div class='talk op-msg' data-timestamp='1468379040' id='479325'>
<a class='timestamp' href='#479325'><time timestamp='2016-07-13T03:04:00Z'>03:04</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
you&#x27;re screwed there
<br>
</div>

<div class='talk op-msg' data-timestamp='1468379100' id='479326'>
<a class='timestamp' href='#479326'><time timestamp='2016-07-13T03:05:00Z'>03:05</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
otoh my brain is on fire so maybe im wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1468394340' id='479327'>
<a class='timestamp' href='#479327'><time timestamp='2016-07-13T07:19:00Z'>07:19</time></a>
&lt;<span class='nick nick-3'> GitHub99</span>&gt;
[bitcoin] maiiz opened pull request #8336: Issues #8334 (master...issues-8334) <a href="https://github.com/bitcoin/bitcoin/pull/8336" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8336</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468394700' id='479328'>
<a class='timestamp' href='#479328'><time timestamp='2016-07-13T07:25:00Z'>07:25</time></a>
&lt;<span class='nick nick-8'> murch</span>&gt;
gmaxwell: <a href="https://github.com/bitcoin/bitcoin/issues/7664#issuecomment-232230899" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/7664#issuecomment-232230899</a> &lt;-- I think you meant &quot;is a large multiple&quot; instead of &quot;isn&#x27;t&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468394940' id='479329'>
<a class='timestamp' href='#479329'><time timestamp='2016-07-13T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
so NicolasDorier and I are discussing libconsensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1468394940' id='479330'>
<a class='timestamp' href='#479330'><time timestamp='2016-07-13T07:29:00Z'>07:29</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
murch: ya, thanks.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395000' id='479331'>
<a class='timestamp' href='#479331'><time timestamp='2016-07-13T07:30:00Z'>07:30</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
do we want locks inside libconsensus? my understanding was no, due to complexity reasons. NicolasDorier thinks it&#x27;s fine with std C++11 but it wasn&#x27;t fine with boost
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395060' id='479332'>
<a class='timestamp' href='#479332'><time timestamp='2016-07-13T07:31:00Z'>07:31</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, personally I think libconsensus should move towards plain C, but that&#x27;s another discussion it seems I lost already
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395120' id='479333'>
<a class='timestamp' href='#479333'><time timestamp='2016-07-13T07:32:00Z'>07:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: i was talking about this with NicolasDorier earlier
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395180' id='479334'>
<a class='timestamp' href='#479334'><time timestamp='2016-07-13T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: i expected that the point of contention would be the idea of it managing its own state
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395180' id='479335'>
<a class='timestamp' href='#479335'><time timestamp='2016-07-13T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(which would imply using locks for that state)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395180' id='479336'>
<a class='timestamp' href='#479336'><time timestamp='2016-07-13T07:33:00Z'>07:33</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
ah yes you wanted to keep the libconsensus &quot;stateless&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395240' id='479337'>
<a class='timestamp' href='#479337'><time timestamp='2016-07-13T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t know whether it should be stateless - having state, especially for caches, would hugely simplify things
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395240' id='479338'>
<a class='timestamp' href='#479338'><time timestamp='2016-07-13T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but i think that should be the first thing to discuss
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395240' id='479339'>
<a class='timestamp' href='#479339'><time timestamp='2016-07-13T07:34:00Z'>07:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as it using locks or not follows naturally
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395360' id='479340'>
<a class='timestamp' href='#479340'><time timestamp='2016-07-13T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa: that pr doesn&#x27;t seem to have improved removeForBlock times by much
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395360' id='479341'>
<a class='timestamp' href='#479341'><time timestamp='2016-07-13T07:36:00Z'>07:36</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
phantomcircuit: that means it improved them at all?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395420' id='479342'>
<a class='timestamp' href='#479342'><time timestamp='2016-07-13T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
im gonna need to do the mempool save/restor thing to know for sure unfortunately
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395420' id='479343'>
<a class='timestamp' href='#479343'><time timestamp='2016-07-13T07:37:00Z'>07:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
if it did it certainly wasn&#x27;t spectacular
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395480' id='479344'>
<a class='timestamp' href='#479344'><time timestamp='2016-07-13T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
I&#x27;m working right now on a verify_block for consensus lib. (like jtimon doing) I think the question of state won&#x27;t come immediately to me as I first need to finish that. Once I done my verify_blocks, I&#x27;ll just make several proposal for handling the hash cache of segwit
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395480' id='479345'>
<a class='timestamp' href='#479345'><time timestamp='2016-07-13T07:38:00Z'>07:38</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
I have several idea, will just try to code them see if they make sense at all :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395600' id='479346'>
<a class='timestamp' href='#479346'><time timestamp='2016-07-13T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
NicolasDorier: how does your verifyblock get access to the chainstate and the block index?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395600' id='479347'>
<a class='timestamp' href='#479347'><time timestamp='2016-07-13T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-9'> KwukDuck</span>&gt;
My Bitcoin Core client keeps crashing since a few days... <a href="http://pastebin.com/fiPXrzZY" class="link" target="_blank">http://pastebin.com/fiPXrzZY</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395600' id='479348'>
<a class='timestamp' href='#479348'><time timestamp='2016-07-13T07:40:00Z'>07:40</time></a>
&lt;<span class='nick nick-9'> KwukDuck</span>&gt;
any ideas?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395660' id='479349'>
<a class='timestamp' href='#479349'><time timestamp='2016-07-13T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: well, I think the interface for the caches can be really simple, and we can provide the implementations we have for those who don&#x27;t want to implement their own, so I disagree on &quot;hugely simplify things&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395660' id='479350'>
<a class='timestamp' href='#479350'><time timestamp='2016-07-13T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
sipa: By cheating, I delegate to the client the calculation of the flags and contextual informations (height, bestblock, mtp)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395660' id='479351'>
<a class='timestamp' href='#479351'><time timestamp='2016-07-13T07:41:00Z'>07:41</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
such that all the consensus code does not depends on CBlockIndex at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479352'>
<a class='timestamp' href='#479352'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
but just to 2 types
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479353'>
<a class='timestamp' href='#479353'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
KwukDuck, hardware error
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479354'>
<a class='timestamp' href='#479354'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
CConsensusContextInfo and CConsensusFlags
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479355'>
<a class='timestamp' href='#479355'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but yeah, my plan has always been to have a C++ version of verifyBlock first, well, I mean, first VerifyHeader, verifyTx...but never got past the point of simply moving the consensus functions out of main...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479356'>
<a class='timestamp' href='#479356'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
both can be calculated by &quot;main&quot; with pIndex trivially. Then passed to consensus methods
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395720' id='479357'>
<a class='timestamp' href='#479357'><time timestamp='2016-07-13T07:42:00Z'>07:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: yes, but that means the api changes whenever a cache is added/changed
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395780' id='479358'>
<a class='timestamp' href='#479358'><time timestamp='2016-07-13T07:43:00Z'>07:43</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
yes, if you add a cache the api changes, not sure what you mean by changing the cache
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395780' id='479359'>
<a class='timestamp' href='#479359'><time timestamp='2016-07-13T07:43:00Z'>07:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if it ends up working differently somehow
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395780' id='479360'>
<a class='timestamp' href='#479360'><time timestamp='2016-07-13T07:43:00Z'>07:43</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
just as if the storage changes, the api for the storage would change as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395840' id='479361'>
<a class='timestamp' href='#479361'><time timestamp='2016-07-13T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
I started working on <a href="https://github.com/NicolasDorier/bitcoin/commits/blkconsensus" class="link" target="_blank">https://github.com/NicolasDorier/bitcoin/commits/blkconsensus</a> but still not done
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395840' id='479362'>
<a class='timestamp' href='#479362'><time timestamp='2016-07-13T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
assuming people want libconsensus to be storageless
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395840' id='479363'>
<a class='timestamp' href='#479363'><time timestamp='2016-07-13T07:44:00Z'>07:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon: yeah, i understand the use case
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395900' id='479364'>
<a class='timestamp' href='#479364'><time timestamp='2016-07-13T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s just a lot harder to introduce abstractions for block indexes and chainstate, especially without degrading performance
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395900' id='479365'>
<a class='timestamp' href='#479365'><time timestamp='2016-07-13T07:45:00Z'>07:45</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I was working on <a href="https://github.com/jtimon/bitcoin/commits/jt" class="link" target="_blank">https://github.com/jtimon/bitcoin/commits/jt</a> but I broke the branch when backported bip9 and never cared to fix it (but review is still very welcomed since I plan to rewrite/cherry pick most of the stuff from there)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468395960' id='479366'>
<a class='timestamp' href='#479366'><time timestamp='2016-07-13T07:46:00Z'>07:46</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
my interfaces: <a href="https://github.com/jtimon/bitcoin/commit/c97fa96c2f9e8989b9f1a9dd41688e07bcc163b9#diff-c2a099d775bac1dccc5f146a3cda81b8R82" class="link" target="_blank">https://github.com/jtimon/bitcoin/commit/c97fa96c2f9e8989b9f1a9dd41688e07bcc163b9#diff-c2a099d775bac1dccc5f146a3cda81b8R82</a> <a href="https://github.com/jtimon/bitcoin/commit/34780bd9af20ddf60dd309eff90b9caf01b63f64" class="link" target="_blank">https://github.com/jtimon/bitcoin/commit/34780bd9af20ddf60dd309eff90b9caf01b63f64</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396020' id='479367'>
<a class='timestamp' href='#479367'><time timestamp='2016-07-13T07:47:00Z'>07:47</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
my main problem with interface is that the callback will probably cross language boundary (C++ calling C#) and it is a performance nightmare (but maybe it has gone better now). I&#x27;m not against callback but this has to be coarse grained.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396080' id='479368'>
<a class='timestamp' href='#479368'><time timestamp='2016-07-13T07:48:00Z'>07:48</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
ho I finish my PR I&#x27;ll see when I hit there
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396140' id='479369'>
<a class='timestamp' href='#479369'><time timestamp='2016-07-13T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-9'> KwukDuck</span>&gt;
phantomcircuit: Hardware error? Like what..? I think my hardware is fine? Experiencing no other issues with the system, even tried running it on a different disk.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396140' id='479370'>
<a class='timestamp' href='#479370'><time timestamp='2016-07-13T07:49:00Z'>07:49</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
at least for bitcoin core as a caller (assuming one day bitcoin core directly calls libconsensus instead of its internals) I don&#x27;t see how performance would be affected very negatively, I worry more about serializing and deserialzing the parameters (like the tx in verify) for example, since people have complained (that&#x27;s the reason why libbitcoin copies the code instead of using libconsensus&#x27; API directly)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396200' id='479371'>
<a class='timestamp' href='#479371'><time timestamp='2016-07-13T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
KwukDuck: that kind of issue is usually caused by hardware error, lose or bad disk cables, or bad memory (run memtest86?)-- sometimes antivirus software can screw with the files bitcoin is using.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396200' id='479372'>
<a class='timestamp' href='#479372'><time timestamp='2016-07-13T07:50:00Z'>07:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
NicolasDorier: as said privately, I think people should use the function pointer to call their DB directly, not calling their external language there, but you said that may be complicated too
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396260' id='479373'>
<a class='timestamp' href='#479373'><time timestamp='2016-07-13T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
or running out of disk space potentially.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396260' id='479374'>
<a class='timestamp' href='#479374'><time timestamp='2016-07-13T07:51:00Z'>07:51</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
jtimon: yes, it really depends on the backend technology. Some might have poor support of C lib. :(
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396320' id='479375'>
<a class='timestamp' href='#479375'><time timestamp='2016-07-13T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-9'> KwukDuck</span>&gt;
gmaxwell: I considered a bad disk that&#x27;s why i ran it on another one. Not sure about the memory though, but i&#x27;m not experiencing any other issues so... I guess i&#x27;ll be running memtest later. Thanks :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396320' id='479376'>
<a class='timestamp' href='#479376'><time timestamp='2016-07-13T07:52:00Z'>07:52</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
also I know I&#x27;m not pro in C so it would take me 10 times  more than you to make use of a C lib even if it existed
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396380' id='479377'>
<a class='timestamp' href='#479377'><time timestamp='2016-07-13T07:53:00Z'>07:53</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
on another topic, should utilmoneystr be part of libconsensus only for this line or should we just write the message in satoshis? <a href="https://github.com/bitcoin/bitcoin/pull/8329/files#diff-ca81084f62961a188f5c1e86a5ff1d7cR238" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8329/files#diff-ca81084f62961a188f5c1e86a5ff1d7cR238</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396380' id='479378'>
<a class='timestamp' href='#479378'><time timestamp='2016-07-13T07:53:00Z'>07:53</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
maaku things yes it should be part of libconsensus, I&#x27;m not very convinced
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396500' id='479379'>
<a class='timestamp' href='#479379'><time timestamp='2016-07-13T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
if we&#x27;re sure about it belonging in libconsensus, I should squash <a href="https://github.com/bitcoin/bitcoin/pull/8329/commits/8af7c64f6908ea4526efde9896d046c431016e00" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8329/commits/8af7c64f6908ea4526efde9896d046c431016e00</a> in #8328
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396500' id='479380'>
<a class='timestamp' href='#479380'><time timestamp='2016-07-13T07:55:00Z'>07:55</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
NicolasDorier: thoughts ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396620' id='479381'>
<a class='timestamp' href='#479381'><time timestamp='2016-07-13T07:57:00Z'>07:57</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
checking that a sec
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396680' id='479382'>
<a class='timestamp' href='#479382'><time timestamp='2016-07-13T07:58:00Z'>07:58</time></a>
&lt;<span class='nick nick-7'> NicolasDorier</span>&gt;
jtimon: well, I think the smaller the diff the better, so I am more inclined to keep it for now, but not really strongly neither
<br>
</div>

<div class='talk op-msg' data-timestamp='1468396860' id='479383'>
<a class='timestamp' href='#479383'><time timestamp='2016-07-13T08:01:00Z'>08:01</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, if I keep it and move it to the consensus dir, that actually makes the diff bigger
<br>
</div>

<div class='talk op-msg' data-timestamp='1468405980' id='479384'>
<a class='timestamp' href='#479384'><time timestamp='2016-07-13T10:33:00Z'>10:33</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa, gmaxwell: mind doing a review of <a href="https://github.com/bitcoin/bitcoin/pull/8323" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8323</a>? I&#x27;d like and I think its important to have this in 0.13
<br>
</div>

<div class='talk op-msg' data-timestamp='1468408620' id='479385'>
<a class='timestamp' href='#479385'><time timestamp='2016-07-13T11:17:00Z'>11:17</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa, gmaxwell: maybe you find time to quickly review the BIP151 switch from HMAC_SHA512 &quot;KDF&quot;  to HKDF: <a href="https://github.com/bitcoin/bips/compare/master...jonasschnelli:2016/07/bip151_hkdf?expand=1" class="link" target="_blank">https://github.com/bitcoin/bips/compare/master...jonasschnelli:2016/07/bip151_hkdf?expand=1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468416060' id='479386'>
<a class='timestamp' href='#479386'><time timestamp='2016-07-13T13:21:00Z'>13:21</time></a>
&lt;<span class='nick nick-3'> GitHub12</span>&gt;
[bitcoin] jtimon closed pull request #8328: Consensus: Rename: Move consensus code to the consensus directory (master...0.12.99-consensus-rename) <a href="https://github.com/bitcoin/bitcoin/pull/8328" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8328</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468416360' id='479387'>
<a class='timestamp' href='#479387'><time timestamp='2016-07-13T13:26:00Z'>13:26</time></a>
&lt;<span class='nick nick-10'> GitHub147</span>&gt;
[bitcoin] jtimon reopened pull request #8328: Consensus: Rename: Move consensus code to the consensus directory (master...0.12.99-consensus-rename) <a href="https://github.com/bitcoin/bitcoin/pull/8328" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8328</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468416480' id='479388'>
<a class='timestamp' href='#479388'><time timestamp='2016-07-13T13:28:00Z'>13:28</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
kanzure: NicolasDorier: <a href="https://github.com/bitcoin/bitcoin/pull/8337" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/8337</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468416720' id='479389'>
<a class='timestamp' href='#479389'><time timestamp='2016-07-13T13:32:00Z'>13:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
and I will continue in <a href="https://github.com/jtimon/bitcoin/tree/0.12.99-consensus" class="link" target="_blank">https://github.com/jtimon/bitcoin/tree/0.12.99-consensus</a> but I won&#x27;t open more PRs for now
<br>
</div>

<div class='talk op-msg' data-timestamp='1468427880' id='479390'>
<a class='timestamp' href='#479390'><time timestamp='2016-07-13T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
NicolasDorier: it just occurred to me that you can always implement my function pointers interface by pre-filling memory with whatever data you were counting on passing as a parameter. Therefore it will be trivial to offer the all-data-upfront interface you want while using my more generic API inside. The costs will be to reading the pointer to a function, the function and executed it, but the function should be merely a map from
<br>
</div>

<div class='talk op-msg' data-timestamp='1468427880' id='479391'>
<a class='timestamp' href='#479391'><time timestamp='2016-07-13T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
 your parameters to a pre-filled position in memory. Does that sound accetable to you? no C# inside
<br>
</div>

<div class='talk op-msg' data-timestamp='1468427880' id='479392'>
<a class='timestamp' href='#479392'><time timestamp='2016-07-13T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
we can offer both interfaces with trivial development costs I think, let&#x27;s see
<br>
</div>

<div class='talk op-msg' data-timestamp='1468431120' id='479393'>
<a class='timestamp' href='#479393'><time timestamp='2016-07-13T17:32:00Z'>17:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
just force pushed 0.12.99-consensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1468431180' id='479394'>
<a class='timestamp' href='#479394'><time timestamp='2016-07-13T17:33:00Z'>17:33</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but I will force push again soon
<br>
</div>

<div class='talk op-msg' data-timestamp='1468434600' id='479395'>
<a class='timestamp' href='#479395'><time timestamp='2016-07-13T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-11'> bsm2357</span>&gt;
I expect a common error for people using python-bitcoinlib will be to call SignatureHash with the scriptPubKey of the corresponding segwit input, rather than an actual script.  This is easy to detect, and insert the corresponding script for calculating the sighash, but causes the SignatureHash function to depart from the behavior of the one in core.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468434600' id='479396'>
<a class='timestamp' href='#479396'><time timestamp='2016-07-13T18:30:00Z'>18:30</time></a>
&lt;<span class='nick nick-11'> bsm2357</span>&gt;
What are your opinions?  Is detecting this and inserting the correct script desirable or not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468434780' id='479397'>
<a class='timestamp' href='#479397'><time timestamp='2016-07-13T18:33:00Z'>18:33</time></a>
&lt;<span class='nick nick-11'> bsm2357</span>&gt;
Hmmm.  Taking this question to #bitcoin-dev.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468434840' id='479398'>
<a class='timestamp' href='#479398'><time timestamp='2016-07-13T18:34:00Z'>18:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
bsm2357: perhaps also good to discuss on the repository itself in an issue
<br>
</div>

<div class='talk op-msg' data-timestamp='1468434900' id='479399'>
<a class='timestamp' href='#479399'><time timestamp='2016-07-13T18:35:00Z'>18:35</time></a>
&lt;<span class='nick nick-11'> bsm2357</span>&gt;
Of course.  I&#x27;ll push my latest there soon with a working SignatureHash.  Just looking for some quick feedback from people who might use it, before I go write code.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436580' id='479400'>
<a class='timestamp' href='#479400'><time timestamp='2016-07-13T19:03:00Z'>19:03</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
Is it unusual for nodes to give back one ip address back for a getaddr message?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436700' id='479401'>
<a class='timestamp' href='#479401'><time timestamp='2016-07-13T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we only respond to one getaddr per connection
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436700' id='479402'>
<a class='timestamp' href='#479402'><time timestamp='2016-07-13T19:05:00Z'>19:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
after that, only normal addr relay
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436760' id='479403'>
<a class='timestamp' href='#479403'><time timestamp='2016-07-13T19:06:00Z'>19:06</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
Ok, but it it unusual to respond with only one ip address? The behavior I am seeing is connecting to a node, I send a getaddr message, then I only get ONE ip address back in the addr message
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436820' id='479404'>
<a class='timestamp' href='#479404'><time timestamp='2016-07-13T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
and that ip address is the node&#x27;s ip address. I guess I was under the impression that it would send back the nodes that it is connected to
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436820' id='479405'>
<a class='timestamp' href='#479405'><time timestamp='2016-07-13T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s not responding at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436820' id='479406'>
<a class='timestamp' href='#479406'><time timestamp='2016-07-13T19:07:00Z'>19:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the addr you see is likely just an independently relayed addr
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436880' id='479407'>
<a class='timestamp' href='#479407'><time timestamp='2016-07-13T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hell no, nodes try to hide who they are connected to
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436880' id='479408'>
<a class='timestamp' href='#479408'><time timestamp='2016-07-13T19:08:00Z'>19:08</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: are you still there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468436940' id='479409'>
<a class='timestamp' href='#479409'><time timestamp='2016-07-13T19:09:00Z'>19:09</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
so how do you connect with more than one node on the network then? It seems that you could only connect to dns seeds then. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437000' id='479410'>
<a class='timestamp' href='#479410'><time timestamp='2016-07-13T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t understand the question
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437000' id='479411'>
<a class='timestamp' href='#479411'><time timestamp='2016-07-13T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
normally, you get 1000 IP addresses back in response to getaddr
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437000' id='479412'>
<a class='timestamp' href='#479412'><time timestamp='2016-07-13T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
unless the peer does not know about many, of course
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437000' id='479413'>
<a class='timestamp' href='#479413'><time timestamp='2016-07-13T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
I should preface this with it is testnet, perhaps the behavior is different? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437000' id='479414'>
<a class='timestamp' href='#479414'><time timestamp='2016-07-13T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s very likely that on testnet the peer just does not know about many peers
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437060' id='479415'>
<a class='timestamp' href='#479415'><time timestamp='2016-07-13T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437060' id='479416'>
<a class='timestamp' href='#479416'><time timestamp='2016-07-13T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
also, if you send getaddr multiple times, the second and later times it is just ignored
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437060' id='479417'>
<a class='timestamp' href='#479417'><time timestamp='2016-07-13T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: great. I want to discuss with you about the libconsensus that you are working on.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437060' id='479418'>
<a class='timestamp' href='#479418'><time timestamp='2016-07-13T19:11:00Z'>19:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
it&#x27;s a great project. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437120' id='479419'>
<a class='timestamp' href='#479419'><time timestamp='2016-07-13T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: absolutely, always interested in discussing that
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437120' id='479420'>
<a class='timestamp' href='#479420'><time timestamp='2016-07-13T19:12:00Z'>19:12</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: I found that out the hard way :-). But it seems unlikely that a response to a getaddr message would have just ONE ip address even on testnet, right? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437180' id='479421'>
<a class='timestamp' href='#479421'><time timestamp='2016-07-13T19:13:00Z'>19:13</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
my I know when this will be merged into the master branch?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437240' id='479422'>
<a class='timestamp' href='#479422'><time timestamp='2016-07-13T19:14:00Z'>19:14</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: right now the longest branch I have is <a href="https://github.com/jtimon/bitcoin/tree/0.12.99-consensus" class="link" target="_blank">https://github.com/jtimon/bitcoin/tree/0.12.99-consensus</a> but I still have things to cherry pick from <a href="https://github.com/jtimon/bitcoin/commits/jt" class="link" target="_blank">https://github.com/jtimon/bitcoin/commits/jt</a> (plus some things that will just have to be new)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437300' id='479423'>
<a class='timestamp' href='#479423'><time timestamp='2016-07-13T19:15:00Z'>19:15</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: uff, no idea myself, I wish I knew, I believe the idea is focusing on refactors like this and the ones going on in net.o and wallet right after forking 0.13&#x27;s branch, which should be soon
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437360' id='479424'>
<a class='timestamp' href='#479424'><time timestamp='2016-07-13T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
whether the PRs will be merged or not, I cannot know, depends on review
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437360' id='479425'>
<a class='timestamp' href='#479425'><time timestamp='2016-07-13T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
does libconsensus include the wallet and the network parts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437360' id='479426'>
<a class='timestamp' href='#479426'><time timestamp='2016-07-13T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
no
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437360' id='479427'>
<a class='timestamp' href='#479427'><time timestamp='2016-07-13T19:16:00Z'>19:16</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but there&#x27;s other people doing refactors both in the net and wallet parts
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437420' id='479428'>
<a class='timestamp' href='#479428'><time timestamp='2016-07-13T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
ie cfields and jonasschnelli respectively
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437420' id='479429'>
<a class='timestamp' href='#479429'><time timestamp='2016-07-13T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i think on machines with a lot of cores, the sig cache actually slows down block validation.   my guess is its the contention on the lock since we erase every time
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437420' id='479430'>
<a class='timestamp' href='#479430'><time timestamp='2016-07-13T19:17:00Z'>19:17</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: i think it might be better to batch erase, or randomly erase or something else
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437480' id='479431'>
<a class='timestamp' href='#479431'><time timestamp='2016-07-13T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: i&#x27;ve scratched my head at that one several times. seems we&#x27;d be better off nuking a bucket at a time or so
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437480' id='479432'>
<a class='timestamp' href='#479432'><time timestamp='2016-07-13T19:18:00Z'>19:18</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: cool. so all the code in libconsensus is in this directory <a href="https://github.com/jtimon/bitcoin/tree/0.12.99-consensus/src/consensus" class="link" target="_blank">https://github.com/jtimon/bitcoin/tree/0.12.99-consensus/src/consensus</a>, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437540' id='479433'>
<a class='timestamp' href='#479433'><time timestamp='2016-07-13T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: it defaults to nuking a bucket at a time if it gets full anyway (although i&#x27;m not sure thats super efficient either, but that tends to happen in ATMP, so who cares)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437540' id='479434'>
<a class='timestamp' href='#479434'><time timestamp='2016-07-13T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
morcos: I once tried with a huge sigcache just to see if the swap partition was working. didn&#x27;t benchmarked but it certainly didn&#x27;t seem to accelerate things
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437540' id='479435'>
<a class='timestamp' href='#479435'><time timestamp='2016-07-13T19:19:00Z'>19:19</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: eh? i thought it just killed a single entry each time
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437600' id='479436'>
<a class='timestamp' href='#479436'><time timestamp='2016-07-13T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: no, there&#x27;s still some in main.cpp, but the idea it&#x27;s that it all should end up there (without counting the code in src/crypto and libsecp256k1)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437600' id='479437'>
<a class='timestamp' href='#479437'><time timestamp='2016-07-13T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: looks to me like it just picks a random bucket and removes the first entry in it. am i misreading?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437600' id='479438'>
<a class='timestamp' href='#479438'><time timestamp='2016-07-13T19:20:00Z'>19:20</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: the problem i&#x27;m referring to is that on validating a block, you erase each stored signature as you read it
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437660' id='479439'>
<a class='timestamp' href='#479439'><time timestamp='2016-07-13T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but yes, if it&#x27;s gotten to big anyway, then it&#x27;ll pick a random bucket and remove entires until its below the limit, but isn&#x27;t that what you said?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437660' id='479440'>
<a class='timestamp' href='#479440'><time timestamp='2016-07-13T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I will keep updating jtimon/0.12.99-consensus moving more things there though
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437660' id='479441'>
<a class='timestamp' href='#479441'><time timestamp='2016-07-13T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: I guess most of the work has already been done?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437660' id='479442'>
<a class='timestamp' href='#479442'><time timestamp='2016-07-13T19:21:00Z'>19:21</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: also you said it can relay 1000 addresses at a time, doesn&#x27;t that effectively give a history of the nodes they are connected to?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479443'>
<a class='timestamp' href='#479443'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the second thing happens when trying to set a new entry, which is in ATMP, so not important to shave micros... as it is in block validation
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479444'>
<a class='timestamp' href='#479444'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Chris_Stewart_5: nodes typically know way more 1000 addresses
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479445'>
<a class='timestamp' href='#479445'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Chris_Stewart_5: and typically know of many addresses they are not currently, or even never have been, connected to
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479446'>
<a class='timestamp' href='#479446'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: So basically caching addresses from addr messages?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479447'>
<a class='timestamp' href='#479447'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Chris_Stewart_5: yes, and from dns seed responses
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437720' id='479448'>
<a class='timestamp' href='#479448'><time timestamp='2016-07-13T19:22:00Z'>19:22</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
unsolicited ones
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437780' id='479449'>
<a class='timestamp' href='#479449'><time timestamp='2016-07-13T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Chris_Stewart_5: that&#x27;s addrman
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437780' id='479450'>
<a class='timestamp' href='#479450'><time timestamp='2016-07-13T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: ah yes, i was talking about the full case
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437780' id='479451'>
<a class='timestamp' href='#479451'><time timestamp='2016-07-13T19:23:00Z'>19:23</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: we plan to prove the correctness of the consensus part.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437840' id='479452'>
<a class='timestamp' href='#479452'><time timestamp='2016-07-13T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: again, correctness compared to which specification?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437840' id='479453'>
<a class='timestamp' href='#479453'><time timestamp='2016-07-13T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
cfields: yeah the problem is lock contention on validation since each of your script validating cores is contending on the sig cache lock since they each have to erase from it.  if you eliminate or batch those erases, it speeds up validation significantly
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437840' id='479454'>
<a class='timestamp' href='#479454'><time timestamp='2016-07-13T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: well, the part of making a complete verifyBlock, I would say it has been done several times. exposing it as a C API is another thing, specially since probably the APIs will be discussed extensively (plus I never decoupled Consensus::Params from uint256)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437840' id='479455'>
<a class='timestamp' href='#479455'><time timestamp='2016-07-13T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
morcos: interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437840' id='479456'>
<a class='timestamp' href='#479456'><time timestamp='2016-07-13T19:24:00Z'>19:24</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: as discussed, we are going to derive a specification from the code.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479457'>
<a class='timestamp' href='#479457'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479458'>
<a class='timestamp' href='#479458'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: a specification derived from the code will by definition match the code, no? :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479459'>
<a class='timestamp' href='#479459'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: Is there documentation for addrman any where? Doesn&#x27;t seem to be in the p2p networking part: <a href="https://bitcoin.org/en/developer-reference#p2p-network" class="link" target="_blank">https://bitcoin.org/en/developer-reference#p2p-network</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479460'>
<a class='timestamp' href='#479460'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
Chris_Stewart_5: in addrman.h :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479461'>
<a class='timestamp' href='#479461'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: I guess the goal is that from then on you can&#x27;t change the code without appropriately changing the specifications or the tests will fail
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479462'>
<a class='timestamp' href='#479462'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jtimon, xinxi_: yes, that would be awesome
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437900' id='479463'>
<a class='timestamp' href='#479463'><time timestamp='2016-07-13T19:25:00Z'>19:25</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: hmm. ignoring larger fixes, if the contention is that high, i wonder if the shared lock is doing more harm than good
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479464'>
<a class='timestamp' href='#479464'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: i would say it&#x27;s going to match the code as much as possible unless we find bugs/inconsistencies in the specification. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479465'>
<a class='timestamp' href='#479465'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: then the specification is wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479466'>
<a class='timestamp' href='#479466'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
hehe
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479467'>
<a class='timestamp' href='#479467'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(but it would still be very interesting to know)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479468'>
<a class='timestamp' href='#479468'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the specification is clearly my branch
<br>
</div>

<div class='talk op-msg' data-timestamp='1468437960' id='479469'>
<a class='timestamp' href='#479469'><time timestamp='2016-07-13T19:26:00Z'>19:26</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: yeah, as discussed, we don&#x27;t want to have a specification with flaws or bugs. if we find that, we should upgrade.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438020' id='479470'>
<a class='timestamp' href='#479470'><time timestamp='2016-07-13T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: i think you&#x27;re dreaming if you think that&#x27;s going to happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438020' id='479471'>
<a class='timestamp' href='#479471'><time timestamp='2016-07-13T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: on my 16 core machine, i think it speeds up the &quot;Connect total&quot; part by about 40% to just not erase..   But I didnt&#x27; run that over a long enough period to model the lower hit rate that&#x27;ll eventually result from not having smart erasing.  If we can conveniently batch the erases from the block that&#x27;ll be best
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438020' id='479472'>
<a class='timestamp' href='#479472'><time timestamp='2016-07-13T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: why is that?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438020' id='479473'>
<a class='timestamp' href='#479473'><time timestamp='2016-07-13T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
a hard fork is not possible?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438020' id='479474'>
<a class='timestamp' href='#479474'><time timestamp='2016-07-13T19:27:00Z'>19:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: because i expect a hard fork to switch to something with only theoretical advantages to be very controversial
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438080' id='479475'>
<a class='timestamp' href='#479475'><time timestamp='2016-07-13T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: well, we will definitely test that first.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438080' id='479476'>
<a class='timestamp' href='#479476'><time timestamp='2016-07-13T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
morcos: whoa
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438080' id='479477'>
<a class='timestamp' href='#479477'><time timestamp='2016-07-13T19:28:00Z'>19:28</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: yes, but a hardfork doesn&#x27;t magically get deployed in all computers when you update the specification, whatever is deployed is the specification in practice
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438140' id='479478'>
<a class='timestamp' href='#479478'><time timestamp='2016-07-13T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: not trying to discourage you... i would be very exciting if you can contribute to the correctness of the system using formal proofs, at whatever level
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438140' id='479479'>
<a class='timestamp' href='#479479'><time timestamp='2016-07-13T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: but please... keep it about analysing the actual code
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438140' id='479480'>
<a class='timestamp' href='#479480'><time timestamp='2016-07-13T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*excited
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438140' id='479481'>
<a class='timestamp' href='#479481'><time timestamp='2016-07-13T19:29:00Z'>19:29</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: the actual code is in C++, which is almost impossible to prove.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438200' id='479482'>
<a class='timestamp' href='#479482'><time timestamp='2016-07-13T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
if you rewrite it in C, we may be able to help.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438200' id='479483'>
<a class='timestamp' href='#479483'><time timestamp='2016-07-13T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
even that has been controversial in the past
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438200' id='479484'>
<a class='timestamp' href='#479484'><time timestamp='2016-07-13T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: in the end the new tests are going to fail when you change either the specification or the implementation, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438200' id='479485'>
<a class='timestamp' href='#479485'><time timestamp='2016-07-13T19:30:00Z'>19:30</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: what do you mean by failure?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438260' id='479486'>
<a class='timestamp' href='#479486'><time timestamp='2016-07-13T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: you could of course do a rewrite in C, and analyse that... we could learn very interesting things from that
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438260' id='479487'>
<a class='timestamp' href='#479487'><time timestamp='2016-07-13T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: but that still doesn&#x27;t mean we need to actually switch to that C code
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438260' id='479488'>
<a class='timestamp' href='#479488'><time timestamp='2016-07-13T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
if you changed the specification, sipa was right, the bug was there, if you change the implementation but you were&#x27;t expecting change in funtionality, then your changes are wrong
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438260' id='479489'>
<a class='timestamp' href='#479489'><time timestamp='2016-07-13T19:31:00Z'>19:31</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: how did you guys fix bugs in the past I am wondering.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479490'>
<a class='timestamp' href='#479490'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: soft forks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479491'>
<a class='timestamp' href='#479491'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so you just leave the bugs there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479492'>
<a class='timestamp' href='#479492'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
let me search for a ccc talk about what I&#x27;m thinking you wanted to do
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479493'>
<a class='timestamp' href='#479493'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: if they&#x27;re not dangerous and merely annoying.. yes, we have no other choice
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479494'>
<a class='timestamp' href='#479494'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: no, sipa answered: softforks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479495'>
<a class='timestamp' href='#479495'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: we don&#x27;t decide the rules of the network
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438320' id='479496'>
<a class='timestamp' href='#479496'><time timestamp='2016-07-13T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
OK. so can we just deploy the slightly different bug free version using a soft fork?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438380' id='479497'>
<a class='timestamp' href='#479497'><time timestamp='2016-07-13T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438380' id='479498'>
<a class='timestamp' href='#479498'><time timestamp='2016-07-13T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that depends on the kind of changes you want to make
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438380' id='479499'>
<a class='timestamp' href='#479499'><time timestamp='2016-07-13T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
for example, the code in bip99 fixes a known bug which is not a priority
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438380' id='479500'>
<a class='timestamp' href='#479500'><time timestamp='2016-07-13T19:33:00Z'>19:33</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
but that fix is a hardfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438440' id='479501'>
<a class='timestamp' href='#479501'><time timestamp='2016-07-13T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so can you explain to me what kind of changes require a soft fork and what kind of changes require a hard fork?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438440' id='479502'>
<a class='timestamp' href='#479502'><time timestamp='2016-07-13T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
and what&#x27;s the difference between the hard and soft forks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438440' id='479503'>
<a class='timestamp' href='#479503'><time timestamp='2016-07-13T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: everything that leaves things that were previously invalid invalid is a softfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438500' id='479504'>
<a class='timestamp' href='#479504'><time timestamp='2016-07-13T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
how do you define invalid?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438500' id='479505'>
<a class='timestamp' href='#479505'><time timestamp='2016-07-13T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
meh, can&#x27;t find the ccc video about proving correctness, I though you were coming from there
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438500' id='479506'>
<a class='timestamp' href='#479506'><time timestamp='2016-07-13T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: abstractly speaking, the consensus rules are black box which you feed a sequence of blocks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438500' id='479507'>
<a class='timestamp' href='#479507'><time timestamp='2016-07-13T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: and it returns whether that sequence of blocks is valid or not
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438500' id='479508'>
<a class='timestamp' href='#479508'><time timestamp='2016-07-13T19:35:00Z'>19:35</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
their &quot;specification&quot; was basically another program for an abstract machine
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438560' id='479509'>
<a class='timestamp' href='#479509'><time timestamp='2016-07-13T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it cannot depend on the order in which those blocks were received, or whatever earlier states the node went through
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438560' id='479510'>
<a class='timestamp' href='#479510'><time timestamp='2016-07-13T19:36:00Z'>19:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: a softfork leaves all previously invalid inputs invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438620' id='479511'>
<a class='timestamp' href='#479511'><time timestamp='2016-07-13T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so a soft fork can only invalid a previously valid input.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438620' id='479512'>
<a class='timestamp' href='#479512'><time timestamp='2016-07-13T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
correct
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438620' id='479513'>
<a class='timestamp' href='#479513'><time timestamp='2016-07-13T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
or in other words, it only add restrictions, doesn&#x27;t remove them: everything that was invalid remains invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438620' id='479514'>
<a class='timestamp' href='#479514'><time timestamp='2016-07-13T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
xinxi_: You can think of the set of all consensus rules R with cardinality n, a soft fork increments the cardinality of R one. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479515'>
<a class='timestamp' href='#479515'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
and a hard fork has no such restriction.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479516'>
<a class='timestamp' href='#479516'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
xinxi_: Any removal from the set R is a hard fork though 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479517'>
<a class='timestamp' href='#479517'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
xinxi_: the whole purpose of the system it to come to a consistent worldwide agreement on the history of the ledger. This is the first and foremost definition of correctness in the system.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479518'>
<a class='timestamp' href='#479518'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: and it&#x27;s very surprising how many things are actually possible with softforks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479519'>
<a class='timestamp' href='#479519'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: sure, i can imaging that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438680' id='479520'>
<a class='timestamp' href='#479520'><time timestamp='2016-07-13T19:38:00Z'>19:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: one analogy is seeing the consensus rules a block of marble from which pieces are cut away that give the complexity
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438740' id='479521'>
<a class='timestamp' href='#479521'><time timestamp='2016-07-13T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so how do hard forks and soft forks differ in terms of deployment?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438740' id='479522'>
<a class='timestamp' href='#479522'><time timestamp='2016-07-13T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
some people theorize that everything that is possible via hardfork is also possible via softfork in some other way, but I&#x27;m not convinced that means we should always prefer softforks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438740' id='479523'>
<a class='timestamp' href='#479523'><time timestamp='2016-07-13T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a hard fork: convince the whole world to switch to different code; period
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438740' id='479524'>
<a class='timestamp' href='#479524'><time timestamp='2016-07-13T19:39:00Z'>19:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a soft fork: read BIP34 and BIP9
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438800' id='479525'>
<a class='timestamp' href='#479525'><time timestamp='2016-07-13T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(BIP9 is newer)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438800' id='479526'>
<a class='timestamp' href='#479526'><time timestamp='2016-07-13T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
has any hard fork happened?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438800' id='479527'>
<a class='timestamp' href='#479527'><time timestamp='2016-07-13T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
very early on in the history of the system, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438800' id='479528'>
<a class='timestamp' href='#479528'><time timestamp='2016-07-13T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in the first 1.5 years
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438800' id='479529'>
<a class='timestamp' href='#479529'><time timestamp='2016-07-13T19:40:00Z'>19:40</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: for softforks miners need to coordinate for deployment, then other nodes can upgrade when they want/can. for hardforks everybody needs to upgrade before deployment, which makes them slower to deploy
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438860' id='479530'>
<a class='timestamp' href='#479530'><time timestamp='2016-07-13T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: there is also BIP50 which is a post-mortem of a consensus failure that occurred between old and new versions of the system
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438860' id='479531'>
<a class='timestamp' href='#479531'><time timestamp='2016-07-13T19:41:00Z'>19:41</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: how can you upgrade without deployment? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479532'>
<a class='timestamp' href='#479532'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
basically, you can automatically activate when a certain height is reached?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479533'>
<a class='timestamp' href='#479533'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: softforks only apply new rules to blocks after some changeover point
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479534'>
<a class='timestamp' href='#479534'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
they use old rules for everything before
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479535'>
<a class='timestamp' href='#479535'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: yeah, you&#x27;ve explained that well.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479536'>
<a class='timestamp' href='#479536'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BIP30 used a fixed timestamp for the changeover point
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438920' id='479537'>
<a class='timestamp' href='#479537'><time timestamp='2016-07-13T19:42:00Z'>19:42</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: for softforks bip9 describes it, for hardforks there&#x27;s different opinions on what would be the best way to signal activation
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438980' id='479538'>
<a class='timestamp' href='#479538'><time timestamp='2016-07-13T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
jtimon: got it.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468438980' id='479539'>
<a class='timestamp' href='#479539'><time timestamp='2016-07-13T19:43:00Z'>19:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BIP34 used block versions above a certain number to let miners indicate they are enforcing the new rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439040' id='479540'>
<a class='timestamp' href='#479540'><time timestamp='2016-07-13T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so who makes the final decision on whether a fork should be deployed or not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439040' id='479541'>
<a class='timestamp' href='#479541'><time timestamp='2016-07-13T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: for a soft fork: miners
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439040' id='479542'>
<a class='timestamp' href='#479542'><time timestamp='2016-07-13T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as it&#x27;s really just miners deciding to start enforcing some additional rules in addition to what the network requires them to
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439040' id='479543'>
<a class='timestamp' href='#479543'><time timestamp='2016-07-13T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
for a hard fork: politics
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439040' id='479544'>
<a class='timestamp' href='#479544'><time timestamp='2016-07-13T19:44:00Z'>19:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(let&#x27;s not go there)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479545'>
<a class='timestamp' href='#479545'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
the politics between whom?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479546'>
<a class='timestamp' href='#479546'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
xinxi_: here&#x27;s a few different ways to coordinate activation, the last 3 in there use bip 9 : <a href="https://github.com/jtimon/bitcoin/blob/0.12.99-consensus/src/consensus/versionbits.cpp#L172" class="link" target="_blank">https://github.com/jtimon/bitcoin/blob/0.12.99-consensus/src/consensus/versionbits.cpp#L172</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479547'>
<a class='timestamp' href='#479547'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
I think it&#x27;s better to clarify things.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479548'>
<a class='timestamp' href='#479548'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: a hard fork is arguably the creation of a new currency for starters...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479549'>
<a class='timestamp' href='#479549'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-7'> sturles</span>&gt;
xinxi_: All bitcoin users.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439100' id='479550'>
<a class='timestamp' href='#479550'><time timestamp='2016-07-13T19:45:00Z'>19:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: some people believe developers or some committee should decide on hard forks, and then assume everyone will follow them
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439160' id='479551'>
<a class='timestamp' href='#479551'><time timestamp='2016-07-13T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: others think hard forks should be reserved for clearly uncontroversial things
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439160' id='479552'>
<a class='timestamp' href='#479552'><time timestamp='2016-07-13T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
is there any democratic decision making process?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439160' id='479553'>
<a class='timestamp' href='#479553'><time timestamp='2016-07-13T19:46:00Z'>19:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
democracy is pretty hard in a system designed to avoid fixed identities
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479554'>
<a class='timestamp' href='#479554'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: there&#x27;s no agreement on what a &quot;democratic decision making process&quot; even looks like
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479555'>
<a class='timestamp' href='#479555'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
bip2 tries to clarify things, but it can only decided on whether something was &quot;accepted&quot; or not observing adoption a posteriori. BIP99 also tries to clarify things, but it&#x27;s based on a vaguely defined concept of &quot;uncontroversial&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479556'>
<a class='timestamp' href='#479556'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: sybil attack.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479557'>
<a class='timestamp' href='#479557'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: whose votes do you count? miner-triggered soft-forks at least have a natural metric: hashing power
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479558'>
<a class='timestamp' href='#479558'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
15:43 &lt; sipa&gt; xinxi_: for a soft fork: miners
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479559'>
<a class='timestamp' href='#479559'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
then, can we just let miners vote?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439220' id='479560'>
<a class='timestamp' href='#479560'><time timestamp='2016-07-13T19:47:00Z'>19:47</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
^ this is not correct, users have to adopt the rules as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479561'>
<a class='timestamp' href='#479561'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
but please, this discussion should be elsewhere
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479562'>
<a class='timestamp' href='#479562'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
I wouldn&#x27;t call that a vote, but just confirmation that they have upgraded
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479563'>
<a class='timestamp' href='#479563'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
for coordination
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479564'>
<a class='timestamp' href='#479564'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: miners should absolutely not be allowed to decide on hardforks (they could for example decide to increase their own reward that way)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479565'>
<a class='timestamp' href='#479565'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
the softfork is supposed to be uncontroversial in the first place
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479566'>
<a class='timestamp' href='#479566'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: why not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479567'>
<a class='timestamp' href='#479567'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: &quot;why not?&quot; is a political question...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439280' id='479568'>
<a class='timestamp' href='#479568'><time timestamp='2016-07-13T19:48:00Z'>19:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: &quot;who watches the watchmen?&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479569'>
<a class='timestamp' href='#479569'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
xinxi_: probably discuss this on #bitcoin
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479570'>
<a class='timestamp' href='#479570'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
sipa: not only they shouldn&#x27;t not be allowed but they have no power over hardforks in practice, &quot;should&quot; or &quot;shouldn&#x27;t&quot; is irrelevant here
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479571'>
<a class='timestamp' href='#479571'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: they&#x27;re called consensus rules because every user in the system choose to accept them
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479572'>
<a class='timestamp' href='#479572'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: sure. that&#x27;s a good reason.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479573'>
<a class='timestamp' href='#479573'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree, this is getting off topic
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439340' id='479574'>
<a class='timestamp' href='#479574'><time timestamp='2016-07-13T19:49:00Z'>19:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sorry
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479575'>
<a class='timestamp' href='#479575'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
yep, sorry, #bitcoin I guess
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479576'>
<a class='timestamp' href='#479576'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
well, it&#x27;s not off topic actually.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479577'>
<a class='timestamp' href='#479577'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> jtimon</span>&gt;
well, it&#x27;s not really development
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479578'>
<a class='timestamp' href='#479578'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it is off topic for the developer of bitcoin core, which is what this channel is about
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479579'>
<a class='timestamp' href='#479579'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
i need to make sure that tremendous amount of effort that could make Bitcoin even greater will be deployed.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439400' id='479580'>
<a class='timestamp' href='#479580'><time timestamp='2016-07-13T19:50:00Z'>19:50</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: I&#x27;d suggest you take that kind of discussion to #bitcoin-wizards at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439460' id='479581'>
<a class='timestamp' href='#479581'><time timestamp='2016-07-13T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: if your tremendous amount of effort requires a hard fork, the answer is that nobody can promise you it will happen
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439460' id='479582'>
<a class='timestamp' href='#479582'><time timestamp='2016-07-13T19:51:00Z'>19:51</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
if there is no certainty but extremely high risk, we will just have to give up.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439520' id='479583'>
<a class='timestamp' href='#479583'><time timestamp='2016-07-13T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: i think there are very interesting things you can do if you aim at something a bit less ambitious than proofs about the entire consensus system
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439520' id='479584'>
<a class='timestamp' href='#479584'><time timestamp='2016-07-13T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: if you want certainty, then yes, I&#x27;d suggest you give up. but I&#x27;d prefer you took sipa&#x27;s advice
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439520' id='479585'>
<a class='timestamp' href='#479585'><time timestamp='2016-07-13T19:52:00Z'>19:52</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: so you mean i should at least try no matter what the result is?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439580' id='479586'>
<a class='timestamp' href='#479586'><time timestamp='2016-07-13T19:53:00Z'>19:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: you can focus on for example just a scripting language... rewriting that part in C would not be very hard, and the result could be very interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439640' id='479587'>
<a class='timestamp' href='#479587'><time timestamp='2016-07-13T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: I&#x27;m just saying, that anything that for any work you do that may require a hard-fork to deploy, you should accept that you may need to create a new currency, economically distint from bitcoin, to deploy your work in production
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439640' id='479588'>
<a class='timestamp' href='#479588'><time timestamp='2016-07-13T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
proofs about its complexity, memory usage, equivalence after certain changes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439640' id='479589'>
<a class='timestamp' href='#479589'><time timestamp='2016-07-13T19:54:00Z'>19:54</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: whereas if you want high certainty of being able to deploy your work in production on bitcoin, you&#x27;ll need to set your sights lower to thinks that can be done in a soft-fork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479590'>
<a class='timestamp' href='#479590'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: complexity, memory usage, etc are certainly important but not the most critical thing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479591'>
<a class='timestamp' href='#479591'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: also, we can always propose a softfork that effectively delegates validation under certain conditions to a completely new scripting language
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479592'>
<a class='timestamp' href='#479592'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: for example basically all my scalability research is stuff that I do knowing full well that it may never be able to be deployed on bitcoin
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479593'>
<a class='timestamp' href='#479593'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
sipa: Does it make any sense at all that a dns seed on testnet would only relay one addr from a getaddr message? Sorry if answered already but I&#x27;m still unclear on this
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479594'>
<a class='timestamp' href='#479594'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: which can be implemented in a different language
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439700' id='479595'>
<a class='timestamp' href='#479595'><time timestamp='2016-07-13T19:55:00Z'>19:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: BIP143 (which we&#x27;re in the process of finished up) makes that very easy
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439760' id='479596'>
<a class='timestamp' href='#479596'><time timestamp='2016-07-13T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: it&#x27;s effectively designed to allow new scripting language to be plugged in in a softfork compatible way
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439760' id='479597'>
<a class='timestamp' href='#479597'><time timestamp='2016-07-13T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: do you have a fulltime job?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439760' id='479598'>
<a class='timestamp' href='#479598'><time timestamp='2016-07-13T19:56:00Z'>19:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: there are people working on thinking about improvements that could be made in a new scripting language
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479599'>
<a class='timestamp' href='#479599'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: and for that, all options are open
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479600'>
<a class='timestamp' href='#479600'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: why does a scripting language make a difference? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479601'>
<a class='timestamp' href='#479601'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: I&#x27;m a consultant, who works pretty much full time on contracts in this space (including Bitcoin Core development contracts)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479602'>
<a class='timestamp' href='#479602'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: by &#x27;scripting&#x27; we mean bitcoin Script here, which is the language used inside transaction outputs to describe the condition under which they can be spent
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479603'>
<a class='timestamp' href='#479603'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: it&#x27;s not scripting as in bash or python
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439820' id='479604'>
<a class='timestamp' href='#479604'><time timestamp='2016-07-13T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: So Bitcoin Core developers get paid?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439880' id='479605'>
<a class='timestamp' href='#479605'><time timestamp='2016-07-13T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s a bytecode language inspired by Forth
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439880' id='479606'>
<a class='timestamp' href='#479606'><time timestamp='2016-07-13T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: and arguable, the implementation of that language interpreter is the most complicated piece of the consensus rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439880' id='479607'>
<a class='timestamp' href='#479607'><time timestamp='2016-07-13T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: many do - there&#x27;s no &quot;bitcoin foundation&quot; that pays core developers, but there&#x27;s lots of ways to get paid
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439880' id='479608'>
<a class='timestamp' href='#479608'><time timestamp='2016-07-13T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: yeah, i know what you are talking about. but doesn&#x27;t that require a hard fork?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439880' id='479609'>
<a class='timestamp' href='#479609'><time timestamp='2016-07-13T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: nope!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439940' id='479610'>
<a class='timestamp' href='#479610'><time timestamp='2016-07-13T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: (there is a &quot;bitcoin foundation&quot;, but they don&#x27;t pay anyone, and are essentially bankrupt last I checked)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439940' id='479611'>
<a class='timestamp' href='#479611'><time timestamp='2016-07-13T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: the basic idea is that we can redefine some of the remaining NOP opcodes in the language
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439940' id='479612'>
<a class='timestamp' href='#479612'><time timestamp='2016-07-13T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: it goes further than that, but it would lead me to far to explain it all here
<br>
</div>

<div class='talk op-msg' data-timestamp='1468439940' id='479613'>
<a class='timestamp' href='#479613'><time timestamp='2016-07-13T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: i know what you mean.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440000' id='479614'>
<a class='timestamp' href='#479614'><time timestamp='2016-07-13T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and redefining NOPs can be done as a softfork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440000' id='479615'>
<a class='timestamp' href='#479615'><time timestamp='2016-07-13T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(as can the new script versions introduced by BIP143)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440000' id='479616'>
<a class='timestamp' href='#479616'><time timestamp='2016-07-13T20:00:00Z'>20:00</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
sipa: you invalid more blocks syntatically, but you add more semantics.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440060' id='479617'>
<a class='timestamp' href='#479617'><time timestamp='2016-07-13T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: we basically take a particular script whose meaning was &quot;anyone can spend this&quot;, and replace it with a new meaning
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440060' id='479618'>
<a class='timestamp' href='#479618'><time timestamp='2016-07-13T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
aka moving to a new piece of marable
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440060' id='479619'>
<a class='timestamp' href='#479619'><time timestamp='2016-07-13T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
marble
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440120' id='479620'>
<a class='timestamp' href='#479620'><time timestamp='2016-07-13T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
now I also have a feeling that softforks can solve all problems.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440120' id='479621'>
<a class='timestamp' href='#479621'><time timestamp='2016-07-13T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
to give an extreme example... we can switch to a different proof of work function using softforks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440180' id='479622'>
<a class='timestamp' href='#479622'><time timestamp='2016-07-13T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: explain :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440180' id='479623'>
<a class='timestamp' href='#479623'><time timestamp='2016-07-13T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(in a hacky way that likely wouldn&#x27;t actually work, as it would go against the interest of miners who decide on softforks...)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479624'>
<a class='timestamp' href='#479624'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
petertodd: define a height-dependent function that maps difficulty of the old PoW to difficulty of the new one
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479625'>
<a class='timestamp' href='#479625'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
petertodd: now demand that every block satisfies both PoWs
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479626'>
<a class='timestamp' href='#479626'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and choose the function so that the difficulty of the old one becomes almost irrelevant over time
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479627'>
<a class='timestamp' href='#479627'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: eh... that&#x27;s not &quot;switching&quot; to a different PoW, that&#x27;s additing an additional PoW
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479628'>
<a class='timestamp' href='#479628'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-15'> Chris_Stewart_5</span>&gt;
interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440240' id='479629'>
<a class='timestamp' href='#479629'><time timestamp='2016-07-13T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
of course... in a softfork we can by definition only &#x27;add&#x27; rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440300' id='479630'>
<a class='timestamp' href='#479630'><time timestamp='2016-07-13T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but in practice it would mean switching
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440300' id='479631'>
<a class='timestamp' href='#479631'><time timestamp='2016-07-13T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(this is a contrived example, and not something i&#x27;d ever actually propose)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440300' id='479632'>
<a class='timestamp' href='#479632'><time timestamp='2016-07-13T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: also, I&#x27;m not sure I&#x27;d want to call that a soft-fork, given that the cost for an attacker to attack old clients goes down to zero - I&#x27;d limit the use of the term &quot;soft-fork&quot; to things that retain lite-client level security for non-adopting clients indefinitely
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440360' id='479633'>
<a class='timestamp' href='#479633'><time timestamp='2016-07-13T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: example: the switch to most-work-chain from bitcoin 0.1&#x27;s longest-chain rule is something I&#x27;d definitely call a hard-fork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440360' id='479634'>
<a class='timestamp' href='#479634'><time timestamp='2016-07-13T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
petertodd: fair point
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440360' id='479635'>
<a class='timestamp' href='#479635'><time timestamp='2016-07-13T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
interesting... i&#x27;m not sure i would see the chain selection rule as a part of consensus
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440360' id='479636'>
<a class='timestamp' href='#479636'><time timestamp='2016-07-13T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
I certainly would!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440360' id='479637'>
<a class='timestamp' href='#479637'><time timestamp='2016-07-13T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;s necessary for convergence... but many things are necessary for convergence, like a working p2p system
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440420' id='479638'>
<a class='timestamp' href='#479638'><time timestamp='2016-07-13T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
about soft fork, can you explain to me how it gets deployed and why we can only be more restrictive? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440420' id='479639'>
<a class='timestamp' href='#479639'><time timestamp='2016-07-13T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: read BIP9 about how to deploy it
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440480' id='479640'>
<a class='timestamp' href='#479640'><time timestamp='2016-07-13T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
I could make the chain selection rule be &quot;only headers whose merkle-root end with the byte string &#x27;peter todd&#x27;&quot;, and we&#x27;d quickly e in a situation where far less than 50% of hashing power is sufficient to attack non-adopting clients
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440480' id='479641'>
<a class='timestamp' href='#479641'><time timestamp='2016-07-13T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: why we can only be more restrictive... so that all rules demanded by old nodes remain satisfied by the majority of the hash rate
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440480' id='479642'>
<a class='timestamp' href='#479642'><time timestamp='2016-07-13T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: _exactly_: your example fails the &quot;majority of the hash rate&quot; condition
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440480' id='479643'>
<a class='timestamp' href='#479643'><time timestamp='2016-07-13T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
petertodd: interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440480' id='479644'>
<a class='timestamp' href='#479644'><time timestamp='2016-07-13T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440540' id='479645'>
<a class='timestamp' href='#479645'><time timestamp='2016-07-13T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it is a validation-rule-more-restrictive change then, but not a soft forking change
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440540' id='479646'>
<a class='timestamp' href='#479646'><time timestamp='2016-07-13T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: having said that, I think we need a new term for the case where a hard-fork is introduced gradually; maybe staged hard-fork? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479647'>
<a class='timestamp' href='#479647'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we should name the different types of consensus rule changes after pokemon
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479648'>
<a class='timestamp' href='#479648'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> * sipa</span>&gt;
hides
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479649'>
<a class='timestamp' href='#479649'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
Ha, I see the key is backward compatibility.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479650'>
<a class='timestamp' href='#479650'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-5'> * petertodd</span>&gt;
glares at sipa
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479651'>
<a class='timestamp' href='#479651'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: yup
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479652'>
<a class='timestamp' href='#479652'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
nodes accepted by new nodes should be accepted by old nodes too.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440600' id='479653'>
<a class='timestamp' href='#479653'><time timestamp='2016-07-13T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: otherwise, any old node will end up not accepting the majority chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479654'>
<a class='timestamp' href='#479654'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
that&#x27;s the easiest explanation to me. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479655'>
<a class='timestamp' href='#479655'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: you mean, blocks accepted by...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479656'>
<a class='timestamp' href='#479656'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: yep
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479657'>
<a class='timestamp' href='#479657'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
that&#x27;s a typo.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479658'>
<a class='timestamp' href='#479658'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: and the ledger will split in half, where each pre-existing coin becomes spendable on both sides of the fork
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479659'>
<a class='timestamp' href='#479659'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
that&#x27;s interesting. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440660' id='479660'>
<a class='timestamp' href='#479660'><time timestamp='2016-07-13T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: spendable on both sides of the fork, because the hard-fork <u>_is_</u> the creation of a new currency
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440720' id='479661'>
<a class='timestamp' href='#479661'><time timestamp='2016-07-13T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
do you know COM+ invented by Microsoft? It&#x27;s also backward compatible.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440720' id='479662'>
<a class='timestamp' href='#479662'><time timestamp='2016-07-13T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
But they can keep releasing new versions of DirectX, which is based on COM+.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440720' id='479663'>
<a class='timestamp' href='#479663'><time timestamp='2016-07-13T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup, just a currency that implicitly assigns the new coins exactly according to how they were distributed at the forking point in the old currency
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440720' id='479664'>
<a class='timestamp' href='#479664'><time timestamp='2016-07-13T20:12:00Z'>20:12</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: heck, I&#x27;ve been asked two or three times now by exchanges and the like to vet their plans for separating UTXO&#x27;s cleanly onto both sides post-hard-fork, so they can trade/withdraw them separately (likely to be a legal requirement)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468440780' id='479665'>
<a class='timestamp' href='#479665'><time timestamp='2016-07-13T20:13:00Z'>20:13</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: that&#x27;s funny.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441080' id='479666'>
<a class='timestamp' href='#479666'><time timestamp='2016-07-13T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so how to nodes check whether a block is valid or not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441140' id='479667'>
<a class='timestamp' href='#479667'><time timestamp='2016-07-13T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
do they just check the syntactics? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441140' id='479668'>
<a class='timestamp' href='#479668'><time timestamp='2016-07-13T20:19:00Z'>20:19</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: what do you mean by &quot;the syntactics&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441200' id='479669'>
<a class='timestamp' href='#479669'><time timestamp='2016-07-13T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
i mean the format of the block data.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441200' id='479670'>
<a class='timestamp' href='#479670'><time timestamp='2016-07-13T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: you mean, without the context of previous blocks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441200' id='479671'>
<a class='timestamp' href='#479671'><time timestamp='2016-07-13T20:20:00Z'>20:20</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: that&#x27;s unlikely to be true. they need to verify transactions, which are dependent on history.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441260' id='479672'>
<a class='timestamp' href='#479672'><time timestamp='2016-07-13T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: indeed
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441260' id='479673'>
<a class='timestamp' href='#479673'><time timestamp='2016-07-13T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: yeah, so how do they check?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441260' id='479674'>
<a class='timestamp' href='#479674'><time timestamp='2016-07-13T20:21:00Z'>20:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: 1) we receive headers and verify them syntactically, and check whether their PoW matches, then check whether they connect to previous headers, and their expected difficulty is correct, then store them
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441320' id='479675'>
<a class='timestamp' href='#479675'><time timestamp='2016-07-13T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
how about the block size? the op codes used?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441320' id='479676'>
<a class='timestamp' href='#479676'><time timestamp='2016-07-13T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: I&#x27;m not clear what you mean by &quot;how&quot; - are you thinking that full nodes check blocks differently than miners?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441320' id='479677'>
<a class='timestamp' href='#479677'><time timestamp='2016-07-13T20:22:00Z'>20:22</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: 2) we download blocks along the best headers from our peers, and when a block arrives, check it syntactically and that its transactions&#x27; hash matches what is in the claimed header we already know; and if so, then store them
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441380' id='479678'>
<a class='timestamp' href='#479678'><time timestamp='2016-07-13T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
petertodd: should miners and full nodes use the same set of rules to check blocks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441380' id='479679'>
<a class='timestamp' href='#479679'><time timestamp='2016-07-13T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441380' id='479680'>
<a class='timestamp' href='#479680'><time timestamp='2016-07-13T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: if they didn&#x27;t, how would we ever get miners to enforce rules that we wanted enforced?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441380' id='479681'>
<a class='timestamp' href='#479681'><time timestamp='2016-07-13T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
yeah, that&#x27;s what I expected.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441380' id='479682'>
<a class='timestamp' href='#479682'><time timestamp='2016-07-13T20:23:00Z'>20:23</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
what if a node see a newer version of blocks?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441440' id='479683'>
<a class='timestamp' href='#479683'><time timestamp='2016-07-13T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: 3) once we have all blocks along a chain whose total work exceeds that of our previous best chain, we look up its input in a database of unspent transaction outputs, validate the scripts, check resource limits, and various other things, ... and if succesful, remove the outputs it spent from the database, and add the outputs it created
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441440' id='479684'>
<a class='timestamp' href='#479684'><time timestamp='2016-07-13T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: what does that mean?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441440' id='479685'>
<a class='timestamp' href='#479685'><time timestamp='2016-07-13T20:24:00Z'>20:24</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: then a soft-fork may have happened, adding rules to the existing set of rules, so the node should warn the user that the consensus rules enforced by it are no longer complete
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479686'>
<a class='timestamp' href='#479686'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: of course, changing the version number for soft-forks is just a nicity - we can&#x27;t force miners to do that
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479687'>
<a class='timestamp' href='#479687'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: (modulo radical redesigns of how bitcoin works, like my client-side validation concepts)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479688'>
<a class='timestamp' href='#479688'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
i mean, if a Bitcoin client of a very low version sees a block generated by the newest version of Bitcoin client, what will happen? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479689'>
<a class='timestamp' href='#479689'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: it will just accept it
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479690'>
<a class='timestamp' href='#479690'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: all software down to 0.2.10 should still work
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441500' id='479691'>
<a class='timestamp' href='#479691'><time timestamp='2016-07-13T20:25:00Z'>20:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(and that was because of a change in the p2p protocol)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479692'>
<a class='timestamp' href='#479692'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so 0.2.10 is a hard fork.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479693'>
<a class='timestamp' href='#479693'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: all that can happen is the node can warn the user that a soft-fork may have happened
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479694'>
<a class='timestamp' href='#479694'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: nope, it was a p2p change
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479695'>
<a class='timestamp' href='#479695'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: not quite, that was a p2p change that can be easily worked around w/o changing the core consensus rules
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479696'>
<a class='timestamp' href='#479696'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: you could create a bridge between 0.2.9 and the current network
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479697'>
<a class='timestamp' href='#479697'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
based on your definition, soft forks should be backward compatible.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479698'>
<a class='timestamp' href='#479698'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: validation of the blocks should be backward compatible
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441560' id='479699'>
<a class='timestamp' href='#479699'><time timestamp='2016-07-13T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and it is
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441620' id='479700'>
<a class='timestamp' href='#479700'><time timestamp='2016-07-13T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the 0.2.9 software just doesn&#x27;t know how to talk to newer clients anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441620' id='479701'>
<a class='timestamp' href='#479701'><time timestamp='2016-07-13T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
OK. although the consensus protocol did not change, it&#x27;s not backward compatible. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441680' id='479702'>
<a class='timestamp' href='#479702'><time timestamp='2016-07-13T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
how did you guys manage to upgrade from 0.2.9 to 0.2.10?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441680' id='479703'>
<a class='timestamp' href='#479703'><time timestamp='2016-07-13T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
sipa: note that the change from longest-chain to most-work was in 0.3.3 <a href="https://github.com/bitcoin/bitcoin/commit/40cd0369419323f8d7385950e20342e998c994e1#diff-623e3fd6da1a45222eeec71496747b31R420" class="link" target="_blank">https://github.com/bitcoin/bitcoin/commit/40cd0369419323f8d7385950e20342e998c994e1#diff-623e3fd6da1a45222eeec71496747b31R420</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441680' id='479704'>
<a class='timestamp' href='#479704'><time timestamp='2016-07-13T20:28:00Z'>20:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
xinxi_: long before my time
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479705'>
<a class='timestamp' href='#479705'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
is there really no better channel for this discussion?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479706'>
<a class='timestamp' href='#479706'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: it&#x27;d be very easy for people to continue to run nodes that had backwards compatbility with 0.2.9
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479707'>
<a class='timestamp' href='#479707'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
morcos makes a good point...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479708'>
<a class='timestamp' href='#479708'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ack, let&#x27;s move to #bitcoin
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479709'>
<a class='timestamp' href='#479709'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
so this is not even dev related?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441740' id='479710'>
<a class='timestamp' href='#479710'><time timestamp='2016-07-13T20:29:00Z'>20:29</time></a>
&lt;<span class='nick nick-7'> petertodd</span>&gt;
xinxi_: it&#x27;s covering really basic material
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441800' id='479711'>
<a class='timestamp' href='#479711'><time timestamp='2016-07-13T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-2'> xinxi_</span>&gt;
but that&#x27;s still dev. anyway, let&#x27;s move.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441800' id='479712'>
<a class='timestamp' href='#479712'><time timestamp='2016-07-13T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-4'> shatoshi</span>&gt;
INCREDIBLE! Send me some bitcoin and I can turn it into MUCH more, using special blockchain accelerating technology. Your bitcoin wallet will explode! Guaranteed to work &amp; vouched by the OPS. PM me to begin!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441800' id='479713'>
<a class='timestamp' href='#479713'><time timestamp='2016-07-13T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
ha ha, you&#x27;ve been replaced by somethign even worse
<br>
</div>

<div class='talk op-msg' data-timestamp='1468441800' id='479714'>
<a class='timestamp' href='#479714'><time timestamp='2016-07-13T20:30:00Z'>20:30</time></a>
&lt;<span class='nick nick-13'> sdaftuar</span>&gt;
thank you x 2
<br>
</div>

<div class='talk op-msg' data-timestamp='1468444560' id='479715'>
<a class='timestamp' href='#479715'><time timestamp='2016-07-13T21:16:00Z'>21:16</time></a>
&lt;<span class='nick nick-12'> MiraclePerson</span>&gt;
SUPER!!!! Want more bitcoin? Send me some Bitcoin and I&#x27;ll instantly send you MORE back. I use special block-chain exploding skills. Totally safe &amp; secure. Vouched by all the OPS! Pm me to begin!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447260' id='479716'>
<a class='timestamp' href='#479716'><time timestamp='2016-07-13T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: how do you feel about boost::lockfree::queue?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447320' id='479717'>
<a class='timestamp' href='#479717'><time timestamp='2016-07-13T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
as a proof of concept that solved the lock contention problem really well
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447320' id='479718'>
<a class='timestamp' href='#479718'><time timestamp='2016-07-13T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
jeremyrubin pointed me in this direction, but we weren&#x27;t sure if this is somethign we wanted in the code
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447320' id='479719'>
<a class='timestamp' href='#479719'><time timestamp='2016-07-13T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
<a href="https://github.com/morcos/bitcoin/commit/3e8a10aa78a8a84a44eca9350178ecf7c308c21c" class="link" target="_blank">https://github.com/morcos/bitcoin/commit/3e8a10aa78a8a84a44eca9350178ecf7c308c21c</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447620' id='479720'>
<a class='timestamp' href='#479720'><time timestamp='2016-07-13T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
morcos: interesting
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447620' id='479721'>
<a class='timestamp' href='#479721'><time timestamp='2016-07-13T22:07:00Z'>22:07</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
morcos: alternatively, there could be thread-local lists of entries to erase, that get applied once there are enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447680' id='479722'>
<a class='timestamp' href='#479722'><time timestamp='2016-07-13T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
morcos: though i believe performance of thread locals may be platform dependent
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447680' id='479723'>
<a class='timestamp' href='#479723'><time timestamp='2016-07-13T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: lockfree is also platform dependent unfortunately 
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447680' id='479724'>
<a class='timestamp' href='#479724'><time timestamp='2016-07-13T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
sipa: yeah i thought about that, but found the boost thing the easiest to code
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447740' id='479725'>
<a class='timestamp' href='#479725'><time timestamp='2016-07-13T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
morcos: did you benchmark?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447740' id='479726'>
<a class='timestamp' href='#479726'><time timestamp='2016-07-13T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
yes, for validation its equally as fast as not erasing at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447740' id='479727'>
<a class='timestamp' href='#479727'><time timestamp='2016-07-13T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
cool!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447740' id='479728'>
<a class='timestamp' href='#479728'><time timestamp='2016-07-13T22:09:00Z'>22:09</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
so maybe on the order of a 40% speedup
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479729'>
<a class='timestamp' href='#479729'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
there is the added erase time
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479730'>
<a class='timestamp' href='#479730'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-2'>@sipa</span>&gt;
that&#x27;s much more than i would have expected
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479731'>
<a class='timestamp' href='#479731'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
but the way i coded it it happens the next time ATMP gets called
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479732'>
<a class='timestamp' href='#479732'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
well 16 cores, so thats a lot of lock contention
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479733'>
<a class='timestamp' href='#479733'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah, yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447800' id='479734'>
<a class='timestamp' href='#479734'><time timestamp='2016-07-13T22:10:00Z'>22:10</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
we should probably also look for ways to avoid sha256 there
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447860' id='479735'>
<a class='timestamp' href='#479735'><time timestamp='2016-07-13T22:11:00Z'>22:11</time></a>
&lt;<span class='nick nick-11'> morcos</span>&gt;
the added erase time is small though, maybe 1ms per block, but again happening at a much better time, and a small fraction of the savings
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447920' id='479736'>
<a class='timestamp' href='#479736'><time timestamp='2016-07-13T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: we compared to using the iterator, but I think it was negligible
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447920' id='479737'>
<a class='timestamp' href='#479737'><time timestamp='2016-07-13T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
but with the benefit of not having to check for iterator validity before erase
<br>
</div>

<div class='talk op-msg' data-timestamp='1468447980' id='479738'>
<a class='timestamp' href='#479738'><time timestamp='2016-07-13T22:13:00Z'>22:13</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
(otherwise you would need to construct a set of iterators from the GC-list because concurrent Gets could add the same iter)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448040' id='479739'>
<a class='timestamp' href='#479739'><time timestamp='2016-07-13T22:14:00Z'>22:14</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: wait could you clarify which you are referring to re: sha256? the uint256_t on the eviction list?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448280' id='479740'>
<a class='timestamp' href='#479740'><time timestamp='2016-07-13T22:18:00Z'>22:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: the sigcache stores sha256&#x27;s of the cached data
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448340' id='479741'>
<a class='timestamp' href='#479741'><time timestamp='2016-07-13T22:19:00Z'>22:19</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sha256 is relatively slow
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448400' id='479742'>
<a class='timestamp' href='#479742'><time timestamp='2016-07-13T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: no, not talking about erasing... just the cache in general
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448400' id='479743'>
<a class='timestamp' href='#479743'><time timestamp='2016-07-13T22:20:00Z'>22:20</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: gotcha, should be fine to use siphash right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448460' id='479744'>
<a class='timestamp' href='#479744'><time timestamp='2016-07-13T22:21:00Z'>22:21</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: i&#x27;m not sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448700' id='479745'>
<a class='timestamp' href='#479745'><time timestamp='2016-07-13T22:25:00Z'>22:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jeremyrubin: it&#x27;s not unreasonable to have a cache size of a billion with certain hardware today
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448700' id='479746'>
<a class='timestamp' href='#479746'><time timestamp='2016-07-13T22:25:00Z'>22:25</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: if it is salted then it wouldn&#x27;t be possible to predictably create a block with bad cache lookup performance?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448760' id='479747'>
<a class='timestamp' href='#479747'><time timestamp='2016-07-13T22:26:00Z'>22:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if siphash&#x27;s security claims are correct, salting should make it unpredictablr
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448760' id='479748'>
<a class='timestamp' href='#479748'><time timestamp='2016-07-13T22:26:00Z'>22:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but the 64-bit hash may not be enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1468448760' id='479749'>
<a class='timestamp' href='#479749'><time timestamp='2016-07-13T22:26:00Z'>22:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
perhaps a 128-bit hash works
<br>
</div>

<div class='talk op-msg' data-timestamp='1468449060' id='479750'>
<a class='timestamp' href='#479750'><time timestamp='2016-07-13T22:31:00Z'>22:31</time></a>
&lt;<span class='nick nick-2'> jeremyrubin</span>&gt;
sipa: ttyl
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450080' id='479751'>
<a class='timestamp' href='#479751'><time timestamp='2016-07-13T22:48:00Z'>22:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
it&#x27;s quite easy to just create a lockfree queue using atomics. I think bluematt has one in his fibre codebase.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450080' id='479752'>
<a class='timestamp' href='#479752'><time timestamp='2016-07-13T22:48:00Z'>22:48</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
so we don&#x27;t need to take the additional boost dep if its irritating, or if we do it shouldn&#x27;t be too hard to get rid of.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450140' id='479753'>
<a class='timestamp' href='#479753'><time timestamp='2016-07-13T22:49:00Z'>22:49</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
<a href="https://github.com/bitcoinfibre/bitcoinfibre/blob/master/src/udpnet.cpp#L1175" class="link" target="_blank">https://github.com/bitcoinfibre/bitcoinfibre/blob/master/src/udpnet.cpp#L1175</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450140' id='479754'>
<a class='timestamp' href='#479754'><time timestamp='2016-07-13T22:49:00Z'>22:49</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
actually lockless ring buffer, but close enough
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450200' id='479755'>
<a class='timestamp' href='#479755'><time timestamp='2016-07-13T22:50:00Z'>22:50</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
sipa: we could have a faster wide cryptographic hash, but last I looked low hitrate seemed to be the bigger performance ipediment than the time spent hashing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450440' id='479756'>
<a class='timestamp' href='#479756'><time timestamp='2016-07-13T22:54:00Z'>22:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gmaxwell: a sparse hash set would also be much more space efficient
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450500' id='479757'>
<a class='timestamp' href='#479757'><time timestamp='2016-07-13T22:55:00Z'>22:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(no malloc for each entry)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450920' id='479758'>
<a class='timestamp' href='#479758'><time timestamp='2016-07-13T23:02:00Z'>23:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: interesting!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468450980' id='479759'>
<a class='timestamp' href='#479759'><time timestamp='2016-07-13T23:03:00Z'>23:03</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
a ring buffer would suffice here, i guess... if it overflows you can always grab the lock and apply the erases regardless
<br>
</div>

<div class='talk op-msg' data-timestamp='1468451100' id='479760'>
<a class='timestamp' href='#479760'><time timestamp='2016-07-13T23:05:00Z'>23:05</time></a>
&lt;<span class='nick nick-6'> shangzhou</span>&gt;
sipa: the bitcoin.sipa.be data looks like not up to date
<br>
</div>

<div class='talk op-msg' data-timestamp='1468451220' id='479761'>
<a class='timestamp' href='#479761'><time timestamp='2016-07-13T23:07:00Z'>23:07</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
shangzhou: oh?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468451280' id='479762'>
<a class='timestamp' href='#479762'><time timestamp='2016-07-13T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, yds
<br>
</div>

<div class='talk op-msg' data-timestamp='1468451280' id='479763'>
<a class='timestamp' href='#479763'><time timestamp='2016-07-13T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452180' id='479764'>
<a class='timestamp' href='#479764'><time timestamp='2016-07-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
thoughts on decreasing transaction-serialization time?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452180' id='479765'>
<a class='timestamp' href='#479765'><time timestamp='2016-07-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
its currently slow as fuck, even when serializing into a static buffer
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452180' id='479766'>
<a class='timestamp' href='#479766'><time timestamp='2016-07-13T23:23:00Z'>23:23</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
caching it helps a lot, but eats a decent chunk of memory
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452300' id='479767'>
<a class='timestamp' href='#479767'><time timestamp='2016-07-13T23:25:00Z'>23:25</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(and, mostly, caching tx serialization diverges fibre a decent chunk from core, which is annoying)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452420' id='479768'>
<a class='timestamp' href='#479768'><time timestamp='2016-07-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
BlueMatt: working on a few optims to tx right now. not sure how applicable though...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452420' id='479769'>
<a class='timestamp' href='#479769'><time timestamp='2016-07-13T23:27:00Z'>23:27</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
BlueMatt: easy quick gain is lazy hashing
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452480' id='479770'>
<a class='timestamp' href='#479770'><time timestamp='2016-07-13T23:28:00Z'>23:28</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields: I said serialization, not deserialization :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479771'>
<a class='timestamp' href='#479771'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: i think transaction data shoild be stored in a songle malloced buffer, with internal pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479772'>
<a class='timestamp' href='#479772'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
BlueMatt: oh right, heh. i just assumed you were working on the other direction. nevermind then :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479773'>
<a class='timestamp' href='#479773'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
lazy hashing would be a quick way to slow you down, then :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479774'>
<a class='timestamp' href='#479774'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
what we really should do is calculate the hash at the same time as we serialize/deserialize, since thats easy
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479775'>
<a class='timestamp' href='#479775'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: that does require encapsulating all fields though
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479776'>
<a class='timestamp' href='#479776'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: yes, that is a bit longer-term, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479777'>
<a class='timestamp' href='#479777'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452540' id='479778'>
<a class='timestamp' href='#479778'><time timestamp='2016-07-13T23:29:00Z'>23:29</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but, yea, that would help a ton of things
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452600' id='479779'>
<a class='timestamp' href='#479779'><time timestamp='2016-07-13T23:30:00Z'>23:30</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: speaking of which, after profiling noticing how much time was spent in prevector, i&#x27;ve fixed up copying/moving to be much quicker. you opposed to dinking around in there?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452840' id='479780'>
<a class='timestamp' href='#479780'><time timestamp='2016-07-13T23:34:00Z'>23:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: please do!
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452900' id='479781'>
<a class='timestamp' href='#479781'><time timestamp='2016-07-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
cfields: actually, we should make it class safe...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452900' id='479782'>
<a class='timestamp' href='#479782'><time timestamp='2016-07-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: better, i added static_asserts :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452900' id='479783'>
<a class='timestamp' href='#479783'><time timestamp='2016-07-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and use std::move etc instead of realloc etx
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452900' id='479784'>
<a class='timestamp' href='#479784'><time timestamp='2016-07-13T23:35:00Z'>23:35</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
cfields: ironically, no, FIBRE is mostly tx copy/serialize - it copies most tx from mempool into a CBlock, and serializes those txn to build the data-FEC chunks from which to calculate the missing chunks
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452960' id='479785'>
<a class='timestamp' href='#479785'><time timestamp='2016-07-13T23:36:00Z'>23:36</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
it only ever has to deserialize txn that it missed from mempool (which is relatively few)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452960' id='479786'>
<a class='timestamp' href='#479786'><time timestamp='2016-07-13T23:36:00Z'>23:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: we could also add a means to serialize a block from a list of tx shared_pointers
<br>
</div>

<div class='talk op-msg' data-timestamp='1468452960' id='479787'>
<a class='timestamp' href='#479787'><time timestamp='2016-07-13T23:36:00Z'>23:36</time></a>
&lt;<span class='nick nick-13'> cfields</span>&gt;
sipa: i started by special-casing it with enable_if&lt;&gt; and SFINAE, but I think we&#x27;re better off just specializing for ~std::is_trivial&lt;&gt;
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479788'>
<a class='timestamp' href='#479788'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
What fiber FECs is not the block directly, but the block with padding to make transactions line up on packet boundaries.
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479789'>
<a class='timestamp' href='#479789'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: instead first needing a full deep copy of the tx into the block
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479790'>
<a class='timestamp' href='#479790'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-14'> gmaxwell</span>&gt;
er fibre
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479791'>
<a class='timestamp' href='#479791'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: who said anything about serializing?
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479792'>
<a class='timestamp' href='#479792'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oh, what gmaxwell said
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453020' id='479793'>
<a class='timestamp' href='#479793'><time timestamp='2016-07-13T23:37:00Z'>23:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
sipa: no, it just deep-copies into the CBlock that it hands to ProcessNewBlock
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453080' id='479794'>
<a class='timestamp' href='#479794'><time timestamp='2016-07-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
&quot;FIBRE is mostly tx copy/serializr&quot; -- BlueMatt
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453080' id='479795'>
<a class='timestamp' href='#479795'><time timestamp='2016-07-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: ok, maybe we should just make CBlock have shared_ptr to transactions...
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453080' id='479796'>
<a class='timestamp' href='#479796'><time timestamp='2016-07-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
that would help a lot, but it doesnt solve my serialize-time problem
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453080' id='479797'>
<a class='timestamp' href='#479797'><time timestamp='2016-07-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
(which is like...all my time)
<br>
</div>

<div class='talk op-msg' data-timestamp='1468453080' id='479798'>
<a class='timestamp' href='#479798'><time timestamp='2016-07-13T23:38:00Z'>23:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok
<br>
</div>

</div>
</section>

</body>
</html>
