<!DOCTYPE html>
<html>
<title>
#bitcoin-core-dev
 on 2019-07-30
 ‚Äî 
searchable irc log
</title>
<meta charset='utf-8'>
<meta content='IE=9' http-equiv='X-UA-Compatible'>
<link href='/style-light.css' id='stylesheet' rel='stylesheet'>
<link href='/favicon.png' rel='shortcut icon'>
<link href='http://chaincode.com/bitcoin-core-dev/2019-07-30' rel='canonical'>
<meta content='channel #bitcoin-core-dev IRC chat logs' name='description'>
<script src='/jquery.min.js'></script>
<script src='/jquery.ba-hashchange.min.js'></script>
<script src='/cookies.min.js'></script>
<script src='/application.js'></script>
<body>
<section id='sidebar'>
<section id='calendar'>
<pre class='clock'>17:19 UTC</pre>
<pre><a href="/bitcoin-core-dev/2019-06-30">&lt;</a><span class='header'>    July 2019     </span><a href="/bitcoin-core-dev/2019-08-30">&gt;</a>&#x000A;<span class='header'>Su Mo Tu We Th Fr Sa  </span>&#x000A;    <a class="" href="/bitcoin-core-dev/2019-07-01">1</a>  <a class="" href="/bitcoin-core-dev/2019-07-02">2</a>  <a class="" href="/bitcoin-core-dev/2019-07-03">3</a>  <a class="" href="/bitcoin-core-dev/2019-07-04">4</a>  <a class="" href="/bitcoin-core-dev/2019-07-05">5</a>  <a class="" href="/bitcoin-core-dev/2019-07-06">6</a>  &#x000A; <a class="" href="/bitcoin-core-dev/2019-07-07">7</a>  <a class="" href="/bitcoin-core-dev/2019-07-08">8</a>  <a class="" href="/bitcoin-core-dev/2019-07-09">9</a> <a class="" href="/bitcoin-core-dev/2019-07-10">10</a> <a class="" href="/bitcoin-core-dev/2019-07-11">11</a> <a class="" href="/bitcoin-core-dev/2019-07-12">12</a> <a class="" href="/bitcoin-core-dev/2019-07-13">13</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2019-07-14">14</a> <a class="" href="/bitcoin-core-dev/2019-07-15">15</a> <a class="" href="/bitcoin-core-dev/2019-07-16">16</a> <a class="" href="/bitcoin-core-dev/2019-07-17">17</a> <a class="" href="/bitcoin-core-dev/2019-07-18">18</a> <a class="" href="/bitcoin-core-dev/2019-07-19">19</a> <a class="" href="/bitcoin-core-dev/2019-07-20">20</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2019-07-21">21</a> <a class="" href="/bitcoin-core-dev/2019-07-22">22</a> <a class="" href="/bitcoin-core-dev/2019-07-23">23</a> <a class="" href="/bitcoin-core-dev/2019-07-24">24</a> <a class="" href="/bitcoin-core-dev/2019-07-25">25</a> <a class="" href="/bitcoin-core-dev/2019-07-26">26</a> <a class="" href="/bitcoin-core-dev/2019-07-27">27</a>  &#x000A;<a class="" href="/bitcoin-core-dev/2019-07-28">28</a> <a class="" href="/bitcoin-core-dev/2019-07-29">29</a> <a class="current" href="/bitcoin-core-dev/2019-07-30">30</a> <a class="" href="/bitcoin-core-dev/2019-07-31">31</a></pre>
</section>
<section id='options'>
<form action='/bitcoin-core-dev/search'>
<input id='search-box' name='q' placeholder='Enter keywords'>
<input type='submit' value='Search'>
<br/>
<br/>
<p>This is a searchable archive of <a href=/bitcoin-core-dev>#bitcoin-core-dev</a> irc</p>
<br/>
<small>
<b>Examples</b>
<br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=bitcoin">bitcoin</a>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=*BIP*">*BIP*</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22bitcoin-git%22">bitcoin-git</a><br/>
<a href="http://bitcoin-irc.chaincode.com/bitcoin-core-dev/search?q=%22core-meetingbot%22">core-meetingbot</a>
<br/>
<br/>
</small>
<small>Search supports standard MySQL <a href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">fulltext search operations</a></small>
<br/>
<br/>
<small>Click on the timestamp of a message for a sharable link</small>
<br/>
<br/>
<small>Message timestamps are in UTC</small>
<br/>
<br/>
<small>This archive is hosted by <a href="http://chaincode.com">Chaincode</a> and runs on <a href="https://github.com/whitequark/irclogger">irclogger</a></small>
<br/>
</form>
</section>
</section>
<section class='without-noise' data-channel='#bitcoin-core-dev' id='log'>
<aside id='log-panel'>
<a href='#' id='light_dark'></a>
<label for='filter'>
Filter:
</label>
<input id='filter'>
<span class='clear-input' id='clear_filter' style='display:none'></span>
<div class='input-group'>
<input id='show_noise' type='checkbox'>
<label for='show_noise'>
Show join/leave messages
</label>
</div>
</aside>
<div class='log-messages with-panel'>
<div class='talk op-msg' data-timestamp='1564446900' id='674041'>
<a class='timestamp' href='#674041'><time timestamp='2019-07-30T00:35:00Z'>00:35</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ezegom opened pull request #16492: &lt;WIP&gt; Add feeRate argument to bumpFee RPC (master...feerate_bumpfee) <a href="https://github.com/bitcoin/bitcoin/pull/16492" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16492</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564447080' id='674042'>
<a class='timestamp' href='#674042'><time timestamp='2019-07-30T00:38:00Z'>00:38</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ezegom closed pull request #16492: &lt;WIP&gt; Add feeRate argument to bumpFee RPC (master...feerate_bumpfee) <a href="https://github.com/bitcoin/bitcoin/pull/16492" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16492</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564448580' id='674043'>
<a class='timestamp' href='#674043'><time timestamp='2019-07-30T01:03:00Z'>01:03</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ezegom reopened pull request #16492: &lt;WIP&gt; Add feeRate argument to bumpFee RPC (master...feerate_bumpfee) <a href="https://github.com/bitcoin/bitcoin/pull/16492" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16492</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564448640' id='674044'>
<a class='timestamp' href='#674044'><time timestamp='2019-07-30T01:04:00Z'>01:04</time></a>
&lt;<span class='nick nick-5'> emilengler</span>&gt;
How the CTRL+L shortcut is being handled in bitcoin-qt? Over a QAction or a QShortcut?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564456620' id='674045'>
<a class='timestamp' href='#674045'><time timestamp='2019-07-30T03:17:00Z'>03:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/68da54987df4...2410088003a1" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/68da54987df4...2410088003a1</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564456620' id='674046'>
<a class='timestamp' href='#674046'><time timestamp='2019-07-30T03:17:00Z'>03:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 62d3f50 Jon Atack: qa: fix deprecated log.warn in feature_dbcrash test
<br>
</div>

<div class='talk op-msg' data-timestamp='1564456620' id='674047'>
<a class='timestamp' href='#674047'><time timestamp='2019-07-30T03:17:00Z'>03:17</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 2410088 fanquake: Merge #16491: qa: fix deprecated log.warn in feature_dbcrash test
<br>
</div>

<div class='talk op-msg' data-timestamp='1564456680' id='674048'>
<a class='timestamp' href='#674048'><time timestamp='2019-07-30T03:18:00Z'>03:18</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #16491: qa: fix deprecated log.warn in feature_dbcrash test (master...test-fix-feature_dbcrash-warn-deprecation) <a href="https://github.com/bitcoin/bitcoin/pull/16491" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16491</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457820' id='674049'>
<a class='timestamp' href='#674049'><time timestamp='2019-07-30T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
achow101: <a href="https://github.com/bitcoin/bitcoin/pull/16440#discussion_r308332901" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16440#discussion_r308332901</a> I basically need the wallet interface to give me a way to sign things from the QT side, and this was the only approach I could think of. sipa suggested I ping you to make sure I wasn&#x27;t trampling on stuff with the descriptor wallet changes you are working on.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457820' id='674050'>
<a class='timestamp' href='#674050'><time timestamp='2019-07-30T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 3 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/2410088003a1...478fe328a793" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/2410088003a1...478fe328a793</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457820' id='674051'>
<a class='timestamp' href='#674051'><time timestamp='2019-07-30T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa6dc7f MarcoFalke: wallet: Enumerate walletdb keys
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457820' id='674052'>
<a class='timestamp' href='#674052'><time timestamp='2019-07-30T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master fa6f22b MarcoFalke: wallet: Rename CWalletKey to OldKey
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457820' id='674053'>
<a class='timestamp' href='#674053'><time timestamp='2019-07-30T03:37:00Z'>03:37</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 478fe32 fanquake: Merge #16475: wallet: Enumerate walletdb keys
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457880' id='674054'>
<a class='timestamp' href='#674054'><time timestamp='2019-07-30T03:38:00Z'>03:38</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #16475: wallet: Enumerate walletdb keys (master...1907-walletDbKeys) <a href="https://github.com/bitcoin/bitcoin/pull/16475" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16475</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457940' id='674055'>
<a class='timestamp' href='#674055'><time timestamp='2019-07-30T03:39:00Z'>03:39</time></a>
&lt;<span class='nick nick-1'> achow101</span>&gt;
kallewoof: it doesn&#x27;t interfere, I&#x27;ll leave a comment
<br>
</div>

<div class='talk op-msg' data-timestamp='1564457940' id='674056'>
<a class='timestamp' href='#674056'><time timestamp='2019-07-30T03:39:00Z'>03:39</time></a>
&lt;<span class='nick nick-11'> kallewoof</span>&gt;
Great, thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1564458660' id='674057'>
<a class='timestamp' href='#674057'><time timestamp='2019-07-30T03:51:00Z'>03:51</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/478fe328a793...33894612c0de" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/478fe328a793...33894612c0de</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564458660' id='674058'>
<a class='timestamp' href='#674058'><time timestamp='2019-07-30T03:51:00Z'>03:51</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master faa88d0 MarcoFalke: doc: update labels in CONTRIBUTING.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1564458660' id='674059'>
<a class='timestamp' href='#674059'><time timestamp='2019-07-30T03:51:00Z'>03:51</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 3389461 fanquake: Merge #16484: doc: update labels in CONTRIBUTING.md
<br>
</div>

<div class='talk op-msg' data-timestamp='1564458720' id='674060'>
<a class='timestamp' href='#674060'><time timestamp='2019-07-30T03:52:00Z'>03:52</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #16484: doc: update labels in CONTRIBUTING.md (master...1907-docNoTrivial) <a href="https://github.com/bitcoin/bitcoin/pull/16484" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16484</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564459320' id='674061'>
<a class='timestamp' href='#674061'><time timestamp='2019-07-30T04:02:00Z'>04:02</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: fwiw I found the issue, the redeem script was expanded in the signing provider but it was a <u>_different_</u> provider. the caller needs to retrieve the expanded provider (instead of using the original one it got from Parse()) before doing the lookup. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564459440' id='674062'>
<a class='timestamp' href='#674062'><time timestamp='2019-07-30T04:04:00Z'>04:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: ha
<br>
</div>

<div class='talk op-msg' data-timestamp='1564459560' id='674063'>
<a class='timestamp' href='#674063'><time timestamp='2019-07-30T04:06:00Z'>04:06</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
silly mistake :D so the correct importing flow is to TopUp(), which generates the cache, then call GetScriptPubKeyMan() to retrieve an expanded provider using the fresh cache, then do DetermineOutputType.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564459800' id='674064'>
<a class='timestamp' href='#674064'><time timestamp='2019-07-30T04:10:00Z'>04:10</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
*GetSigningProvider, not GetScriptPubKeyMan
<br>
</div>

<div class='talk op-msg' data-timestamp='1564465020' id='674065'>
<a class='timestamp' href='#674065'><time timestamp='2019-07-30T05:37:00Z'>05:37</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] Bushstar reopened pull request #15709: wallet: Do not add &quot;setting&quot; key as unknown (master...walletdb-settings) <a href="https://github.com/bitcoin/bitcoin/pull/15709" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/15709</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475400' id='674066'>
<a class='timestamp' href='#674066'><time timestamp='2019-07-30T08:30:00Z'>08:30</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
achow101: In <a href="https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Wallet-Class-Structure-Changes#cwallet-changes" class="link" target="_blank">https://github.com/bitcoin-core/bitcoin-devwiki/wiki/Wallet-Class-Structure-Changes#cwallet-changes</a>, can you explain &quot;These may all be the same ScriptPubKeyManager or different.&quot;? Reading through I got the impression that legacy/p2sh/bech would each be in separate ScriptPubKeyManagers.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475460' id='674067'>
<a class='timestamp' href='#674067'><time timestamp='2019-07-30T08:31:00Z'>08:31</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Is/would there any benefit to keeping them siloed ?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475520' id='674068'>
<a class='timestamp' href='#674068'><time timestamp='2019-07-30T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] meshcollider pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/33894612c0de...ff57fb457892" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/33894612c0de...ff57fb457892</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475520' id='674069'>
<a class='timestamp' href='#674069'><time timestamp='2019-07-30T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 914923d Peter Bushnell: Add setting as known type
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475520' id='674070'>
<a class='timestamp' href='#674070'><time timestamp='2019-07-30T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master ff57fb4 MeshCollider: Merge #15709: wallet: Do not add &quot;setting&quot; key as unknown
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475520' id='674071'>
<a class='timestamp' href='#674071'><time timestamp='2019-07-30T08:32:00Z'>08:32</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] meshcollider merged pull request #15709: wallet: Do not add &quot;setting&quot; key as unknown (master...walletdb-settings) <a href="https://github.com/bitcoin/bitcoin/pull/15709" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/15709</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475760' id='674072'>
<a class='timestamp' href='#674072'><time timestamp='2019-07-30T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/ff57fb457892...53b5a4f7eca9" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/ff57fb457892...53b5a4f7eca9</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475760' id='674073'>
<a class='timestamp' href='#674073'><time timestamp='2019-07-30T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master e0324c3 Aaron Clauson: Updated python command in readme so it will work on systems that have both...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475760' id='674074'>
<a class='timestamp' href='#674074'><time timestamp='2019-07-30T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 53b5a4f fanquake: Merge #16483: doc: update Python command in msvc readme
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475760' id='674075'>
<a class='timestamp' href='#674075'><time timestamp='2019-07-30T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
fanquake: for example, if you have an old wallet, the legacy wallet structure is wrapped as a scriptpubkeymanager, and all address types would point to it
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475760' id='674076'>
<a class='timestamp' href='#674076'><time timestamp='2019-07-30T08:36:00Z'>08:36</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] fanquake merged pull request #16483: doc: update Python command in msvc readme (master...update_msvc_readme) <a href="https://github.com/bitcoin/bitcoin/pull/16483" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16483</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564475940' id='674077'>
<a class='timestamp' href='#674077'><time timestamp='2019-07-30T08:39:00Z'>08:39</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
meshcollider: right, cheers
<br>
</div>

<div class='talk op-msg' data-timestamp='1564476060' id='674078'>
<a class='timestamp' href='#674078'><time timestamp='2019-07-30T08:41:00Z'>08:41</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
fanquake: in a pure descriptor wallet you would probably have 6 separate scriptpubkeymanagers though yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564476300' id='674079'>
<a class='timestamp' href='#674079'><time timestamp='2019-07-30T08:45:00Z'>08:45</time></a>
&lt;<span class='nick nick-3'> meshcollider</span>&gt;
if you have a wpkh() descriptor for your bech32 addresses it wouldnt make sense for the legacy output type to point to that for example
<br>
</div>

<div class='talk op-msg' data-timestamp='1564476360' id='674080'>
<a class='timestamp' href='#674080'><time timestamp='2019-07-30T08:46:00Z'>08:46</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
meshcollider: üëç
<br>
</div>

<div class='talk op-msg' data-timestamp='1564481220' id='674081'>
<a class='timestamp' href='#674081'><time timestamp='2019-07-30T10:07:00Z'>10:07</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] practicalswift closed pull request #16312: tests: Reduce memory usage by 0.5 GB when compiling script_tests.cpp (master...fix-absurd-memory-usage-when-compiling-script_build) <a href="https://github.com/bitcoin/bitcoin/pull/16312" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16312</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564484760' id='674082'>
<a class='timestamp' href='#674082'><time timestamp='2019-07-30T11:06:00Z'>11:06</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa, BlueMatt: I&#x27;m unsure about the fixed 4byte message string. We would &quot;waste&quot; 3 bytes on each inv compared to the short-id approach. I don&#x27;t expect much collisions with a space of 256-12 possible short-IDs.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564484820' id='674083'>
<a class='timestamp' href='#674083'><time timestamp='2019-07-30T11:07:00Z'>11:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
New commands that are not broadly used on the network could still use a string,.... and only get a short ID after some time (to avoid collisions).
<br>
</div>

<div class='talk op-msg' data-timestamp='1564484880' id='674084'>
<a class='timestamp' href='#674084'><time timestamp='2019-07-30T11:08:00Z'>11:08</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
What we could do, instead, of using the value 1-12 for string based message commands, ... we could use value 0 as an indicator for a 4 byte string base command.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564484940' id='674085'>
<a class='timestamp' href='#674085'><time timestamp='2019-07-30T11:09:00Z'>11:09</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(compared to the fixed 4 bytes command it would be +1 byte)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564484940' id='674086'>
<a class='timestamp' href='#674086'><time timestamp='2019-07-30T11:09:00Z'>11:09</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
The argument, &quot;but parsing variable length!&quot; I don&#x27;t buy that completely,.. because one needs to deal with vlen anyways
<br>
</div>

<div class='talk op-msg' data-timestamp='1564485060' id='674087'>
<a class='timestamp' href='#674087'><time timestamp='2019-07-30T11:11:00Z'>11:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
you need to verify the MAC tag therefore deserializing,... so one needs to read the whole content of the stream anyways. Maybe I don&#x27;t see the point, but messages are vlen anyway.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564485060' id='674088'>
<a class='timestamp' href='#674088'><time timestamp='2019-07-30T11:11:00Z'>11:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Skipping a message needs one to read the &quot;header&quot; (in v2 case the command ID/name)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564486680' id='674089'>
<a class='timestamp' href='#674089'><time timestamp='2019-07-30T11:38:00Z'>11:38</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Is it just me or does travis hang while fetching the pull request page? <a href="https://travis-ci.org/bitcoin/bitcoin/pull_requests" class="link" target="_blank">https://travis-ci.org/bitcoin/bitcoin/pull_requests</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564486740' id='674090'>
<a class='timestamp' href='#674090'><time timestamp='2019-07-30T11:39:00Z'>11:39</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
idles forever at my end
<br>
</div>

<div class='talk op-msg' data-timestamp='1564488240' id='674091'>
<a class='timestamp' href='#674091'><time timestamp='2019-07-30T12:04:00Z'>12:04</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
jonasschnelli: loading ok for me here.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564488900' id='674092'>
<a class='timestamp' href='#674092'><time timestamp='2019-07-30T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
fanquake: maybe a local browser issue then
<br>
</div>

<div class='talk op-msg' data-timestamp='1564488900' id='674093'>
<a class='timestamp' href='#674093'><time timestamp='2019-07-30T12:15:00Z'>12:15</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
jup.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494180' id='674094'>
<a class='timestamp' href='#674094'><time timestamp='2019-07-30T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/53b5a4f7eca9...bd35ec36f5d6" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/53b5a4f7eca9...bd35ec36f5d6</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494180' id='674095'>
<a class='timestamp' href='#674095'><time timestamp='2019-07-30T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 29ee4c4 Daniel Kraft: Specify AM_CPPFLAGS for ZMQ.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494180' id='674096'>
<a class='timestamp' href='#674096'><time timestamp='2019-07-30T13:43:00Z'>13:43</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master bd35ec3 Wladimir J. van der Laan: Merge #16434: build: Specify AM_CPPFLAGS for ZMQ
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494240' id='674097'>
<a class='timestamp' href='#674097'><time timestamp='2019-07-30T13:44:00Z'>13:44</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj merged pull request #16434: build: Specify AM_CPPFLAGS for ZMQ (master...zmq-cppflags) <a href="https://github.com/bitcoin/bitcoin/pull/16434" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16434</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494540' id='674098'>
<a class='timestamp' href='#674098'><time timestamp='2019-07-30T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
sipa, achow: importpubkey ought to recognize p2shwpkh addresses, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564494540' id='674099'>
<a class='timestamp' href='#674099'><time timestamp='2019-07-30T13:49:00Z'>13:49</time></a>
&lt;<span class='nick nick-7'> stevenroose</span>&gt;
ah nvm
<br>
</div>

<div class='talk op-msg' data-timestamp='1564495920' id='674100'>
<a class='timestamp' href='#674100'><time timestamp='2019-07-30T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
I finished with the descriptors but I&#x27;m trying to figure out `IsSolvable` right now. and i&#x27;m not sure how does taproot fit in the SigningProvider API. the first thing oviously to check is to convert the point to P2PK and check if it can sign for that key. but if it can&#x27;t I need to somhow be able to reconstruct the tree out of the signing provider. I&#x27;m thinking of adding it as a member, but is it okay that there
<br>
</div>

<div class='talk op-msg' data-timestamp='1564495920' id='674101'>
<a class='timestamp' href='#674101'><time timestamp='2019-07-30T14:12:00Z'>14:12</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
might be duplicate scripts between that tree and the `scripts` map? or maybe I should store there a tree to `CScriptID` and then get the right scripts through that map and try to solve for all the possible leafs(and the first that return true i&#x27;ll return true)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564496220' id='674102'>
<a class='timestamp' href='#674102'><time timestamp='2019-07-30T14:17:00Z'>14:17</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
hmm and even if I have the correct tweak I need to find the correct internal key, and I guess brute forcing the tweak against all the pubkeys in the map isn&#x27;t a good solution heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497120' id='674103'>
<a class='timestamp' href='#674103'><time timestamp='2019-07-30T14:32:00Z'>14:32</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
so I can negate the tweak and add it to the taproot key to get the internal key. cool
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497540' id='674104'>
<a class='timestamp' href='#674104'><time timestamp='2019-07-30T14:39:00Z'>14:39</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: I really hope we&#x27;re not so starved for bandwidth that we can&#x27;t afford 3 extra bytes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497540' id='674105'>
<a class='timestamp' href='#674105'><time timestamp='2019-07-30T14:39:00Z'>14:39</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and if we are, we can just have more things in each inv, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497840' id='674106'>
<a class='timestamp' href='#674106'><time timestamp='2019-07-30T14:44:00Z'>14:44</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: What does afford means in that context? :-) We can afford it, but It&#x27;s more a question of waste/optimizing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497900' id='674107'>
<a class='timestamp' href='#674107'><time timestamp='2019-07-30T14:45:00Z'>14:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: bundling inv&#x27;s.. sure. Not always possible.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497900' id='674108'>
<a class='timestamp' href='#674108'><time timestamp='2019-07-30T14:45:00Z'>14:45</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
over-optimizing is the root of all evil :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497900' id='674109'>
<a class='timestamp' href='#674109'><time timestamp='2019-07-30T14:45:00Z'>14:45</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Sure. But I think we are in an acceptable range of optimizing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497960' id='674110'>
<a class='timestamp' href='#674110'><time timestamp='2019-07-30T14:46:00Z'>14:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I mean if we&#x27;re in a place where we can&#x27;t bundle invs, then we have low tx traffic, and we can afford a few more bytes per message without anyone caring about the bw usage
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497960' id='674111'>
<a class='timestamp' href='#674111'><time timestamp='2019-07-30T14:46:00Z'>14:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if we&#x27;re not, we can bundle more
<br>
</div>

<div class='talk op-msg' data-timestamp='1564497960' id='674112'>
<a class='timestamp' href='#674112'><time timestamp='2019-07-30T14:46:00Z'>14:46</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
I just dont really think an extra 3 bytes on a 32 byte thing to send really has much cost
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498020' id='674113'>
<a class='timestamp' href='#674113'><time timestamp='2019-07-30T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
in exchange for a constant length header
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498020' id='674114'>
<a class='timestamp' href='#674114'><time timestamp='2019-07-30T14:47:00Z'>14:47</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
which is way easier to deal with
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498440' id='674115'>
<a class='timestamp' href='#674115'><time timestamp='2019-07-30T14:54:00Z'>14:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: i don&#x27;t care much about variable length either, but it seems a sticking point for BlueMatt 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498500' id='674116'>
<a class='timestamp' href='#674116'><time timestamp='2019-07-30T14:55:00Z'>14:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: but also just diminishing returns; there is a 16 byte MAC per message; maybe saving 8 bytes per message matters, but saving 3 more is quickly becoming negligable for all but the shortest messages
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498560' id='674117'>
<a class='timestamp' href='#674117'><time timestamp='2019-07-30T14:56:00Z'>14:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: IsSolvable meams &quot;you know enough to sign under all conditions, if you had the private keys&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498620' id='674118'>
<a class='timestamp' href='#674118'><time timestamp='2019-07-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: taproot descriptors would always be solvable
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498620' id='674119'>
<a class='timestamp' href='#674119'><time timestamp='2019-07-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
i&#x27;m talking about a different `IsSolvable` haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498620' id='674120'>
<a class='timestamp' href='#674120'><time timestamp='2019-07-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
in sign.cpp
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498620' id='674121'>
<a class='timestamp' href='#674121'><time timestamp='2019-07-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
(the one that&#x27;s used in descriptors_test.cpp )
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498620' id='674122'>
<a class='timestamp' href='#674122'><time timestamp='2019-07-30T14:57:00Z'>14:57</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
oh, i see
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674123'>
<a class='timestamp' href='#674123'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/bd35ec36f5d6...74f1a27f2f45" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/bd35ec36f5d6...74f1a27f2f45</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674124'>
<a class='timestamp' href='#674124'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 0c78e49 practicalswift: tests: Switch one of the Travis jobs to an unsigned char environment (-fun...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674125'>
<a class='timestamp' href='#674125'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 74f1a27 Wladimir J. van der Laan: Merge #15134: tests: Switch one of the Travis jobs to an unsigned char env...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674126'>
<a class='timestamp' href='#674126'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] laanwj merged pull request #15134: tests: Switch one of the Travis jobs to an unsigned char environment (-funsigned-char) (master...unsigned-char) <a href="https://github.com/bitcoin/bitcoin/pull/15134" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/15134</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674127'>
<a class='timestamp' href='#674127'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: the concept of solvable there needs to go away i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498740' id='674128'>
<a class='timestamp' href='#674128'><time timestamp='2019-07-30T14:59:00Z'>14:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: it captures whether you&#x27;re able to estimate fees
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498800' id='674129'>
<a class='timestamp' href='#674129'><time timestamp='2019-07-30T15:00:00Z'>15:00</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
wait what. I thought it checks if you have the right script+private key
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498800' id='674130'>
<a class='timestamp' href='#674130'><time timestamp='2019-07-30T15:00:00Z'>15:00</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
like, it literally tries to produce a signature
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498920' id='674131'>
<a class='timestamp' href='#674131'><time timestamp='2019-07-30T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt, sipa: sorry... was on the phone. BlueMatt: what are the benefits of a constant length &quot;header&quot;?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564498920' id='674132'>
<a class='timestamp' href='#674132'><time timestamp='2019-07-30T15:02:00Z'>15:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Also, V2&#x27;s &quot;header&quot; is the encrypted length &amp; MAC TAG
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499040' id='674133'>
<a class='timestamp' href='#674133'><time timestamp='2019-07-30T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
A 32byte field for defining the message type seems very large for the message variety we are expecting in the next years.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499040' id='674134'>
<a class='timestamp' href='#674134'><time timestamp='2019-07-30T15:04:00Z'>15:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I also don&#x27;t fully buy into the anit-collision argument
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499100' id='674135'>
<a class='timestamp' href='#674135'><time timestamp='2019-07-30T15:05:00Z'>15:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Maybe if we consider collisions be a thing in the future, we could say short-ID tables are bound to a certain net-protocol version?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499160' id='674136'>
<a class='timestamp' href='#674136'><time timestamp='2019-07-30T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: it basically checks if you can sign with a dummysigner (which doesn&#x27;t need private keys)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499160' id='674137'>
<a class='timestamp' href='#674137'><time timestamp='2019-07-30T15:06:00Z'>15:06</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: you shouldn&#x27;t need taproot specific logic; just signing logix
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499280' id='674138'>
<a class='timestamp' href='#674138'><time timestamp='2019-07-30T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-5'> emilengler</span>&gt;
How does bitcoin-qt detects when Ctrl-L was pressed? I can&#x27;t find something like a QShortcut or a QAction
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499280' id='674139'>
<a class='timestamp' href='#674139'><time timestamp='2019-07-30T15:08:00Z'>15:08</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
sipa: yeah but to &quot;try&quot; you sign with the dummy signature I need to convert it to something it knows. it calls `ProduceSignature` which does things like: <a href="https://github.com/bitcoin/bitcoin/blob/master/src/script/sign.cpp#L213" class="link" target="_blank">https://github.com/bitcoin/bitcoin/blob/master/src/script/sign.cpp#L213</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499400' id='674140'>
<a class='timestamp' href='#674140'><time timestamp='2019-07-30T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
[16:46:57]  &lt;BlueMatt&gt;in exchange for a constant length header [...] which is way easier to deal with
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499400' id='674141'>
<a class='timestamp' href='#674141'><time timestamp='2019-07-30T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
^^^ can you elaborate a bit more on this?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499400' id='674142'>
<a class='timestamp' href='#674142'><time timestamp='2019-07-30T15:10:00Z'>15:10</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
so I need to &quot;try&quot; producing signatures for the scripts, right? because I can&#x27;t asusme it&#x27;s using a dummy signer and will return true for whatever pubkey. so I need to try with the internal key as P2PK and then with each script until `SignStep` returns true
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499460' id='674143'>
<a class='timestamp' href='#674143'><time timestamp='2019-07-30T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
You have a raw packet on the stream [3 bytes encrypted length] + [ ? encrypted payload ] + [ 16 bytes MAC]
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499460' id='674144'>
<a class='timestamp' href='#674144'><time timestamp='2019-07-30T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(varlen already)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499460' id='674145'>
<a class='timestamp' href='#674145'><time timestamp='2019-07-30T15:11:00Z'>15:11</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
you check the mac and decrypt
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499520' id='674146'>
<a class='timestamp' href='#674146'><time timestamp='2019-07-30T15:12:00Z'>15:12</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
then &quot;deserialize&quot; the message ([ ? payload]), where the header is actually the message command (which is varlen compared to the 24byte V1 headers)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499580' id='674147'>
<a class='timestamp' href='#674147'><time timestamp='2019-07-30T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jonasschnelli, it&#x27;s infinitely easier to parse a constant length header than a variable length one
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499580' id='674148'>
<a class='timestamp' href='#674148'><time timestamp='2019-07-30T15:13:00Z'>15:13</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: easier in what context?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499640' id='674149'>
<a class='timestamp' href='#674149'><time timestamp='2019-07-30T15:14:00Z'>15:14</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I mean the message that follows has very likely also variable length fields
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499700' id='674150'>
<a class='timestamp' href='#674150'><time timestamp='2019-07-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: yes, you need taproot signing logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499700' id='674151'>
<a class='timestamp' href='#674151'><time timestamp='2019-07-30T15:15:00Z'>15:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you have that, IsSolvable will work automatically
<br>
</div>

<div class='talk op-msg' data-timestamp='1564499880' id='674152'>
<a class='timestamp' href='#674152'><time timestamp='2019-07-30T15:18:00Z'>15:18</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
great. so i&#x27;ll add a map of taproot trees to `FlatSigningProvider` and recalc the internal key by negation, Thanks :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500000' id='674153'>
<a class='timestamp' href='#674153'><time timestamp='2019-07-30T15:20:00Z'>15:20</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #16493: test: Bump rpc_timeout in feature_dbcrash (master...1907-testRpcTimeoutBump) <a href="https://github.com/bitcoin/bitcoin/pull/16493" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16493</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500360' id='674154'>
<a class='timestamp' href='#674154'><time timestamp='2019-07-30T15:26:00Z'>15:26</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: i&#x27;d add TaprootPath entries to SigningProvider (with a map from keyid, or from pubkey, unsure), one for each spending path
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500420' id='674155'>
<a class='timestamp' href='#674155'><time timestamp='2019-07-30T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: for key paths, it would contain the tweak and the pubkey it&#x27;s derived from
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500420' id='674156'>
<a class='timestamp' href='#674156'><time timestamp='2019-07-30T15:27:00Z'>15:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: for script paths it would contain leaf version, script, and Merkle path
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500480' id='674157'>
<a class='timestamp' href='#674157'><time timestamp='2019-07-30T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the advantage is that this approach works evenn when you don&#x27;t know all scripts
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500480' id='674158'>
<a class='timestamp' href='#674158'><time timestamp='2019-07-30T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
hmm so you&#x27;re suggesting to split it to paths in the first place for the situation that you don&#x27;t know all the paths
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500480' id='674159'>
<a class='timestamp' href='#674159'><time timestamp='2019-07-30T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500480' id='674160'>
<a class='timestamp' href='#674160'><time timestamp='2019-07-30T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
although i&#x27;ll argue that you shouldn&#x27;t be able to sign for an address that you don&#x27;t know all the paths for
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500480' id='674161'>
<a class='timestamp' href='#674161'><time timestamp='2019-07-30T15:28:00Z'>15:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i don&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500540' id='674162'>
<a class='timestamp' href='#674162'><time timestamp='2019-07-30T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
because that mean you might not really &quot;own&quot; the coins
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500540' id='674163'>
<a class='timestamp' href='#674163'><time timestamp='2019-07-30T15:29:00Z'>15:29</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there is a difference between treating a coin as yours, and participating in signing
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500600' id='674164'>
<a class='timestamp' href='#674164'><time timestamp='2019-07-30T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the descriptor side of things will always have the whole tree, and is used for determining what is yours
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500600' id='674165'>
<a class='timestamp' href='#674165'><time timestamp='2019-07-30T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
and in the end of the path do you think it should be a CScript or a CScriptID to the map of scripts that is already that (and probably will already have those scripts because i&#x27;m using descriptors for the leafs so ExpandHelper will fill it up)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500600' id='674166'>
<a class='timestamp' href='#674166'><time timestamp='2019-07-30T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
sipa: right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500600' id='674167'>
<a class='timestamp' href='#674167'><time timestamp='2019-07-30T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think it can be CScript
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500600' id='674168'>
<a class='timestamp' href='#674168'><time timestamp='2019-07-30T15:30:00Z'>15:30</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
even with the redundancy?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500660' id='674169'>
<a class='timestamp' href='#674169'><time timestamp='2019-07-30T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the scripts shouldn&#x27;t be in the normal script map i think
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500660' id='674170'>
<a class='timestamp' href='#674170'><time timestamp='2019-07-30T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as they&#x27;re distinct anyway
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500660' id='674171'>
<a class='timestamp' href='#674171'><time timestamp='2019-07-30T15:31:00Z'>15:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
as in: they ought to be a distinct namespace, because taproot scripts have different semantics 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500720' id='674172'>
<a class='timestamp' href='#674172'><time timestamp='2019-07-30T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: wouldn&#x27;t that complicate the new IsMine() logic, which is now just a look up in the &quot;regular&quot; scripts map?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500720' id='674173'>
<a class='timestamp' href='#674173'><time timestamp='2019-07-30T15:32:00Z'>15:32</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
sipa: but if I have `tap(key, [p2k(...), p2kh(...)])` I want to use the PKDescriptor and PKHDescriptor descriptors
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500780' id='674174'>
<a class='timestamp' href='#674174'><time timestamp='2019-07-30T15:33:00Z'>15:33</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
and in the end it&#x27;s still `OP_CHECKSIG`
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500900' id='674175'>
<a class='timestamp' href='#674175'><time timestamp='2019-07-30T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: the IsMine logic will just be descriptors
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500900' id='674176'>
<a class='timestamp' href='#674176'><time timestamp='2019-07-30T15:35:00Z'>15:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
in no way should taproot stuff influence the old legacy IsMine code
<br>
</div>

<div class='talk op-msg' data-timestamp='1564500960' id='674177'>
<a class='timestamp' href='#674177'><time timestamp='2019-07-30T15:36:00Z'>15:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: ok, so?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501020' id='674178'>
<a class='timestamp' href='#674178'><time timestamp='2019-07-30T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: expanding a PK descriptor gives you a script; inside a taproot descriptor you put that in the tree rather than directly in the script map
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501020' id='674179'>
<a class='timestamp' href='#674179'><time timestamp='2019-07-30T15:37:00Z'>15:37</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
yeah I mean for native descriptor wallets, not the legacy ones. i.e., DescriptorScriptPubKeyMan::IsMine() . That will have to change if we add tapscripts to a different map, no?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501080' id='674180'>
<a class='timestamp' href='#674180'><time timestamp='2019-07-30T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: no
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501080' id='674181'>
<a class='timestamp' href='#674181'><time timestamp='2019-07-30T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
I just realized that when I&#x27;m expanding I use `MakeScripts` on the subdescriptors and not`ExpandHelper` so it wouldn&#x27;t automatically get added to the FlatSigningProvider
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501080' id='674182'>
<a class='timestamp' href='#674182'><time timestamp='2019-07-30T15:38:00Z'>15:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: there is a map of scriptPubKeys
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501140' id='674183'>
<a class='timestamp' href='#674183'><time timestamp='2019-07-30T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: that is not the same map as the mapScripts in signing providers
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501140' id='674184'>
<a class='timestamp' href='#674184'><time timestamp='2019-07-30T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
makes sense. so the ExpandHelper could also generate all the possible script paths and add them to the provider
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501140' id='674185'>
<a class='timestamp' href='#674185'><time timestamp='2019-07-30T15:39:00Z'>15:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
right, or the taproot specific code does that
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501200' id='674186'>
<a class='timestamp' href='#674186'><time timestamp='2019-07-30T15:40:00Z'>15:40</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501260' id='674187'>
<a class='timestamp' href='#674187'><time timestamp='2019-07-30T15:41:00Z'>15:41</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
btw, I see that your code right now hard codes `0xc0` in the consensus code, and it doesn&#x27;t compose it in a way. I&#x27;m thinking if it&#x27;s worth the effort to really add a leaf version already or do the same (which isn&#x27;t good in engineering stand point but not sure if it&#x27;s worth the effort assuming that other parts hard code it)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501320' id='674188'>
<a class='timestamp' href='#674188'><time timestamp='2019-07-30T15:42:00Z'>15:42</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: i think it makes sense that descripts for now only support tapscript v0
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501380' id='674189'>
<a class='timestamp' href='#674189'><time timestamp='2019-07-30T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
*descriptors
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501380' id='674190'>
<a class='timestamp' href='#674190'><time timestamp='2019-07-30T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i think for psbt extensions we do want to support encoding other tapscript versions
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501380' id='674191'>
<a class='timestamp' href='#674191'><time timestamp='2019-07-30T15:43:00Z'>15:43</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
üëç yeah. probably won&#x27;t see a new tapscript version for a while haha
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501560' id='674192'>
<a class='timestamp' href='#674192'><time timestamp='2019-07-30T15:46:00Z'>15:46</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: you&#x27;re right I got those 2 mixed up, oops. So it&#x27;s the `LookupHelper` for SigningProvider that will have to change to account for tapscripts, IsMine won&#x27;t.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501560' id='674193'>
<a class='timestamp' href='#674193'><time timestamp='2019-07-30T15:46:00Z'>15:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: i don&#x27;t think the descriptor wallet code will need to change at all
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501620' id='674194'>
<a class='timestamp' href='#674194'><time timestamp='2019-07-30T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: taproot descriptors will still be populating the list of scriptPubKeys to watch for
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501620' id='674195'>
<a class='timestamp' href='#674195'><time timestamp='2019-07-30T15:47:00Z'>15:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mapScripts/taproot tree elichai2 and i were talking about is for internal scripts, not scriptPubKeys
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501680' id='674196'>
<a class='timestamp' href='#674196'><time timestamp='2019-07-30T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
yep. the scriptPubKey is the easiest part.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501680' id='674197'>
<a class='timestamp' href='#674197'><time timestamp='2019-07-30T15:48:00Z'>15:48</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jonasschnelli, it means you can just copy the a buffer into the fields without much real logic
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501920' id='674198'>
<a class='timestamp' href='#674198'><time timestamp='2019-07-30T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: well for new message types they can be selected to not collide with existing ones
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501920' id='674199'>
<a class='timestamp' href='#674199'><time timestamp='2019-07-30T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: right descriptor part won&#x27;t change, but the Signing Provider will need to change, right? as it involves looking up for things to sign which include internal scripts?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501920' id='674200'>
<a class='timestamp' href='#674200'><time timestamp='2019-07-30T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: signingprovider will get extra fields yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501920' id='674201'>
<a class='timestamp' href='#674201'><time timestamp='2019-07-30T15:52:00Z'>15:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but they should &#x27;t really interact with descriptor wallets
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501980' id='674202'>
<a class='timestamp' href='#674202'><time timestamp='2019-07-30T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: but it also supports &quot;uncoordinated new messages&quot; because until there are 1000s of message types, the chance for collisions will be negligae
<br>
</div>

<div class='talk op-msg' data-timestamp='1564501980' id='674203'>
<a class='timestamp' href='#674203'><time timestamp='2019-07-30T15:53:00Z'>15:53</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
phantomcircuit: bitcoin core already uses variables sizes for everything.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502100' id='674204'>
<a class='timestamp' href='#674204'><time timestamp='2019-07-30T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
elichai2: i think BlueMatt&#x27;s comment is mostly for the sake of other implementations
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502100' id='674205'>
<a class='timestamp' href='#674205'><time timestamp='2019-07-30T15:55:00Z'>15:55</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: I get the point. But in out context and with the V2 encryption packet that is already vlen this point has little weight IMO
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502160' id='674206'>
<a class='timestamp' href='#674206'><time timestamp='2019-07-30T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
oh. but they will need to implement the variable size type/functions anyway for the rest of the stuff in bitcoin. so why not use the same type we use everywhere?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502160' id='674207'>
<a class='timestamp' href='#674207'><time timestamp='2019-07-30T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
elichai2: we actually dont for the headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502160' id='674208'>
<a class='timestamp' href='#674208'><time timestamp='2019-07-30T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: i&#x27;m personally perfectly fine with the approach you suggested, but given BlueMatt&#x27;s criticism i found this idea of just shortening the field perhaps a useful middle grou d
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502160' id='674209'>
<a class='timestamp' href='#674209'><time timestamp='2019-07-30T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. I think in general it&#x27;s an acceptable idea... but...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502160' id='674210'>
<a class='timestamp' href='#674210'><time timestamp='2019-07-30T15:56:00Z'>15:56</time></a>
&lt;<span class='nick nick-10'> elichai2</span>&gt;
BlueMatt: oh really? ok. sorry, I don&#x27;t know much about the p2p layer so i&#x27;ll remove myself from this conversation ha
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502220' id='674211'>
<a class='timestamp' href='#674211'><time timestamp='2019-07-30T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: the header is not, no? and its a different layer - net vs protocol/net_processing deserialization
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502220' id='674212'>
<a class='timestamp' href='#674212'><time timestamp='2019-07-30T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the net code isnt aware of what the message contains, or how to deserialize it
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502220' id='674213'>
<a class='timestamp' href='#674213'><time timestamp='2019-07-30T15:57:00Z'>15:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
and it is dead simple
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502280' id='674214'>
<a class='timestamp' href='#674214'><time timestamp='2019-07-30T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
but, honestly, I dont think its <b>*really*</b> worth it. I find variable length headers distasteful given the million and one issues that have existed in implementing them, but if you really, really want to save 3 bytes, I&#x27;m not gonna argue for them
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502280' id='674215'>
<a class='timestamp' href='#674215'><time timestamp='2019-07-30T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
In current v2: the headers is the short-ID where ID 1-12 is a varlen string message-command
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502280' id='674216'>
<a class='timestamp' href='#674216'><time timestamp='2019-07-30T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
dont think endlessly debating it is really worth it, that is
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502280' id='674217'>
<a class='timestamp' href='#674217'><time timestamp='2019-07-30T15:58:00Z'>15:58</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
right, yes, I was under the impression that was the only variable length in the message header/the part that net has to deal with
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502340' id='674218'>
<a class='timestamp' href='#674218'><time timestamp='2019-07-30T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-16'> * BlueMatt</span>&gt;
-&gt; lunch
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502340' id='674219'>
<a class='timestamp' href='#674219'><time timestamp='2019-07-30T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well, the payload is also variable size, obviously
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502340' id='674220'>
<a class='timestamp' href='#674220'><time timestamp='2019-07-30T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: From a design perspective, I dislike variable length headers as much as you do. But I think in our case its fine and the complexity it adds is near 0.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502340' id='674221'>
<a class='timestamp' href='#674221'><time timestamp='2019-07-30T15:59:00Z'>15:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: excactly.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674222'>
<a class='timestamp' href='#674222'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
the compexity it adds is, however, non-0, and the cost it removes <b>*is*</b> 0 :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674223'>
<a class='timestamp' href='#674223'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: descriptors do depend on the Signing Providers to expand their cache, so they interact somewhat? (which was my bug yesterday). But descriptors don&#x27;t need to know how SPs generate the cache (and therefore won&#x27;t need to change at all for Taproot to work).
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674224'>
<a class='timestamp' href='#674224'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: I disagree. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674225'>
<a class='timestamp' href='#674225'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: yes, descriptors very much interact with signingproviders
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674226'>
<a class='timestamp' href='#674226'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: but the wallet code shouldn&#x27;t
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674227'>
<a class='timestamp' href='#674227'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
That&#x27;s why I&#x27;d like to hear what the &quot;non-0 complexity&quot; is,.. why a vlen headers adds complexity in our case (not in a general case)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502400' id='674228'>
<a class='timestamp' href='#674228'><time timestamp='2019-07-30T16:00:00Z'>16:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: ^
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502460' id='674229'>
<a class='timestamp' href='#674229'><time timestamp='2019-07-30T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-14'> hugohn</span>&gt;
sipa: right. ok it&#x27;s clear to me now. thanks!
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502460' id='674230'>
<a class='timestamp' href='#674230'><time timestamp='2019-07-30T16:01:00Z'>16:01</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: actually one issue about the variable length header scares me a bit, namely tha6 the encryption is designed to hide message types
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502520' id='674231'>
<a class='timestamp' href='#674231'><time timestamp='2019-07-30T16:02:00Z'>16:02</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
though i need to read up on the openssl chacha/poly1305 design to understand it better
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502580' id='674232'>
<a class='timestamp' href='#674232'><time timestamp='2019-07-30T16:03:00Z'>16:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: Yeah, that&#x27;s maybe a point. Though, in most cases, you&#x27;ll never ever use variable length messages.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502580' id='674233'>
<a class='timestamp' href='#674233'><time timestamp='2019-07-30T16:03:00Z'>16:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BIP324 defines short ids (single byte command) for every message.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502640' id='674234'>
<a class='timestamp' href='#674234'><time timestamp='2019-07-30T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
New messages could do the same,...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502640' id='674235'>
<a class='timestamp' href='#674235'><time timestamp='2019-07-30T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: there may be coordination issues there
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502640' id='674236'>
<a class='timestamp' href='#674236'><time timestamp='2019-07-30T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
using string based message commands is more for extensions that don&#x27;t want to deal with short IDs
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502640' id='674237'>
<a class='timestamp' href='#674237'><time timestamp='2019-07-30T16:04:00Z'>16:04</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: eventually,... but as long as all new message types come with a short ID, I don&#x27;t think there is.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502700' id='674238'>
<a class='timestamp' href='#674238'><time timestamp='2019-07-30T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
The fallback to string base commands is unused in the ideal case
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502700' id='674239'>
<a class='timestamp' href='#674239'><time timestamp='2019-07-30T16:05:00Z'>16:05</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
except a fork-coin adds shit messages and don&#x27;t bother with adding a short ID
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502760' id='674240'>
<a class='timestamp' href='#674240'><time timestamp='2019-07-30T16:06:00Z'>16:06</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jonasschnelli, it means you can have a simple bent pipe that isn&#x27;t doing decryption but does understand the headers
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502820' id='674241'>
<a class='timestamp' href='#674241'><time timestamp='2019-07-30T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
And I do think 3 bytes matter. Especially if we know that almost 50% of our messages. are &lt;=64bytes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502820' id='674242'>
<a class='timestamp' href='#674242'><time timestamp='2019-07-30T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Which results that 3bytes may be 5%.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502820' id='674243'>
<a class='timestamp' href='#674243'><time timestamp='2019-07-30T16:07:00Z'>16:07</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(BTCFlood though)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502880' id='674244'>
<a class='timestamp' href='#674244'><time timestamp='2019-07-30T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: ehm?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502880' id='674245'>
<a class='timestamp' href='#674245'><time timestamp='2019-07-30T16:08:00Z'>16:08</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
If you don&#x27;t understand decryption, you won&#x27;t be able to read the payload length and therefore would never come to the point where a fix length header would matter? Not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502940' id='674246'>
<a class='timestamp' href='#674246'><time timestamp='2019-07-30T16:09:00Z'>16:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: let me think think things through the next days
<br>
</div>

<div class='talk op-msg' data-timestamp='1564502940' id='674247'>
<a class='timestamp' href='#674247'><time timestamp='2019-07-30T16:09:00Z'>16:09</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
hugohn: yw
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503000' id='674248'>
<a class='timestamp' href='#674248'><time timestamp='2019-07-30T16:10:00Z'>16:10</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa:  Sure. Thanks for digging in!
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503000' id='674249'>
<a class='timestamp' href='#674249'><time timestamp='2019-07-30T16:10:00Z'>16:10</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
phantomcircuit: <a href="https://bitcoinbuilds.org/v2.png" class="link" target="_blank">https://bitcoinbuilds.org/v2.png</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503060' id='674250'>
<a class='timestamp' href='#674250'><time timestamp='2019-07-30T16:11:00Z'>16:11</time></a>
&lt;<span class='nick nick-12'> * jonasschnelli</span>&gt;
break
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503120' id='674251'>
<a class='timestamp' href='#674251'><time timestamp='2019-07-30T16:12:00Z'>16:12</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] promag opened pull request #16494: wallet: Drop support to serialize OldKey (master...2019-07-drop-oldkey-serialize) <a href="https://github.com/bitcoin/bitcoin/pull/16494" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16494</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503420' id='674252'>
<a class='timestamp' href='#674252'><time timestamp='2019-07-30T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
jonasschnelli, the length is encrypted?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503420' id='674253'>
<a class='timestamp' href='#674253'><time timestamp='2019-07-30T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
jup
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503420' id='674254'>
<a class='timestamp' href='#674254'><time timestamp='2019-07-30T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i guess that makes sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503420' id='674255'>
<a class='timestamp' href='#674255'><time timestamp='2019-07-30T16:17:00Z'>16:17</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
shrug
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503600' id='674256'>
<a class='timestamp' href='#674256'><time timestamp='2019-07-30T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: to answer your question, in a general case, the way you write a network layer (eg the way bitcoin core does it today) is step 1) read message header, step 2) check stuff about the header, step 3) allocate buffer for the size it told you, step 4) read message. this keeps things nice and simple, you dont have much allocation complexity and you avoid most buffer overflow issues if you misallocate in your network stack. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503600' id='674257'>
<a class='timestamp' href='#674257'><time timestamp='2019-07-30T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hence my (strongly-held) view that variable-length, when it is reasonably avoidable, is always bad protocol design. obviously there are tradeoffs, but more lines of code that allocate and then read into a buffer in async networking have been the source of such a huge number of buffer overflow vulns over the years....
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503600' id='674258'>
<a class='timestamp' href='#674258'><time timestamp='2019-07-30T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
in this case its not as much an issue cause at least its only twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503600' id='674259'>
<a class='timestamp' href='#674259'><time timestamp='2019-07-30T16:20:00Z'>16:20</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so, again, not worth endless debate around it, I&#x27;m happy to not care anymore.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503660' id='674260'>
<a class='timestamp' href='#674260'><time timestamp='2019-07-30T16:21:00Z'>16:21</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
just answering your question of why
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503720' id='674261'>
<a class='timestamp' href='#674261'><time timestamp='2019-07-30T16:22:00Z'>16:22</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
thanks! i totaly agree with all of your point... but... we deal with inner messages (decrypted)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503780' id='674262'>
<a class='timestamp' href='#674262'><time timestamp='2019-07-30T16:23:00Z'>16:23</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
the buffer is allocated and the data has ben read regardless of a fix length header or not (in our case of encrypted messages)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503780' id='674263'>
<a class='timestamp' href='#674263'><time timestamp='2019-07-30T16:23:00Z'>16:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: the &#x27;encrypted length&#x27; field covers the sum of message type and payload, or not?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503840' id='674264'>
<a class='timestamp' href='#674264'><time timestamp='2019-07-30T16:24:00Z'>16:24</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(i think it should)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503900' id='674265'>
<a class='timestamp' href='#674265'><time timestamp='2019-07-30T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
the payload of a encrypted packet is [message command short ID + message payload]
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503900' id='674266'>
<a class='timestamp' href='#674266'><time timestamp='2019-07-30T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
so the encrypted length is on the network layer
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503900' id='674267'>
<a class='timestamp' href='#674267'><time timestamp='2019-07-30T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, so the encrypted length is the length of the encrypted payload, not just the message payload?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503900' id='674268'>
<a class='timestamp' href='#674268'><time timestamp='2019-07-30T16:25:00Z'>16:25</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564503960' id='674269'>
<a class='timestamp' href='#674269'><time timestamp='2019-07-30T16:26:00Z'>16:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: I&#x27;m not sure you read my point? my pont was that most protocols have variable length bodies, but those are handled at a different level than the constant-length header.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504020' id='674270'>
<a class='timestamp' href='#674270'><time timestamp='2019-07-30T16:27:00Z'>16:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
BlueMatt: right, but here it is still a fixed length header + variable length message; the command is just the first few bytes of that variable length message
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504020' id='674271'>
<a class='timestamp' href='#674271'><time timestamp='2019-07-30T16:27:00Z'>16:27</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so there are no additional variable length buffers or so involved
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504080' id='674272'>
<a class='timestamp' href='#674272'><time timestamp='2019-07-30T16:28:00Z'>16:28</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
just a decision where the command ends and where the message payload begins
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504080' id='674273'>
<a class='timestamp' href='#674273'><time timestamp='2019-07-30T16:28:00Z'>16:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504080' id='674274'>
<a class='timestamp' href='#674274'><time timestamp='2019-07-30T16:28:00Z'>16:28</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
eventually the v2 header is the 3 byte payload length
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504140' id='674275'>
<a class='timestamp' href='#674275'><time timestamp='2019-07-30T16:29:00Z'>16:29</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I see all the design points. but I don&#x27;t think there are practical costs for a variable length message command in v2
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504200' id='674276'>
<a class='timestamp' href='#674276'><time timestamp='2019-07-30T16:30:00Z'>16:30</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
(though I hope I&#x27;m right)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504200' id='674277'>
<a class='timestamp' href='#674277'><time timestamp='2019-07-30T16:30:00Z'>16:30</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: so... either you&#x27;re going to make the decision between splitting the command from payload on the fly (before you&#x27;ve validated the MAC) or you do it afterwards
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504260' id='674278'>
<a class='timestamp' href='#674278'><time timestamp='2019-07-30T16:31:00Z'>16:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you do it on the fly there is a risk of creating a decryption oracle (not saying there is... but running any code based on decrypted but unauthenticated data is a red flag)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504260' id='674279'>
<a class='timestamp' href='#674279'><time timestamp='2019-07-30T16:31:00Z'>16:31</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if you do it afterwards, it&#x27;ll may hard to avoid a copy
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674280'>
<a class='timestamp' href='#674280'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I see...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674281'>
<a class='timestamp' href='#674281'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
with fixed command size you could split on the fly without that risk
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674282'>
<a class='timestamp' href='#674282'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
hmm?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674283'>
<a class='timestamp' href='#674283'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;d just be &quot;first 3 bytes go here, other bytes go there&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674284'>
<a class='timestamp' href='#674284'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
without looking at what those bytes are
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674285'>
<a class='timestamp' href='#674285'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
(3 or 4 or whatever)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504320' id='674286'>
<a class='timestamp' href='#674286'><time timestamp='2019-07-30T16:32:00Z'>16:32</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I see
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504380' id='674287'>
<a class='timestamp' href='#674287'><time timestamp='2019-07-30T16:33:00Z'>16:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
there actually is another solution: putting the information on variable length command or not in the length field
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504380' id='674288'>
<a class='timestamp' href='#674288'><time timestamp='2019-07-30T16:33:00Z'>16:33</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
but that&#x27;s... even less conventional
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504380' id='674289'>
<a class='timestamp' href='#674289'><time timestamp='2019-07-30T16:33:00Z'>16:33</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
so.. your saying, before we decrypt, we place the 4 byte command string into a buffer and the payload
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504440' id='674290'>
<a class='timestamp' href='#674290'><time timestamp='2019-07-30T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if decryption is in-place, sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504440' id='674291'>
<a class='timestamp' href='#674291'><time timestamp='2019-07-30T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
then decrypt the fix length command and not needing to deal with buffers anymore
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504440' id='674292'>
<a class='timestamp' href='#674292'><time timestamp='2019-07-30T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I think this is a valid point
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504440' id='674293'>
<a class='timestamp' href='#674293'><time timestamp='2019-07-30T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
let me write things in pseudocode
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504440' id='674294'>
<a class='timestamp' href='#674294'><time timestamp='2019-07-30T16:34:00Z'>16:34</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
hi, make on depends/ gives &quot;./google/protobuf/stubs/common.h:38:10: fatal error: &#x27;assert.h&#x27; file not found&quot; .. hints?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504500' id='674295'>
<a class='timestamp' href='#674295'><time timestamp='2019-07-30T16:35:00Z'>16:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
though, we could optimize of that case and avoid a copy if the message command is a 1byte short ID
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504500' id='674296'>
<a class='timestamp' href='#674296'><time timestamp='2019-07-30T16:35:00Z'>16:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
and if not, we do a copy.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504500' id='674297'>
<a class='timestamp' href='#674297'><time timestamp='2019-07-30T16:35:00Z'>16:35</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: copy should always be avoidable
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504500' id='674298'>
<a class='timestamp' href='#674298'><time timestamp='2019-07-30T16:35:00Z'>16:35</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
yes.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504560' id='674299'>
<a class='timestamp' href='#674299'><time timestamp='2019-07-30T16:36:00Z'>16:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, putting the mac after the data is just asking for implementers to decrypt the payload before checking the mac
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504560' id='674300'>
<a class='timestamp' href='#674300'><time timestamp='2019-07-30T16:36:00Z'>16:36</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
I need to go through the code...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504560' id='674301'>
<a class='timestamp' href='#674301'><time timestamp='2019-07-30T16:36:00Z'>16:36</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
(although i do understand it being after makes it easier to stream data out)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504560' id='674302'>
<a class='timestamp' href='#674302'><time timestamp='2019-07-30T16:36:00Z'>16:36</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: but it&#x27;s also the only option if you want to avoid a copy
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504620' id='674303'>
<a class='timestamp' href='#674303'><time timestamp='2019-07-30T16:37:00Z'>16:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, uh why
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504620' id='674304'>
<a class='timestamp' href='#674304'><time timestamp='2019-07-30T16:37:00Z'>16:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
wait a copy on the sender or a copy on the receivers side?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504620' id='674305'>
<a class='timestamp' href='#674305'><time timestamp='2019-07-30T16:37:00Z'>16:37</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: you&#x27;d need to buffer the unencrypted data when sending
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504680' id='674306'>
<a class='timestamp' href='#674306'><time timestamp='2019-07-30T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or the encrypted data, also possible
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504680' id='674307'>
<a class='timestamp' href='#674307'><time timestamp='2019-07-30T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, it&#x27;s probably getting buffered anyways but in smaller pieces
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504680' id='674308'>
<a class='timestamp' href='#674308'><time timestamp='2019-07-30T16:38:00Z'>16:38</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
maybe
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504740' id='674309'>
<a class='timestamp' href='#674309'><time timestamp='2019-07-30T16:39:00Z'>16:39</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
either way objects being serialized are going to be copied into a buffer
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504740' id='674310'>
<a class='timestamp' href='#674310'><time timestamp='2019-07-30T16:39:00Z'>16:39</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
sure, but putting MAC first means an additional buffering either way on top of whatever else is being done
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504740' id='674311'>
<a class='timestamp' href='#674311'><time timestamp='2019-07-30T16:39:00Z'>16:39</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
but there&#x27;s no easy way as of now i think to serialize directly into the buffer you&#x27;re going to use for the send() call
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504800' id='674312'>
<a class='timestamp' href='#674312'><time timestamp='2019-07-30T16:40:00Z'>16:40</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, fair, put otherwise: you&#x27;re going to need to go over your data twice
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504920' id='674313'>
<a class='timestamp' href='#674313'><time timestamp='2019-07-30T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i think right now you&#x27;d do something like, serialize a bunch of stuff into a buffer forming an unencrypted message, copy chunks for chacha20 and mac, then send the chunk and the mac after you&#x27;ve processed all the chunks
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504920' id='674314'>
<a class='timestamp' href='#674314'><time timestamp='2019-07-30T16:42:00Z'>16:42</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
but if you just do the chacha20 encryption of the buffer with the unencrypted message in place you can easily calculate the mac before without a copy
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504980' id='674315'>
<a class='timestamp' href='#674315'><time timestamp='2019-07-30T16:43:00Z'>16:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the mac is computed over the encrypted data
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504980' id='674316'>
<a class='timestamp' href='#674316'><time timestamp='2019-07-30T16:43:00Z'>16:43</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah that&#x27;s what i said
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504980' id='674317'>
<a class='timestamp' href='#674317'><time timestamp='2019-07-30T16:43:00Z'>16:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so you can do one pass of encrypting-in-place + mac, send mac, and then go back over your encrypted data and send it out
<br>
</div>

<div class='talk op-msg' data-timestamp='1564504980' id='674318'>
<a class='timestamp' href='#674318'><time timestamp='2019-07-30T16:43:00Z'>16:43</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
if the mac goes last, you can interleave encryption and sending
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505040' id='674319'>
<a class='timestamp' href='#674319'><time timestamp='2019-07-30T16:44:00Z'>16:44</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
yeah but you cant deallocate anything anyways so it&#x27;s just a very small latency win
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505040' id='674320'>
<a class='timestamp' href='#674320'><time timestamp='2019-07-30T16:44:00Z'>16:44</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
for large messages it may matter, but agree it&#x27;s a small point
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505040' id='674321'>
<a class='timestamp' href='#674321'><time timestamp='2019-07-30T16:44:00Z'>16:44</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
as long as it&#x27;s very clear you cant decrypt things before checking the mac im sure it&#x27;s fine... but doing so is going to look like a performance/latency win to a naive implementer
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505100' id='674322'>
<a class='timestamp' href='#674322'><time timestamp='2019-07-30T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i mean our largest message is like 2MB right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505100' id='674323'>
<a class='timestamp' href='#674323'><time timestamp='2019-07-30T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
well you very much can decrypt before checking mac
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505100' id='674324'>
<a class='timestamp' href='#674324'><time timestamp='2019-07-30T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you just can&#x27;t use the data before doing so
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505100' id='674325'>
<a class='timestamp' href='#674325'><time timestamp='2019-07-30T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
chacha20 + mac over 2MB on even an rpi3 is going to be basically instant
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505100' id='674326'>
<a class='timestamp' href='#674326'><time timestamp='2019-07-30T16:45:00Z'>16:45</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
or can&#x27;t make any decision that the other party can observe based on that decrypted data even
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505160' id='674327'>
<a class='timestamp' href='#674327'><time timestamp='2019-07-30T16:46:00Z'>16:46</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505220' id='674328'>
<a class='timestamp' href='#674328'><time timestamp='2019-07-30T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
i cant see that being an issue in most languages... but things that are very very &quot;async&quot; might try to decrypt, consume and calculate the mac in parallel
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505220' id='674329'>
<a class='timestamp' href='#674329'><time timestamp='2019-07-30T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
phantomcircuit: 7.5 ms on a RK3399 ARM64 CPU to decrypt/auth 1MB of data
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505220' id='674330'>
<a class='timestamp' href='#674330'><time timestamp='2019-07-30T16:47:00Z'>16:47</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
that&#x27;s not nothing
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505280' id='674331'>
<a class='timestamp' href='#674331'><time timestamp='2019-07-30T16:48:00Z'>16:48</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
the poly1305 code can be optimized more, though
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505280' id='674332'>
<a class='timestamp' href='#674332'><time timestamp='2019-07-30T16:48:00Z'>16:48</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: I don&#x27;t think we need to copy
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505340' id='674333'>
<a class='timestamp' href='#674333'><time timestamp='2019-07-30T16:49:00Z'>16:49</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
We have a. CDataStream where the encrypted payload sits. Then we decrypt that &quot;buffer&quot; with ChaCha (after the MAC check). We read the eventually variable length command from that now decrypted CDataStream,...  then directly deserialize from that CDataStream
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505340' id='674334'>
<a class='timestamp' href='#674334'><time timestamp='2019-07-30T16:49:00Z'>16:49</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
jonasschnelli: yeah, that&#x27;s fair
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505400' id='674335'>
<a class='timestamp' href='#674335'><time timestamp='2019-07-30T16:50:00Z'>16:50</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Looking at the (old) V2 code,... I think there is no copy involved
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505460' id='674336'>
<a class='timestamp' href='#674336'><time timestamp='2019-07-30T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it&#x27;d be nice to be able to decrypt on the fly though, so if you have a slow CPU + slow network, the message is already mostly decrypted by the time the last part of the packet arrives
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505460' id='674337'>
<a class='timestamp' href='#674337'><time timestamp='2019-07-30T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
So the variable length message command is more or less part of the message (which is vlen anyways)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505460' id='674338'>
<a class='timestamp' href='#674338'><time timestamp='2019-07-30T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and you can, and it&#x27;s probably fine... just a bit scary
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505460' id='674339'>
<a class='timestamp' href='#674339'><time timestamp='2019-07-30T16:51:00Z'>16:51</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: decrypting on the fly is orthogonal to the fixed length command string, right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505520' id='674340'>
<a class='timestamp' href='#674340'><time timestamp='2019-07-30T16:52:00Z'>16:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ah i see, with that CDataStream trick it is
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505520' id='674341'>
<a class='timestamp' href='#674341'><time timestamp='2019-07-30T16:52:00Z'>16:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
you effectively leave the command inside the CDataStream you give to the net processing code, but with the offset placed after it
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505520' id='674342'>
<a class='timestamp' href='#674342'><time timestamp='2019-07-30T16:52:00Z'>16:52</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505520' id='674343'>
<a class='timestamp' href='#674343'><time timestamp='2019-07-30T16:52:00Z'>16:52</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yup, agree
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505580' id='674344'>
<a class='timestamp' href='#674344'><time timestamp='2019-07-30T16:53:00Z'>16:53</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Also, the important part of &quot;on the fly&quot; is probably precomputing the ChaCha20 stream up a a certain &quot;cache&quot; size.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505580' id='674345'>
<a class='timestamp' href='#674345'><time timestamp='2019-07-30T16:53:00Z'>16:53</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
We then eventually only do xors in the network code
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505640' id='674346'>
<a class='timestamp' href='#674346'><time timestamp='2019-07-30T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
heh, good point
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505640' id='674347'>
<a class='timestamp' href='#674347'><time timestamp='2019-07-30T16:54:00Z'>16:54</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
ok, i agree that the ability to decode on the fly isn&#x27;t an argument against variable length commands
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505700' id='674348'>
<a class='timestamp' href='#674348'><time timestamp='2019-07-30T16:55:00Z'>16:55</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
The remaining question is whether the variable length command increases message type detectability
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505760' id='674349'>
<a class='timestamp' href='#674349'><time timestamp='2019-07-30T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
not if the encrypted length covers the command as well
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505760' id='674350'>
<a class='timestamp' href='#674350'><time timestamp='2019-07-30T16:56:00Z'>16:56</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Yes. It does. So I also think it&#x27;s not an agrument.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505820' id='674351'>
<a class='timestamp' href='#674351'><time timestamp='2019-07-30T16:57:00Z'>16:57</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Which makes me again think saving 3 bytes is worth the variable length command
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505880' id='674352'>
<a class='timestamp' href='#674352'><time timestamp='2019-07-30T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
i like the perspective of &quot;the command is just the first bytes of the message payload, and we detect the command after allocating/receiving/decrypting/authenticating the whole payload&quot;
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505880' id='674353'>
<a class='timestamp' href='#674353'><time timestamp='2019-07-30T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Maybe one could think passing a CDataStream to the next layer with a pointer not pointing the the buffer start is ugly stuff
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505880' id='674354'>
<a class='timestamp' href='#674354'><time timestamp='2019-07-30T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sipa: Yes. I think that definition clears up things
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505880' id='674355'>
<a class='timestamp' href='#674355'><time timestamp='2019-07-30T16:58:00Z'>16:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
so i&#x27;m fine with whatever
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505940' id='674356'>
<a class='timestamp' href='#674356'><time timestamp='2019-07-30T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Somehow I care about those 3 bytes... maybe wrongly. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505940' id='674357'>
<a class='timestamp' href='#674357'><time timestamp='2019-07-30T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
including BlueMatt&#x27;s suggestion earlier of only supporting 1-byte and 12-byte commands
<br>
</div>

<div class='talk op-msg' data-timestamp='1564505940' id='674358'>
<a class='timestamp' href='#674358'><time timestamp='2019-07-30T16:59:00Z'>16:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
Though there is a yes/no wether a V2 inv is larger than a V1 inv.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564506000' id='674359'>
<a class='timestamp' href='#674359'><time timestamp='2019-07-30T17:00:00Z'>17:00</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
though with a 4 bytes fixed length command. It would still be 1 bytes smaller then V1.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564506060' id='674360'>
<a class='timestamp' href='#674360'><time timestamp='2019-07-30T17:01:00Z'>17:01</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
<b>*than V1*</b>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564509360' id='674361'>
<a class='timestamp' href='#674361'><time timestamp='2019-07-30T17:56:00Z'>17:56</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke opened pull request #16497: gui: Generate bech32 addresses by default (take 2, fixup) (master...1907-guiBech32Take2) <a href="https://github.com/bitcoin/bitcoin/pull/16497" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16497</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564509540' id='674362'>
<a class='timestamp' href='#674362'><time timestamp='2019-07-30T17:59:00Z'>17:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gleb: have you seen the discussion last thursday on changes to wallet rebroadcasting? i wonder if you have any thoughts on interaction with erlay
<br>
</div>

<div class='talk op-msg' data-timestamp='1564509780' id='674363'>
<a class='timestamp' href='#674363'><time timestamp='2019-07-30T18:03:00Z'>18:03</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] TheBlueMatt reopened pull request #16323:  Call ProcessNewBlock() asynchronously (master...2019-07-background-pnb) <a href="https://github.com/bitcoin/bitcoin/pull/16323" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16323</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564509900' id='674364'>
<a class='timestamp' href='#674364'><time timestamp='2019-07-30T18:05:00Z'>18:05</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] TheBlueMatt reopened pull request #16324: Get cs_main out of the critical path in ProcessMessages (master...2019-07-peerstate-initial-moves) <a href="https://github.com/bitcoin/bitcoin/pull/16324" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16324</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564510200' id='674365'>
<a class='timestamp' href='#674365'><time timestamp='2019-07-30T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
^ seeking concept review :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564510200' id='674366'>
<a class='timestamp' href='#674366'><time timestamp='2019-07-30T18:10:00Z'>18:10</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
also seeking ibd benchmarks from multiple peers....(jamesob :p)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564510920' id='674367'>
<a class='timestamp' href='#674367'><time timestamp='2019-07-30T18:22:00Z'>18:22</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
sipa: I think it would work right away by just applying the same reasoning and looking at it as if the transaction was new
<br>
</div>

<div class='talk op-msg' data-timestamp='1564510980' id='674368'>
<a class='timestamp' href='#674368'><time timestamp='2019-07-30T18:23:00Z'>18:23</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
gleb: but if different nodes had inconsistent rebroadcasting rules (or even randomization in whether/when to try rebroadcasting), erlay would suffer
<br>
</div>

<div class='talk op-msg' data-timestamp='1564511100' id='674369'>
<a class='timestamp' href='#674369'><time timestamp='2019-07-30T18:25:00Z'>18:25</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
Oops, you are right, it would announce already known transactions potentially.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512300' id='674370'>
<a class='timestamp' href='#674370'><time timestamp='2019-07-30T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
There would be 2 kinds of nodes: those which have it in the mempool and those which don&#x27;t. For the latter we can&#x27;t do anything ‚Äî¬†we can only apply the default protocol (flooding/erlay) (unless we pass a flag along with a tx, but we&#x27;re not gonna do this)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512300' id='674371'>
<a class='timestamp' href='#674371'><time timestamp='2019-07-30T18:45:00Z'>18:45</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
For the former ‚Äî¬†I guess according to the rebroadcast reasoning they won&#x27;t re-relay anything if it&#x27;s received from somewhere (only if their own timer triggers).
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512360' id='674372'>
<a class='timestamp' href='#674372'><time timestamp='2019-07-30T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
So the question is really how we should act at the node which triggers rebroadcast. 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512360' id='674373'>
<a class='timestamp' href='#674373'><time timestamp='2019-07-30T18:46:00Z'>18:46</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
an alternative to rebroadcasting is of course mempool (full mempool, not relay) reconciliation...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512480' id='674374'>
<a class='timestamp' href='#674374'><time timestamp='2019-07-30T18:48:00Z'>18:48</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
Which is essentially just batching rebroadcasts over an hour or whatever.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564512960' id='674375'>
<a class='timestamp' href='#674375'><time timestamp='2019-07-30T18:56:00Z'>18:56</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
Yeah, I think exchanging sketches of rebroadcasts every hour or so might work. It&#x27;s really mempool reconciliation done right (no point to reconcile obviously known to both parties fresh txs or low-fee garbage)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513020' id='674376'>
<a class='timestamp' href='#674376'><time timestamp='2019-07-30T18:57:00Z'>18:57</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
I&#x27;m not sure estimation would work that well as in Erlay ‚Äî¬† I can&#x27;t tell how often rebroadcasts would happen and how different the rules will be and all that.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513080' id='674377'>
<a class='timestamp' href='#674377'><time timestamp='2019-07-30T18:58:00Z'>18:58</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
it can be orthogonal of course; post-erlay the rebroadcasts can just stay normal invs too
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513140' id='674378'>
<a class='timestamp' href='#674378'><time timestamp='2019-07-30T18:59:00Z'>18:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
though if their bandwidth is considerable, we&#x27;ll want a reconciliation based solution, whether by integrating into erlay, or by having a separate independent reconciliation step for rebroadcasts
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513800' id='674379'>
<a class='timestamp' href='#674379'><time timestamp='2019-07-30T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
Yeah. I think we can&#x27;t do much if rebroadcast uses regular invs though, as I explained above w.r.t 2 kinds of nodes. Anything coming to my mind about &quot;integrating into erlay&quot; is really complicated separate things.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513800' id='674380'>
<a class='timestamp' href='#674380'><time timestamp='2019-07-30T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
So in this case if Erlay&#x27;s estimation formula adjusts to this stuff we&#x27;re good, otherwise we might loose a bit of efficiency.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564513800' id='674381'>
<a class='timestamp' href='#674381'><time timestamp='2019-07-30T19:10:00Z'>19:10</time></a>
&lt;<span class='nick nick-2'> gleb</span>&gt;
In the case of regular inv rebroadcast *
<br>
</div>

<div class='talk op-msg' data-timestamp='1564515120' id='674382'>
<a class='timestamp' href='#674382'><time timestamp='2019-07-30T19:32:00Z'>19:32</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, it&#x27;s 10% faster to skip the bip30 checks
<br>
</div>

<div class='talk op-msg' data-timestamp='1564515240' id='674383'>
<a class='timestamp' href='#674383'><time timestamp='2019-07-30T19:34:00Z'>19:34</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hmm, fun.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564515420' id='674384'>
<a class='timestamp' href='#674384'><time timestamp='2019-07-30T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: well you at least need to fix sdaftuar&#x27;s comment on the pr, but mostly I&#x27;m highly dubious of reorg conditions around the bip30 shit
<br>
</div>

<div class='talk op-msg' data-timestamp='1564515420' id='674385'>
<a class='timestamp' href='#674385'><time timestamp='2019-07-30T19:37:00Z'>19:37</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if you write a test that tests shit like that, I&#x27;ll be happy :p
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516620' id='674386'>
<a class='timestamp' href='#674386'><time timestamp='2019-07-30T19:57:00Z'>19:57</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
fanquake: care2merge #16433
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516680' id='674387'>
<a class='timestamp' href='#674387'><time timestamp='2019-07-30T19:58:00Z'>19:58</time></a>
&lt;<span class='nick nick-9'> gribble</span>&gt;
<a href="https://github.com/bitcoin/bitcoin/issues/16433" class="link" target="_blank">https://github.com/bitcoin/bitcoin/issues/16433</a> | txmempool: Remove unused default value MemPoolRemovalReason::UNKNOWN by MarcoFalke ¬∑ Pull Request #16433 ¬∑ bitcoin/bitcoin ¬∑ GitHub
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516740' id='674388'>
<a class='timestamp' href='#674388'><time timestamp='2019-07-30T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: hell.. It&#x27;s 4am for poor fanquake. Let me have a look. :)
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516740' id='674389'>
<a class='timestamp' href='#674389'><time timestamp='2019-07-30T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oh, ehh, bad timezone conversion, was thinking it was later than it was
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516740' id='674390'>
<a class='timestamp' href='#674390'><time timestamp='2019-07-30T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
I thought fanquake lived in a timeless realm
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516740' id='674391'>
<a class='timestamp' href='#674391'><time timestamp='2019-07-30T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
heh
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516740' id='674392'>
<a class='timestamp' href='#674392'><time timestamp='2019-07-30T19:59:00Z'>19:59</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
whatever, its trivial
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516860' id='674393'>
<a class='timestamp' href='#674393'><time timestamp='2019-07-30T20:01:00Z'>20:01</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
BlueMatt: Thinking about <a href="https://github.com/bitcoin/bitcoin/pull/16442#discussion_r308429740" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16442#discussion_r308429740</a> more (the BlockRequestAllowed comment), I think just checking the stop block might be OK
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674394'>
<a class='timestamp' href='#674394'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
BlueMatt: your utACK didn&#x27;t end up in the commit merge message because you missed the commit hash :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674395'>
<a class='timestamp' href='#674395'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: meh
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674396'>
<a class='timestamp' href='#674396'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
its trivial enough I figured no one cared
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674397'>
<a class='timestamp' href='#674397'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jimpo: hmm? 
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674398'>
<a class='timestamp' href='#674398'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
somehow github-merge.py does
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674399'>
<a class='timestamp' href='#674399'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jonasschnelli pushed 2 commits to master: <a href="https://github.com/bitcoin/bitcoin/compare/74f1a27f2f45...39763b75556b" class="link" target="_blank">https://github.com/bitcoin/bitcoin/compare/74f1a27f2f45...39763b75556b</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674400'>
<a class='timestamp' href='#674400'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 0000ff0 MarcoFalke: txmempool: Remove unused default value MemPoolRemovalReason::UNKNOWN
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674401'>
<a class='timestamp' href='#674401'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
bitcoin/master 39763b7 Jonas Schnelli: Merge #16433: txmempool: Remove unused default value MemPoolRemovalReason:...
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516920' id='674402'>
<a class='timestamp' href='#674402'><time timestamp='2019-07-30T20:02:00Z'>20:02</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jonasschnelli: right, I mean no reason to need or care about anoher ack on something that trivial
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516980' id='674403'>
<a class='timestamp' href='#674403'><time timestamp='2019-07-30T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
sure
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516980' id='674404'>
<a class='timestamp' href='#674404'><time timestamp='2019-07-30T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
I assume the concern is some pathological case where there&#x27;s a stale chain where some of the early stale blocks are more than 1 month old but the latest blocks in the chain are less than 1 month old?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516980' id='674405'>
<a class='timestamp' href='#674405'><time timestamp='2019-07-30T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jimpo: right, thats why I was referencing
<br>
</div>

<div class='talk op-msg' data-timestamp='1564516980' id='674406'>
<a class='timestamp' href='#674406'><time timestamp='2019-07-30T20:03:00Z'>20:03</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] jonasschnelli merged pull request #16433: txmempool: Remove unused default value MemPoolRemovalReason::UNKNOWN (master...1907-txmempoolNoUnknownDefault) <a href="https://github.com/bitcoin/bitcoin/pull/16433" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16433</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517040' id='674407'>
<a class='timestamp' href='#674407'><time timestamp='2019-07-30T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jimpo: ah, you&#x27;re right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517040' id='674408'>
<a class='timestamp' href='#674408'><time timestamp='2019-07-30T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
In that cause, it&#x27;s plausible that the node has been online less than a month and synced up the earlier stale blocks since the chain is &quot;active&quot; in some sense
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517040' id='674409'>
<a class='timestamp' href='#674409'><time timestamp='2019-07-30T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jimpo: yea, doesn&#x27;t matter
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517040' id='674410'>
<a class='timestamp' href='#674410'><time timestamp='2019-07-30T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
no, specifically it doesnt matter cause it doesn&#x27;t reveal information
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517040' id='674411'>
<a class='timestamp' href='#674411'><time timestamp='2019-07-30T20:04:00Z'>20:04</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
if you are BLOCK_VALID_SCRIPTS at the top of the fork, then you are clearly also BLOCK_VALID_SCRIPTS everywhere down the fork path
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517100' id='674412'>
<a class='timestamp' href='#674412'><time timestamp='2019-07-30T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so hiding the fact that you have those blocks...welll...you&#x27;re not hiding anything
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517100' id='674413'>
<a class='timestamp' href='#674413'><time timestamp='2019-07-30T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
well yes, that too
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517100' id='674414'>
<a class='timestamp' href='#674414'><time timestamp='2019-07-30T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
I mean, I still think having the BlockRequestAllowed check in addition to the BLOCK_VALID_SCRIPTS check is valuable
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517100' id='674415'>
<a class='timestamp' href='#674415'><time timestamp='2019-07-30T20:05:00Z'>20:05</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
but just on the stop block should be fine
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517160' id='674416'>
<a class='timestamp' href='#674416'><time timestamp='2019-07-30T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
hmm? no my point with that comment was that BlockRequestAllowed already does the BLOCK_VALID_SCRIPTS check for you
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517160' id='674417'>
<a class='timestamp' href='#674417'><time timestamp='2019-07-30T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
so....no reason to call it again
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517160' id='674418'>
<a class='timestamp' href='#674418'><time timestamp='2019-07-30T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
yes, I agree with that
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517160' id='674419'>
<a class='timestamp' href='#674419'><time timestamp='2019-07-30T20:06:00Z'>20:06</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
I am removing the redundant check
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517220' id='674420'>
<a class='timestamp' href='#674420'><time timestamp='2019-07-30T20:07:00Z'>20:07</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
but it&#x27;s still better to do the full BlockRequestAllowed check instead of just the BLOCK_VALID_SCRIPTS check
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674421'>
<a class='timestamp' href='#674421'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
not just better, you must
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674422'>
<a class='timestamp' href='#674422'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
just to prevent fingerprinting, right? Or is there another reason?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674423'>
<a class='timestamp' href='#674423'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
right
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674424'>
<a class='timestamp' href='#674424'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, either im missing something or this will cause reorg issues in exactly the same way an invalid script would
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674425'>
<a class='timestamp' href='#674425'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
except that it doesn&#x27;t let a miner steal coins just destroy them
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674426'>
<a class='timestamp' href='#674426'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
so like
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674427'>
<a class='timestamp' href='#674427'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
why
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517280' id='674428'>
<a class='timestamp' href='#674428'><time timestamp='2019-07-30T20:08:00Z'>20:08</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: ehhh, the cache flushing shit is....complicated
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517340' id='674429'>
<a class='timestamp' href='#674429'><time timestamp='2019-07-30T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: go read the comment(s) there, and then test it anyway :P
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517340' id='674430'>
<a class='timestamp' href='#674430'><time timestamp='2019-07-30T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, there&#x27;s no cache flushing issues
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517340' id='674431'>
<a class='timestamp' href='#674431'><time timestamp='2019-07-30T20:09:00Z'>20:09</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
the BIP30 checks are literally always cache miss down to disk unless the blocks invalid
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517400' id='674432'>
<a class='timestamp' href='#674432'><time timestamp='2019-07-30T20:10:00Z'>20:10</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sdaftuar, did i read your comment right?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517460' id='674433'>
<a class='timestamp' href='#674433'><time timestamp='2019-07-30T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-13'> jimpo</span>&gt;
BlueMatt: To be clear, you agree that there&#x27;s no need to additionally check BlockRequestAllowed on the start block right? Is your reasoning the same as mine?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517460' id='674434'>
<a class='timestamp' href='#674434'><time timestamp='2019-07-30T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, oh and the 10% is probably the smallest improvement possible, an rpi with a spinning disk would almost certainly be more than 10%
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517460' id='674435'>
<a class='timestamp' href='#674435'><time timestamp='2019-07-30T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
jimpo: thats my understanding yes, not sure what your reasoning is
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517460' id='674436'>
<a class='timestamp' href='#674436'><time timestamp='2019-07-30T20:11:00Z'>20:11</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
phantomcircuit: ah, right, sorry, I&#x27;m mis-thinking about this
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517640' id='674437'>
<a class='timestamp' href='#674437'><time timestamp='2019-07-30T20:14:00Z'>20:14</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, wait does leveldb do a bloomfilter lookup for key existence?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517700' id='674438'>
<a class='timestamp' href='#674438'><time timestamp='2019-07-30T20:15:00Z'>20:15</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517760' id='674439'>
<a class='timestamp' href='#674439'><time timestamp='2019-07-30T20:16:00Z'>20:16</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
so maybe it doesn&#x27;t do a disk lookup and instead is just the cost of the bloomfilter that&#x27;s being saved?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517880' id='674440'>
<a class='timestamp' href='#674440'><time timestamp='2019-07-30T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
yes
<br>
</div>

<div class='talk op-msg' data-timestamp='1564517880' id='674441'>
<a class='timestamp' href='#674441'><time timestamp='2019-07-30T20:18:00Z'>20:18</time></a>
&lt;<span class='nick nick-13'> sipa</span>&gt;
and the bloomfilter is likely cached in ram
<br>
</div>

<div class='talk op-msg' data-timestamp='1564518360' id='674442'>
<a class='timestamp' href='#674442'><time timestamp='2019-07-30T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
#proposedmeetingtopic bitcoin-dev mailing list moderation
<br>
</div>

<div class='talk op-msg' data-timestamp='1564518360' id='674443'>
<a class='timestamp' href='#674443'><time timestamp='2019-07-30T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-4'> BlueMatt</span>&gt;
oh boy
<br>
</div>

<div class='talk op-msg' data-timestamp='1564518360' id='674444'>
<a class='timestamp' href='#674444'><time timestamp='2019-07-30T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
heh... don&#x27;t fear
<br>
</div>

<div class='talk op-msg' data-timestamp='1564518360' id='674445'>
<a class='timestamp' href='#674445'><time timestamp='2019-07-30T20:26:00Z'>20:26</time></a>
&lt;<span class='nick nick-13'> jonasschnelli</span>&gt;
It&#x27;s just about ramping up more people so we can have actual debates without +48h lags
<br>
</div>

<div class='talk op-msg' data-timestamp='1564518420' id='674446'>
<a class='timestamp' href='#674446'><time timestamp='2019-07-30T20:27:00Z'>20:27</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] MarcoFalke closed pull request #16264: policy: Add experimental -mempoolreplacement=full (off by default) (master...1906-policyFullRbf) <a href="https://github.com/bitcoin/bitcoin/pull/16264" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16264</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564519020' id='674447'>
<a class='timestamp' href='#674447'><time timestamp='2019-07-30T20:37:00Z'>20:37</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sipa, well it&#x27;s most definitely faster without the 34m lookups at least
<br>
</div>

<div class='talk op-msg' data-timestamp='1564519080' id='674448'>
<a class='timestamp' href='#674448'><time timestamp='2019-07-30T20:38:00Z'>20:38</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
it also made generating (very bad) data on leveldb Get calls vs dbcache easier
<br>
</div>

<div class='talk op-msg' data-timestamp='1564520520' id='674449'>
<a class='timestamp' href='#674449'><time timestamp='2019-07-30T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-5'> emilengler</span>&gt;
I don&#x27;t get where the bitcoin-qt rpc console detecs when Ctrl-L is being pressed? With the help of the grep command I&#x27;ve only found the way how Ctrl-Q is being handled. Can someone tell me where I find it?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564520520' id='674450'>
<a class='timestamp' href='#674450'><time timestamp='2019-07-30T21:02:00Z'>21:02</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
promag: it‚Äôll be a missing SDK. Assuming your building for MacOS
<br>
</div>

<div class='talk op-msg' data-timestamp='1564520760' id='674451'>
<a class='timestamp' href='#674451'><time timestamp='2019-07-30T21:06:00Z'>21:06</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] instagibbs opened pull request #16500: GetFee should round up to avoid undershooting feerate (master...fix_filter_mempool_mistmatch) <a href="https://github.com/bitcoin/bitcoin/pull/16500" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16500</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564521780' id='674452'>
<a class='timestamp' href='#674452'><time timestamp='2019-07-30T21:23:00Z'>21:23</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ronaldstoner opened pull request #16501: Update configure.ac to remove extra no in $use_tests (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/16501" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16501</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564522260' id='674453'>
<a class='timestamp' href='#674453'><time timestamp='2019-07-30T21:31:00Z'>21:31</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ronaldstoner closed pull request #16501: Update configure.ac to remove extra no in $use_tests (master...master) <a href="https://github.com/bitcoin/bitcoin/pull/16501" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16501</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564523580' id='674454'>
<a class='timestamp' href='#674454'><time timestamp='2019-07-30T21:53:00Z'>21:53</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] promag opened pull request #16502: wallet: Drop unused OldKey (master...2019-07-drop-oldkey) <a href="https://github.com/bitcoin/bitcoin/pull/16502" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16502</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564523640' id='674455'>
<a class='timestamp' href='#674455'><time timestamp='2019-07-30T21:54:00Z'>21:54</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] promag closed pull request #16494: wallet: Drop support to serialize OldKey (master...2019-07-drop-oldkey-serialize) <a href="https://github.com/bitcoin/bitcoin/pull/16494" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16494</a>
<br>
</div>

<div class='talk op-msg' data-timestamp='1564523760' id='674456'>
<a class='timestamp' href='#674456'><time timestamp='2019-07-30T21:56:00Z'>21:56</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
fanquake: which sdk?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564523940' id='674457'>
<a class='timestamp' href='#674457'><time timestamp='2019-07-30T21:59:00Z'>21:59</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
promag: the macOS SDK. Are you building depends for a macOS HOST?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524000' id='674458'>
<a class='timestamp' href='#674458'><time timestamp='2019-07-30T22:00:00Z'>22:00</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
I&#x27;m on a mac, building for mac
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524060' id='674459'>
<a class='timestamp' href='#674459'><time timestamp='2019-07-30T22:01:00Z'>22:01</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
sdaftuar, sorry im confused i dont see how removing the bip30 check would prevent a reorg to a greater pow chain
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524120' id='674460'>
<a class='timestamp' href='#674460'><time timestamp='2019-07-30T22:02:00Z'>22:02</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Does the version of macOS you‚Äôre on have the correct SDK? Are you testing the tool chain update PR
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524240' id='674461'>
<a class='timestamp' href='#674461'><time timestamp='2019-07-30T22:04:00Z'>22:04</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
fanquake: `xcrun --sdk macosx --show-sdk-path` gives /Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524300' id='674462'>
<a class='timestamp' href='#674462'><time timestamp='2019-07-30T22:05:00Z'>22:05</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
promag: oh, did you recently update your macOS or Xcode?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524360' id='674463'>
<a class='timestamp' href='#674463'><time timestamp='2019-07-30T22:06:00Z'>22:06</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
fanquake: nope, I don&#x27;t recall doing it, at least recently
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524360' id='674464'>
<a class='timestamp' href='#674464'><time timestamp='2019-07-30T22:06:00Z'>22:06</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
why?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524480' id='674465'>
<a class='timestamp' href='#674465'><time timestamp='2019-07-30T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
In newer versions of Xcode some of the headers our depends packages rely on aren‚Äôt where they used to be, and there a a script you can run that‚Äôll put them back. See this comment: <a href="https://github.com/bitcoin/bitcoin/pull/16392#issuecomment-515268092" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16392#issuecomment-515268092</a> and the one I‚Äôm referencing.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524480' id='674466'>
<a class='timestamp' href='#674466'><time timestamp='2019-07-30T22:08:00Z'>22:08</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Otherwise unsure atm.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524720' id='674467'>
<a class='timestamp' href='#674467'><time timestamp='2019-07-30T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
should it work if I have the previous sdk?
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524720' id='674468'>
<a class='timestamp' href='#674468'><time timestamp='2019-07-30T22:12:00Z'>22:12</time></a>
&lt;<span class='nick nick-8'> promag</span>&gt;
fanquake: ^
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524840' id='674469'>
<a class='timestamp' href='#674469'><time timestamp='2019-07-30T22:14:00Z'>22:14</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
promag: no, in that PR it‚Äôll be looking for the newer one. Thinking about that, we could drop the requirements.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564524900' id='674470'>
<a class='timestamp' href='#674470'><time timestamp='2019-07-30T22:15:00Z'>22:15</time></a>
&lt;<span class='nick nick-8'> fanquake</span>&gt;
Although, at least it‚Äôs easy to download and extract the new SDK on a mac.
<br>
</div>

<div class='talk op-msg' data-timestamp='1564526820' id='674471'>
<a class='timestamp' href='#674471'><time timestamp='2019-07-30T22:47:00Z'>22:47</time></a>
&lt;<span class='nick nick-4'> phantomcircuit</span>&gt;
BlueMatt, what am i missing
<br>
</div>

<div class='talk op-msg' data-timestamp='1564528080' id='674472'>
<a class='timestamp' href='#674472'><time timestamp='2019-07-30T23:08:00Z'>23:08</time></a>
&lt;<span class='nick nick-11'> bitcoin-git</span>&gt;
[bitcoin] ariard opened pull request #16503: Remove p2pEnabled from Chain interface (master...2019-07-remove-p2p-chain) <a href="https://github.com/bitcoin/bitcoin/pull/16503" class="link" target="_blank">https://github.com/bitcoin/bitcoin/pull/16503</a>
<br>
</div>

</div>
</section>

</body>
</html>
